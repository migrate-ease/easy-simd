#define EASYSIMD_TEST_X86_AVX512_INSN range

#include <test/x86/avx512/test-avx512.h>
#include <easysimd/x86/avx512/reduce.h>
#include <easysimd/x86/avx512/set.h>

static int
test_easysimd_mm512_reduce_add_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { {  INT64_C( 7468690105001643914),  INT64_C( 3690122393492869766), -INT64_C( 6066736503053115468),  INT64_C( 3807590806574124331),
        -INT64_C( 7650982381975048106),  INT64_C( 6091914127295294867), -INT64_C(  835065020672824717), -INT64_C( 1447045723866051315) },
      5058487802796893272  },
    { {  INT64_C( 6459051121688610303), -INT64_C( 8590270950389300523), -INT64_C( 8637428571527759260),  INT64_C( 7457164286125627902),
        -INT64_C( 3328413031788522576),  INT64_C( 2231832383777570651), -INT64_C( 1203466115266887607),  INT64_C( 7464434590342548422) },
      1852903712961887312  },
    { { -INT64_C( 9106369543623865134),  INT64_C( 4397180048276383020), -INT64_C( 8859620888018857684),  INT64_C( 6914795145929133529),
        -INT64_C( 5909623754527484843),  INT64_C(  424070474991201969),  INT64_C(  733293105140393194), -INT64_C( 9176207204462960196) },
     -2135738542586504529  },
    { {  INT64_C( 5878314209073943652), -INT64_C( 6141544569965762587), -INT64_C( 3316478818900580675), -INT64_C( 8643602701405809823),
        -INT64_C( 2123727611742058859),  INT64_C( 1482077180604284455), -INT64_C( 4237329365852822453), -INT64_C( 6829044675352966258) },
     -5484592279832220932  },
    { { -INT64_C( 3512139582611675294), -INT64_C( 7761874482813738019), -INT64_C( 3146566680126928340),  INT64_C( 7214414770022557297),
         INT64_C( 3665656683637831272),  INT64_C(  848839328445929194),  INT64_C( 5914336685387987960), -INT64_C( 4395814113372038761) },
     -1173147391430074691  },
    { { -INT64_C( 5446063846557826332),  INT64_C( 8589119300502540616),  INT64_C( 6313424080384478825),  INT64_C( 4575357448746003810),
         INT64_C( 5345740882512990385),  INT64_C( 3290622540819535540), -INT64_C( 8320094470394060686),  INT64_C( 1953937070863448707) },
     -2144701066832440751  },
    { {  INT64_C( 3198617279979230487), -INT64_C( 1527835759910857509), -INT64_C( 2441050660282808982),  INT64_C( 5090432277033019424),
        -INT64_C( 2732906520011326866), -INT64_C( 1947166398807969384), -INT64_C( 2610795050686736757), -INT64_C( 4074340009251602177) },
     -7045044841939051764  },
    { {  INT64_C( 3467419423813260612),  INT64_C( 7534305425332672304), -INT64_C( 6996603026076203184), -INT64_C( 7299700204435125102),
         INT64_C( 5683537363982966550), -INT64_C( 6063665501253853037), -INT64_C( 3689681496987719793), -INT64_C( 1091161003364149013) },
     -8455549018988150663  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_add_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_add_epi64");
    if(res != test_vec[i].res)
        return 1;
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_add_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { { -INT64_C( 8979761467014543669), -INT64_C( 5140220713430436006), -INT64_C( 7054472885930533272),  INT64_C( 1082377131910709329),
        -INT64_C( 5336987267131645466),  INT64_C( 8873256827357941485),  INT64_C( 7812311709725466755),  INT64_C( 4286227644967089448) },
      UINT8_C(158),
       INT64_C( 6283667984094735649) },
    { {  INT64_C( 7238885037129246545), -INT64_C( 6498146687008645079), -INT64_C(  157296096261923391),  INT64_C(  738747266815442660),
         INT64_C( 1382613786326874677),  INT64_C( 6526052971713767399),  INT64_C( 7049774428661699023), -INT64_C( 1380842882868303854) },
      UINT8_C(124),
      -INT64_C( 2906851716453691248) },
    { { -INT64_C( 8189943362436548760),  INT64_C( 2727916747039917018), -INT64_C( 5734485816371924092),  INT64_C( 8558055413208463109),
         INT64_C( 9043295826107312650), -INT64_C( 5946610604779657344),  INT64_C( 2544659265323670296),  INT64_C( 1382094953939449513) },
      UINT8_C( 90),
       INT64_C( 4427183177969811457) },
    { {  INT64_C( 3229498216042857492), -INT64_C( 5079494550308444923),  INT64_C( 2892712230289613321),  INT64_C( 2229356627808607334),
         INT64_C( 8068551034868330057),  INT64_C( 6538201162550169189), -INT64_C(  930000410019261571), -INT64_C( 2955071030725883435) },
      UINT8_C(104),
       INT64_C( 7837557380339514952) },
    { { -INT64_C( 1436294660689320852),  INT64_C( 7201985675694773274),  INT64_C( 4772659989937512812), -INT64_C( 8912441036650898834),
         INT64_C( 9210778664045716298),  INT64_C( 1408474013599273047), -INT64_C( 3601836949310440248), -INT64_C( 4365387193662385202) },
      UINT8_C( 42),
      -INT64_C(  301981347356852513) },
    { { -INT64_C( 8199632708007187812),  INT64_C( 7255661739364474114),  INT64_C( 5279788275169784770),  INT64_C( 3637366529701587785),
         INT64_C( 1746347818736486704),  INT64_C( 9146726990580118179), -INT64_C( 8005647208354040794),  INT64_C( 6786461945863186533) },
      UINT8_C(100),
       INT64_C( 6420868057395862155) },
    { { -INT64_C( 4960271574868751297),  INT64_C( 6372300608715077013), -INT64_C( 7383034831155819798), -INT64_C(  805821401473251823),
         INT64_C( 8373497787399687217), -INT64_C( 8406766254182061224),  INT64_C( 3944654254843688245), -INT64_C( 2636730405886982720) },
      UINT8_C(191),
       INT64_C( 8999918002257448984) },
    { {  INT64_C( 3881561410229982690),  INT64_C( 2751524764636339152), -INT64_C( 7418694041295170287), -INT64_C( 3794810552182407133),
        -INT64_C( 2796120698692438668),  INT64_C( 8890672369204660235),  INT64_C( 5838022113797582168), -INT64_C( 2664372416923809710) },
      UINT8_C( 52),
      -INT64_C( 1324142370782948720) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_add_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_add_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_add_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_and_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { { -INT64_C( 7562753312702304575),  INT64_C( 2061072877008036729),  INT64_C( 1244075784337619830), -INT64_C( 3162234938670451747),
        -INT64_C( 4508023749295106582), -INT64_C( 8222185233759030804), -INT64_C( 5453736178493882391), -INT64_C( 1276020608260536478) },
                       64  },
    { { -INT64_C( 9198882379616286392), -INT64_C( 7819272357863361960),  INT64_C( 4492495491227258485),  INT64_C( 1322756237255816732),
         INT64_C( 1449898206362844008),  INT64_C( 8561505624672150532),  INT64_C( 2141641949068424610), -INT64_C( 8126860808199354278) },
         4503599627370496  },
    { {  INT64_C( 1347454996258746171), -INT64_C( 6796547408142673843),  INT64_C( 3818510968637607721), -INT64_C( 2557305022043001740),
        -INT64_C( 4408845412892519024),  INT64_C( 6286961504060726650),  INT64_C( 6433663531441705621),  INT64_C( 5071210094969755106) },
             137438953472  },
    { { -INT64_C( 1224442188197828250), -INT64_C( 3842036215583590673), -INT64_C(  629472579862263129), -INT64_C( 2848858324883251867),
        -INT64_C( 4216479935985029829),  INT64_C( 8032292843131269187), -INT64_C(   38628482749501575),  INT64_C( 8028790258190016801) },
      4611686018427387904  },
    { {  INT64_C( 9007024664503958527), -INT64_C( 1118597885046803272), -INT64_C( 8431496747763273177),  INT64_C( 7524194918259055248),
         INT64_C( 8411724356881963786),  INT64_C( 2215028806822069670),  INT64_C( 5817063849217389263), -INT64_C( 5437948484808647754) },
         2251799813685248  },
    { { -INT64_C( 2482109394462270702),  INT64_C( 6825421000631076689), -INT64_C( 3304749880676711707),  INT64_C( 5439171018525868084),
        -INT64_C(  220137985774131860), -INT64_C( 5275264575572931280), -INT64_C( 1598491213011318144), -INT64_C( 2087255185291630972) },
                        0  },
    { {  INT64_C( 7280320628699063808),  INT64_C( 1401718387180784993), -INT64_C(  204605607767113187),  INT64_C( 7724595211838100828),
         INT64_C(  512125744435413420),  INT64_C( 3116994575077877436), -INT64_C( 5543094038916218932),  INT64_C( 5900853113297264142) },
        72057594037927936  },
    { {  INT64_C( 6512524344185346679), -INT64_C( 6874549072401445015),  INT64_C( 3429126253256660695),  INT64_C( 2558939233658719632),
         INT64_C( 5711517496327127943),  INT64_C( 5934772872046496177), -INT64_C(  704356610397851166), -INT64_C(  703879379153960340) },
                        0  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_and_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_and_epi64");
    if(res != test_vec[i].res)
        return 1;
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_and_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { {  INT64_C( 3308996930907151276), -INT64_C( 7504018971569446450), -INT64_C( 1384946412905088656), -INT64_C( 4084475578250321881),
        -INT64_C( 7026468844553312990),  INT64_C( 1923132329459075992),  INT64_C( 6633276912768354191), -INT64_C( 2835915680052891710) },
      UINT8_C(178),
       INT64_C( 1152996821304869120) },
    { { -INT64_C( 1206928808561465424), -INT64_C( 8034506354933016166),  INT64_C( 6913906893576839438),  INT64_C( 2674274462514729117),
         INT64_C( 6460710257563639318),  INT64_C(  360791505449403239), -INT64_C( 8828698042640710037), -INT64_C( 7668771999020183302) },
      UINT8_C(171),
       INT64_C(           536870912) },
    { {  INT64_C( 4311567690048884576),  INT64_C(  955386848353600781),  INT64_C( 7534657242960059757), -INT64_C(  927041604766138518),
         INT64_C( 6773192080796781771), -INT64_C( 3040081031144918661), -INT64_C( 6263666785641577261),  INT64_C( 4647787888092707323) },
      UINT8_C(206),
       INT64_C(             2113536) },
    { {  INT64_C( 3788505865239987425), -INT64_C( 1659733537615751762), -INT64_C( 5849103115396668708), -INT64_C( 4323626198897565201),
         INT64_C( 5088906601068895592), -INT64_C( 8588818944609338430), -INT64_C( 5447608679746374396),  INT64_C( 6213531448287529621) },
      UINT8_C(  2),
      -INT64_C( 1659733537615751762) },
    { { -INT64_C( 7258431093813427948), -INT64_C( 1247268425537475766),  INT64_C( 6483608754015397936), -INT64_C( 4597157436023410356),
        -INT64_C(  695376590967485090), -INT64_C( 6874372716629942095),  INT64_C(   64175966293150907),  INT64_C( 2728167380125559409) },
      UINT8_C( 50),
      -INT64_C( 6913023054373060608) },
    { { -INT64_C( 2569632080910687458), -INT64_C( 1763744624699309705),  INT64_C( 2045087173524000752),  INT64_C( 8674786490722778572),
        -INT64_C( 8213593652604353813),  INT64_C( 3096467985269280373), -INT64_C(  361841378824907796), -INT64_C( 3401466878442545671) },
      UINT8_C(209),
      -INT64_C( 9222809069720961016) },
    { {  INT64_C( 5319446027079055337),  INT64_C( 7969592174629348303),  INT64_C( 5781661439141640392),  INT64_C( 4909775008055005122),
         INT64_C( 5927145595245497597),  INT64_C( 4152206092908086358), -INT64_C( 7722624622209975535),  INT64_C(  930004385359333705) },
      UINT8_C( 22),
       INT64_C( 4611686027025711304) },
    { {  INT64_C(  672139455231493257),  INT64_C( 6887609274067551467), -INT64_C(  777778114767808463),  INT64_C( 5317643679891249324),
         INT64_C( 4351770615121011989), -INT64_C( 4206267961012330723),  INT64_C( 4922122785753453165),  INT64_C( 8702581085075886780) },
      UINT8_C( 45),
       INT64_C(   72057594037927936) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_and_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_and_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_and_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_mul_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { { -INT64_C( 3773868497906004063),  INT64_C( 5936192485819244943),  INT64_C(  371465441809046820), -INT64_C( 8744171999802290917),
         INT64_C(  173590292838476805), -INT64_C( 4825405134205550311),  INT64_C( 3833633215846179924), -INT64_C( 8411057765077413414) },
     -8667989162497801440  },
    { {  INT64_C( 3264424821259787480), -INT64_C( 5843161743997295726),  INT64_C( 3935598914444168784), -INT64_C( 6399267832471297249),
         INT64_C( 9068349606138632856), -INT64_C(  582494153839428382), -INT64_C(  814588769509194209),  INT64_C( 8888359518406879203) },
      -366569873567027200  },
    { {  INT64_C( 7894247789803555621), -INT64_C( 1847719638014019908), -INT64_C( 7052053471362433958), -INT64_C( 5973838501487002438),
        -INT64_C(  293776040076099596), -INT64_C( 8993766343859858046),  INT64_C( 6759855363084947573), -INT64_C( 4700048506180984687) },
      1064170468842271104  },
    { {  INT64_C( 6019951302660686929),  INT64_C( 1759725083772643774), -INT64_C( 8981275025427849892), -INT64_C( 5061937782304516551),
        -INT64_C( 1942507026508022297), -INT64_C( 3496701567463217218),  INT64_C( 1570397120183124822), -INT64_C( 5718207265126258814) },
      -821346318187765568  },
    { { -INT64_C( 9159913985310921259),  INT64_C( 4349451286385634841), -INT64_C( 2878275876871197923), -INT64_C( 3228966590045018442),
         INT64_C( 2636488193545836628), -INT64_C( 1188653629885548706),  INT64_C(  893954997898249784), -INT64_C( 1878075188171757027) },
     -2281791819704582784  },
    { { -INT64_C( 3637621591942316459),  INT64_C( 8848328907780404490), -INT64_C( 3892393564884585318), -INT64_C( 7417195197019879526),
        -INT64_C( 6210607239234253678),  INT64_C( 1112477575521100211), -INT64_C( 8972583425961658107), -INT64_C( 4152391201826381950) },
      4078960322120826080  },
    { { -INT64_C( 8641397416630200117), -INT64_C( 1297618433428514696),  INT64_C( 8706331050342546535),  INT64_C(  752836984522572152),
         INT64_C( 5211658524634135029),  INT64_C( 2807205738793259295),  INT64_C( 2710403558753604654),  INT64_C( 8004096624895843530) },
     -6649797431253050112  },
    { {  INT64_C( 3500859386505103741),  INT64_C( 3117948882180950623), -INT64_C( 3488902104212259903),  INT64_C( 2788553530050962890),
        -INT64_C( 2758726924389585801), -INT64_C( 2379241879394324526),  INT64_C(  273841316541844472),  INT64_C(  798818926993057350) },
     -3344438493089697984  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_mul_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_mul_epi64");
    if(res != test_vec[i].res)
        return 1;
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_mul_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { {  INT64_C(  298466376518790297), -INT64_C( 4983152749264191077),  INT64_C( 4050979211371679934),  INT64_C( 7553727140016992704),
        -INT64_C( 7367577833990348761),  INT64_C( 6957893898359233243), -INT64_C( 7723165572970128264),  INT64_C( 2573638945901560447) },
      UINT8_C(  7),
       INT64_C(  181661947953886970) },
    { { -INT64_C(  242457007963643475), -INT64_C( 2158070817200638163),  INT64_C( 4170697706051184020), -INT64_C( 7833068281359159330),
         INT64_C( 2006914311311216698),  INT64_C(  746678855287207796),  INT64_C( 4400664859959366498), -INT64_C( 2668438165445851267) },
      UINT8_C( 29),
      -INT64_C( 3544050430626050768) },
    { {  INT64_C(  559052804485592913), -INT64_C( 5983444861712515881),  INT64_C( 2936145614381764596),  INT64_C( 7761007388182258378),
        -INT64_C( 4615489328289038246), -INT64_C( 1369575910103879752),  INT64_C( 2027443722893789464), -INT64_C( 1615552506036491505) },
      UINT8_C( 40),
       INT64_C( 4704106926443894576) },
    { {  INT64_C( 3855872679371395917), -INT64_C( 2628667519758707933), -INT64_C( 8411798726595740090),  INT64_C( 5587563062880791804),
        -INT64_C( 8155568762731914282),  INT64_C( 6636475259429780844), -INT64_C( 8418683939621681410),  INT64_C( 2129211170273248319) },
      UINT8_C( 21),
      -INT64_C( 8551856331009154124) },
    { { -INT64_C( 8599326026603906653),  INT64_C( 5082024109733242633), -INT64_C( 7810261759774349942),  INT64_C(  855393008665418574),
         INT64_C( 8557949168382402225), -INT64_C( 1864906561860771368), -INT64_C( 6805818285594709078),  INT64_C( 1022115205316503228) },
      UINT8_C(166),
       INT64_C(   43376678049819712) },
    { {  INT64_C( 8016558027393157751),  INT64_C( 3006066122010859656), -INT64_C( 6732285246320103179),  INT64_C( 6734586672995874440),
        -INT64_C( 7218137622386472360),  INT64_C( 5079602232654602014), -INT64_C( 6778570440465122545),  INT64_C( 6028041692730486116) },
      UINT8_C(113),
       INT64_C( 2062234393336548304) },
    { {  INT64_C( 3211383801175717996),  INT64_C( 6861449966754064073),  INT64_C( 6841840234434954208),  INT64_C( 5900750033956453770),
         INT64_C( 5917259911854778468),  INT64_C( 4683376786279144250),  INT64_C( 1947176340454078262),  INT64_C( 7941376710024191488) },
      UINT8_C(217),
       INT64_C( 6396000472148049920) },
    { {  INT64_C( 1839918902338019577), -INT64_C( 7199081906980706514),  INT64_C( 2398809755128544904),  INT64_C( 6709969150764855253),
         INT64_C( 7174571981816955129),  INT64_C( 5412301747404409434),  INT64_C( 7421334678052096281), -INT64_C( 4912922786266404849) },
      UINT8_C( 74),
       INT64_C( 5247347702559608790) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_mul_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_mul_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_mul_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_or_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { { -INT64_C( 5562977680541367591),  INT64_C( 2664561762610853846), -INT64_C( 4039933470773882716), -INT64_C( 4894751009893247066),
         INT64_C( 2599573479174895899), -INT64_C( 6434416801523525950), -INT64_C( 1162979523087236052), -INT64_C( 6486634229298483109) },
             -68719476737  },
    { { -INT64_C( 7993780820546548057),  INT64_C( 1889689538234569550),  INT64_C( 6714725894159230078),  INT64_C( 1509138449595765059),
        -INT64_C( 6855755911933792361),  INT64_C( 2198698489068526025), -INT64_C( 4631895607554540100), -INT64_C( 2034143460992957628) },
                   -65537  },
    { { -INT64_C( 7843978554700826112), -INT64_C( 3242789323625073793),  INT64_C(  239701435215209849), -INT64_C( 2205326887759249839),
        -INT64_C( 4451716681656456300), -INT64_C( 2133776682655605434),  INT64_C( 8350984472519609010),  INT64_C( 1182504399821627814) },
      -864691128455135233  },
    { { -INT64_C( 8196275768619377703),  INT64_C( 1625718167704794434), -INT64_C( 1487994772259348704),  INT64_C( 2828518187498181794),
        -INT64_C( 3823377381282705979), -INT64_C( 5171052009978273513),  INT64_C( 5343939490595672986),  INT64_C( 7460134315288475665) },
              -2147483649  },
    { { -INT64_C( 4439282376556558871), -INT64_C( 3749458355522976828), -INT64_C( 2722522949873725752), -INT64_C( 1764840414623436043),
         INT64_C( 8701011332541854667), -INT64_C( 5386539429966663946), -INT64_C( 3936106678618149704),  INT64_C( 5763372239237578005) },
          -70368744177665  },
    { {  INT64_C(  256244746781595153), -INT64_C( 7662205199792505283),  INT64_C( 5090813850860162203), -INT64_C( 3425275870908900823),
        -INT64_C( 8480082053262217201), -INT64_C( 8954075353357121488),  INT64_C( 4812034738718172231), -INT64_C( 7966866080267597342) },
     -2305843009213693953  },
    { {  INT64_C( 8654519849028105609), -INT64_C( 8333855862221069060), -INT64_C( 8534776758157899383),  INT64_C( 6803668916677341430),
         INT64_C( 5844388454558092977), -INT64_C( 2819493819072045804), -INT64_C(  830531505753383889), -INT64_C( 7926490510065703733) },
         -140737488355329  },
    { { -INT64_C( 2853223040094481472), -INT64_C( 8532901434634849171), -INT64_C( 8603577617264057689), -INT64_C( 3185971202671140777),
        -INT64_C( 4893354168809816453), -INT64_C(  763343309703134587),  INT64_C( 3221820669349781873), -INT64_C( 8954795397102641196) },
                       -1  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_or_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_or_epi64");
    if(res != test_vec[i].res)
        return 1;
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_or_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { { -INT64_C( 3672154691053079940), -INT64_C( 1325505640712337370), -INT64_C( 7250544216126884239),  INT64_C( 2352030900052349840),
         INT64_C( 3160357079748649802), -INT64_C( 5119671080538313887), -INT64_C( 1816523680813321796), -INT64_C( 8646378850856458436) },
      UINT8_C(  8),
       INT64_C( 2352030900052349840) },
    { { -INT64_C( 2591195475267971375),  INT64_C( 8424223909668393189),  INT64_C(  687556379141609700),  INT64_C( 4457948372019997680),
         INT64_C(  699448978397719142), -INT64_C( 7531956247093455103), -INT64_C( 2008200864650149067), -INT64_C( 6880209153676449318) },
      UINT8_C(129),
      -INT64_C(  248050390434709541) },
    { {  INT64_C(  242821835969034347),  INT64_C( 2248790291458188002), -INT64_C( 2847128805572391629), -INT64_C( 5636057819232681295),
        -INT64_C(  190721173824312021), -INT64_C( 7869703487381237298), -INT64_C( 8878933716039836544), -INT64_C( 5158147086770972046) },
      UINT8_C(  1),
       INT64_C(  242821835969034347) },
    { {  INT64_C( 8841438436047720312),  INT64_C(  200527995593121046),  INT64_C( 6467831517704206239),  INT64_C( 6826505844707195686),
         INT64_C(  545487445697943725),  INT64_C( 8465105759016806994), -INT64_C( 3411609027174117169), -INT64_C( 2862804833741927166) },
      UINT8_C( 30),
       INT64_C( 6917529027641081791) },
    { { -INT64_C( 1526695532568776824),  INT64_C( 1390828073200404582), -INT64_C( 3349396901761016581),  INT64_C( 4142420715053542167),
         INT64_C(  589556632727751876),  INT64_C( 2352519638208147407),  INT64_C(  469543072106177136),  INT64_C( 1908366627718857105) },
      UINT8_C(109),
      -INT64_C(     562949953421313) },
    { {  INT64_C( 8901110181183577650),  INT64_C( 2369668278149716382), -INT64_C( 7270474345228560798),  INT64_C(  776883959604796538),
        -INT64_C( 8182676649162909591),  INT64_C( 3837880324126216803), -INT64_C( 2148261653060431239), -INT64_C( 7631905732279000780) },
      UINT8_C(222),
      -INT64_C(      35188667056129) },
    { {  INT64_C( 1118684899240217816),  INT64_C( 4376117757815728222), -INT64_C( 6926387248763744300), -INT64_C( 2690230063251788603),
         INT64_C( 3745732469899229422), -INT64_C( 4012090493143491285),  INT64_C( 4800085677946762879), -INT64_C( 5107723219242161856) },
      UINT8_C( 48),
      -INT64_C(  289439881892069905) },
    { {  INT64_C( 8991500013742236698),  INT64_C( 2764428624033537454),  INT64_C( 7008417923012451245), -INT64_C( 4837739412866693644),
        -INT64_C( 3844630302054292855), -INT64_C(  264579540953000194), -INT64_C( 3334280155160971423),  INT64_C( 6135128422063400646) },
      UINT8_C( 60),
      -INT64_C(      26389621243905) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_or_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_or_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_or_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_and_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(  1827390763), -INT32_C(   169052319), -INT32_C(    46908052),  INT32_C(   970229199),  INT32_C(   950868303), -INT32_C(  1515880592),  INT32_C(   277221569), -INT32_C(   431822405),
         INT32_C(   273821359),  INT32_C(   285556645),  INT32_C(  1276000636),  INT32_C(   243655358),  INT32_C(  1816540156),  INT32_C(  1930554546), -INT32_C(  1216112644),  INT32_C(   815711873) },
             0  },
    { { -INT32_C(  1723797260), -INT32_C(  1398127313),  INT32_C(  1022933118), -INT32_C(  1773503078),  INT32_C(  1644335536),  INT32_C(  2044007549),  INT32_C(   741366187),  INT32_C(   324849183),
        -INT32_C(   290677569),  INT32_C(  1603950305), -INT32_C(  1466134002), -INT32_C(  1069554160), -INT32_C(   199016073),  INT32_C(    23984213),  INT32_C(  1882037841),  INT32_C(   730040940) },
             0  },
    { {  INT32_C(   135933734), -INT32_C(  1821920123),  INT32_C(  1463550791),  INT32_C(  1628929002),  INT32_C(   307641020), -INT32_C(  2079079629), -INT32_C(   822787999), -INT32_C(   235308854),
         INT32_C(   771298216),  INT32_C(   264331464),  INT32_C(  1315372388),  INT32_C(   883916152), -INT32_C(   347732552),  INT32_C(   711940553),  INT32_C(  1694000282), -INT32_C(  2057964835) },
             0  },
    { { -INT32_C(   843952635),  INT32_C(   333214639), -INT32_C(   396279184),  INT32_C(  2015170752), -INT32_C(   547134698),  INT32_C(  1460261565),  INT32_C(   347800119), -INT32_C(   107408908),
         INT32_C(   247941983),  INT32_C(   790733759), -INT32_C(  1508343066), -INT32_C(  1457637997),  INT32_C(  1435009432), -INT32_C(  1968402093), -INT32_C(  2019661677), -INT32_C(   662620295) },
             0  },
    { {  INT32_C(  1122453635), -INT32_C(   781121301),  INT32_C(   511150475),  INT32_C(  1472697790),  INT32_C(  1789677334),  INT32_C(  1962170848),  INT32_C(   989565889),  INT32_C(  1293057226),
        -INT32_C(  1332741692), -INT32_C(  1920925438),  INT32_C(  1236007306), -INT32_C(  1516211570), -INT32_C(  1592832831),  INT32_C(  1712653221),  INT32_C(  1637880214),  INT32_C(  1387180941) },
             0  },
    { { -INT32_C(  1375584596), -INT32_C(   918846657),  INT32_C(   185788028),  INT32_C(   431010392), -INT32_C(  1531199489),  INT32_C(  1493946562),  INT32_C(  1874504673),  INT32_C(   197224542),
        -INT32_C(   440810586), -INT32_C(  1011878586),  INT32_C(   885965275),  INT32_C(  1934458484), -INT32_C(    15267779), -INT32_C(  1168629031),  INT32_C(   740889294),  INT32_C(   557312635) },
             0  },
    { { -INT32_C(   200805971), -INT32_C(  1044924698), -INT32_C(   336231049),  INT32_C(  1079919363),  INT32_C(   608138827),  INT32_C(  1725929624),  INT32_C(   630393002), -INT32_C(  1605907725),
        -INT32_C(  1584116037),  INT32_C(  2070104836), -INT32_C(   748201776), -INT32_C(   418134629), -INT32_C(   737455301), -INT32_C(  1791300885), -INT32_C(   423899661),  INT32_C(  1401291416) },
             0  },
    { {  INT32_C(  1425349456),  INT32_C(   936335462),  INT32_C(  1275737776),  INT32_C(   926097148),  INT32_C(  1544240753),  INT32_C(   485574185), -INT32_C(  1425888237), -INT32_C(    16807762),
         INT32_C(   173208739), -INT32_C(    62840244),  INT32_C(  1414024024), -INT32_C(   628327575), -INT32_C(   482961478), -INT32_C(   234936099), -INT32_C(  2086927916),  INT32_C(   763468681) },
             0  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_and_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_and_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}

static int
test_easysimd_mm512_reduce_add_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {

  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { { -INT32_C(   947420736), -INT32_C(   136827657), -INT32_C(   606913089),  INT32_C(   730616257),  INT32_C(  1548420834),  INT32_C(   740127852), -INT32_C(  1571042244), -INT32_C(  1643529762),
         INT32_C(   828739642),  INT32_C(  2066300604),  INT32_C(  1012399227),  INT32_C(   812114766),  INT32_C(  1452061673),  INT32_C(  1669507623),  INT32_C(  1409670518), -INT32_C(   772600169) },
   -1998309253  },
    { {  INT32_C(  1510168734),  INT32_C(   299248790),  INT32_C(  1984834856), -INT32_C(    89737968), -INT32_C(  1890569368),  INT32_C(  1408422621),  INT32_C(  1185413295), -INT32_C(  1525114362),
        -INT32_C(  1979769869),  INT32_C(  1872483655),  INT32_C(   333900034),  INT32_C(   118328478), -INT32_C(  1667867201), -INT32_C(   554727121), -INT32_C(  2027579519),  INT32_C(   606879025) },
    -415685920  },
    { { -INT32_C(  1615975336),  INT32_C(    68045057), -INT32_C(   803736526),  INT32_C(  1087841409), -INT32_C(  1327665535),  INT32_C(  2022624503), -INT32_C(  1778404509),  INT32_C(  1220095216),
         INT32_C(  1508337496), -INT32_C(   497158480),  INT32_C(  1806922986),  INT32_C(   430738072), -INT32_C(   272004616), -INT32_C(  1184409515), -INT32_C(    61970677), -INT32_C(   347863149) },
     255416396  },
    { {  INT32_C(   524561519),  INT32_C(   201499170), -INT32_C(  1351043818),  INT32_C(   952640575),  INT32_C(    36147885), -INT32_C(   172257302), -INT32_C(  1980691978), -INT32_C(  2139867631),
        -INT32_C(  2069907358),  INT32_C(  1905303898), -INT32_C(  1776285610), -INT32_C(   640751572),  INT32_C(  1692202362),  INT32_C(  2052757380), -INT32_C(  1308406879), -INT32_C(   483231871) },
    -262363934  },
    { { -INT32_C(  1972907728), -INT32_C(   906233741),  INT32_C(   761207552),  INT32_C(  2114333956), -INT32_C(  1478237661),  INT32_C(   455228794),  INT32_C(   181216648), -INT32_C(   840040547),
         INT32_C(  1129797072),  INT32_C(  1292718925),  INT32_C(  1920625774), -INT32_C(  1108246118), -INT32_C(   580594589), -INT32_C(  1711765999),  INT32_C(  1235469740), -INT32_C(  1793683004) },
   -1301110926  },
    { {  INT32_C(   869821926),  INT32_C(   796976576), -INT32_C(   324928686), -INT32_C(   542535044),  INT32_C(  2008878438),  INT32_C(  1074902420),  INT32_C(  1065989243),  INT32_C(   735354693),
        -INT32_C(   849433332), -INT32_C(   453189742),  INT32_C(  1456512474), -INT32_C(  1774880464),  INT32_C(   453964423),  INT32_C(   593174440),  INT32_C(   425911507), -INT32_C(  1891354749) },
    -649803173  },
    { {  INT32_C(  1985782756),  INT32_C(  1549490306),  INT32_C(   649210870),  INT32_C(   750577573), -INT32_C(  2109224230), -INT32_C(  1113218327),  INT32_C(   165021574),  INT32_C(   580393534),
         INT32_C(  1067054525),  INT32_C(  1134294093), -INT32_C(   999731937),  INT32_C(   267396661), -INT32_C(   628017168),  INT32_C(  1603745497),  INT32_C(  2087218493),  INT32_C(  1167982983) },
    -431957389  },
    { {  INT32_C(  1132738550),  INT32_C(  1267146795), -INT32_C(  1576013715),  INT32_C(   129040406),  INT32_C(   299975223), -INT32_C(  1234143112),  INT32_C(  1815271909), -INT32_C(   793653030),
         INT32_C(   856897032), -INT32_C(  1015113130), -INT32_C(  1587114357), -INT32_C(   978839666), -INT32_C(   757692070), -INT32_C(   427276543), -INT32_C(    95176160), -INT32_C(  1815477109) },
    -484461681  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_add_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_add_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_mul_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(   879652617),  INT32_C(     5626867), -INT32_C(    49214996),  INT32_C(  1941089099), -INT32_C(   898243977),  INT32_C(   822400381),  INT32_C(  1889765343),  INT32_C(   622297884),
        -INT32_C(   430340622),  INT32_C(  1290186336),  INT32_C(    38401975),  INT32_C(   427162530),  INT32_C(  1524886237), -INT32_C(  1634998337), -INT32_C(  1961939346), -INT32_C(  1531959630) },
    1862672384  },
    { {  INT32_C(   193596075),  INT32_C(  1884778680),  INT32_C(   158507111),  INT32_C(  2032330908), -INT32_C(  1831598382),  INT32_C(  1546674157),  INT32_C(  1088896910),  INT32_C(   283416421),
         INT32_C(  1511747489),  INT32_C(  1204450015), -INT32_C(  1353696237), -INT32_C(   148344028),  INT32_C(  1720319097), -INT32_C(   356337316),  INT32_C(  1579854329), -INT32_C(   496038335) },
     678709248  },
    { {  INT32_C(  1564248701),  INT32_C(   279185149),  INT32_C(  1740633155), -INT32_C(   530651289),  INT32_C(  1078454244), -INT32_C(  1708521055), -INT32_C(   185051981), -INT32_C(   522819742),
        -INT32_C(   281209870),  INT32_C(  1560273177),  INT32_C(  1036304085), -INT32_C(  1994579291), -INT32_C(  1412865014),  INT32_C(   558232430), -INT32_C(  1441448633), -INT32_C(  1752503387) },
    -199812160  },
    { {  INT32_C(   411486206),  INT32_C(  2104788392), -INT32_C(   390449085),  INT32_C(  1702025307), -INT32_C(  1441776836),  INT32_C(  1993037103),  INT32_C(   924901522), -INT32_C(   892425524),
         INT32_C(   434263153),  INT32_C(   479680473), -INT32_C(   368750193),  INT32_C(  1716483881), -INT32_C(   519020622),  INT32_C(  1197006004), -INT32_C(  2004977476), -INT32_C(  1806480093) },
     193314816  },
    { {  INT32_C(  2075014561),  INT32_C(   479675788), -INT32_C(  1073308522), -INT32_C(   970566125),  INT32_C(  1789343413), -INT32_C(   810418414), -INT32_C(  1688785032),  INT32_C(   506440316),
         INT32_C(  1822023136), -INT32_C(  1182257118), -INT32_C(   528904243), -INT32_C(  1700356123), -INT32_C(   402370859), -INT32_C(   977816243),  INT32_C(  1633685221), -INT32_C(  1719693127) },
    1768587264  },
    { { -INT32_C(  1878714259),  INT32_C(   373919305),  INT32_C(    49725981),  INT32_C(   916233569),  INT32_C(   941531627),  INT32_C(  1006556502), -INT32_C(  1650630940),  INT32_C(  1547050222),
         INT32_C(  2129410869), -INT32_C(   426494519),  INT32_C(  1491634935),  INT32_C(   311330087),  INT32_C(  2085334310),  INT32_C(  1723353474), -INT32_C(  1778166361), -INT32_C(  1494075023) },
    1104822720  },
    { {  INT32_C(  1042603637),  INT32_C(   170244115),  INT32_C(  1784810819), -INT32_C(  1199705966),  INT32_C(   540395677), -INT32_C(  1199117039), -INT32_C(  1286698430),  INT32_C(   945438915),
         INT32_C(   829914654),  INT32_C(  2050726967),  INT32_C(  1021615529),  INT32_C(   737436046),  INT32_C(   978004265),  INT32_C(  1492374038),  INT32_C(   520896860), -INT32_C(  1604819326) },
      49051904  },
    { {  INT32_C(   466800612),  INT32_C(   345312619),  INT32_C(   961575595),  INT32_C(    90457563), -INT32_C(  2059423634), -INT32_C(   555928958), -INT32_C(   151131788),  INT32_C(   882267471),
        -INT32_C(  1890621404),  INT32_C(   564454774),  INT32_C(   979039327), -INT32_C(  1472217543), -INT32_C(   265453714),  INT32_C(   634260145),  INT32_C(  1125895412),  INT32_C(  1182249505) },
     123998208  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_mul_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_mul_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}

static int
test_easysimd_mm512_reduce_or_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(    51891924),  INT32_C(  1382933663), -INT32_C(   641023473), -INT32_C(   552882101), -INT32_C(  2008476776),  INT32_C(   170999026), -INT32_C(  1342105204),  INT32_C(  1902927517),
        -INT32_C(   864779475),  INT32_C(  1981735271), -INT32_C(   296687197),  INT32_C(   852319129),  INT32_C(  1622808430), -INT32_C(   529798061), -INT32_C(  1567593467), -INT32_C(   149619510) },
            -1  },
    { { -INT32_C(   406615937),  INT32_C(   224256618),  INT32_C(  1694281163),  INT32_C(  2006370569),  INT32_C(   886591968),  INT32_C(  1108624189),  INT32_C(  2045093039),  INT32_C(   527563168),
        -INT32_C(   351914879), -INT32_C(   503749610),  INT32_C(   440857873), -INT32_C(  1617765186),  INT32_C(  1792240173),  INT32_C(  1554900909),  INT32_C(   735416971),  INT32_C(   206194315) },
            -1  },
    { { -INT32_C(  1845997189), -INT32_C(   965480011), -INT32_C(  1528710682), -INT32_C(  1018989675), -INT32_C(  1976756515), -INT32_C(  1998136579), -INT32_C(   139216020),  INT32_C(  2097479170),
         INT32_C(    68090959), -INT32_C(   741703187), -INT32_C(   797463750), -INT32_C(    74204386), -INT32_C(   813317935),  INT32_C(   123169691),  INT32_C(   704580391),  INT32_C(  1487274761) },
            -1  },
    { { -INT32_C(   329468673),  INT32_C(  1891575350), -INT32_C(   264227118), -INT32_C(  1007889423),  INT32_C(   798126484),  INT32_C(    70707677), -INT32_C(    47368716),  INT32_C(   928371512),
        -INT32_C(  1121734265), -INT32_C(  1439767848),  INT32_C(   177892889), -INT32_C(   691173822), -INT32_C(   721068040),  INT32_C(  1037646665), -INT32_C(  1455749519),  INT32_C(  1625395417) },
            -1  },
    { {  INT32_C(   438174786),  INT32_C(    12864743), -INT32_C(    66429254), -INT32_C(   573384475), -INT32_C(  2135763145), -INT32_C(  2067887341),  INT32_C(  1781397905), -INT32_C(   875950455),
        -INT32_C(    85596141), -INT32_C(   268785356), -INT32_C(   303365112),  INT32_C(   348831452), -INT32_C(  1466663787), -INT32_C(  1741925881), -INT32_C(   721266101),  INT32_C(  2074135656) },
            -1  },
    { { -INT32_C(   378173771),  INT32_C(   936931119),  INT32_C(  1344586868),  INT32_C(   392490626),  INT32_C(  1908472170), -INT32_C(  1760957365), -INT32_C(  1351873722), -INT32_C(  1926624040),
        -INT32_C(  1032413038), -INT32_C(  2080813297), -INT32_C(  1781260781),  INT32_C(  2007775244),  INT32_C(  2112384049), -INT32_C(  1626017191), -INT32_C(   716275459),  INT32_C(   526547340) },
            -1  },
    { {  INT32_C(   685889817),  INT32_C(  1001183784),  INT32_C(    97550584), -INT32_C(   360940360),  INT32_C(  1114072297),  INT32_C(  1424063318), -INT32_C(  2027343621), -INT32_C(  1029272407),
        -INT32_C(  1914009755),  INT32_C(  1523095138), -INT32_C(   815818730), -INT32_C(    38151404), -INT32_C(  1774247872), -INT32_C(  1763040869), -INT32_C(    98757551),  INT32_C(    96257184) },
            -1  },
    { { -INT32_C(  1382898101),  INT32_C(  1393056317),  INT32_C(   102918130), -INT32_C(  2096833725), -INT32_C(  1776729093), -INT32_C(  1255406492), -INT32_C(  1196471784),  INT32_C(  1505585934),
         INT32_C(  1325879058), -INT32_C(  1683877975), -INT32_C(  1180580490), -INT32_C(  1673747040),  INT32_C(  1295144681),  INT32_C(  1912823642), -INT32_C(  1221938519),  INT32_C(   806414110) },
      -4194305  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_or_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_or_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}


static int
test_easysimd_mm512_reduce_add_pd (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    double array_a[8];
    double res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT64_C(    -5.28), EASYSIMD_FLOAT64_C(    73.42), EASYSIMD_FLOAT64_C(  -260.19), EASYSIMD_FLOAT64_C(  -298.43),
        EASYSIMD_FLOAT64_C(  -244.89), EASYSIMD_FLOAT64_C(    90.40), EASYSIMD_FLOAT64_C(  -239.48), EASYSIMD_FLOAT64_C(    89.03) },
          -795.420000  },
    { { EASYSIMD_FLOAT64_C(  -154.58), EASYSIMD_FLOAT64_C(    -4.51), EASYSIMD_FLOAT64_C(   110.85), EASYSIMD_FLOAT64_C(  -137.60),
        EASYSIMD_FLOAT64_C(    34.95), EASYSIMD_FLOAT64_C(   -36.77), EASYSIMD_FLOAT64_C(   -57.33), EASYSIMD_FLOAT64_C(    93.69) },
          -151.300000  },
    { { EASYSIMD_FLOAT64_C(   255.39), EASYSIMD_FLOAT64_C(    57.57), EASYSIMD_FLOAT64_C(  -244.14), EASYSIMD_FLOAT64_C(   264.58),
        EASYSIMD_FLOAT64_C(  -221.46), EASYSIMD_FLOAT64_C(  -269.37), EASYSIMD_FLOAT64_C(  -124.47), EASYSIMD_FLOAT64_C(  -251.32) },
          -533.220000  },
    { { EASYSIMD_FLOAT64_C(   191.27), EASYSIMD_FLOAT64_C(  -221.74), EASYSIMD_FLOAT64_C(    44.53), EASYSIMD_FLOAT64_C(  -260.12),
        EASYSIMD_FLOAT64_C(   -34.63), EASYSIMD_FLOAT64_C(   -80.01), EASYSIMD_FLOAT64_C(   186.68), EASYSIMD_FLOAT64_C(   260.08) },
            86.060000  },
    { { EASYSIMD_FLOAT64_C(   293.41), EASYSIMD_FLOAT64_C(   226.49), EASYSIMD_FLOAT64_C(   261.66), EASYSIMD_FLOAT64_C(  -251.48),
        EASYSIMD_FLOAT64_C(    16.88), EASYSIMD_FLOAT64_C(  -277.82), EASYSIMD_FLOAT64_C(   137.55), EASYSIMD_FLOAT64_C(   162.31) },
           569.000000  },
    { { EASYSIMD_FLOAT64_C(    17.66), EASYSIMD_FLOAT64_C(   -51.60), EASYSIMD_FLOAT64_C(  -275.29), EASYSIMD_FLOAT64_C(  -247.39),
        EASYSIMD_FLOAT64_C(   211.63), EASYSIMD_FLOAT64_C(   -32.62), EASYSIMD_FLOAT64_C(   146.31), EASYSIMD_FLOAT64_C(   167.03) },
           -64.270000  },
    { { EASYSIMD_FLOAT64_C(  -275.05), EASYSIMD_FLOAT64_C(   202.17), EASYSIMD_FLOAT64_C(   131.61), EASYSIMD_FLOAT64_C(  -196.50),
        EASYSIMD_FLOAT64_C(   232.81), EASYSIMD_FLOAT64_C(  -292.86), EASYSIMD_FLOAT64_C(  -147.82), EASYSIMD_FLOAT64_C(   124.07) },
          -221.570000  },
    { { EASYSIMD_FLOAT64_C(  -214.60), EASYSIMD_FLOAT64_C(   196.71), EASYSIMD_FLOAT64_C(   163.95), EASYSIMD_FLOAT64_C(    50.77),
        EASYSIMD_FLOAT64_C(  -183.29), EASYSIMD_FLOAT64_C(    50.64), EASYSIMD_FLOAT64_C(    10.85), EASYSIMD_FLOAT64_C(  -189.88) },
          -114.850000  }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512d a = easysimd_mm512_loadu_pd(test_vec[i].array_a);
    double res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_add_pd(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_add_pd");
    easysimd_assert_equal_f64(res, test_vec[i].res, 1);
  }

  return 0;
}


static int
test_easysimd_mm512_reduce_mul_pd (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    double array_a[8];
    double res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT64_C(  2580.93), EASYSIMD_FLOAT64_C(   674.38), EASYSIMD_FLOAT64_C(   541.15), EASYSIMD_FLOAT64_C( -1726.47),
        EASYSIMD_FLOAT64_C(   166.58), EASYSIMD_FLOAT64_C(  -275.03), EASYSIMD_FLOAT64_C(   464.88), EASYSIMD_FLOAT64_C( -1407.74) },
      EASYSIMD_FLOAT64_C(-48755526063251391512576.00) },
    { { EASYSIMD_FLOAT64_C( -2721.29), EASYSIMD_FLOAT64_C(  -295.58), EASYSIMD_FLOAT64_C(   275.03), EASYSIMD_FLOAT64_C(  -870.22),
        EASYSIMD_FLOAT64_C(   -73.54), EASYSIMD_FLOAT64_C(  1459.87), EASYSIMD_FLOAT64_C( -2417.08), EASYSIMD_FLOAT64_C(  -504.15) },
      EASYSIMD_FLOAT64_C(25185327672715116544000.00) },
    { { EASYSIMD_FLOAT64_C( -1447.20), EASYSIMD_FLOAT64_C(   607.08), EASYSIMD_FLOAT64_C(  1020.00), EASYSIMD_FLOAT64_C(   447.85),
        EASYSIMD_FLOAT64_C(  2190.27), EASYSIMD_FLOAT64_C( -1045.30), EASYSIMD_FLOAT64_C(  2590.58), EASYSIMD_FLOAT64_C(   527.30) },
      EASYSIMD_FLOAT64_C(1255164404141497031589888.00) },
    { { EASYSIMD_FLOAT64_C( -1682.30), EASYSIMD_FLOAT64_C( -2575.97), EASYSIMD_FLOAT64_C( -2035.01), EASYSIMD_FLOAT64_C(   336.00),
        EASYSIMD_FLOAT64_C( -2287.87), EASYSIMD_FLOAT64_C(  2094.55), EASYSIMD_FLOAT64_C(  2612.18), EASYSIMD_FLOAT64_C( -2706.94) },
      EASYSIMD_FLOAT64_C(-100404661462504045350486016.00) },
    { { EASYSIMD_FLOAT64_C(  -231.07), EASYSIMD_FLOAT64_C(   153.33), EASYSIMD_FLOAT64_C( -1433.41), EASYSIMD_FLOAT64_C(  2935.51),
        EASYSIMD_FLOAT64_C(  2878.30), EASYSIMD_FLOAT64_C(  2031.47), EASYSIMD_FLOAT64_C( -1472.23), EASYSIMD_FLOAT64_C( -2842.99) },
      EASYSIMD_FLOAT64_C(3648565610136235411505152.00) },
    { { EASYSIMD_FLOAT64_C( -1264.11), EASYSIMD_FLOAT64_C(  1802.79), EASYSIMD_FLOAT64_C(  -713.21), EASYSIMD_FLOAT64_C(  1662.35),
        EASYSIMD_FLOAT64_C(   262.66), EASYSIMD_FLOAT64_C(  -130.29), EASYSIMD_FLOAT64_C( -1841.80), EASYSIMD_FLOAT64_C(  1815.47) },
      EASYSIMD_FLOAT64_C(309176494156707335766016.00) },
    { { EASYSIMD_FLOAT64_C( -2523.22), EASYSIMD_FLOAT64_C(  2178.20), EASYSIMD_FLOAT64_C(  -736.69), EASYSIMD_FLOAT64_C(  2667.06),
        EASYSIMD_FLOAT64_C( -1867.10), EASYSIMD_FLOAT64_C( -1146.10), EASYSIMD_FLOAT64_C(   194.36), EASYSIMD_FLOAT64_C(  -549.40) },
      EASYSIMD_FLOAT64_C(-2467493797746198064398336.00) },
    { { EASYSIMD_FLOAT64_C(  -722.07), EASYSIMD_FLOAT64_C(  1159.35), EASYSIMD_FLOAT64_C(  2786.61), EASYSIMD_FLOAT64_C(    -9.94),
        EASYSIMD_FLOAT64_C(   253.90), EASYSIMD_FLOAT64_C(  2398.79), EASYSIMD_FLOAT64_C(   283.12), EASYSIMD_FLOAT64_C( -2977.17) },
      EASYSIMD_FLOAT64_C(-11903798257915269218304.00) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512d a = easysimd_mm512_loadu_pd(test_vec[i].array_a);
    double res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_mul_pd(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_mul_pd");
    easysimd_assert_equal_f64(res, test_vec[i].res, 1);
  }

  return 0;
}


static int
test_easysimd_mm512_reduce_add_ps (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    float array_a[16];
    float res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT32_C(  -217.41), EASYSIMD_FLOAT32_C(  1464.59), EASYSIMD_FLOAT32_C( -2652.58), EASYSIMD_FLOAT32_C(   411.12),
        EASYSIMD_FLOAT32_C(   421.51), EASYSIMD_FLOAT32_C( -1298.95), EASYSIMD_FLOAT32_C(  -764.99), EASYSIMD_FLOAT32_C( -1671.60),
        EASYSIMD_FLOAT32_C(  -911.60), EASYSIMD_FLOAT32_C(  2935.59), EASYSIMD_FLOAT32_C( -2595.06), EASYSIMD_FLOAT32_C( -2971.78),
        EASYSIMD_FLOAT32_C(   912.80), EASYSIMD_FLOAT32_C( -2185.23), EASYSIMD_FLOAT32_C(  1471.25), EASYSIMD_FLOAT32_C(  1977.34) },
      EASYSIMD_FLOAT32_C( -5675.00) },
    { { EASYSIMD_FLOAT32_C( -2858.39), EASYSIMD_FLOAT32_C( -1196.35), EASYSIMD_FLOAT32_C(  1337.80), EASYSIMD_FLOAT32_C(   225.22),
        EASYSIMD_FLOAT32_C( -2234.69), EASYSIMD_FLOAT32_C(  -106.11), EASYSIMD_FLOAT32_C( -1133.68), EASYSIMD_FLOAT32_C(  -587.69),
        EASYSIMD_FLOAT32_C(  2721.69), EASYSIMD_FLOAT32_C( -1124.18), EASYSIMD_FLOAT32_C( -2357.89), EASYSIMD_FLOAT32_C( -2091.19),
        EASYSIMD_FLOAT32_C(  2441.35), EASYSIMD_FLOAT32_C( -2872.68), EASYSIMD_FLOAT32_C( -2294.93), EASYSIMD_FLOAT32_C(  -776.05) },
      EASYSIMD_FLOAT32_C(-12907.77) },
    { { EASYSIMD_FLOAT32_C(  1591.91), EASYSIMD_FLOAT32_C( -1947.51), EASYSIMD_FLOAT32_C(  2635.06), EASYSIMD_FLOAT32_C(  -986.58),
        EASYSIMD_FLOAT32_C(  -246.46), EASYSIMD_FLOAT32_C( -1129.93), EASYSIMD_FLOAT32_C(   341.82), EASYSIMD_FLOAT32_C(  1841.94),
        EASYSIMD_FLOAT32_C( -1194.34), EASYSIMD_FLOAT32_C(   746.77), EASYSIMD_FLOAT32_C(  1870.16), EASYSIMD_FLOAT32_C(  2718.46),
        EASYSIMD_FLOAT32_C(  1561.54), EASYSIMD_FLOAT32_C(   341.41), EASYSIMD_FLOAT32_C(  1695.80), EASYSIMD_FLOAT32_C(  1703.15) },
      EASYSIMD_FLOAT32_C( 11543.20) },
    { { EASYSIMD_FLOAT32_C(  2145.06), EASYSIMD_FLOAT32_C(    33.60), EASYSIMD_FLOAT32_C( -1071.64), EASYSIMD_FLOAT32_C(  2910.37),
        EASYSIMD_FLOAT32_C(  2927.48), EASYSIMD_FLOAT32_C(   794.68), EASYSIMD_FLOAT32_C(  -677.32), EASYSIMD_FLOAT32_C(  2649.18),
        EASYSIMD_FLOAT32_C(  2670.50), EASYSIMD_FLOAT32_C(   -35.21), EASYSIMD_FLOAT32_C( -2442.01), EASYSIMD_FLOAT32_C(  2111.85),
        EASYSIMD_FLOAT32_C(    92.11), EASYSIMD_FLOAT32_C( -1736.94), EASYSIMD_FLOAT32_C( -1664.21), EASYSIMD_FLOAT32_C( -1315.99) },
      EASYSIMD_FLOAT32_C(  7391.51) },
    { { EASYSIMD_FLOAT32_C(  -684.45), EASYSIMD_FLOAT32_C( -2029.14), EASYSIMD_FLOAT32_C(   697.43), EASYSIMD_FLOAT32_C(  2069.09),
        EASYSIMD_FLOAT32_C(  -159.07), EASYSIMD_FLOAT32_C( -1960.74), EASYSIMD_FLOAT32_C(   911.02), EASYSIMD_FLOAT32_C(  1646.58),
        EASYSIMD_FLOAT32_C(  1786.02), EASYSIMD_FLOAT32_C(  -218.81), EASYSIMD_FLOAT32_C(  1365.04), EASYSIMD_FLOAT32_C(   347.56),
        EASYSIMD_FLOAT32_C( -2877.40), EASYSIMD_FLOAT32_C(    60.84), EASYSIMD_FLOAT32_C(  -949.30), EASYSIMD_FLOAT32_C(  2267.66) },
      EASYSIMD_FLOAT32_C(  2272.33) },
    { { EASYSIMD_FLOAT32_C( -2905.57), EASYSIMD_FLOAT32_C(   979.07), EASYSIMD_FLOAT32_C(  2178.02), EASYSIMD_FLOAT32_C( -2978.09),
        EASYSIMD_FLOAT32_C( -1226.26), EASYSIMD_FLOAT32_C( -1499.30), EASYSIMD_FLOAT32_C(  2671.09), EASYSIMD_FLOAT32_C( -1555.76),
        EASYSIMD_FLOAT32_C(  1465.49), EASYSIMD_FLOAT32_C( -2770.92), EASYSIMD_FLOAT32_C( -2443.91), EASYSIMD_FLOAT32_C( -1442.40),
        EASYSIMD_FLOAT32_C( -1507.86), EASYSIMD_FLOAT32_C( -1108.12), EASYSIMD_FLOAT32_C(   241.61), EASYSIMD_FLOAT32_C(   807.69) },
      EASYSIMD_FLOAT32_C(-11095.22) },
    { { EASYSIMD_FLOAT32_C(  -137.26), EASYSIMD_FLOAT32_C( -2060.96), EASYSIMD_FLOAT32_C(  -123.22), EASYSIMD_FLOAT32_C(  2703.66),
        EASYSIMD_FLOAT32_C( -1021.70), EASYSIMD_FLOAT32_C( -2212.20), EASYSIMD_FLOAT32_C(  1350.24), EASYSIMD_FLOAT32_C( -2235.68),
        EASYSIMD_FLOAT32_C(   568.99), EASYSIMD_FLOAT32_C(  -284.71), EASYSIMD_FLOAT32_C(  1111.87), EASYSIMD_FLOAT32_C(   691.58),
        EASYSIMD_FLOAT32_C(  2776.12), EASYSIMD_FLOAT32_C( -2837.42), EASYSIMD_FLOAT32_C(   -40.76), EASYSIMD_FLOAT32_C(  2870.56) },
      EASYSIMD_FLOAT32_C(  1119.11) },
    { { EASYSIMD_FLOAT32_C(  1141.64), EASYSIMD_FLOAT32_C(  -862.74), EASYSIMD_FLOAT32_C(  2892.47), EASYSIMD_FLOAT32_C(  2915.39),
        EASYSIMD_FLOAT32_C(   637.97), EASYSIMD_FLOAT32_C(  2563.56), EASYSIMD_FLOAT32_C( -1640.37), EASYSIMD_FLOAT32_C(  -896.54),
        EASYSIMD_FLOAT32_C(  2792.64), EASYSIMD_FLOAT32_C( -1084.28), EASYSIMD_FLOAT32_C(   661.06), EASYSIMD_FLOAT32_C( -1715.23),
        EASYSIMD_FLOAT32_C(   807.60), EASYSIMD_FLOAT32_C( -2097.33), EASYSIMD_FLOAT32_C(  2092.46), EASYSIMD_FLOAT32_C( -2329.67) },
      EASYSIMD_FLOAT32_C(  5878.63) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_add_ps(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_add_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

  return 0;
}

static int
test_easysimd_mm512_reduce_mul_ps (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    float array_a[16];
    float res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT32_C(   -22.49), EASYSIMD_FLOAT32_C(    22.45), EASYSIMD_FLOAT32_C(   -28.18), EASYSIMD_FLOAT32_C(   -14.81),
        EASYSIMD_FLOAT32_C(     1.68), EASYSIMD_FLOAT32_C(   -23.77), EASYSIMD_FLOAT32_C(    26.08), EASYSIMD_FLOAT32_C(    26.45),
        EASYSIMD_FLOAT32_C(    12.90), EASYSIMD_FLOAT32_C(   -22.71), EASYSIMD_FLOAT32_C(    24.62), EASYSIMD_FLOAT32_C(    -6.45),
        EASYSIMD_FLOAT32_C(   -10.50), EASYSIMD_FLOAT32_C(    10.39), EASYSIMD_FLOAT32_C(    19.32), EASYSIMD_FLOAT32_C(    10.24) },
      EASYSIMD_FLOAT32_C(-5828275843352231936.00) },
    { { EASYSIMD_FLOAT32_C(   -17.23), EASYSIMD_FLOAT32_C(    23.19), EASYSIMD_FLOAT32_C(   -21.30), EASYSIMD_FLOAT32_C(    -5.59),
        EASYSIMD_FLOAT32_C(    19.38), EASYSIMD_FLOAT32_C(   -22.31), EASYSIMD_FLOAT32_C(   -24.39), EASYSIMD_FLOAT32_C(   -14.90),
        EASYSIMD_FLOAT32_C(     5.69), EASYSIMD_FLOAT32_C(   -21.20), EASYSIMD_FLOAT32_C(   -29.53), EASYSIMD_FLOAT32_C(    26.46),
        EASYSIMD_FLOAT32_C(     2.13), EASYSIMD_FLOAT32_C(    -0.93), EASYSIMD_FLOAT32_C(    19.05), EASYSIMD_FLOAT32_C(     9.64) },
      EASYSIMD_FLOAT32_C(-256309526372810752.00) },
    { { EASYSIMD_FLOAT32_C(    -8.48), EASYSIMD_FLOAT32_C(    20.88), EASYSIMD_FLOAT32_C(    24.83), EASYSIMD_FLOAT32_C(    23.20),
        EASYSIMD_FLOAT32_C(    27.11), EASYSIMD_FLOAT32_C(    20.90), EASYSIMD_FLOAT32_C(    19.65), EASYSIMD_FLOAT32_C(    10.01),
        EASYSIMD_FLOAT32_C(    28.19), EASYSIMD_FLOAT32_C(    14.28), EASYSIMD_FLOAT32_C(   -26.44), EASYSIMD_FLOAT32_C(   -12.31),
        EASYSIMD_FLOAT32_C(    -5.33), EASYSIMD_FLOAT32_C(    22.88), EASYSIMD_FLOAT32_C(    27.92), EASYSIMD_FLOAT32_C(     7.43) },
      EASYSIMD_FLOAT32_C(37678508663325589504.00) },
    { { EASYSIMD_FLOAT32_C(   -17.23), EASYSIMD_FLOAT32_C(    23.19), EASYSIMD_FLOAT32_C(   -21.30), EASYSIMD_FLOAT32_C(    -5.59),
        EASYSIMD_FLOAT32_C(    19.38), EASYSIMD_FLOAT32_C(   -22.31), EASYSIMD_FLOAT32_C(   -24.39), EASYSIMD_FLOAT32_C(   -14.90),
        EASYSIMD_FLOAT32_C(     5.69), EASYSIMD_FLOAT32_C(   -21.20), EASYSIMD_FLOAT32_C(   -29.53), EASYSIMD_FLOAT32_C(    26.46),
        EASYSIMD_FLOAT32_C(     2.13), EASYSIMD_FLOAT32_C(    -0.93), EASYSIMD_FLOAT32_C(    19.05), EASYSIMD_FLOAT32_C(     9.64) },
      EASYSIMD_FLOAT32_C(-256309526372810752.00) },
    { { EASYSIMD_FLOAT32_C(    -3.62), EASYSIMD_FLOAT32_C(    -7.16), EASYSIMD_FLOAT32_C(     4.82), EASYSIMD_FLOAT32_C(    -6.51),
        EASYSIMD_FLOAT32_C(   -16.26), EASYSIMD_FLOAT32_C(    -5.52), EASYSIMD_FLOAT32_C(   -26.50), EASYSIMD_FLOAT32_C(   -18.07),
        EASYSIMD_FLOAT32_C(   -21.25), EASYSIMD_FLOAT32_C(   -22.94), EASYSIMD_FLOAT32_C(    -0.38), EASYSIMD_FLOAT32_C(     3.42),
        EASYSIMD_FLOAT32_C(    29.95), EASYSIMD_FLOAT32_C(    -2.46), EASYSIMD_FLOAT32_C(   -19.15), EASYSIMD_FLOAT32_C(    16.02) },
      EASYSIMD_FLOAT32_C(500539783643136.00) },
    { { EASYSIMD_FLOAT32_C(     4.16), EASYSIMD_FLOAT32_C(   -17.31), EASYSIMD_FLOAT32_C(    -8.53), EASYSIMD_FLOAT32_C(    18.46),
        EASYSIMD_FLOAT32_C(    -9.86), EASYSIMD_FLOAT32_C(   -17.97), EASYSIMD_FLOAT32_C(     8.46), EASYSIMD_FLOAT32_C(     6.40),
        EASYSIMD_FLOAT32_C(   -26.94), EASYSIMD_FLOAT32_C(    -5.09), EASYSIMD_FLOAT32_C(    -5.22), EASYSIMD_FLOAT32_C(    -6.85),
        EASYSIMD_FLOAT32_C(   -29.58), EASYSIMD_FLOAT32_C(    22.79), EASYSIMD_FLOAT32_C(   -25.23), EASYSIMD_FLOAT32_C(    -3.20) },
      EASYSIMD_FLOAT32_C(-29029033266118656.00) },
    { { EASYSIMD_FLOAT32_C(   -14.36), EASYSIMD_FLOAT32_C(     9.60), EASYSIMD_FLOAT32_C(    20.29), EASYSIMD_FLOAT32_C(    -0.62),
        EASYSIMD_FLOAT32_C(   -25.93), EASYSIMD_FLOAT32_C(    23.80), EASYSIMD_FLOAT32_C(    11.31), EASYSIMD_FLOAT32_C(   -17.17),
        EASYSIMD_FLOAT32_C(   -29.14), EASYSIMD_FLOAT32_C(   -19.07), EASYSIMD_FLOAT32_C(    16.25), EASYSIMD_FLOAT32_C(   -29.19),
        EASYSIMD_FLOAT32_C(     8.47), EASYSIMD_FLOAT32_C(    27.10), EASYSIMD_FLOAT32_C(    16.83), EASYSIMD_FLOAT32_C(   -17.38) },
      EASYSIMD_FLOAT32_C(3678122031364177920.00) },
    { { EASYSIMD_FLOAT32_C(   -20.21), EASYSIMD_FLOAT32_C(   -21.70), EASYSIMD_FLOAT32_C(   -28.91), EASYSIMD_FLOAT32_C(    -0.06),
        EASYSIMD_FLOAT32_C(    -9.67), EASYSIMD_FLOAT32_C(     9.54), EASYSIMD_FLOAT32_C(   -23.67), EASYSIMD_FLOAT32_C(    -6.61),
        EASYSIMD_FLOAT32_C(   -25.55), EASYSIMD_FLOAT32_C(     1.11), EASYSIMD_FLOAT32_C(    16.54), EASYSIMD_FLOAT32_C(   -25.13),
        EASYSIMD_FLOAT32_C(    -6.09), EASYSIMD_FLOAT32_C(    21.32), EASYSIMD_FLOAT32_C(     1.67), EASYSIMD_FLOAT32_C(     9.54) },
      EASYSIMD_FLOAT32_C(267738698219520.00) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_mul_ps(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_mul_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

  return 0;
}

static int
test_easysimd_mm512_reduce_max_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { {  INT64_C( 2963047650701805365), -INT64_C( 3729247875137237455), -INT64_C( 3845856339008494304), -INT64_C( 1064163723365597460),
        -INT64_C( 1465710870982959524), -INT64_C( 1879674754197178035), -INT64_C( 3258716177167933198),  INT64_C( 7359271061997204852) },
       INT64_C( 7359271061997204852) },
    { { -INT64_C( 3465927269503614400), -INT64_C( 5336245755521944250),  INT64_C( 3652832430159628280),  INT64_C( 8979477522402171181),
         INT64_C( 6239558131097502277),  INT64_C( 6163829598680351762), -INT64_C( 2357100376895505575),  INT64_C( 8320034375959227326) },
       INT64_C( 8979477522402171181) },
    { {  INT64_C( 6745216083348417845), -INT64_C( 6338609425029071786), -INT64_C( 2267271996729508617), -INT64_C( 8622897590329237581),
        -INT64_C( 5123855703646302147), -INT64_C( 3937144625421412763), -INT64_C( 2832205455576326993),  INT64_C( 1762894116904602523) },
       INT64_C( 6745216083348417845) },
    { {  INT64_C( 1349255441948820638),  INT64_C( 5131326863507334298),  INT64_C( 4700572348260591934), -INT64_C( 6825304177649912748),
         INT64_C(  408239233910892523), -INT64_C( 3359780352071405441), -INT64_C( 7693996159258036398), -INT64_C(  430080504125626269) },
       INT64_C( 5131326863507334298) },
    { { -INT64_C( 8906928169272825101), -INT64_C( 3310150677164140884),  INT64_C( 1605818808189731698),  INT64_C( 1041602663088393835),
        -INT64_C( 1245016314218805714), -INT64_C( 4469756319524629337),  INT64_C( 3551298060346049152),  INT64_C( 8715626680643470796) },
       INT64_C( 8715626680643470796) },
    { { -INT64_C( 2857706374665903834),  INT64_C( 4740311016225604791), -INT64_C( 4057535475899744838), -INT64_C( 6754657834242319231),
         INT64_C(  652286721455287811), -INT64_C( 4762038720263156505), -INT64_C( 7289378254966924012),  INT64_C( 2983818538095248457) },
       INT64_C( 4740311016225604791) },
    { { -INT64_C( 4688411215848967275), -INT64_C( 1497639468970606730), -INT64_C( 6097643673284348755),  INT64_C(   46400951836329045),
        -INT64_C( 2098160191430786740),  INT64_C( 4942582495215110101), -INT64_C( 5253894944362688248), -INT64_C( 6008973567403587793) },
       INT64_C( 4942582495215110101) },
    { {  INT64_C( 3325539268017750744),  INT64_C( 2293582456250074104),  INT64_C( 8654968820995907074), -INT64_C(  201627181610021081),
        -INT64_C( 6073551927168138449),  INT64_C(  225477953352077547),  INT64_C( 8263688924353309677), -INT64_C( 6992069941805858348) },
       INT64_C( 8654968820995907074) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_epi64");
    easysimd_assert_equal_i64(res, test_vec[i].res);
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_max_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { { -INT64_C( 3468118206106751029),  INT64_C( 7287340568953727409), -INT64_C( 8134662791901854853),  INT64_C(  532886265934614440),
        -INT64_C( 3743138789970389407),  INT64_C( 2766369790900426076),  INT64_C(  377038332634824289), -INT64_C( 8911298599433735663) },
      UINT8_C( 11),
       INT64_C( 7287340568953727409) },
    { { -INT64_C( 6541212579406691543),  INT64_C( 1976647699072563438),  INT64_C( 5147753279223503581),  INT64_C( 4219572759391026638),
        -INT64_C( 7842931178794994766), -INT64_C( 3801583519979767673),  INT64_C(  271792907066455849), -INT64_C( 3412861971781505193) },
      UINT8_C(199),
       INT64_C( 5147753279223503581) },
    { { -INT64_C(  896497272401144903), -INT64_C( 6280079526330256480),  INT64_C( 5460579481672308438), -INT64_C( 8340038884265480346),
         INT64_C( 5763240478037552781),  INT64_C( 6805457494421200087), -INT64_C( 7668340235170853331), -INT64_C( 4313513619379651132) },
      UINT8_C(  0),
                           INT64_MIN },
    { { -INT64_C( 6650973565335122761),  INT64_C( 4179773579424660476), -INT64_C( 2616028575611401641),  INT64_C( 2477498126220609551),
         INT64_C(  797049235055710372),  INT64_C( 1968882020421351979), -INT64_C( 3899068643739649239),  INT64_C( 8182632386889709057) },
      UINT8_C(156),
       INT64_C( 8182632386889709057) },
    { {  INT64_C( 2767663096782380428), -INT64_C( 8242424242043715436),  INT64_C( 9135571123277702414),  INT64_C( 5720906070949049404),
         INT64_C( 6533866288610807706), -INT64_C( 6065104474919233676),  INT64_C( 7572303790975622160), -INT64_C( 5080176793953934738) },
      UINT8_C(165),
       INT64_C( 9135571123277702414) },
    { { -INT64_C( 9046388138365468917), -INT64_C( 6120450648780588141),  INT64_C( 2370092689708853052), -INT64_C( 6867997592022739597),
         INT64_C( 8261032040072223287), -INT64_C( 3816378955478285105), -INT64_C( 7564598059191836121),  INT64_C( 8318236733881795643) },
      UINT8_C(106),
      -INT64_C( 3816378955478285105) },
    { { -INT64_C(    3171841329228528),  INT64_C( 4526778830010864171),  INT64_C(   71487758218213275),  INT64_C( 5572271319421865370),
        -INT64_C( 8899563283356148412),  INT64_C(   95140075770154168),  INT64_C( 5221009723545072824), -INT64_C( 6694170525608726386) },
      UINT8_C( 37),
       INT64_C(   95140075770154168) },
    { { -INT64_C( 6005266837363940725), -INT64_C( 4185793418400448976), -INT64_C( 9140974834808562218), -INT64_C( 7738446358522040082),
         INT64_C( 5400711068551288998), -INT64_C( 1242319389194451476), -INT64_C( 2371521303014984253),  INT64_C( 2393364661494216345) },
      UINT8_C(  8),
      -INT64_C( 7738446358522040082) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_max_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_max_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_max_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_min_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int64_t array_a[8];
    int64_t res;
  } test_vec[] = {
    { { -INT64_C( 8968308188143983927),  INT64_C( 3870922026709747468), -INT64_C( 3320461749101678243), -INT64_C(  920830910563375938),
        -INT64_C( 2041379856125154321), -INT64_C( 7647501151022681962),  INT64_C( 8917755899130372943), -INT64_C( 1514307912516735521) },
      -INT64_C( 8968308188143983927) },
    { {  INT64_C( 2773581374287905220),  INT64_C( 5871477862398124974), -INT64_C( 1925002938447377647),  INT64_C(  456528508247484785),
        -INT64_C( 3196678164149409812),  INT64_C( 3662609711212622465), -INT64_C( 8364791882273777921), -INT64_C( 5783944892972083085) },
      -INT64_C( 8364791882273777921) },
    { { -INT64_C(  311928722164065101), -INT64_C( 7452522139648891839),  INT64_C( 5840474781024949352),  INT64_C(  275777651657344097),
         INT64_C( 1050613930186833438), -INT64_C( 3666770787044486420), -INT64_C( 6501406463455347817), -INT64_C( 5857603595053445791) },
      -INT64_C( 7452522139648891839) },
    { {  INT64_C(  321403846285300122),  INT64_C( 9160506258330609133),  INT64_C( 3408022935468011618),  INT64_C( 5460216181797426312),
        -INT64_C( 3007515148187202266), -INT64_C( 2993688185128039155), -INT64_C( 6145786065866364744),  INT64_C( 5897614532196603357) },
      -INT64_C( 6145786065866364744) },
    { { -INT64_C( 4587526778002568298),  INT64_C( 9145449399050403233),  INT64_C( 1035468587449739409),  INT64_C( 4668953709954932815),
        -INT64_C( 3354596573047726849), -INT64_C( 2173319627157395567), -INT64_C( 2055345035643921862), -INT64_C( 8647992616717315053) },
      -INT64_C( 8647992616717315053) },
    { {  INT64_C( 7027211702151789444),  INT64_C( 8575854508670217170), -INT64_C( 7070550762448578455), -INT64_C( 1549424750833812113),
         INT64_C( 3981785036249544978), -INT64_C(  989844646671025265), -INT64_C( 1144530579473095179), -INT64_C( 2351890773300447476) },
      -INT64_C( 7070550762448578455) },
    { { -INT64_C( 5855801985860503008),  INT64_C( 7456481532190529022),  INT64_C( 5067680125251185379), -INT64_C( 4312173951674991493),
        -INT64_C( 1451559942966613746), -INT64_C(  579577783790643942),  INT64_C( 6545893958157589335), -INT64_C( 5669245077572841493) },
      -INT64_C( 5855801985860503008) },
    { { -INT64_C( 4932644867309397068),  INT64_C( 4834962659844095503),  INT64_C( 1032075435591365656),  INT64_C( 8399195441700140346),
         INT64_C( 3956025412778487179), -INT64_C( 8949089603330494818), -INT64_C( 8639931249554971930),  INT64_C( 3527995974304052673) },
      -INT64_C( 8949089603330494818) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].array_a);
    int64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_epi64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_epi64");
    easysimd_assert_equal_i64(res, test_vec[i].res);
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_min_epi64 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int64_t a[8];
    uint8_t k;
    int64_t r;
  } test_vec[] = {
    { {  INT64_C( 1968107673969146975), -INT64_C(   21132959839832093), -INT64_C( 8906968193266267454),  INT64_C( 8723788152267657754),
        -INT64_C( 5082510270409230373), -INT64_C( 2976377887502620669), -INT64_C( 8343542339706004717), -INT64_C( 2581067255003160166) },
      UINT8_C(236),
      -INT64_C( 8906968193266267454) },
    { { -INT64_C( 2848390770786682839),  INT64_C( 3921442147901647504),  INT64_C( 3713557993756302374), -INT64_C( 7675804560766255783),
         INT64_C( 5174779698500746313), -INT64_C( 6575805767845102420), -INT64_C(  816245978375690712),  INT64_C( 4204951317434785881) },
      UINT8_C( 56),
      -INT64_C( 7675804560766255783) },
    { { -INT64_C( 4642587775966629276),  INT64_C( 4470916471953693143),  INT64_C( 1291352430467449973),  INT64_C( 7963837531013951568),
        -INT64_C( 8921095754222373521), -INT64_C( 4101246185524203521),  INT64_C(  952868371087093495), -INT64_C( 1770794842707051276) },
      UINT8_C( 85),
      -INT64_C( 8921095754222373521) },
    { { -INT64_C(  385754258726561344), -INT64_C( 9198861099262509842), -INT64_C(  746109101368639635), -INT64_C( 3469929987771096157),
         INT64_C( 5635158034330540718),  INT64_C(  119352623532834967), -INT64_C( 3299916770806930042), -INT64_C( 6496391927740128774) },
      UINT8_C(  7),
      -INT64_C( 9198861099262509842) },
    { { -INT64_C( 7782301440895623603), -INT64_C( 5336438108329662619),  INT64_C(  445211380151431387),  INT64_C( 6718984780819216138),
        -INT64_C( 4528997948372703616),  INT64_C( 5868223809758973419),  INT64_C( 1493420506186273870), -INT64_C( 2930283872102140439) },
      UINT8_C( 48),
      -INT64_C( 4528997948372703616) },
    { { -INT64_C( 2537130159760447206),  INT64_C( 5397181482946168185),  INT64_C(  559404384271964456),  INT64_C( 3129215664252697523),
        -INT64_C( 4680695464812938849),  INT64_C( 2853380005673000025),  INT64_C(  517848347898408406),  INT64_C( 7114756964852469376) },
      UINT8_C(170),
       INT64_C( 2853380005673000025) },
    { { -INT64_C(  651701867990970170), -INT64_C( 3883758892471663865), -INT64_C(   44149300760002017),  INT64_C( 8630627178524177514),
         INT64_C( 7946327108313331638),  INT64_C( 8786747560568175945), -INT64_C( 6953627963634151666),  INT64_C( 2152019577569755829) },
      UINT8_C( 57),
      -INT64_C(  651701867990970170) },
    { { -INT64_C(  991057218325418257),  INT64_C( 7321382219267466688), -INT64_C( 2695341048164902621), -INT64_C( 3769407487610781963),
         INT64_C( 2194379324356907213), -INT64_C( 6187870538247257755), -INT64_C( 1598735034166166947),  INT64_C( 4597067401457046052) },
      UINT8_C( 96),
      -INT64_C( 6187870538247257755) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi64(test_vec[i].a);
    easysimd__mmask8 k = test_vec[i].k;
    int64_t r = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_mask_reduce_min_epi64(k, a);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_mask_reduce_min_epi64");
    easysimd_assert_equal_i64(r, test_vec[i].r);
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i64x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    int64_t r = easysimd_mm512_mask_reduce_min_epi64(k, a);

    easysimd_test_x86_write_i64x8(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i64(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_reduce_max_pd (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    double array_a[8];
    double res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT64_C(-21009.36), EASYSIMD_FLOAT64_C( 50171.27), EASYSIMD_FLOAT64_C(-61284.41), EASYSIMD_FLOAT64_C( 54843.72),
        EASYSIMD_FLOAT64_C( 55336.25), EASYSIMD_FLOAT64_C(  -964.40), EASYSIMD_FLOAT64_C(-52192.85), EASYSIMD_FLOAT64_C( 59523.08) },
      EASYSIMD_FLOAT64_C( 59523.08) },
    { { EASYSIMD_FLOAT64_C( 71338.32), EASYSIMD_FLOAT64_C(-57553.06), EASYSIMD_FLOAT64_C(-60841.66), EASYSIMD_FLOAT64_C( 96461.42),
        EASYSIMD_FLOAT64_C(-29639.39), EASYSIMD_FLOAT64_C( 99680.99), EASYSIMD_FLOAT64_C( -4296.48), EASYSIMD_FLOAT64_C(  6415.40) },
      EASYSIMD_FLOAT64_C( 99680.99) },
    { { EASYSIMD_FLOAT64_C(-48357.48), EASYSIMD_FLOAT64_C(-58191.19), EASYSIMD_FLOAT64_C( 37789.17), EASYSIMD_FLOAT64_C(-34180.70),
        EASYSIMD_FLOAT64_C(-97344.18), EASYSIMD_FLOAT64_C(-92922.96), EASYSIMD_FLOAT64_C(  7344.93), EASYSIMD_FLOAT64_C( 91740.96) },
      EASYSIMD_FLOAT64_C( 91740.96) },
    { { EASYSIMD_FLOAT64_C( 63679.85), EASYSIMD_FLOAT64_C(-37636.64), EASYSIMD_FLOAT64_C(-66525.25), EASYSIMD_FLOAT64_C( -5592.80),
        EASYSIMD_FLOAT64_C( 33701.43), EASYSIMD_FLOAT64_C(-84201.42), EASYSIMD_FLOAT64_C(-62365.35), EASYSIMD_FLOAT64_C(-87307.93) },
      EASYSIMD_FLOAT64_C( 63679.85) },
    { { EASYSIMD_FLOAT64_C( 65969.84), EASYSIMD_FLOAT64_C(-23649.76), EASYSIMD_FLOAT64_C( 67535.79), EASYSIMD_FLOAT64_C( 21306.09),
        EASYSIMD_FLOAT64_C( 75385.84), EASYSIMD_FLOAT64_C(-84657.06), EASYSIMD_FLOAT64_C(-19170.84), EASYSIMD_FLOAT64_C( 46724.16) },
      EASYSIMD_FLOAT64_C( 75385.84) },
    { { EASYSIMD_FLOAT64_C(-42210.13), EASYSIMD_FLOAT64_C( 19987.51), EASYSIMD_FLOAT64_C( 43185.58), EASYSIMD_FLOAT64_C( 28150.48),
        EASYSIMD_FLOAT64_C( 19668.50), EASYSIMD_FLOAT64_C(-61110.90), EASYSIMD_FLOAT64_C(-65434.12), EASYSIMD_FLOAT64_C( 71311.02) },
      EASYSIMD_FLOAT64_C( 71311.02) },
    { { EASYSIMD_FLOAT64_C(-19302.09), EASYSIMD_FLOAT64_C( 72355.05), EASYSIMD_FLOAT64_C(-62869.68), EASYSIMD_FLOAT64_C(-16646.28),
        EASYSIMD_FLOAT64_C( 79432.09), EASYSIMD_FLOAT64_C( 44475.25), EASYSIMD_FLOAT64_C(-24905.32), EASYSIMD_FLOAT64_C( 43111.95) },
      EASYSIMD_FLOAT64_C( 79432.09) },
    { { EASYSIMD_FLOAT64_C(-93161.39), EASYSIMD_FLOAT64_C(  8569.44), EASYSIMD_FLOAT64_C(-62480.85), EASYSIMD_FLOAT64_C( 40540.04),
        EASYSIMD_FLOAT64_C( 24368.01), EASYSIMD_FLOAT64_C(-24846.21), EASYSIMD_FLOAT64_C( 53232.11), EASYSIMD_FLOAT64_C( -9662.15) },
      EASYSIMD_FLOAT64_C( 53232.11) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512d a = easysimd_mm512_loadu_pd(test_vec[i].array_a);
    double res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_pd(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_pd");
    easysimd_assert_equal_f64(res, test_vec[i].res, 1);
  }

  return 0;
}


static int
test_easysimd_mm512_reduce_min_pd (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    double array_a[8];
    double res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT64_C( 90763.90), EASYSIMD_FLOAT64_C( 65463.95), EASYSIMD_FLOAT64_C( 82359.02), EASYSIMD_FLOAT64_C(-81335.70),
        EASYSIMD_FLOAT64_C(-44033.20), EASYSIMD_FLOAT64_C( -5332.70), EASYSIMD_FLOAT64_C( 84607.00), EASYSIMD_FLOAT64_C( 34419.20) },
      EASYSIMD_FLOAT64_C(-81335.70) },
    { { EASYSIMD_FLOAT64_C(  4921.75), EASYSIMD_FLOAT64_C(-20864.64), EASYSIMD_FLOAT64_C(-25282.05), EASYSIMD_FLOAT64_C( 34935.54),
        EASYSIMD_FLOAT64_C( 76387.77), EASYSIMD_FLOAT64_C(-73634.09), EASYSIMD_FLOAT64_C(-78185.42), EASYSIMD_FLOAT64_C(-61834.94) },
      EASYSIMD_FLOAT64_C(-78185.42) },
    { { EASYSIMD_FLOAT64_C(-36174.28), EASYSIMD_FLOAT64_C( 49412.94), EASYSIMD_FLOAT64_C( 30278.17), EASYSIMD_FLOAT64_C(-48737.37),
        EASYSIMD_FLOAT64_C( 47803.40), EASYSIMD_FLOAT64_C( 59657.65), EASYSIMD_FLOAT64_C(-25615.33), EASYSIMD_FLOAT64_C(  9293.45) },
      EASYSIMD_FLOAT64_C(-48737.37) },
    { { EASYSIMD_FLOAT64_C( 21376.06), EASYSIMD_FLOAT64_C( 79349.82), EASYSIMD_FLOAT64_C(-49714.33), EASYSIMD_FLOAT64_C(-37550.56),
        EASYSIMD_FLOAT64_C( 24158.14), EASYSIMD_FLOAT64_C( 83129.81), EASYSIMD_FLOAT64_C(-58313.02), EASYSIMD_FLOAT64_C( 14922.04) },
      EASYSIMD_FLOAT64_C(-58313.02) },
    { { EASYSIMD_FLOAT64_C( 48593.77), EASYSIMD_FLOAT64_C(-75954.00), EASYSIMD_FLOAT64_C( 33586.33), EASYSIMD_FLOAT64_C(-95439.43),
        EASYSIMD_FLOAT64_C( 18713.30), EASYSIMD_FLOAT64_C( 18193.33), EASYSIMD_FLOAT64_C( 38979.77), EASYSIMD_FLOAT64_C(-76364.95) },
      EASYSIMD_FLOAT64_C(-95439.43) },
    { { EASYSIMD_FLOAT64_C( 97328.69), EASYSIMD_FLOAT64_C(-86302.28), EASYSIMD_FLOAT64_C( 58570.59), EASYSIMD_FLOAT64_C( 73716.46),
        EASYSIMD_FLOAT64_C(-59936.37), EASYSIMD_FLOAT64_C( 80385.16), EASYSIMD_FLOAT64_C(-88118.48), EASYSIMD_FLOAT64_C(  3889.36) },
      EASYSIMD_FLOAT64_C(-88118.48) },
    { { EASYSIMD_FLOAT64_C( 29798.10), EASYSIMD_FLOAT64_C( 42159.69), EASYSIMD_FLOAT64_C( 55151.99), EASYSIMD_FLOAT64_C(-22398.50),
        EASYSIMD_FLOAT64_C(  1817.34), EASYSIMD_FLOAT64_C(-70463.34), EASYSIMD_FLOAT64_C( 86894.96), EASYSIMD_FLOAT64_C(-76806.59) },
      EASYSIMD_FLOAT64_C(-76806.59) },
    { { EASYSIMD_FLOAT64_C(-91113.53), EASYSIMD_FLOAT64_C(-62819.37), EASYSIMD_FLOAT64_C(-14357.15), EASYSIMD_FLOAT64_C( 33044.61),
        EASYSIMD_FLOAT64_C(-79689.56), EASYSIMD_FLOAT64_C( 27329.83), EASYSIMD_FLOAT64_C(-52033.35), EASYSIMD_FLOAT64_C( 68904.21) },
      EASYSIMD_FLOAT64_C(-91113.53) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512d a = easysimd_mm512_loadu_pd(test_vec[i].array_a);
    double res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_pd(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_pd");
    easysimd_assert_equal_f64(res, test_vec[i].res, 1);
  }

  return 0;
}

static int
test_easysimd_mm512_reduce_max_ps (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    float array_a[16];
    float res;
  } test_vec[] = {
     { { EASYSIMD_FLOAT32_C( 93028.78), EASYSIMD_FLOAT32_C(  7436.08), EASYSIMD_FLOAT32_C(-31502.70), EASYSIMD_FLOAT32_C( 97437.45),
        EASYSIMD_FLOAT32_C(-50821.52), EASYSIMD_FLOAT32_C(-30884.36), EASYSIMD_FLOAT32_C(-67874.95), EASYSIMD_FLOAT32_C(-33114.17),
        EASYSIMD_FLOAT32_C( 38977.99), EASYSIMD_FLOAT32_C( 88134.64), EASYSIMD_FLOAT32_C( 57015.71), EASYSIMD_FLOAT32_C(-78156.80),
        EASYSIMD_FLOAT32_C(-59941.25), EASYSIMD_FLOAT32_C(  7609.25), EASYSIMD_FLOAT32_C(-97707.81), EASYSIMD_FLOAT32_C(-97868.66) },
      EASYSIMD_FLOAT32_C( 97437.45) },
    { { EASYSIMD_FLOAT32_C( 41658.31), EASYSIMD_FLOAT32_C( 47619.53), EASYSIMD_FLOAT32_C( -7652.59), EASYSIMD_FLOAT32_C(-12650.03),
        EASYSIMD_FLOAT32_C(-79400.35), EASYSIMD_FLOAT32_C(-72329.69), EASYSIMD_FLOAT32_C( 45082.61), EASYSIMD_FLOAT32_C(-87536.73),
        EASYSIMD_FLOAT32_C( 36190.49), EASYSIMD_FLOAT32_C(-22676.67), EASYSIMD_FLOAT32_C( 67223.02), EASYSIMD_FLOAT32_C( 80988.36),
        EASYSIMD_FLOAT32_C( 85131.81), EASYSIMD_FLOAT32_C(-36045.24), EASYSIMD_FLOAT32_C( 86085.83), EASYSIMD_FLOAT32_C( 78160.60) },
      EASYSIMD_FLOAT32_C( 86085.83) },
    { { EASYSIMD_FLOAT32_C( 71390.83), EASYSIMD_FLOAT32_C(-45416.88), EASYSIMD_FLOAT32_C( 75598.05), EASYSIMD_FLOAT32_C(-79430.69),
        EASYSIMD_FLOAT32_C( 23698.77), EASYSIMD_FLOAT32_C(-92276.91), EASYSIMD_FLOAT32_C(-12544.86), EASYSIMD_FLOAT32_C(-37323.26),
        EASYSIMD_FLOAT32_C( 95857.73), EASYSIMD_FLOAT32_C(-55529.17), EASYSIMD_FLOAT32_C(-15480.06), EASYSIMD_FLOAT32_C(-64083.53),
        EASYSIMD_FLOAT32_C( 52080.10), EASYSIMD_FLOAT32_C(-13187.87), EASYSIMD_FLOAT32_C(-61952.18), EASYSIMD_FLOAT32_C( -6261.61) },
      EASYSIMD_FLOAT32_C( 95857.73) },
    { { EASYSIMD_FLOAT32_C(-65568.33), EASYSIMD_FLOAT32_C( 30395.23), EASYSIMD_FLOAT32_C( 81088.38), EASYSIMD_FLOAT32_C(-44968.68),
        EASYSIMD_FLOAT32_C( 58065.53), EASYSIMD_FLOAT32_C( 26170.96), EASYSIMD_FLOAT32_C(-32505.41), EASYSIMD_FLOAT32_C( -5743.98),
        EASYSIMD_FLOAT32_C(-96505.71), EASYSIMD_FLOAT32_C(-65282.39), EASYSIMD_FLOAT32_C(-24755.63), EASYSIMD_FLOAT32_C( 88626.11),
        EASYSIMD_FLOAT32_C( -1327.63), EASYSIMD_FLOAT32_C(-38669.80), EASYSIMD_FLOAT32_C( 66786.71), EASYSIMD_FLOAT32_C(-29936.80) },
      EASYSIMD_FLOAT32_C( 88626.11) },
    { { EASYSIMD_FLOAT32_C( 15913.32), EASYSIMD_FLOAT32_C( 42384.74), EASYSIMD_FLOAT32_C( -9367.49), EASYSIMD_FLOAT32_C(-60387.92),
        EASYSIMD_FLOAT32_C( 50107.83), EASYSIMD_FLOAT32_C( 78087.66), EASYSIMD_FLOAT32_C(  2288.84), EASYSIMD_FLOAT32_C( 45965.55),
        EASYSIMD_FLOAT32_C(-77441.52), EASYSIMD_FLOAT32_C( 86808.78), EASYSIMD_FLOAT32_C( 81882.03), EASYSIMD_FLOAT32_C( 74638.58),
        EASYSIMD_FLOAT32_C(-26379.09), EASYSIMD_FLOAT32_C(-80070.16), EASYSIMD_FLOAT32_C(-31623.04), EASYSIMD_FLOAT32_C(  8052.58) },
      EASYSIMD_FLOAT32_C( 86808.78) },
    { { EASYSIMD_FLOAT32_C( 50325.06), EASYSIMD_FLOAT32_C(-50534.68), EASYSIMD_FLOAT32_C( 63083.91), EASYSIMD_FLOAT32_C(  8390.59),
        EASYSIMD_FLOAT32_C( 75636.28), EASYSIMD_FLOAT32_C(-69421.52), EASYSIMD_FLOAT32_C(-97353.38), EASYSIMD_FLOAT32_C( 79130.58),
        EASYSIMD_FLOAT32_C(-34703.90), EASYSIMD_FLOAT32_C(-22109.01), EASYSIMD_FLOAT32_C( 67756.69), EASYSIMD_FLOAT32_C( 63968.47),
        EASYSIMD_FLOAT32_C( 39221.19), EASYSIMD_FLOAT32_C( 34543.36), EASYSIMD_FLOAT32_C(-65968.35), EASYSIMD_FLOAT32_C(-44865.48) },
      EASYSIMD_FLOAT32_C( 79130.58) },
    { { EASYSIMD_FLOAT32_C(-23071.91), EASYSIMD_FLOAT32_C( 24664.17), EASYSIMD_FLOAT32_C( -5253.40), EASYSIMD_FLOAT32_C(-72964.10),
        EASYSIMD_FLOAT32_C(  2751.82), EASYSIMD_FLOAT32_C( 97035.44), EASYSIMD_FLOAT32_C( 73001.46), EASYSIMD_FLOAT32_C( 25310.31),
        EASYSIMD_FLOAT32_C( 83844.22), EASYSIMD_FLOAT32_C( 54883.47), EASYSIMD_FLOAT32_C(   -51.13), EASYSIMD_FLOAT32_C(-42534.88),
        EASYSIMD_FLOAT32_C( 74813.31), EASYSIMD_FLOAT32_C( 68325.83), EASYSIMD_FLOAT32_C( 65517.71), EASYSIMD_FLOAT32_C( 25138.38) },
      EASYSIMD_FLOAT32_C( 97035.44) },
    { { EASYSIMD_FLOAT32_C(-82208.85), EASYSIMD_FLOAT32_C( 28601.60), EASYSIMD_FLOAT32_C(-66471.03), EASYSIMD_FLOAT32_C( 93427.44),
        EASYSIMD_FLOAT32_C( 59180.08), EASYSIMD_FLOAT32_C(-63824.42), EASYSIMD_FLOAT32_C( 72558.00), EASYSIMD_FLOAT32_C(-75523.82),
        EASYSIMD_FLOAT32_C( 14066.58), EASYSIMD_FLOAT32_C( 40314.67), EASYSIMD_FLOAT32_C( 88444.64), EASYSIMD_FLOAT32_C(-46712.23),
        EASYSIMD_FLOAT32_C(-25141.97), EASYSIMD_FLOAT32_C(-77523.70), EASYSIMD_FLOAT32_C(  8422.28), EASYSIMD_FLOAT32_C( 51786.11) },
      EASYSIMD_FLOAT32_C( 93427.44) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_ps(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

  return 0;
}


static int
test_easysimd_mm512_reduce_min_ps (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    float array_a[16];
    float res;
  } test_vec[] = {
     { { EASYSIMD_FLOAT32_C( 95236.09), EASYSIMD_FLOAT32_C( 53766.22), EASYSIMD_FLOAT32_C( -1091.20), EASYSIMD_FLOAT32_C( 18964.07),
        EASYSIMD_FLOAT32_C( 47366.47), EASYSIMD_FLOAT32_C(-69633.38), EASYSIMD_FLOAT32_C( 73272.36), EASYSIMD_FLOAT32_C(-31970.67),
        EASYSIMD_FLOAT32_C(-29858.42), EASYSIMD_FLOAT32_C( 79286.27), EASYSIMD_FLOAT32_C( 35490.14), EASYSIMD_FLOAT32_C(-88047.18),
        EASYSIMD_FLOAT32_C( 71948.67), EASYSIMD_FLOAT32_C( 66740.33), EASYSIMD_FLOAT32_C( 75206.24), EASYSIMD_FLOAT32_C( 28764.20) },
      EASYSIMD_FLOAT32_C(-88047.18) },
    { { EASYSIMD_FLOAT32_C( 78677.38), EASYSIMD_FLOAT32_C(-32416.31), EASYSIMD_FLOAT32_C( 82248.94), EASYSIMD_FLOAT32_C( 59826.86),
        EASYSIMD_FLOAT32_C( -9347.90), EASYSIMD_FLOAT32_C( 19645.52), EASYSIMD_FLOAT32_C( 33364.99), EASYSIMD_FLOAT32_C( -7579.08),
        EASYSIMD_FLOAT32_C( 46591.19), EASYSIMD_FLOAT32_C(-66896.10), EASYSIMD_FLOAT32_C(-48489.24), EASYSIMD_FLOAT32_C( 33178.02),
        EASYSIMD_FLOAT32_C(-85891.30), EASYSIMD_FLOAT32_C( 42159.38), EASYSIMD_FLOAT32_C( 76400.50), EASYSIMD_FLOAT32_C(-90655.22) },
      EASYSIMD_FLOAT32_C(-90655.22) },
    { { EASYSIMD_FLOAT32_C( -4074.40), EASYSIMD_FLOAT32_C(-24690.70), EASYSIMD_FLOAT32_C( 28308.85), EASYSIMD_FLOAT32_C(-56707.94),
        EASYSIMD_FLOAT32_C(  5675.93), EASYSIMD_FLOAT32_C(  1581.20), EASYSIMD_FLOAT32_C( 11321.39), EASYSIMD_FLOAT32_C( 75817.50),
        EASYSIMD_FLOAT32_C(-19132.54), EASYSIMD_FLOAT32_C(-53188.48), EASYSIMD_FLOAT32_C( 87770.33), EASYSIMD_FLOAT32_C(-47183.87),
        EASYSIMD_FLOAT32_C(-86448.16), EASYSIMD_FLOAT32_C( 62976.56), EASYSIMD_FLOAT32_C( 81580.33), EASYSIMD_FLOAT32_C( 92229.20) },
      EASYSIMD_FLOAT32_C(-86448.16) },
    { { EASYSIMD_FLOAT32_C(-69439.75), EASYSIMD_FLOAT32_C( 63829.27), EASYSIMD_FLOAT32_C( 52056.06), EASYSIMD_FLOAT32_C( 21212.35),
        EASYSIMD_FLOAT32_C(-16525.24), EASYSIMD_FLOAT32_C(-14578.95), EASYSIMD_FLOAT32_C(-86366.73), EASYSIMD_FLOAT32_C(-69934.05),
        EASYSIMD_FLOAT32_C( 18524.95), EASYSIMD_FLOAT32_C(-34855.98), EASYSIMD_FLOAT32_C( 63243.97), EASYSIMD_FLOAT32_C( 32633.64),
        EASYSIMD_FLOAT32_C(-92696.59), EASYSIMD_FLOAT32_C( 39644.47), EASYSIMD_FLOAT32_C( 41978.42), EASYSIMD_FLOAT32_C(  3229.02) },
      EASYSIMD_FLOAT32_C(-92696.59) },
    { { EASYSIMD_FLOAT32_C(-85046.23), EASYSIMD_FLOAT32_C(-29712.73), EASYSIMD_FLOAT32_C( 46521.08), EASYSIMD_FLOAT32_C( 20629.70),
        EASYSIMD_FLOAT32_C( 71868.47), EASYSIMD_FLOAT32_C(-42157.55), EASYSIMD_FLOAT32_C( -3552.80), EASYSIMD_FLOAT32_C(-47264.08),
        EASYSIMD_FLOAT32_C(  4653.98), EASYSIMD_FLOAT32_C(-15782.47), EASYSIMD_FLOAT32_C(  5552.06), EASYSIMD_FLOAT32_C( 18205.83),
        EASYSIMD_FLOAT32_C(-52805.91), EASYSIMD_FLOAT32_C(-12867.63), EASYSIMD_FLOAT32_C( 10435.02), EASYSIMD_FLOAT32_C(-22245.67) },
      EASYSIMD_FLOAT32_C(-85046.23) },
    { { EASYSIMD_FLOAT32_C(-49038.37), EASYSIMD_FLOAT32_C(-37508.92), EASYSIMD_FLOAT32_C( 98966.69), EASYSIMD_FLOAT32_C( 34436.41),
        EASYSIMD_FLOAT32_C( 47912.14), EASYSIMD_FLOAT32_C(-87400.05), EASYSIMD_FLOAT32_C( 64502.35), EASYSIMD_FLOAT32_C(-33562.92),
        EASYSIMD_FLOAT32_C(-22256.02), EASYSIMD_FLOAT32_C( 27746.32), EASYSIMD_FLOAT32_C( 99070.72), EASYSIMD_FLOAT32_C(-14952.63),
        EASYSIMD_FLOAT32_C(-32609.22), EASYSIMD_FLOAT32_C( 41049.16), EASYSIMD_FLOAT32_C( 88276.39), EASYSIMD_FLOAT32_C(-17655.45) },
      EASYSIMD_FLOAT32_C(-87400.05) },
    { { EASYSIMD_FLOAT32_C(-88663.58), EASYSIMD_FLOAT32_C( 34797.45), EASYSIMD_FLOAT32_C(-97025.75), EASYSIMD_FLOAT32_C( 83204.88),
        EASYSIMD_FLOAT32_C( 92639.92), EASYSIMD_FLOAT32_C(  -578.55), EASYSIMD_FLOAT32_C(-64059.19), EASYSIMD_FLOAT32_C( -2706.10),
        EASYSIMD_FLOAT32_C( 83638.99), EASYSIMD_FLOAT32_C( 41492.86), EASYSIMD_FLOAT32_C(-84500.29), EASYSIMD_FLOAT32_C(-69166.94),
        EASYSIMD_FLOAT32_C(-71374.77), EASYSIMD_FLOAT32_C( 25934.74), EASYSIMD_FLOAT32_C(  8587.40), EASYSIMD_FLOAT32_C(-20413.13) },
      EASYSIMD_FLOAT32_C(-97025.75) },
    { { EASYSIMD_FLOAT32_C( 88425.81), EASYSIMD_FLOAT32_C(  7554.08), EASYSIMD_FLOAT32_C(-85976.73), EASYSIMD_FLOAT32_C( 36337.95),
        EASYSIMD_FLOAT32_C( 20154.04), EASYSIMD_FLOAT32_C( 78525.63), EASYSIMD_FLOAT32_C(-97224.98), EASYSIMD_FLOAT32_C( 97898.02),
        EASYSIMD_FLOAT32_C(  6271.94), EASYSIMD_FLOAT32_C(-98154.25), EASYSIMD_FLOAT32_C(-17054.63), EASYSIMD_FLOAT32_C( 73662.72),
        EASYSIMD_FLOAT32_C( 42894.89), EASYSIMD_FLOAT32_C(-28778.24), EASYSIMD_FLOAT32_C(-43992.73), EASYSIMD_FLOAT32_C( 54231.31) },
      EASYSIMD_FLOAT32_C(-98154.25) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_ps(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_max_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(  1409384711), -INT32_C(  2097091350), -INT32_C(  1000270197), -INT32_C(   173279532), -INT32_C(  2109023485),  INT32_C(   307226672), -INT32_C(  1415132457),  INT32_C(  1426035277),
        -INT32_C(    39321581),  INT32_C(  2021698028), -INT32_C(  1824726337), -INT32_C(   611784488), -INT32_C(   211889469), -INT32_C(  1861833286), -INT32_C(  1002591113),  INT32_C(  1360608318) },
       INT32_C(  2021698028) },
    { {  INT32_C(   693092668),  INT32_C(   698470250), -INT32_C(  1984111183), -INT32_C(  1989851963), -INT32_C(   797129962), -INT32_C(   412974480),  INT32_C(  1823186734),  INT32_C(   398378203),
        -INT32_C(   264237690), -INT32_C(  1910840868), -INT32_C(  2078812481),  INT32_C(   822967323), -INT32_C(  1358788033),  INT32_C(   999711756), -INT32_C(   559463933), -INT32_C(  1930074874) },
       INT32_C(  1823186734) },
    { {  INT32_C(  1333606002), -INT32_C(   690120937), -INT32_C(  2007239571), -INT32_C(  1329960847), -INT32_C(    10437390),  INT32_C(   591066656),  INT32_C(  1057087800), -INT32_C(  1177815481),
         INT32_C(  1141393452),  INT32_C(  1293608415),  INT32_C(  1272280538), -INT32_C(   788820002),  INT32_C(  1808751435), -INT32_C(  1970402990),  INT32_C(   852070379), -INT32_C(  1293183610) },
       INT32_C(  1808751435) },
    { { -INT32_C(  1107888931), -INT32_C(  1291185703),  INT32_C(  1694424966), -INT32_C(  1170867601), -INT32_C(  1490680747), -INT32_C(   114117618), -INT32_C(   903087292),  INT32_C(  1853626000),
        -INT32_C(   466914550),  INT32_C(   177681796), -INT32_C(  2089839084), -INT32_C(   448879472), -INT32_C(  1232247640),  INT32_C(  1555021592),  INT32_C(  1260837562), -INT32_C(    71719951) },
       INT32_C(  1853626000) },
    { { -INT32_C(  1696603114),  INT32_C(   765753113), -INT32_C(  1649339635),  INT32_C(  1619193783),  INT32_C(  1796607827), -INT32_C(  1983330610), -INT32_C(  1848316256), -INT32_C(  1483895407),
        -INT32_C(  1975423887), -INT32_C(   256383261), -INT32_C(  1316132615), -INT32_C(  1441722281), -INT32_C(   300538081), -INT32_C(  1904746771),  INT32_C(  1579109324),  INT32_C(  1225108696) },
       INT32_C(  1796607827) },
    { { -INT32_C(    53262567),  INT32_C(   653101613),  INT32_C(  1255635699), -INT32_C(  1426724726), -INT32_C(    40367344), -INT32_C(  1249177623),  INT32_C(   840149850),  INT32_C(  1887115607),
        -INT32_C(  1922216352), -INT32_C(   877438248),  INT32_C(  1595313108), -INT32_C(  2096559245), -INT32_C(     8281834),  INT32_C(   179571888),  INT32_C(   255641783),  INT32_C(  1098889185) },
       INT32_C(  1887115607) },
    { { -INT32_C(   573641723),  INT32_C(   464093510), -INT32_C(  2139439348), -INT32_C(   536640566), -INT32_C(   723549148),  INT32_C(  1222546321),  INT32_C(  1012341339), -INT32_C(   696395823),
         INT32_C(   179522499), -INT32_C(   651862835), -INT32_C(   447111397),  INT32_C(  1187339554),  INT32_C(  1914348769), -INT32_C(  1816397768), -INT32_C(   472903150), -INT32_C(  1380364823) },
       INT32_C(  1914348769) },
    { {  INT32_C(  1723296921), -INT32_C(   465576759), -INT32_C(  1647666821), -INT32_C(   672952330),  INT32_C(  1816853812),  INT32_C(   134153717),  INT32_C(    32165655), -INT32_C(  1230068963),
        -INT32_C(   669227761), -INT32_C(  1128441023), -INT32_C(   363231244),  INT32_C(  1254243350),  INT32_C(   783682617),  INT32_C(   674608657), -INT32_C(  1574363259), -INT32_C(   782706750) },
       INT32_C(  1816853812) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_min_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    int32_t array_a[16];
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(  1800199221), -INT32_C(  1216131109), -INT32_C(  2036223632),  INT32_C(   904423992), -INT32_C(   611090893), -INT32_C(  1345004458),  INT32_C(   359507368), -INT32_C(  1265971074),
        -INT32_C(  2011179348), -INT32_C(  1774214619), -INT32_C(  1944264364),  INT32_C(  2126579019), -INT32_C(   648391549), -INT32_C(   645321168),  INT32_C(  1391392468),  INT32_C(  1929803975) },
      -INT32_C(  2036223632) },
    { {  INT32_C(  1962616399),  INT32_C(   470432712),  INT32_C(  1739138844), -INT32_C(  1343854036), -INT32_C(   276283201),  INT32_C(  1120407918), -INT32_C(   812271864),  INT32_C(  2118294319),
        -INT32_C(  1963770175), -INT32_C(  1784218247),  INT32_C(  1358712612),  INT32_C(  2046812858), -INT32_C(  1855420382), -INT32_C(  1579994727),  INT32_C(   393242856), -INT32_C(   979979516) },
      -INT32_C(  1963770175) },
    { {  INT32_C(  1783597553), -INT32_C(  1409288570), -INT32_C(      263355),  INT32_C(     7928798),  INT32_C(   479322499), -INT32_C(    88185582), -INT32_C(   787403059), -INT32_C(   761813023),
        -INT32_C(  1220745680),  INT32_C(   576863196),  INT32_C(   354508087), -INT32_C(   619341224), -INT32_C(  1913084037), -INT32_C(   645417460), -INT32_C(   961832732),  INT32_C(  1889026624) },
      -INT32_C(  1913084037) },
    { {  INT32_C(    86496552),  INT32_C(  1193773328),  INT32_C(  1063012583),  INT32_C(  1562079970),  INT32_C(   636097305), -INT32_C(  1375833655),  INT32_C(  1249093898),  INT32_C(   347737323),
        -INT32_C(   249961759),  INT32_C(  1379483755),  INT32_C(  1804768648),  INT32_C(   550022407), -INT32_C(  1991920704),  INT32_C(   775308324), -INT32_C(   646403347), -INT32_C(  1746062410) },
      -INT32_C(  1991920704) },
    { { -INT32_C(  2138569195), -INT32_C(   824983226),  INT32_C(  1580819799), -INT32_C(   763428334), -INT32_C(   648297291), -INT32_C(   167210744), -INT32_C(   238059461), -INT32_C(   930562893),
         INT32_C(   139006402),  INT32_C(   701897938), -INT32_C(  1819799423), -INT32_C(   949680366), -INT32_C(   727662389), -INT32_C(  1916098479), -INT32_C(   595683031),  INT32_C(   396691285) },
      -INT32_C(  2138569195) },
    { { -INT32_C(   367006184), -INT32_C(  1961560822),  INT32_C(   387881989),  INT32_C(  1860076451), -INT32_C(  1807581373),  INT32_C(  1344343079), -INT32_C(    97673051), -INT32_C(  1089351001),
        -INT32_C(   894881600),  INT32_C(   727039270), -INT32_C(    62688423),  INT32_C(   963322358), -INT32_C(   926044768),  INT32_C(  1595469754),  INT32_C(   911885711), -INT32_C(   671782121) },
      -INT32_C(  1961560822) },
    { { -INT32_C(  1029595492), -INT32_C(  1242696100),  INT32_C(  1605513321), -INT32_C(   224912046), -INT32_C(  2068158774), -INT32_C(   454765739),  INT32_C(   807026200),  INT32_C(  1158090665),
         INT32_C(   151497133),  INT32_C(   163575199),  INT32_C(  2003333413),  INT32_C(  1483342222), -INT32_C(  1126357913),  INT32_C(   278970871), -INT32_C(  1472152833),  INT32_C(  1995327433) },
      -INT32_C(  2068158774) },
    { { -INT32_C(  1870596624),  INT32_C(   278478826),  INT32_C(  1049035184),  INT32_C(  1771499778),  INT32_C(   220558102),  INT32_C(   857589044),  INT32_C(  1222401407), -INT32_C(  1782592859),
        -INT32_C(  1440399425),  INT32_C(   783990398), -INT32_C(  1033092672),  INT32_C(  1227620915), -INT32_C(  1437183626), -INT32_C(  1763806185),  INT32_C(  1994373841),  INT32_C(  1124900484) },
      -INT32_C(  1870596624) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_epi32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_max_epu64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    uint64_t array_a[8];
    uint64_t res;
  } test_vec[] = {
    { { UINT64_C( 1734445173528646480), UINT64_C(13389948653576599367), UINT64_C( 1130725675272359402), UINT64_C(13046614094565653946),
        UINT64_C(16249244304946011829), UINT64_C( 4122541120114894625), UINT64_C( 1951378465005386498), UINT64_C(15818978520270324845) },
      UINT64_C(16249244304946011829) },
    { { UINT64_C( 7667311611174150379), UINT64_C(  140207522574748267), UINT64_C( 1068226818496459096), UINT64_C( 5431174435092566622),
        UINT64_C(15095002062092608456), UINT64_C(15565704200851251971), UINT64_C( 9375760105298004590), UINT64_C( 3396107086365916791) },
      UINT64_C(15565704200851251971) },
    { { UINT64_C( 3332871718502003208), UINT64_C(13220937146941098785), UINT64_C(16637674090463169342), UINT64_C( 6375089708958870242),
        UINT64_C(10892527955889076689), UINT64_C(14831676900073102035), UINT64_C( 7067296251702713278), UINT64_C( 9270417593828364799) },
      UINT64_C(16637674090463169342) },
    { { UINT64_C( 5398310134772166620), UINT64_C(10690766883179143937), UINT64_C(11653017454044614102), UINT64_C( 7049988865640129190),
        UINT64_C(18070868299217130246), UINT64_C( 4624044986932539329), UINT64_C( 7545866671673961589), UINT64_C( 5086416932173686959) },
      UINT64_C(18070868299217130246) },
    { { UINT64_C(12239812819134204648), UINT64_C(14151835387458250427), UINT64_C(17834980507454798424), UINT64_C(13746044714126950716),
        UINT64_C(14888754218765616909), UINT64_C(11814164802466734050), UINT64_C(11570098619016925266), UINT64_C(10093939502354382208) },
      UINT64_C(17834980507454798424) },
    { { UINT64_C( 1245281784770507879), UINT64_C(16568240085393357568), UINT64_C( 7713277390092217094), UINT64_C( 8059708339308865741),
        UINT64_C( 9064393086794816394), UINT64_C( 5396639760473656684), UINT64_C( 4808085682947187810), UINT64_C(15879525512269233128) },
      UINT64_C(16568240085393357568) },
    { { UINT64_C(16554494978686339268), UINT64_C(11528590788474996335), UINT64_C( 6549261294400025132), UINT64_C(11407241661861491233),
        UINT64_C(13064832870279800049), UINT64_C( 2954192015185163042), UINT64_C(12962956847849532440), UINT64_C(14598265196681441054) },
      UINT64_C(16554494978686339268) },
    { { UINT64_C( 3842560126870713944), UINT64_C( 4169370227522780088), UINT64_C( 8198143767153452672), UINT64_C(13221162637291350744),
        UINT64_C(17131879029953376376), UINT64_C( 7619666061480252772), UINT64_C(  209206458816627235), UINT64_C(14573700425714979115) },
      UINT64_C(17131879029953376376) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_si512(test_vec[i].array_a);
    uint64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_epu64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_epu64");
    easysimd_assert_equal_u64(res, test_vec[i].res);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_min_epu64 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    uint64_t array_a[8];
    uint64_t res;
  } test_vec[] = {
    { { UINT64_C(11988811858194412885), UINT64_C( 2661552849397960258), UINT64_C( 4102213972185241418), UINT64_C(14685263627489474295),
        UINT64_C( 9890680244969502655), UINT64_C(10694787194684804624), UINT64_C( 2121772832280029531), UINT64_C( 3802874776636812420) },
      UINT64_C( 2121772832280029531) },
    { { UINT64_C(18000346653266028541), UINT64_C( 4863795139451052961), UINT64_C( 3537560662345424852), UINT64_C( 6090820903408226780),
        UINT64_C(  863398558091007769), UINT64_C(13472366444024314827), UINT64_C( 4824141788769187092), UINT64_C( 2902317140676976284) },
      UINT64_C(  863398558091007769) },
    { { UINT64_C( 1505932124541870449), UINT64_C( 7350084947669474400), UINT64_C( 2007227194256372788), UINT64_C(18118076452809109304),
        UINT64_C( 2347709940259854903), UINT64_C( 5715462771721067674), UINT64_C(14679417648692427036), UINT64_C( 5960938637466191156) },
      UINT64_C( 1505932124541870449) },
    { { UINT64_C(16788688574333751325), UINT64_C(16730351227586700483), UINT64_C( 1223917916135823262), UINT64_C(12569132667344129536),
        UINT64_C( 7732267862803038232), UINT64_C(16474581157049672173), UINT64_C( 6880393432248165520), UINT64_C(16816415520948111904) },
      UINT64_C( 1223917916135823262) },
    { { UINT64_C( 6862251573675813417), UINT64_C(10298247998594385343), UINT64_C( 3574862020651712478), UINT64_C( 2916997749572507328),
        UINT64_C( 2881516960518556203), UINT64_C(12485410623341729209), UINT64_C( 8455656413004971798), UINT64_C(12016591698148145820) },
      UINT64_C( 2881516960518556203) },
    { { UINT64_C(12239447814870121548), UINT64_C( 3806287283487836246), UINT64_C(16001768049679776998), UINT64_C(16577255011784464621),
        UINT64_C(16758869011732321017), UINT64_C( 9282446162140198014), UINT64_C(14896832111240293787), UINT64_C( 7909804684514571845) },
      UINT64_C( 3806287283487836246) },
    { { UINT64_C( 6130219153125433495), UINT64_C(11166891877589983197), UINT64_C( 9700529579671164145), UINT64_C(12847128285706311274),
        UINT64_C( 7546042354279096715), UINT64_C( 6892434246911175181), UINT64_C(13598003701295947501), UINT64_C(15092657764500642470) },
      UINT64_C( 6130219153125433495) },
    { { UINT64_C( 5294240005176381317), UINT64_C( 2118095007932307606), UINT64_C(  876233137637332250), UINT64_C( 3256737671993475867),
        UINT64_C(16651696035172541840), UINT64_C( 9393188752667142925), UINT64_C(14147522390521784292), UINT64_C(17631970105357575132) },
      UINT64_C(  876233137637332250) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_si512(test_vec[i].array_a);
    uint64_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_epu64(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_epu64");
    easysimd_assert_equal_u64(res, test_vec[i].res);
  }

  return 0;
}




static int
test_easysimd_mm512_reduce_max_epu32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    uint32_t array_a[16];
    uint32_t res;
  } test_vec[] = {
    { { UINT32_C(1575093006), UINT32_C(3305553291), UINT32_C(2480361111), UINT32_C(3564555539), UINT32_C(1896727079), UINT32_C(1365803392), UINT32_C(4235101745), UINT32_C(1055881264),
        UINT32_C( 127718012), UINT32_C( 650945167), UINT32_C(  79340528), UINT32_C(2547527792), UINT32_C(1913186034), UINT32_C(2563010663), UINT32_C( 664089334), UINT32_C( 660964523) },
      UINT32_C(4235101745) },
    { { UINT32_C(3844997462), UINT32_C(2483878820), UINT32_C( 261670558), UINT32_C(3919999478), UINT32_C(3193679703), UINT32_C( 374808351), UINT32_C(4248693842), UINT32_C(3341066864),
        UINT32_C(1219252900), UINT32_C(3973888077), UINT32_C(1979413886), UINT32_C(1029612006), UINT32_C(1895545168), UINT32_C( 730223321), UINT32_C(2938684222), UINT32_C( 158747749) },
      UINT32_C(4248693842) },
    { { UINT32_C(3964740254), UINT32_C(1507339995), UINT32_C(2312033187), UINT32_C(3318099060), UINT32_C(3207971302), UINT32_C(1391115028), UINT32_C(3808498302), UINT32_C(4243421022),
        UINT32_C(1978154650), UINT32_C( 265207916), UINT32_C( 144219539), UINT32_C(2949471945), UINT32_C( 879624736), UINT32_C( 998660285), UINT32_C(3357444202), UINT32_C(2579827711) },
      UINT32_C(4243421022) },
    { { UINT32_C(3054415178), UINT32_C(  29810030), UINT32_C(1124687482), UINT32_C(3723744957), UINT32_C(2500944344), UINT32_C( 617650106), UINT32_C( 535686943), UINT32_C(1152955130),
        UINT32_C(3455829855), UINT32_C( 516932004), UINT32_C(3697399839), UINT32_C(2277069999), UINT32_C(1881000630), UINT32_C(2174020962), UINT32_C(3617620444), UINT32_C(2468043059) },
      UINT32_C(3723744957) },
    { { UINT32_C(3294631456), UINT32_C(4158795735), UINT32_C(3084075784), UINT32_C(1312722328), UINT32_C(3116260183), UINT32_C( 624644681), UINT32_C( 134011860), UINT32_C(1419384884),
        UINT32_C( 102300462), UINT32_C( 855505450), UINT32_C(3605647422), UINT32_C(3039045725), UINT32_C(3429819011), UINT32_C( 150120756), UINT32_C(3104894597), UINT32_C( 890153478) },
      UINT32_C(4158795735) },
    { { UINT32_C(3493537445), UINT32_C(1593980961), UINT32_C(1714809864), UINT32_C(2535151892), UINT32_C(1868859707), UINT32_C(3094894131), UINT32_C(1265731652), UINT32_C(3632299826),
        UINT32_C(3349724070), UINT32_C(4213615347), UINT32_C(2858507158), UINT32_C(4014111924), UINT32_C( 962504198), UINT32_C(1089591036), UINT32_C(2441831006), UINT32_C(2288585698) },
      UINT32_C(4213615347) },
    { { UINT32_C(3108966854), UINT32_C(1387623867), UINT32_C(2231113424), UINT32_C(2574466707), UINT32_C(3771912676), UINT32_C( 102876072), UINT32_C( 127380517), UINT32_C(2123301048),
        UINT32_C(3443056145), UINT32_C( 589294931), UINT32_C(2527533827), UINT32_C(1043274330), UINT32_C(2485060076), UINT32_C(3935977668), UINT32_C(2767270636), UINT32_C(1143177522) },
      UINT32_C(3935977668) },
    { { UINT32_C(3004259167), UINT32_C(1272328264), UINT32_C(2783084107), UINT32_C(2229539224), UINT32_C(3608675091), UINT32_C( 801223491), UINT32_C( 399815653), UINT32_C(2472277812),
        UINT32_C(2588306514), UINT32_C(3907329436), UINT32_C( 864929691), UINT32_C(3971510745), UINT32_C(3083063412), UINT32_C(1760003459), UINT32_C(1820375864), UINT32_C(  83876786) },
      UINT32_C(3971510745) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_si512(test_vec[i].array_a);
    uint32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_max_epu32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_max_epu32");
    easysimd_assert_equal_u32(res, test_vec[i].res);
  }

  return 0;
}



static int
test_easysimd_mm512_reduce_min_epu32 (EASYSIMD_MUNIT_TEST_ARGS) {
  static const struct {
    uint32_t array_a[16];
    uint32_t res;
  } test_vec[] = {
    { { UINT32_C(3835577928), UINT32_C(4274815843), UINT32_C( 607214155), UINT32_C(1074850251), UINT32_C(1039651770), UINT32_C(2426855000), UINT32_C(1274816153), UINT32_C(1229978625),
        UINT32_C(2771316034), UINT32_C(3164863089), UINT32_C( 551605332), UINT32_C(2019619006), UINT32_C( 481646531), UINT32_C(3484179254), UINT32_C(2199628161), UINT32_C(3888933541) },
      UINT32_C( 481646531) },
    { { UINT32_C(3381459544), UINT32_C(1233465333), UINT32_C(3244909827), UINT32_C( 406440277), UINT32_C(1463086881), UINT32_C(3425100106), UINT32_C( 793723274), UINT32_C(  68557740),
        UINT32_C( 198025750), UINT32_C(3562296017), UINT32_C( 211205815), UINT32_C(2820984711), UINT32_C( 167729598), UINT32_C(3302303290), UINT32_C( 334701671), UINT32_C(1427573055) },
      UINT32_C(  68557740) },
    { { UINT32_C(2086724779), UINT32_C(3981489462), UINT32_C(4210681459), UINT32_C(1956847286), UINT32_C(2977800823), UINT32_C( 812995272), UINT32_C(3057870966), UINT32_C( 470506353),
        UINT32_C(1989700671), UINT32_C(2489575457), UINT32_C(2240699855), UINT32_C(4076417403), UINT32_C(2627958740), UINT32_C(1087117513), UINT32_C(4059435136), UINT32_C(2852979051) },
      UINT32_C( 470506353) },
    { { UINT32_C(2384504173), UINT32_C(1545766029), UINT32_C(1558295009), UINT32_C(3058621410), UINT32_C( 458486098), UINT32_C(2304450313), UINT32_C(2591707439), UINT32_C(3225782099),
        UINT32_C(3108988204), UINT32_C(3390468585), UINT32_C(  86439714), UINT32_C( 616264914), UINT32_C(1849691749), UINT32_C(1576508206), UINT32_C(1090023917), UINT32_C( 603995640) },
      UINT32_C(  86439714) },
    { { UINT32_C(2363379618), UINT32_C(3814126785), UINT32_C(3202907627), UINT32_C(1474471153), UINT32_C(3771015858), UINT32_C(2873015742), UINT32_C( 669726254), UINT32_C( 357297011),
        UINT32_C(4238420283), UINT32_C( 165672989), UINT32_C(1724369013), UINT32_C( 515746156), UINT32_C(2332001228), UINT32_C(1848982848), UINT32_C(3868532851), UINT32_C(1190912267) },
      UINT32_C( 165672989) },
    { { UINT32_C( 675454218), UINT32_C( 170992277), UINT32_C(1450244330), UINT32_C(1836330657), UINT32_C(4059526065), UINT32_C( 593439920), UINT32_C(1477047628), UINT32_C(3768452566),
        UINT32_C( 923328930), UINT32_C(3980474627), UINT32_C(3544428849), UINT32_C(2420160479), UINT32_C(3682678827), UINT32_C(2986336612), UINT32_C(2886273238), UINT32_C(2945230605) },
      UINT32_C( 170992277) },
    { { UINT32_C(2347144584), UINT32_C(   7874510), UINT32_C(3100883929), UINT32_C(2655589235), UINT32_C(2960771659), UINT32_C(2170648747), UINT32_C(2385341057), UINT32_C(2587802129),
        UINT32_C( 488973391), UINT32_C( 622698060), UINT32_C(3437097049), UINT32_C(1332356612), UINT32_C(2634015985), UINT32_C(3709755484), UINT32_C(3698084810), UINT32_C(1417062917) },
      UINT32_C(   7874510) },
    { { UINT32_C( 443718606), UINT32_C(2470416185), UINT32_C(2220825984), UINT32_C( 886295107), UINT32_C( 181523374), UINT32_C(4276678451), UINT32_C(1088050234), UINT32_C(3432272126),
        UINT32_C( 635897579), UINT32_C( 381167254), UINT32_C(2275022659), UINT32_C(2411425249), UINT32_C(1956285504), UINT32_C(3060957819), UINT32_C(3572911318), UINT32_C(2275445404) },
      UINT32_C( 181523374) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_si512(test_vec[i].array_a);
    uint32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_reduce_min_epu32(a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_reduce_min_epu32");
    easysimd_assert_equal_u32(res, test_vec[i].res);
  }

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_add_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int32_t array_a[16];
    easysimd__mmask16 k;
    int32_t res;
  } test_vec[] = {
    { { -INT32_C(  1842256972), -INT32_C(   868710863),  INT32_C(  1172537741), -INT32_C(  1912111045), -INT32_C(  1296656914), -INT32_C(   229804774), -INT32_C(  1959851535),  INT32_C(  1057792650),
         INT32_C(   936459525),  INT32_C(  1359153604), -INT32_C(   979966326),  INT32_C(  1431608678),  INT32_C(  1292306994),  INT32_C(  1883198591), -INT32_C(   386109859),  INT32_C(   371656720) },
      UINT16_C(63558),
      -INT32_C(  1358330829) },
    { {  INT32_C(  1342245453), -INT32_C(   248083365), -INT32_C(  1517314991), -INT32_C(   105922063),  INT32_C(  1296903950), -INT32_C(  1682134113), -INT32_C(  1163604845),  INT32_C(   800254690),
         INT32_C(  1333769204), -INT32_C(  1858030273),  INT32_C(  1127665490), -INT32_C(  1623398767), -INT32_C(  1259501035), -INT32_C(   934237899),  INT32_C(  1484977269), -INT32_C(   762891042) },
      UINT16_C( 2023),
      -INT32_C(  1865232750) },
    { {  INT32_C(  1639720737), -INT32_C(   298774856), -INT32_C(  1898659246),  INT32_C(  1310255457), -INT32_C(   285782626), -INT32_C(  1746768619),  INT32_C(  1288421573), -INT32_C(  1286360174),
        -INT32_C(  1844178726),  INT32_C(  1887454494),  INT32_C(  1778341127), -INT32_C(   591980738),  INT32_C(  2060103525), -INT32_C(   518869988), -INT32_C(    30548628),  INT32_C(  1790017936) },
      UINT16_C(50833),
       INT32_C(  1197875570) },
    { {  INT32_C(  2097917948),  INT32_C(   533861152),  INT32_C(   859181180), -INT32_C(  1209885715),  INT32_C(   677707286),  INT32_C(   218484959), -INT32_C(  2138138929), -INT32_C(    45736192),
        -INT32_C(   293973298), -INT32_C(   519222171),  INT32_C(  1226064988), -INT32_C(   184420385), -INT32_C(   719493643),  INT32_C(    81929013), -INT32_C(  1182437191),  INT32_C(  1572260751) },
      UINT16_C(12317),
       INT32_C(  1787356069) },
    { {  INT32_C(  1501332044),  INT32_C(  2023610723),  INT32_C(   594509090), -INT32_C(  1870109582),  INT32_C(   464764473),  INT32_C(  1200319682), -INT32_C(   602727899), -INT32_C(  1005834120),
         INT32_C(   371034547), -INT32_C(  2071020702), -INT32_C(  1431765704), -INT32_C(  1690685342), -INT32_C(  1313346066),  INT32_C(  2146976345), -INT32_C(   715453603), -INT32_C(   275159236) },
      UINT16_C(46832),
       INT32_C(  1407174069) },
    { { -INT32_C(  1804512763),  INT32_C(  2140252631), -INT32_C(  1901071532),  INT32_C(  1182572175),  INT32_C(  1200149839), -INT32_C(  1353456300),  INT32_C(  1394053050), -INT32_C(  2096494722),
         INT32_C(   823622490),  INT32_C(  2041620773),  INT32_C(   721903516),  INT32_C(  1282507773), -INT32_C(  1382745511), -INT32_C(  1705121825), -INT32_C(   185764746), -INT32_C(   713558149) },
      UINT16_C(36723),
       INT32_C(  1437615564) },
    { { -INT32_C(  1237805050),  INT32_C(   404149265),  INT32_C(  1906053888), -INT32_C(   194251424), -INT32_C(     2405470), -INT32_C(   764194331), -INT32_C(  1127551163), -INT32_C(   884261436),
        -INT32_C(   427719723),  INT32_C(  1493079896),  INT32_C(   197761707),  INT32_C(   855586191),  INT32_C(  1697766016),  INT32_C(  1882694955),  INT32_C(  1479278996),  INT32_C(   321091646) },
      UINT16_C(42491),
      -INT32_C(  1832491024) },
    { { -INT32_C(   130264071),  INT32_C(  1972561835), -INT32_C(   240508174), -INT32_C(  2050282924), -INT32_C(   970262897), -INT32_C(  1815560602),  INT32_C(   973800983),  INT32_C(   333383194),
         INT32_C(    84614234), -INT32_C(   159736317),  INT32_C(   350692544), -INT32_C(   577129650),  INT32_C(   279233705), -INT32_C(  1717343102), -INT32_C(  1932218766),  INT32_C(   245412788) },
      UINT16_C(43983),
      -INT32_C(  1265491204) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_add_epi32(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_add_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i32x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    int32_t r = easysimd_mm512_mask_reduce_add_epi32(k, a);

    easysimd_test_x86_write_i32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif
  return 0;
}


static int
test_easysimd_mm512_mask_reduce_add_ps (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    float array_a[16];
    easysimd__mmask16 k;
    float res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT32_C(  -876.41), EASYSIMD_FLOAT32_C(    83.77), EASYSIMD_FLOAT32_C(  -889.74), EASYSIMD_FLOAT32_C(   501.25),
        EASYSIMD_FLOAT32_C(  -440.84), EASYSIMD_FLOAT32_C(   228.91), EASYSIMD_FLOAT32_C(  -139.78), EASYSIMD_FLOAT32_C(  -649.00),
        EASYSIMD_FLOAT32_C(   580.06), EASYSIMD_FLOAT32_C(  -664.35), EASYSIMD_FLOAT32_C(  -782.93), EASYSIMD_FLOAT32_C(  -540.72),
        EASYSIMD_FLOAT32_C(   873.23), EASYSIMD_FLOAT32_C(  -862.07), EASYSIMD_FLOAT32_C(    90.20), EASYSIMD_FLOAT32_C(  -441.97) },
      UINT16_C(15522),
      EASYSIMD_FLOAT32_C( -1648.81) },
    { { EASYSIMD_FLOAT32_C(  -320.74), EASYSIMD_FLOAT32_C(   379.76), EASYSIMD_FLOAT32_C(  -872.58), EASYSIMD_FLOAT32_C(  -737.37),
        EASYSIMD_FLOAT32_C(   844.25), EASYSIMD_FLOAT32_C(  -117.38), EASYSIMD_FLOAT32_C(     8.28), EASYSIMD_FLOAT32_C(   278.90),
        EASYSIMD_FLOAT32_C(   758.82), EASYSIMD_FLOAT32_C(   -51.23), EASYSIMD_FLOAT32_C(  -518.25), EASYSIMD_FLOAT32_C(  -102.08),
        EASYSIMD_FLOAT32_C(  -460.65), EASYSIMD_FLOAT32_C(  -394.66), EASYSIMD_FLOAT32_C(   981.70), EASYSIMD_FLOAT32_C(  -350.38) },
      UINT16_C(  622),
      EASYSIMD_FLOAT32_C( -1390.52) },
    { { EASYSIMD_FLOAT32_C(   878.53), EASYSIMD_FLOAT32_C(   -33.20), EASYSIMD_FLOAT32_C(  -108.15), EASYSIMD_FLOAT32_C(   458.59),
        EASYSIMD_FLOAT32_C(   302.45), EASYSIMD_FLOAT32_C(   108.93), EASYSIMD_FLOAT32_C(   917.87), EASYSIMD_FLOAT32_C(   175.68),
        EASYSIMD_FLOAT32_C(   246.85), EASYSIMD_FLOAT32_C(     8.07), EASYSIMD_FLOAT32_C(   733.71), EASYSIMD_FLOAT32_C(  -840.83),
        EASYSIMD_FLOAT32_C(   698.76), EASYSIMD_FLOAT32_C(  -587.03), EASYSIMD_FLOAT32_C(   538.93), EASYSIMD_FLOAT32_C(   826.18) },
      UINT16_C(41250),
      EASYSIMD_FLOAT32_C(   561.73) },
    { { EASYSIMD_FLOAT32_C(  -291.20), EASYSIMD_FLOAT32_C(   683.87), EASYSIMD_FLOAT32_C(  -337.92), EASYSIMD_FLOAT32_C(  -532.38),
        EASYSIMD_FLOAT32_C(  -367.36), EASYSIMD_FLOAT32_C(   143.83), EASYSIMD_FLOAT32_C(   365.54), EASYSIMD_FLOAT32_C(   171.99),
        EASYSIMD_FLOAT32_C(   749.16), EASYSIMD_FLOAT32_C(   347.23), EASYSIMD_FLOAT32_C(   821.61), EASYSIMD_FLOAT32_C(   855.75),
        EASYSIMD_FLOAT32_C(   888.09), EASYSIMD_FLOAT32_C(   700.13), EASYSIMD_FLOAT32_C(  -177.45), EASYSIMD_FLOAT32_C(  -220.06) },
      UINT16_C(54257),
      EASYSIMD_FLOAT32_C(  1609.77) },
    { { EASYSIMD_FLOAT32_C(   888.86), EASYSIMD_FLOAT32_C(    76.59), EASYSIMD_FLOAT32_C(   300.68), EASYSIMD_FLOAT32_C(   135.72),
        EASYSIMD_FLOAT32_C(  -915.33), EASYSIMD_FLOAT32_C(    34.38), EASYSIMD_FLOAT32_C(   294.89), EASYSIMD_FLOAT32_C(   783.43),
        EASYSIMD_FLOAT32_C(   447.35), EASYSIMD_FLOAT32_C(  -166.19), EASYSIMD_FLOAT32_C(   609.60), EASYSIMD_FLOAT32_C(  -877.05),
        EASYSIMD_FLOAT32_C(  -783.01), EASYSIMD_FLOAT32_C(  -681.60), EASYSIMD_FLOAT32_C(   806.82), EASYSIMD_FLOAT32_C(  -120.94) },
      UINT16_C(24319),
      EASYSIMD_FLOAT32_C(  1189.39) },
    { { EASYSIMD_FLOAT32_C(  -977.11), EASYSIMD_FLOAT32_C(  -848.44), EASYSIMD_FLOAT32_C(   611.45), EASYSIMD_FLOAT32_C(   772.05),
        EASYSIMD_FLOAT32_C(   498.79), EASYSIMD_FLOAT32_C(   433.06), EASYSIMD_FLOAT32_C(   627.80), EASYSIMD_FLOAT32_C(   386.88),
        EASYSIMD_FLOAT32_C(   133.19), EASYSIMD_FLOAT32_C(  -549.65), EASYSIMD_FLOAT32_C(  -833.18), EASYSIMD_FLOAT32_C(  -708.08),
        EASYSIMD_FLOAT32_C(  -424.65), EASYSIMD_FLOAT32_C(  -944.32), EASYSIMD_FLOAT32_C(   368.51), EASYSIMD_FLOAT32_C(   876.03) },
      UINT16_C(16529),
      EASYSIMD_FLOAT32_C(   277.07) },
    { { EASYSIMD_FLOAT32_C(   -89.59), EASYSIMD_FLOAT32_C(  -513.71), EASYSIMD_FLOAT32_C(   236.60), EASYSIMD_FLOAT32_C(  -642.24),
        EASYSIMD_FLOAT32_C(   320.10), EASYSIMD_FLOAT32_C(  -153.80), EASYSIMD_FLOAT32_C(  -519.29), EASYSIMD_FLOAT32_C(   537.09),
        EASYSIMD_FLOAT32_C(   164.61), EASYSIMD_FLOAT32_C(  -712.47), EASYSIMD_FLOAT32_C(  -583.85), EASYSIMD_FLOAT32_C(   950.63),
        EASYSIMD_FLOAT32_C(  -273.01), EASYSIMD_FLOAT32_C(  -560.96), EASYSIMD_FLOAT32_C(  -897.82), EASYSIMD_FLOAT32_C(  -661.56) },
      UINT16_C(54161),
      EASYSIMD_FLOAT32_C( -1612.65) },
    { { EASYSIMD_FLOAT32_C(   771.49), EASYSIMD_FLOAT32_C(   838.89), EASYSIMD_FLOAT32_C(   -12.14), EASYSIMD_FLOAT32_C(   -95.31),
        EASYSIMD_FLOAT32_C(  -710.75), EASYSIMD_FLOAT32_C(   154.68), EASYSIMD_FLOAT32_C(   196.60), EASYSIMD_FLOAT32_C(  -135.40),
        EASYSIMD_FLOAT32_C(   210.36), EASYSIMD_FLOAT32_C(  -434.89), EASYSIMD_FLOAT32_C(  -259.38), EASYSIMD_FLOAT32_C(  -598.24),
        EASYSIMD_FLOAT32_C(  -981.71), EASYSIMD_FLOAT32_C(   651.03), EASYSIMD_FLOAT32_C(  -111.95), EASYSIMD_FLOAT32_C(   254.89) },
      UINT16_C(20902),
      EASYSIMD_FLOAT32_C(   -37.27) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_add_ps(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_add_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_f32x16(-1000.0, 1000.0);
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    float r = easysimd_mm512_mask_reduce_add_ps(k, a);

    easysimd_test_x86_write_f32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_f32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif
  return 0;
}


static int
test_easysimd_mm512_mask_reduce_max_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int32_t array_a[16];
    easysimd__mmask16 k;
    int32_t res;
  } test_vec[] = {
    { {  INT32_C(  1947694841),  INT32_C(   697398151),  INT32_C(  2112951604), -INT32_C(  1631586482),  INT32_C(   841753166),  INT32_C(   601106931), -INT32_C(  1214626552), -INT32_C(  1534597205),
        -INT32_C(   468148643),  INT32_C(  1175300625),  INT32_C(   230948543),  INT32_C(  1152156661), -INT32_C(  1737041755),  INT32_C(   180046593),  INT32_C(  1002526352), -INT32_C(  1696643011) },
      UINT16_C(63718),
       INT32_C(  2112951604) },
    { { -INT32_C(  1935476609),  INT32_C(    25911614),  INT32_C(   444891246),  INT32_C(  1005726148),  INT32_C(  2105996482), -INT32_C(  1076685058),  INT32_C(   822546514),  INT32_C(   707390891),
         INT32_C(   599182309), -INT32_C(  1692057300), -INT32_C(  2034914878), -INT32_C(  1782470445), -INT32_C(  1710078052), -INT32_C(  1336285602), -INT32_C(  1579065098),  INT32_C(   868944717) },
      UINT16_C(33494),
       INT32_C(  2105996482) },
    { {  INT32_C(  1694258938), -INT32_C(  1801838331), -INT32_C(  1307725403),  INT32_C(  1801255651), -INT32_C(  1416105985),  INT32_C(  1844943138),  INT32_C(   344394893), -INT32_C(  1062369594),
        -INT32_C(   517690916),  INT32_C(  1869987530),  INT32_C(  1377928047),  INT32_C(  2092858749), -INT32_C(  1910024852),  INT32_C(  2096897775), -INT32_C(   242187477), -INT32_C(   441369335) },
      UINT16_C(54759),
       INT32_C(  1844943138) },
    { {  INT32_C(  1016312262),  INT32_C(  1119814177),  INT32_C(   331365461), -INT32_C(   546820936), -INT32_C(  1208133701),  INT32_C(  1681533139), -INT32_C(   895401191), -INT32_C(   291534808),
         INT32_C(  1529492026), -INT32_C(  1969362635), -INT32_C(   576889563),  INT32_C(  1169950090),  INT32_C(   821869149), -INT32_C(    57395486), -INT32_C(  1580845447), -INT32_C(   124819778) },
      UINT16_C(47768),
       INT32_C(  1169950090) },
    { { -INT32_C(   240923309), -INT32_C(   196163241),  INT32_C(  1677383846),  INT32_C(   421353245),  INT32_C(   475004807), -INT32_C(  1034761989), -INT32_C(   114814871),  INT32_C(  1555283977),
        -INT32_C(   447916402), -INT32_C(   958751713), -INT32_C(  1842752396), -INT32_C(  1297398229),  INT32_C(  1104083781),  INT32_C(   755179715),  INT32_C(   975579953),  INT32_C(  2039929323) },
      UINT16_C(58415),
       INT32_C(  2039929323) },
    { {  INT32_C(   964710239),  INT32_C(  1041101845),  INT32_C(   847526022), -INT32_C(  1188181526),  INT32_C(   232386570),  INT32_C(  1127746077), -INT32_C(   618912700), -INT32_C(    54571875),
        -INT32_C(  1338687589), -INT32_C(  1158790605),  INT32_C(  1709994618),  INT32_C(  1176377659),  INT32_C(   659814153),  INT32_C(  1181387778),  INT32_C(  1294043056),  INT32_C(  1850400979) },
      UINT16_C(32543),
       INT32_C(  1709994618) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_max_epi32(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_max_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i32x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    int32_t r = easysimd_mm512_mask_reduce_max_epi32(k, a);

    easysimd_test_x86_write_i32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif


  return 0;
}


static int
test_easysimd_mm512_mask_reduce_max_ps (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    float array_a[16];
    easysimd__mmask16 k;
    float res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT32_C(  -798.39), EASYSIMD_FLOAT32_C(  -853.77), EASYSIMD_FLOAT32_C(  -807.27), EASYSIMD_FLOAT32_C(   208.15),
        EASYSIMD_FLOAT32_C(   240.91), EASYSIMD_FLOAT32_C(  -895.66), EASYSIMD_FLOAT32_C(   652.74), EASYSIMD_FLOAT32_C(  -545.16),
        EASYSIMD_FLOAT32_C(  -300.02), EASYSIMD_FLOAT32_C(  -568.83), EASYSIMD_FLOAT32_C(   101.89), EASYSIMD_FLOAT32_C(   -39.35),
        EASYSIMD_FLOAT32_C(  -666.62), EASYSIMD_FLOAT32_C(   348.62), EASYSIMD_FLOAT32_C(   -33.23), EASYSIMD_FLOAT32_C(  -932.03) },
      UINT16_C(47426),
      EASYSIMD_FLOAT32_C(   652.74) },
    { { EASYSIMD_FLOAT32_C(   900.31), EASYSIMD_FLOAT32_C(   485.86), EASYSIMD_FLOAT32_C(  -649.53), EASYSIMD_FLOAT32_C(  -667.39),
        EASYSIMD_FLOAT32_C(  -778.80), EASYSIMD_FLOAT32_C(   -34.36), EASYSIMD_FLOAT32_C(   300.95), EASYSIMD_FLOAT32_C(   579.90),
        EASYSIMD_FLOAT32_C(    34.25), EASYSIMD_FLOAT32_C(  -518.43), EASYSIMD_FLOAT32_C(  -152.77), EASYSIMD_FLOAT32_C(   487.80),
        EASYSIMD_FLOAT32_C(   880.42), EASYSIMD_FLOAT32_C(    48.84), EASYSIMD_FLOAT32_C(   634.03), EASYSIMD_FLOAT32_C(  -926.85) },
      UINT16_C(33183),
      EASYSIMD_FLOAT32_C(   900.31) },
    { { EASYSIMD_FLOAT32_C(  -822.51), EASYSIMD_FLOAT32_C(   909.73), EASYSIMD_FLOAT32_C(   329.78), EASYSIMD_FLOAT32_C(  -122.53),
        EASYSIMD_FLOAT32_C(  -659.10), EASYSIMD_FLOAT32_C(  -568.33), EASYSIMD_FLOAT32_C(   838.12), EASYSIMD_FLOAT32_C(  -325.73),
        EASYSIMD_FLOAT32_C(   780.29), EASYSIMD_FLOAT32_C(  -195.11), EASYSIMD_FLOAT32_C(  -257.76), EASYSIMD_FLOAT32_C(   350.16),
        EASYSIMD_FLOAT32_C(  -219.49), EASYSIMD_FLOAT32_C(  -357.45), EASYSIMD_FLOAT32_C(  -163.98), EASYSIMD_FLOAT32_C(   130.97) },
      UINT16_C(52119),
      EASYSIMD_FLOAT32_C(   909.73) },
    { { EASYSIMD_FLOAT32_C(  -903.38), EASYSIMD_FLOAT32_C(  -723.90), EASYSIMD_FLOAT32_C(  -362.87), EASYSIMD_FLOAT32_C(   130.86),
        EASYSIMD_FLOAT32_C(  -242.33), EASYSIMD_FLOAT32_C(   484.36), EASYSIMD_FLOAT32_C(  -381.34), EASYSIMD_FLOAT32_C(  -361.91),
        EASYSIMD_FLOAT32_C(  -466.80), EASYSIMD_FLOAT32_C(  -747.30), EASYSIMD_FLOAT32_C(  -288.76), EASYSIMD_FLOAT32_C(  -209.81),
        EASYSIMD_FLOAT32_C(   127.64), EASYSIMD_FLOAT32_C(  -111.27), EASYSIMD_FLOAT32_C(  -300.08), EASYSIMD_FLOAT32_C(  -542.58) },
      UINT16_C(27794),
      EASYSIMD_FLOAT32_C(  -111.27) },
    { { EASYSIMD_FLOAT32_C(  -110.91), EASYSIMD_FLOAT32_C(   604.33), EASYSIMD_FLOAT32_C(   715.09), EASYSIMD_FLOAT32_C(  -330.61),
        EASYSIMD_FLOAT32_C(  -590.78), EASYSIMD_FLOAT32_C(  -542.67), EASYSIMD_FLOAT32_C(  -980.46), EASYSIMD_FLOAT32_C(   189.72),
        EASYSIMD_FLOAT32_C(    99.87), EASYSIMD_FLOAT32_C(  -144.44), EASYSIMD_FLOAT32_C(  -679.30), EASYSIMD_FLOAT32_C(  -924.98),
        EASYSIMD_FLOAT32_C(   912.79), EASYSIMD_FLOAT32_C(  -582.69), EASYSIMD_FLOAT32_C(  -648.87), EASYSIMD_FLOAT32_C(  -450.09) },
      UINT16_C( 6252),
      EASYSIMD_FLOAT32_C(   912.79) },
    { { EASYSIMD_FLOAT32_C(  -965.73), EASYSIMD_FLOAT32_C(  -833.16), EASYSIMD_FLOAT32_C(   746.89), EASYSIMD_FLOAT32_C(  -432.53),
        EASYSIMD_FLOAT32_C(  -580.46), EASYSIMD_FLOAT32_C(  -541.87), EASYSIMD_FLOAT32_C(   357.66), EASYSIMD_FLOAT32_C(   547.18),
        EASYSIMD_FLOAT32_C(   346.86), EASYSIMD_FLOAT32_C(  -942.42), EASYSIMD_FLOAT32_C(  -995.40), EASYSIMD_FLOAT32_C(   113.07),
        EASYSIMD_FLOAT32_C(    98.40), EASYSIMD_FLOAT32_C(  -106.31), EASYSIMD_FLOAT32_C(  -282.60), EASYSIMD_FLOAT32_C(  -186.51) },
      UINT16_C(52021),
      EASYSIMD_FLOAT32_C(   746.89) },
    { { EASYSIMD_FLOAT32_C(   270.82), EASYSIMD_FLOAT32_C(   582.62), EASYSIMD_FLOAT32_C(  -683.66), EASYSIMD_FLOAT32_C(  -629.31),
        EASYSIMD_FLOAT32_C(  -561.82), EASYSIMD_FLOAT32_C(  -362.96), EASYSIMD_FLOAT32_C(  -554.29), EASYSIMD_FLOAT32_C(  -649.04),
        EASYSIMD_FLOAT32_C(    54.35), EASYSIMD_FLOAT32_C(  -203.16), EASYSIMD_FLOAT32_C(   -99.12), EASYSIMD_FLOAT32_C(  -397.48),
        EASYSIMD_FLOAT32_C(   905.63), EASYSIMD_FLOAT32_C(   -64.85), EASYSIMD_FLOAT32_C(  -230.64), EASYSIMD_FLOAT32_C(   652.52) },
      UINT16_C(36048),
      EASYSIMD_FLOAT32_C(   652.52) },
    { { EASYSIMD_FLOAT32_C(  -889.35), EASYSIMD_FLOAT32_C(  -139.72), EASYSIMD_FLOAT32_C(  -263.93), EASYSIMD_FLOAT32_C(   457.52),
        EASYSIMD_FLOAT32_C(   -82.14), EASYSIMD_FLOAT32_C(  -259.33), EASYSIMD_FLOAT32_C(  -429.41), EASYSIMD_FLOAT32_C(  -983.74),
        EASYSIMD_FLOAT32_C(   634.36), EASYSIMD_FLOAT32_C(   287.99), EASYSIMD_FLOAT32_C(  -170.25), EASYSIMD_FLOAT32_C(   197.43),
        EASYSIMD_FLOAT32_C(  -585.39), EASYSIMD_FLOAT32_C(  -899.43), EASYSIMD_FLOAT32_C(  -219.95), EASYSIMD_FLOAT32_C(  -269.05) },
      UINT16_C(37364),
      EASYSIMD_FLOAT32_C(   634.36) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_max_ps(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_max_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_f32x16(-1000.0, 1000.0);
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    float r = easysimd_mm512_mask_reduce_max_ps(k, a);

    easysimd_test_x86_write_f32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_f32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_min_epi32 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    int32_t array_a[16];
    easysimd__mmask16 k;
    int32_t res;
  } test_vec[] = {
    { { -INT32_C(   267771764),  INT32_C(   492290777),  INT32_C(  2093841683), -INT32_C(  1897098458),  INT32_C(   206429065), -INT32_C(  1254790352),  INT32_C(   270283760),  INT32_C(  1391148230),
         INT32_C(   893580636), -INT32_C(   900490825),  INT32_C(  1028005911),  INT32_C(  1036792499),  INT32_C(  1044977934),  INT32_C(  1978957445),  INT32_C(  2022052018), -INT32_C(  1446350516) },
      UINT16_C( 3174),
      -INT32_C(  1254790352) },
    { {  INT32_C(   832970206),  INT32_C(   777108967), -INT32_C(   966785542), -INT32_C(  1948225982), -INT32_C(  1593219667),  INT32_C(  1622260698), -INT32_C(    36569805), -INT32_C(  2062927962),
         INT32_C(  1018605652),  INT32_C(  1735002221),  INT32_C(  1328466445), -INT32_C(   421917127),  INT32_C(  1300751219), -INT32_C(   760334177), -INT32_C(   590315723),  INT32_C(   190962359) },
      UINT16_C( 6026),
      -INT32_C(  2062927962) },
    { { -INT32_C(  1323305145), -INT32_C(  1938019234),  INT32_C(  1436202363),  INT32_C(   574164379),  INT32_C(   156948571),  INT32_C(  2055770026), -INT32_C(   866893973), -INT32_C(  1830494645),
         INT32_C(   876872661), -INT32_C(  1413431248),  INT32_C(   268524405), -INT32_C(  1020118424), -INT32_C(  1127445486), -INT32_C(  2026416869), -INT32_C(   548172908),  INT32_C(  1064449898) },
      UINT16_C(46651),
      -INT32_C(  2026416869) },
    { {  INT32_C(   880175987),  INT32_C(   395307798),  INT32_C(   760346619), -INT32_C(  2017893445),  INT32_C(  1474090016), -INT32_C(  1344114341), -INT32_C(  1025094576), -INT32_C(     8904308),
        -INT32_C(  1556877684), -INT32_C(   725957927),  INT32_C(  1963003066), -INT32_C(  1879262609), -INT32_C(   353969777), -INT32_C(  1701197494), -INT32_C(  1587707883),  INT32_C(   782357921) },
      UINT16_C(54468),
      -INT32_C(  1587707883) },
    { { -INT32_C(  1952997935),  INT32_C(  1939296626), -INT32_C(  1037170746),  INT32_C(  2107358614),  INT32_C(  1095165351), -INT32_C(   574530688), -INT32_C(  1632476419),  INT32_C(  1634891408),
        -INT32_C(  2031285996),  INT32_C(   553223258),  INT32_C(   585312139), -INT32_C(  1935704348), -INT32_C(   456268444),  INT32_C(  1036095040), -INT32_C(  2116324368), -INT32_C(    18723094) },
      UINT16_C(53079),
      -INT32_C(  2116324368) },
    { {  INT32_C(  2102702724), -INT32_C(  1247420462), -INT32_C(  1607169791), -INT32_C(   494561259),  INT32_C(  1030801020), -INT32_C(   542088957), -INT32_C(  1003644190),  INT32_C(   479495320),
         INT32_C(   161146934), -INT32_C(   910278713), -INT32_C(   563481912),  INT32_C(   113307530), -INT32_C(  1203555915),  INT32_C(  1956115602),  INT32_C(   658031758),  INT32_C(  2135149641) },
      UINT16_C(56756),
      -INT32_C(  1607169791) },
    { {  INT32_C(  1193049224), -INT32_C(  1371937467), -INT32_C(  2086812477),  INT32_C(   246698698), -INT32_C(  1576909301), -INT32_C(   211316550), -INT32_C(    71323465), -INT32_C(  1193774033),
         INT32_C(   905967088), -INT32_C(  1646053158), -INT32_C(   954170884), -INT32_C(   556411437), -INT32_C(   696133861),  INT32_C(   533325927), -INT32_C(   954562408), -INT32_C(   327159044) },
      UINT16_C(32487),
      -INT32_C(  2086812477) },
    { {  INT32_C(    95928609),  INT32_C(  2139534174),  INT32_C(  1330927994), -INT32_C(  1188663496),  INT32_C(   245468741), -INT32_C(   946390611), -INT32_C(  2135321856), -INT32_C(  1577148032),
        -INT32_C(  1046039198), -INT32_C(   482333591), -INT32_C(  1103915898),  INT32_C(  1232558339), -INT32_C(  1806231321),  INT32_C(  1364979281),  INT32_C(    47256962),  INT32_C(   413388982) },
      UINT16_C(19077),
      -INT32_C(  1577148032) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512i a = easysimd_mm512_loadu_epi32(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    int32_t res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_min_epi32(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_min_epi32");
    easysimd_assert_equal_i32(res, test_vec[i].res);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_i32x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    int32_t r = easysimd_mm512_mask_reduce_min_epi32(k, a);

    easysimd_test_x86_write_i32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_i32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif

  return 0;
}

static int
test_easysimd_mm512_mask_reduce_min_ps (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    float array_a[16];
    easysimd__mmask16 k;
    float res;
  } test_vec[] = {
    { { EASYSIMD_FLOAT32_C(   943.83), EASYSIMD_FLOAT32_C(   452.96), EASYSIMD_FLOAT32_C(     4.02), EASYSIMD_FLOAT32_C(  -978.40),
        EASYSIMD_FLOAT32_C(    60.53), EASYSIMD_FLOAT32_C(   755.34), EASYSIMD_FLOAT32_C(   368.40), EASYSIMD_FLOAT32_C(   950.49),
        EASYSIMD_FLOAT32_C(   562.49), EASYSIMD_FLOAT32_C(   845.07), EASYSIMD_FLOAT32_C(  -677.66), EASYSIMD_FLOAT32_C(   280.16),
        EASYSIMD_FLOAT32_C(  -736.82), EASYSIMD_FLOAT32_C(  -425.08), EASYSIMD_FLOAT32_C(  -860.36), EASYSIMD_FLOAT32_C(  -463.12) },
      UINT16_C(39642),
      EASYSIMD_FLOAT32_C(  -978.40) },
    { { EASYSIMD_FLOAT32_C(  -441.80), EASYSIMD_FLOAT32_C(   928.91), EASYSIMD_FLOAT32_C(   960.58), EASYSIMD_FLOAT32_C(  -307.85),
        EASYSIMD_FLOAT32_C(   588.52), EASYSIMD_FLOAT32_C(  -478.93), EASYSIMD_FLOAT32_C(    25.50), EASYSIMD_FLOAT32_C(   992.79),
        EASYSIMD_FLOAT32_C(  -473.63), EASYSIMD_FLOAT32_C(  -312.44), EASYSIMD_FLOAT32_C(  -597.60), EASYSIMD_FLOAT32_C(    90.33),
        EASYSIMD_FLOAT32_C(  -615.62), EASYSIMD_FLOAT32_C(  -653.76), EASYSIMD_FLOAT32_C(  -456.71), EASYSIMD_FLOAT32_C(   388.40) },
      UINT16_C(54028),
      EASYSIMD_FLOAT32_C(  -615.62) },
    { { EASYSIMD_FLOAT32_C(   143.74), EASYSIMD_FLOAT32_C(   736.24), EASYSIMD_FLOAT32_C(   554.31), EASYSIMD_FLOAT32_C(  -293.76),
        EASYSIMD_FLOAT32_C(   581.31), EASYSIMD_FLOAT32_C(   876.65), EASYSIMD_FLOAT32_C(   986.39), EASYSIMD_FLOAT32_C(   844.49),
        EASYSIMD_FLOAT32_C(  -548.43), EASYSIMD_FLOAT32_C(  -873.96), EASYSIMD_FLOAT32_C(  -618.63), EASYSIMD_FLOAT32_C(   710.91),
        EASYSIMD_FLOAT32_C(  -329.82), EASYSIMD_FLOAT32_C(   -60.43), EASYSIMD_FLOAT32_C(   639.82), EASYSIMD_FLOAT32_C(  -369.24) },
      UINT16_C(55480),
      EASYSIMD_FLOAT32_C(  -369.24) },
    { { EASYSIMD_FLOAT32_C(   151.82), EASYSIMD_FLOAT32_C(  -342.78), EASYSIMD_FLOAT32_C(   221.13), EASYSIMD_FLOAT32_C(   678.19),
        EASYSIMD_FLOAT32_C(   344.78), EASYSIMD_FLOAT32_C(   623.54), EASYSIMD_FLOAT32_C(  -231.48), EASYSIMD_FLOAT32_C(   729.16),
        EASYSIMD_FLOAT32_C(   969.78), EASYSIMD_FLOAT32_C(   311.81), EASYSIMD_FLOAT32_C(   117.57), EASYSIMD_FLOAT32_C(  -662.39),
        EASYSIMD_FLOAT32_C(   -84.37), EASYSIMD_FLOAT32_C(  -738.69), EASYSIMD_FLOAT32_C(  -926.15), EASYSIMD_FLOAT32_C(  -530.06) },
      UINT16_C( 6081),
      EASYSIMD_FLOAT32_C(  -231.48) },
    { { EASYSIMD_FLOAT32_C(  -653.41), EASYSIMD_FLOAT32_C(   -46.06), EASYSIMD_FLOAT32_C(   499.64), EASYSIMD_FLOAT32_C(  -201.83),
        EASYSIMD_FLOAT32_C(    79.97), EASYSIMD_FLOAT32_C(   881.01), EASYSIMD_FLOAT32_C(  -490.92), EASYSIMD_FLOAT32_C(   750.15),
        EASYSIMD_FLOAT32_C(  -179.42), EASYSIMD_FLOAT32_C(  -851.10), EASYSIMD_FLOAT32_C(  -619.09), EASYSIMD_FLOAT32_C(  -547.70),
        EASYSIMD_FLOAT32_C(   377.24), EASYSIMD_FLOAT32_C(   532.73), EASYSIMD_FLOAT32_C(   109.52), EASYSIMD_FLOAT32_C(  -401.63) },
      UINT16_C(17098),
      EASYSIMD_FLOAT32_C(  -851.10) },
    { { EASYSIMD_FLOAT32_C(  -778.09), EASYSIMD_FLOAT32_C(   979.45), EASYSIMD_FLOAT32_C(  -816.54), EASYSIMD_FLOAT32_C(  -808.31),
        EASYSIMD_FLOAT32_C(   291.26), EASYSIMD_FLOAT32_C(   301.03), EASYSIMD_FLOAT32_C(  -470.70), EASYSIMD_FLOAT32_C(  -793.12),
        EASYSIMD_FLOAT32_C(   562.34), EASYSIMD_FLOAT32_C(  -396.85), EASYSIMD_FLOAT32_C(  -323.18), EASYSIMD_FLOAT32_C(  -470.12),
        EASYSIMD_FLOAT32_C(  -741.69), EASYSIMD_FLOAT32_C(    23.41), EASYSIMD_FLOAT32_C(   483.82), EASYSIMD_FLOAT32_C(   757.95) },
      UINT16_C(13579),
      EASYSIMD_FLOAT32_C(  -808.31) },
    { { EASYSIMD_FLOAT32_C(   638.97), EASYSIMD_FLOAT32_C(  -669.35), EASYSIMD_FLOAT32_C(  -686.06), EASYSIMD_FLOAT32_C(  -540.45),
        EASYSIMD_FLOAT32_C(  -520.44), EASYSIMD_FLOAT32_C(  -305.15), EASYSIMD_FLOAT32_C(   -88.15), EASYSIMD_FLOAT32_C(   856.80),
        EASYSIMD_FLOAT32_C(  -772.42), EASYSIMD_FLOAT32_C(  -978.63), EASYSIMD_FLOAT32_C(  -544.83), EASYSIMD_FLOAT32_C(   438.50),
        EASYSIMD_FLOAT32_C(  -524.33), EASYSIMD_FLOAT32_C(  -322.92), EASYSIMD_FLOAT32_C(   417.95), EASYSIMD_FLOAT32_C(  -340.87) },
      UINT16_C( 3926),
      EASYSIMD_FLOAT32_C(  -978.63) },
    { { EASYSIMD_FLOAT32_C(   960.16), EASYSIMD_FLOAT32_C(   398.07), EASYSIMD_FLOAT32_C(   -83.91), EASYSIMD_FLOAT32_C(   522.50),
        EASYSIMD_FLOAT32_C(  -998.78), EASYSIMD_FLOAT32_C(   592.91), EASYSIMD_FLOAT32_C(  -947.62), EASYSIMD_FLOAT32_C(  -740.47),
        EASYSIMD_FLOAT32_C(  -383.69), EASYSIMD_FLOAT32_C(   536.20), EASYSIMD_FLOAT32_C(  -982.51), EASYSIMD_FLOAT32_C(  -562.11),
        EASYSIMD_FLOAT32_C(  -900.01), EASYSIMD_FLOAT32_C(   656.45), EASYSIMD_FLOAT32_C(  -231.46), EASYSIMD_FLOAT32_C(  -586.07) },
      UINT16_C(45862),
      EASYSIMD_FLOAT32_C(  -900.01) }
  };

  for(size_t i = 0; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++){
    easysimd__m512 a = easysimd_mm512_loadu_ps(test_vec[i].array_a);
    easysimd__mmask16 k = test_vec[i].k;
    float res = 0;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      res = easysimd_mm512_mask_reduce_min_ps(k, a);
    }
    EASYSIMD_TEST_PERF_END("_mm512_mask_reduce_min_ps");
    easysimd_assert_equal_f32(res, test_vec[i].res, 1);
  }

#else
  fputc('\n', stdout);

  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m512i a = easysimd_test_x86_random_f32x16(-1000.0, 1000.0);
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    float r = easysimd_mm512_mask_reduce_min_ps(k, a);

    easysimd_test_x86_write_f32x16(2, a, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_codegen_write_u16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_codegen_write_f32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }

#endif

  return 0;
}

EASYSIMD_TEST_FUNC_LIST_BEGIN

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_add_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_add_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_and_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_and_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_mul_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_mul_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_or_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_or_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_and_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_add_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_mul_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_or_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_add_pd)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_mul_pd)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_add_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_mul_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_max_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_min_epi64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_pd)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_pd)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_epu64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_epu64)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_max_epu32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_reduce_min_epu32)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_add_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_add_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_max_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_max_ps)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_min_epi32)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_reduce_min_ps)

EASYSIMD_TEST_FUNC_LIST_END

#include <test/x86/avx512/test-avx512-footer.h>