/* SPDX-License-Identifier: MIT
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 * Copyright:
 *   2020      Evan Nemerson <evan@nemerson.com>
 *   2020      Hidayat Khan <huk2209@gmail.com>
 */

#define EASYSIMD_TEST_X86_AVX512_INSN subs

#include <test/x86/avx512/test-avx512.h>
#include <easysimd/x86/avx512/set.h>
#include <easysimd/x86/avx512/subs.h>

static int
test_easysimd_mm_mask_subs_epi8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const int8_t src[16];
    const uint16_t k;
    const int8_t a[16];
    const int8_t b[16];
    const int8_t r[16];
  } test_vec[] = {
    { {  INT8_C(  16),  INT8_C(  24),  INT8_C(  57), -INT8_C( 120),  INT8_C(  45), -INT8_C( 123),  INT8_C(  91),  INT8_C(   6),
         INT8_C(  43), -INT8_C(  38),  INT8_C( 101), -INT8_C(  82),  INT8_C( 121), -INT8_C(  15), -INT8_C(  12),  INT8_C(  21) },
      UINT16_C(62443),
      { -INT8_C(  43),  INT8_C(  98),  INT8_C(  70),  INT8_C( 123), -INT8_C(  92), -INT8_C(  53),  INT8_C(  30),  INT8_C(  64),
        -INT8_C( 114),  INT8_C(  83), -INT8_C( 105), -INT8_C( 120),  INT8_C(  29), -INT8_C(  89), -INT8_C(  96),  INT8_C(  87) },
      {  INT8_C(  47), -INT8_C(  50), -INT8_C(  36), -INT8_C( 117), -INT8_C(  44),  INT8_C(   8),  INT8_C( 101),  INT8_C(  57),
        -INT8_C(  74), -INT8_C(  34),  INT8_C(  42), -INT8_C(  86), -INT8_C(  12),  INT8_C(  21), -INT8_C(  99), -INT8_C(  55) },
      { -INT8_C(  90),      INT8_MAX,  INT8_C(  57),      INT8_MAX,  INT8_C(  45), -INT8_C(  61), -INT8_C(  71),  INT8_C(   7),
        -INT8_C(  40),  INT8_C( 117),  INT8_C( 101), -INT8_C(  82),  INT8_C(  41), -INT8_C( 110),  INT8_C(   3),      INT8_MAX } },
    { {  INT8_C( 120), -INT8_C(  29),  INT8_C(  68),  INT8_C(  28), -INT8_C(  81),  INT8_C(  98),  INT8_C(  93),  INT8_C(  61),
        -INT8_C(  75), -INT8_C(  12), -INT8_C(  59), -INT8_C(  45), -INT8_C( 100),  INT8_C( 101),  INT8_C(  42), -INT8_C(  53) },
      UINT16_C( 1587),
      {  INT8_C(  86),  INT8_C(   7),  INT8_C(  14), -INT8_C(  69),  INT8_C(  64), -INT8_C(  60), -INT8_C( 102),  INT8_C( 106),
         INT8_C( 111), -INT8_C( 114),      INT8_MIN,  INT8_C(  12),  INT8_C(  87), -INT8_C(   8), -INT8_C(  16), -INT8_C( 101) },
      {  INT8_C(  20), -INT8_C(  97), -INT8_C(   2),  INT8_C( 113), -INT8_C(  36), -INT8_C(  77),  INT8_C( 102), -INT8_C(  95),
        -INT8_C( 122),  INT8_C(   2),  INT8_C(   6), -INT8_C(  80), -INT8_C(  51),  INT8_C(  58), -INT8_C(  73),  INT8_C(  36) },
      {  INT8_C(  66),  INT8_C( 104),  INT8_C(  68),  INT8_C(  28),  INT8_C( 100),  INT8_C(  17),  INT8_C(  93),  INT8_C(  61),
        -INT8_C(  75), -INT8_C( 116),      INT8_MIN, -INT8_C(  45), -INT8_C( 100),  INT8_C( 101),  INT8_C(  42), -INT8_C(  53) } },
    { {  INT8_C(  65), -INT8_C(  59), -INT8_C(  33), -INT8_C( 126), -INT8_C( 118),  INT8_C( 121), -INT8_C(  20), -INT8_C(   7),
         INT8_C(   7),  INT8_C( 108),  INT8_C(   5),  INT8_C(  94),  INT8_C( 100), -INT8_C(  11), -INT8_C(   6),  INT8_C( 121) },
      UINT16_C(63636),
      { -INT8_C(  22),  INT8_C( 112), -INT8_C(  85),  INT8_C(  80),  INT8_C(  17),  INT8_C(  50),  INT8_C(  82),  INT8_C(  24),
        -INT8_C(  30),  INT8_C(  32),  INT8_C(  82), -INT8_C( 103),  INT8_C(  68), -INT8_C( 109),  INT8_C(  95),  INT8_C(  35) },
      {  INT8_C(  21), -INT8_C(  23), -INT8_C(  99),  INT8_C(   2), -INT8_C(  30), -INT8_C(  92),  INT8_C( 110), -INT8_C(  25),
         INT8_C(   3), -INT8_C(  45), -INT8_C(  35), -INT8_C(   3),  INT8_C(  76),  INT8_C( 113), -INT8_C(  11),  INT8_C(  54) },
      {  INT8_C(  65), -INT8_C(  59),  INT8_C(  14), -INT8_C( 126),  INT8_C(  47),  INT8_C( 121), -INT8_C(  20),  INT8_C(  49),
         INT8_C(   7),  INT8_C( 108),  INT8_C(   5), -INT8_C( 100), -INT8_C(   8),      INT8_MIN,  INT8_C( 106), -INT8_C(  19) } },
    { { -INT8_C(  30), -INT8_C(  96), -INT8_C( 121), -INT8_C(  13), -INT8_C(  46), -INT8_C(  39),  INT8_C(  11), -INT8_C(  75),
        -INT8_C(   7),  INT8_C(  93),  INT8_C(  78),  INT8_C(  61), -INT8_C(  15), -INT8_C(  83),  INT8_C(  97),  INT8_C(   6) },
      UINT16_C(65174),
      {  INT8_C(   8),  INT8_C( 120), -INT8_C(  94),  INT8_C( 119),  INT8_C(  96), -INT8_C(  91),  INT8_C(  74),  INT8_C(  61),
        -INT8_C(  94), -INT8_C( 106), -INT8_C(  82), -INT8_C( 105), -INT8_C(  52), -INT8_C( 112),  INT8_C(  56),  INT8_C(  83) },
      { -INT8_C( 124),  INT8_C(  10),  INT8_C(  45), -INT8_C( 113), -INT8_C(  65),  INT8_C(  38), -INT8_C(  19),  INT8_C(  14),
         INT8_C( 100), -INT8_C(  34), -INT8_C(  69), -INT8_C(  59), -INT8_C(  28),  INT8_C(  82), -INT8_C(  61), -INT8_C(  19) },
      { -INT8_C(  30),  INT8_C( 110),      INT8_MIN, -INT8_C(  13),      INT8_MAX, -INT8_C(  39),  INT8_C(  11),  INT8_C(  47),
        -INT8_C(   7), -INT8_C(  72), -INT8_C(  13), -INT8_C(  46), -INT8_C(  24),      INT8_MIN,  INT8_C( 117),  INT8_C( 102) } },
    { { -INT8_C(  54),  INT8_C( 101),  INT8_C( 100),  INT8_C(  42),  INT8_C(  11), -INT8_C(  82),  INT8_C( 103), -INT8_C(  83),
         INT8_C(  68),  INT8_C(  22),  INT8_C(  69),  INT8_C(  16), -INT8_C(  90),  INT8_C( 125),  INT8_C( 100),  INT8_C(  42) },
      UINT16_C(37255),
      { -INT8_C(  70),  INT8_C(  71), -INT8_C(  73), -INT8_C(  89),  INT8_C(  85),  INT8_C(  27), -INT8_C( 123),  INT8_C(  16),
        -INT8_C(  32),  INT8_C( 105),  INT8_C(  98), -INT8_C(  93),  INT8_C(  86),  INT8_C(  45),  INT8_C(   9), -INT8_C(  70) },
      {  INT8_C(  87),  INT8_C(  20),  INT8_C( 104), -INT8_C(  65), -INT8_C(  63), -INT8_C(  84), -INT8_C(  43),  INT8_C(   6),
        -INT8_C(  67),  INT8_C( 123), -INT8_C( 125),  INT8_C(  33), -INT8_C(  90),  INT8_C(  11), -INT8_C(  78),  INT8_C(  96) },
      {      INT8_MIN,  INT8_C(  51),      INT8_MIN,  INT8_C(  42),  INT8_C(  11), -INT8_C(  82),  INT8_C( 103),  INT8_C(  10),
         INT8_C(  35),  INT8_C(  22),  INT8_C(  69),  INT8_C(  16),      INT8_MAX,  INT8_C( 125),  INT8_C( 100),      INT8_MIN } },
    { {  INT8_C(  82),  INT8_C( 105),  INT8_C(   7), -INT8_C(  89), -INT8_C( 123), -INT8_C( 116), -INT8_C(  73),  INT8_C( 101),
        -INT8_C(  11),  INT8_C(  26),  INT8_C(   9),  INT8_C(  76),  INT8_C(  71),  INT8_C(  18),  INT8_C(   6), -INT8_C(  98) },
      UINT16_C(28454),
      {  INT8_C(  93), -INT8_C(  25),  INT8_C(  27),  INT8_C(  50), -INT8_C(  18), -INT8_C(  40), -INT8_C(  82),  INT8_C( 113),
        -INT8_C(   7),  INT8_C(  84),  INT8_C( 124), -INT8_C(  85), -INT8_C(  76), -INT8_C(  50),  INT8_C(  21), -INT8_C(  69) },
      {  INT8_C( 117), -INT8_C( 102),  INT8_C(  71),  INT8_C(  45), -INT8_C(   1),  INT8_C(  60),  INT8_C(  71),  INT8_C(   8),
        -INT8_C( 120), -INT8_C( 114),  INT8_C(  26), -INT8_C( 113),  INT8_C(  44),  INT8_C(  64), -INT8_C(   2), -INT8_C( 118) },
      {  INT8_C(  82),  INT8_C(  77), -INT8_C(  44), -INT8_C(  89), -INT8_C( 123), -INT8_C( 100), -INT8_C(  73),  INT8_C( 101),
         INT8_C( 113),      INT8_MAX,  INT8_C(  98),  INT8_C(  28),  INT8_C(  71), -INT8_C( 114),  INT8_C(  23), -INT8_C(  98) } },
    { {  INT8_C(  40),  INT8_C(  25), -INT8_C(  68),  INT8_C(  22), -INT8_C(  14),  INT8_C( 106), -INT8_C( 121), -INT8_C(  21),
        -INT8_C(  66),  INT8_C(   4), -INT8_C( 105),  INT8_C( 114), -INT8_C(  46), -INT8_C(  84),  INT8_C(  45),  INT8_C(  72) },
      UINT16_C(29766),
      {  INT8_C( 117),  INT8_C(  69), -INT8_C(  79), -INT8_C(  68),  INT8_C(  78),  INT8_C(  57),  INT8_C(  74),  INT8_C( 104),
        -INT8_C(  56),  INT8_C( 118), -INT8_C(  87), -INT8_C(  58),  INT8_C(   0), -INT8_C(  47), -INT8_C(  32), -INT8_C(  67) },
      { -INT8_C(  25), -INT8_C(  46),  INT8_C(  39),  INT8_C( 110), -INT8_C(  67), -INT8_C(  26),  INT8_C( 114),  INT8_C(  84),
         INT8_C(  88),  INT8_C(  69),  INT8_C(   0), -INT8_C( 122), -INT8_C( 115),  INT8_C(  70), -INT8_C(   6),  INT8_C(   2) },
      {  INT8_C(  40),  INT8_C( 115), -INT8_C( 118),  INT8_C(  22), -INT8_C(  14),  INT8_C( 106), -INT8_C(  40), -INT8_C(  21),
        -INT8_C(  66),  INT8_C(   4), -INT8_C(  87),  INT8_C( 114),  INT8_C( 115), -INT8_C( 117), -INT8_C(  26),  INT8_C(  72) } },
    { { -INT8_C( 116), -INT8_C(  85), -INT8_C(  66), -INT8_C(  38), -INT8_C(  27),  INT8_C(   8),  INT8_C(  66), -INT8_C(  83),
         INT8_C( 126), -INT8_C(  21),  INT8_C( 116),      INT8_MAX, -INT8_C(  68),  INT8_C(  84),  INT8_C(  60), -INT8_C(  93) },
      UINT16_C(25382),
      {  INT8_C(  18), -INT8_C(  29),  INT8_C(  73), -INT8_C( 124),  INT8_C(  56), -INT8_C(  94), -INT8_C(  55),  INT8_C(  56),
         INT8_C(  40),  INT8_C(  86),      INT8_MAX,  INT8_C(  34),  INT8_C(  88),  INT8_C(  11), -INT8_C(  50),  INT8_C(  22) },
      { -INT8_C(  27), -INT8_C(  77),  INT8_C(  30),  INT8_C(  39),  INT8_C(  96), -INT8_C(  99),  INT8_C(  19), -INT8_C(  44),
         INT8_C(  28), -INT8_C(  49),  INT8_C(  40),  INT8_C(  88),  INT8_C( 115),  INT8_C(  78), -INT8_C(  69), -INT8_C( 123) },
      { -INT8_C( 116),  INT8_C(  48),  INT8_C(  43), -INT8_C(  38), -INT8_C(  27),  INT8_C(   5),  INT8_C(  66), -INT8_C(  83),
         INT8_C(  12),      INT8_MAX,  INT8_C( 116),      INT8_MAX, -INT8_C(  68), -INT8_C(  67),  INT8_C(  19), -INT8_C(  93) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m128i src = easysimd_mm_loadu_epi8(test_vec[i].src);
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi8(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi8(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_mask_subs_epi8(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_mask_subs_epi8");
    easysimd_test_x86_assert_equal_i8x16(r, easysimd_mm_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m128i src = easysimd_test_x86_random_i8x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m128i a = easysimd_test_x86_random_i8x16();
    easysimd__m128i b = easysimd_test_x86_random_i8x16();
    easysimd__m128i r = easysimd_mm_mask_subs_epi8(src, k, a, b);

    easysimd_test_x86_write_i8x16(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_maskz_subs_epi8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t k;
    const int8_t a[16];
    const int8_t b[16];
    const int8_t r[16];
  } test_vec[] = {
    { UINT16_C(39831),
      {  INT8_C( 104),  INT8_C(  20),  INT8_C(  24), -INT8_C(   4),  INT8_C(  59),  INT8_C( 107),  INT8_C(  81),  INT8_C(  72),
         INT8_C(  32), -INT8_C(  64), -INT8_C(  77),  INT8_C(  54),  INT8_C( 104),  INT8_C(  75), -INT8_C( 115), -INT8_C(  20) },
      {  INT8_C(  11), -INT8_C(   2), -INT8_C(   1),  INT8_C(  44),  INT8_C(  81),  INT8_C(  57), -INT8_C(  45),  INT8_C(  13),
        -INT8_C(  68), -INT8_C(  85),  INT8_C(  92), -INT8_C(  93),  INT8_C( 110), -INT8_C(  13),  INT8_C(  62), -INT8_C(  42) },
      {  INT8_C(  93),  INT8_C(  22),  INT8_C(  25),  INT8_C(   0), -INT8_C(  22),  INT8_C(   0),  INT8_C(   0),  INT8_C(  59),
         INT8_C( 100),  INT8_C(  21),  INT8_C(   0),      INT8_MAX, -INT8_C(   6),  INT8_C(   0),  INT8_C(   0),  INT8_C(  22) } },
    { UINT16_C(22024),
      { -INT8_C(  46),  INT8_C(  67), -INT8_C(  62),  INT8_C(  35), -INT8_C( 116), -INT8_C(  30), -INT8_C(  28),  INT8_C(  63),
         INT8_C(  24),  INT8_C(  76), -INT8_C( 118), -INT8_C(  91),  INT8_C(  57), -INT8_C( 107), -INT8_C(  93),  INT8_C(  56) },
      { -INT8_C(  62), -INT8_C(  11),  INT8_C( 113), -INT8_C( 107),  INT8_C(   2),  INT8_C(  45),  INT8_C(  64),  INT8_C(  95),
        -INT8_C(  48), -INT8_C(  82),  INT8_C(  82),  INT8_C(  14), -INT8_C( 124),  INT8_C(  90),  INT8_C( 101),  INT8_C(  86) },
      {  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),      INT8_MAX,  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),
         INT8_C(   0),      INT8_MAX,      INT8_MIN,  INT8_C(   0),      INT8_MAX,  INT8_C(   0),      INT8_MIN,  INT8_C(   0) } },
    { UINT16_C(10142),
      {  INT8_C( 122),  INT8_C(  42),  INT8_C(   9),  INT8_C(  94),  INT8_C( 105),  INT8_C(  33), -INT8_C(  86), -INT8_C(  13),
        -INT8_C(  58), -INT8_C(  29), -INT8_C( 120),  INT8_C( 105),  INT8_C(  27),  INT8_C(  74),  INT8_C(  94), -INT8_C( 116) },
      { -INT8_C(  32),  INT8_C(  97), -INT8_C(  71),  INT8_C(  32), -INT8_C(  64), -INT8_C( 119), -INT8_C(  49),  INT8_C(  18),
        -INT8_C( 104),  INT8_C(  83),  INT8_C( 109), -INT8_C(   3), -INT8_C(  86),  INT8_C(  11),  INT8_C(  36),  INT8_C(  36) },
      {  INT8_C(   0), -INT8_C(  55),  INT8_C(  80),  INT8_C(  62),      INT8_MAX,  INT8_C(   0),  INT8_C(   0), -INT8_C(  31),
         INT8_C(  46), -INT8_C( 112),      INT8_MIN,  INT8_C(   0),  INT8_C(   0),  INT8_C(  63),  INT8_C(   0),  INT8_C(   0) } },
    { UINT16_C(11573),
      { -INT8_C( 126), -INT8_C(  98),  INT8_C(  78),  INT8_C(  44), -INT8_C( 111),  INT8_C(  20),  INT8_C(  16),  INT8_C(  25),
         INT8_C( 125),  INT8_C(  43),  INT8_C( 100), -INT8_C(  36), -INT8_C(  72),  INT8_C(  68),  INT8_C(  61),  INT8_C( 113) },
      {  INT8_C( 100), -INT8_C(   3), -INT8_C(   5),  INT8_C(  51),  INT8_C(  15), -INT8_C( 109), -INT8_C( 121),  INT8_C( 124),
        -INT8_C( 112),  INT8_C(  49), -INT8_C( 121), -INT8_C(  76),  INT8_C(  85), -INT8_C(  68), -INT8_C(  31), -INT8_C(  41) },
      {      INT8_MIN,  INT8_C(   0),  INT8_C(  83),  INT8_C(   0), -INT8_C( 126),      INT8_MAX,  INT8_C(   0),  INT8_C(   0),
             INT8_MAX,  INT8_C(   0),      INT8_MAX,  INT8_C(  40),  INT8_C(   0),      INT8_MAX,  INT8_C(   0),  INT8_C(   0) } },
    { UINT16_C(12122),
      {  INT8_C(   3), -INT8_C(  21),  INT8_C(  67),  INT8_C(  19),  INT8_C(   5), -INT8_C(  64),  INT8_C(  63),  INT8_C( 105),
        -INT8_C( 100), -INT8_C(   9), -INT8_C(  83), -INT8_C(  39),  INT8_C( 104),  INT8_C(  17), -INT8_C(  42),  INT8_C(  99) },
      {  INT8_C(  69), -INT8_C(  26), -INT8_C(  10), -INT8_C(  52),  INT8_C(  98), -INT8_C( 122), -INT8_C(   3), -INT8_C(  22),
         INT8_C(  58),  INT8_C(  82), -INT8_C(  90),  INT8_C(  27),  INT8_C(  41),  INT8_C(   1),  INT8_C(  74),  INT8_C(  44) },
      {  INT8_C(   0),  INT8_C(   5),  INT8_C(   0),  INT8_C(  71), -INT8_C(  93),  INT8_C(   0),  INT8_C(  66),  INT8_C(   0),
             INT8_MIN, -INT8_C(  91),  INT8_C(   7), -INT8_C(  66),  INT8_C(   0),  INT8_C(  16),  INT8_C(   0),  INT8_C(   0) } },
    { UINT16_C(36332),
      {  INT8_C(  64), -INT8_C(  15),  INT8_C(  78),      INT8_MAX,  INT8_C(  90), -INT8_C(  22),  INT8_C( 118),  INT8_C(   7),
        -INT8_C(  60), -INT8_C(  34),  INT8_C(  25), -INT8_C( 102),  INT8_C(  66),  INT8_C(  94),      INT8_MIN,  INT8_C(  56) },
      {  INT8_C(  42), -INT8_C(  29), -INT8_C(  65),  INT8_C(  39), -INT8_C(  51), -INT8_C(   7),  INT8_C( 121),  INT8_C( 115),
         INT8_C(  21), -INT8_C(  94),  INT8_C( 116),  INT8_C(  95), -INT8_C(  50),  INT8_C(  97), -INT8_C(  19),  INT8_C(  14) },
      {  INT8_C(   0),  INT8_C(   0),      INT8_MAX,  INT8_C(  88),  INT8_C(   0), -INT8_C(  15), -INT8_C(   3), -INT8_C( 108),
        -INT8_C(  81),  INT8_C(   0), -INT8_C(  91),      INT8_MIN,  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(  42) } },
    { UINT16_C(15186),
      { -INT8_C( 115), -INT8_C(  83),  INT8_C(  37),  INT8_C(   3), -INT8_C(  76), -INT8_C(  23), -INT8_C(  30), -INT8_C(  51),
        -INT8_C( 124),  INT8_C(  36),  INT8_C(  43),  INT8_C(   4),  INT8_C(  92),  INT8_C(  85), -INT8_C(  25),  INT8_C(  27) },
      {  INT8_C( 124), -INT8_C(  76),  INT8_C(  21), -INT8_C(  11),  INT8_C(  40),  INT8_C(  42), -INT8_C( 105), -INT8_C( 100),
        -INT8_C( 119),  INT8_C( 102), -INT8_C(   3),  INT8_C( 118),  INT8_C( 116),  INT8_C(  80), -INT8_C(  79),  INT8_C(   2) },
      {  INT8_C(   0), -INT8_C(   7),  INT8_C(   0),  INT8_C(   0), -INT8_C( 116),  INT8_C(   0),  INT8_C(  75),  INT8_C(   0),
        -INT8_C(   5), -INT8_C(  66),  INT8_C(   0), -INT8_C( 114), -INT8_C(  24),  INT8_C(   5),  INT8_C(   0),  INT8_C(   0) } },
    { UINT16_C(55293),
      {  INT8_C(   5), -INT8_C(  79), -INT8_C(  64), -INT8_C(  25),      INT8_MAX,  INT8_C(  68),  INT8_C(  11), -INT8_C(  86),
         INT8_C(  73),  INT8_C( 104),  INT8_C(   0),  INT8_C(  48), -INT8_C( 125),  INT8_C( 124), -INT8_C(  27), -INT8_C( 104) },
      {  INT8_C( 114),  INT8_C(  13), -INT8_C(  62),  INT8_C(   9), -INT8_C(  87),  INT8_C(  76),  INT8_C( 111), -INT8_C(  89),
        -INT8_C(  62), -INT8_C(  28), -INT8_C(   9),  INT8_C( 116), -INT8_C(  26), -INT8_C(  12),  INT8_C(  75), -INT8_C(  21) },
      { -INT8_C( 109),  INT8_C(   0), -INT8_C(   2), -INT8_C(  34),      INT8_MAX, -INT8_C(   8), -INT8_C( 100),  INT8_C(   3),
             INT8_MAX,      INT8_MAX,  INT8_C(   9),  INT8_C(   0), -INT8_C(  99),  INT8_C(   0), -INT8_C( 102), -INT8_C(  83) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi8(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi8(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_maskz_subs_epi8(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_maskz_subs_epi8");
    easysimd_test_x86_assert_equal_i8x16(r, easysimd_mm_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m128i a = easysimd_test_x86_random_i8x16();
    easysimd__m128i b = easysimd_test_x86_random_i8x16();
    easysimd__m128i r = easysimd_mm_maskz_subs_epi8(k, a, b);

    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_i8x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_mask_subs_epi16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const int16_t src[8];
    const uint8_t k;
    const int16_t a[8];
    const int16_t b[8];
    const int16_t r[8];
  } test_vec[] = {
    { {  INT16_C(  1330),  INT16_C( 27145), -INT16_C( 11353), -INT16_C( 12382),  INT16_C(  8489), -INT16_C( 32015), -INT16_C( 16596),  INT16_C(  4504) },
      UINT8_C(114),
      {  INT16_C( 14775),  INT16_C( 21715), -INT16_C( 22708),  INT16_C(  7024), -INT16_C( 14128),  INT16_C(  7822),  INT16_C(  4995), -INT16_C( 30640) },
      { -INT16_C( 17891), -INT16_C(  4049), -INT16_C(   419),  INT16_C( 32281), -INT16_C( 25616), -INT16_C( 20565), -INT16_C( 17356), -INT16_C(  5342) },
      {  INT16_C(  1330),  INT16_C( 25764), -INT16_C( 11353), -INT16_C( 12382),  INT16_C( 11488),  INT16_C( 28387),  INT16_C( 22351),  INT16_C(  4504) } },
    { { -INT16_C(  2571),  INT16_C( 16703), -INT16_C( 20580),  INT16_C( 27741), -INT16_C(  5257), -INT16_C(  1397), -INT16_C(  9217),  INT16_C(  7299) },
      UINT8_C(150),
      {  INT16_C(  3250), -INT16_C( 19981),  INT16_C( 28965), -INT16_C( 15967),  INT16_C( 20508), -INT16_C(  9739), -INT16_C(  8078),  INT16_C( 26574) },
      {  INT16_C(  4127), -INT16_C( 12796),  INT16_C( 28781),  INT16_C( 22597),  INT16_C( 16379), -INT16_C( 10409),  INT16_C( 29634),  INT16_C( 30061) },
      { -INT16_C(  2571), -INT16_C(  7185),  INT16_C(   184),  INT16_C( 27741),  INT16_C(  4129), -INT16_C(  1397), -INT16_C(  9217), -INT16_C(  3487) } },
    { {  INT16_C( 24703), -INT16_C( 23258), -INT16_C( 14383), -INT16_C(  4506),  INT16_C( 23319), -INT16_C( 30009), -INT16_C( 27333),  INT16_C( 23281) },
      UINT8_C(165),
      {  INT16_C( 10485),  INT16_C( 26130),  INT16_C( 27501), -INT16_C( 21407),  INT16_C( 14530),  INT16_C( 13935), -INT16_C(  7003),  INT16_C(  1461) },
      {  INT16_C( 23050), -INT16_C( 11817), -INT16_C( 14912),  INT16_C(  7144),  INT16_C( 29324),  INT16_C(  8534), -INT16_C( 20380),  INT16_C( 22983) },
      { -INT16_C( 12565), -INT16_C( 23258),        INT16_MAX, -INT16_C(  4506),  INT16_C( 23319),  INT16_C(  5401), -INT16_C( 27333), -INT16_C( 21522) } },
    { { -INT16_C(  9768),  INT16_C( 17855),  INT16_C(  8516),  INT16_C(  2034),  INT16_C( 24921), -INT16_C(   195), -INT16_C(  3515),  INT16_C( 20228) },
      UINT8_C( 77),
      {  INT16_C(  8411), -INT16_C( 24563),  INT16_C( 10504),  INT16_C( 31532),  INT16_C( 20095),  INT16_C( 12511),  INT16_C( 14357), -INT16_C(  4600) },
      {  INT16_C( 20216),  INT16_C(  6451),  INT16_C( 14912), -INT16_C( 24206),  INT16_C( 29047),  INT16_C( 27110),  INT16_C( 13686),  INT16_C( 20918) },
      { -INT16_C( 11805),  INT16_C( 17855), -INT16_C(  4408),        INT16_MAX,  INT16_C( 24921), -INT16_C(   195),  INT16_C(   671),  INT16_C( 20228) } },
    { { -INT16_C( 15275),  INT16_C( 24050),  INT16_C(  7917),  INT16_C( 27864), -INT16_C( 18580), -INT16_C( 32356), -INT16_C( 23056), -INT16_C(  6032) },
      UINT8_C(243),
      {  INT16_C(   419), -INT16_C(  8909), -INT16_C( 11149), -INT16_C(  6828), -INT16_C( 16966), -INT16_C(  4261), -INT16_C( 21388),  INT16_C( 14404) },
      { -INT16_C( 24162), -INT16_C( 17115), -INT16_C( 28294),  INT16_C( 12585), -INT16_C( 21714), -INT16_C( 11487),  INT16_C(  2331), -INT16_C( 16698) },
      {  INT16_C( 24581),  INT16_C(  8206),  INT16_C(  7917),  INT16_C( 27864),  INT16_C(  4748),  INT16_C(  7226), -INT16_C( 23719),  INT16_C( 31102) } },
    { { -INT16_C(  1782),  INT16_C( 32411), -INT16_C(  4147), -INT16_C( 30877), -INT16_C( 16724),  INT16_C(  8310), -INT16_C( 17814),  INT16_C(  2392) },
      UINT8_C( 91),
      { -INT16_C( 14723),  INT16_C(  4053),  INT16_C(  2031), -INT16_C( 26051),  INT16_C(  4136),  INT16_C( 12981),  INT16_C( 29654), -INT16_C( 12484) },
      { -INT16_C( 17906), -INT16_C(   612),  INT16_C(  8989), -INT16_C(  9302), -INT16_C( 13671),  INT16_C( 21318),  INT16_C( 20259), -INT16_C( 24402) },
      {  INT16_C(  3183),  INT16_C(  4665), -INT16_C(  4147), -INT16_C( 16749),  INT16_C( 17807),  INT16_C(  8310),  INT16_C(  9395),  INT16_C(  2392) } },
    { { -INT16_C( 31723),  INT16_C(  1199), -INT16_C(  4981), -INT16_C( 19553),  INT16_C( 21756), -INT16_C( 11547),  INT16_C(  8904), -INT16_C( 10591) },
      UINT8_C(220),
      { -INT16_C( 11203),  INT16_C( 24826), -INT16_C( 10882),  INT16_C( 18681),  INT16_C( 19483),  INT16_C( 27243),  INT16_C(  3323),  INT16_C( 32639) },
      { -INT16_C( 31557), -INT16_C( 22518), -INT16_C( 17117),  INT16_C( 30628),  INT16_C( 30627), -INT16_C( 15041),  INT16_C(  5656),  INT16_C( 22177) },
      { -INT16_C( 31723),  INT16_C(  1199),  INT16_C(  6235), -INT16_C( 11947), -INT16_C( 11144), -INT16_C( 11547), -INT16_C(  2333),  INT16_C( 10462) } },
    { { -INT16_C( 25622),  INT16_C( 26806), -INT16_C( 20367), -INT16_C( 29520),  INT16_C(  7420), -INT16_C(  2057),  INT16_C( 30248), -INT16_C(  7306) },
      UINT8_C(250),
      { -INT16_C( 29824),  INT16_C( 15901), -INT16_C( 27344), -INT16_C( 22559), -INT16_C( 22828), -INT16_C(  5441),  INT16_C(  5447), -INT16_C(  7212) },
      {  INT16_C( 15564),  INT16_C( 31828), -INT16_C(  7955),  INT16_C(  2424),  INT16_C( 28887),  INT16_C( 20017),  INT16_C(  5350),  INT16_C( 26440) },
      { -INT16_C( 25622), -INT16_C( 15927), -INT16_C( 20367), -INT16_C( 24983),        INT16_MIN, -INT16_C( 25458),  INT16_C(    97),        INT16_MIN } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m128i src = easysimd_mm_loadu_epi16(test_vec[i].src);
    easysimd__mmask8 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi16(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi16(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_mask_subs_epi16(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_mask_subs_epi16");
    easysimd_test_x86_assert_equal_i16x8(r, easysimd_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m128i src = easysimd_test_x86_random_i16x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    easysimd__m128i a = easysimd_test_x86_random_i16x8();
    easysimd__m128i b = easysimd_test_x86_random_i16x8();
    easysimd__m128i r = easysimd_mm_mask_subs_epi16(src, k, a, b);

    easysimd_test_x86_write_i16x8(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x8(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x8(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x8(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_maskz_subs_epi16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint8_t k;
    const int16_t a[8];
    const int16_t b[8];
    const int16_t r[8];
  } test_vec[] = {
    { UINT8_C(165),
      { -INT16_C( 11509),  INT16_C( 20516), -INT16_C( 12322),  INT16_C( 18073), -INT16_C( 13873),  INT16_C( 19402),  INT16_C( 25262), -INT16_C( 17475) },
      { -INT16_C( 14555),  INT16_C( 29029),  INT16_C(  3126),  INT16_C(  6707), -INT16_C( 22781), -INT16_C(  2304), -INT16_C(  4878), -INT16_C(   356) },
      {  INT16_C(  3046),  INT16_C(     0), -INT16_C( 15448),  INT16_C(     0),  INT16_C(     0),  INT16_C( 21706),  INT16_C(     0), -INT16_C( 17119) } },
    { UINT8_C(191),
      {  INT16_C( 20161), -INT16_C( 28515), -INT16_C(  6937), -INT16_C( 20385), -INT16_C( 21842),  INT16_C(  4191),  INT16_C(  6760),  INT16_C( 12085) },
      { -INT16_C( 22913), -INT16_C( 29851), -INT16_C( 32550), -INT16_C( 32370), -INT16_C( 31360),  INT16_C( 27764),  INT16_C( 29218), -INT16_C(  7381) },
      {        INT16_MAX,  INT16_C(  1336),  INT16_C( 25613),  INT16_C( 11985),  INT16_C(  9518), -INT16_C( 23573),  INT16_C(     0),  INT16_C( 19466) } },
    { UINT8_C(192),
      {  INT16_C( 29641), -INT16_C( 21081),  INT16_C( 22482),  INT16_C( 31835),  INT16_C( 27574), -INT16_C( 11804),  INT16_C(  5025),  INT16_C( 18256) },
      { -INT16_C(  9095), -INT16_C(  1759), -INT16_C( 23702), -INT16_C(  3975), -INT16_C(  6633), -INT16_C( 30446), -INT16_C(  2799), -INT16_C(  9655) },
      {  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7824),  INT16_C( 27911) } },
    { UINT8_C(104),
      { -INT16_C( 30736),  INT16_C( 18234), -INT16_C( 18718),  INT16_C( 20222), -INT16_C( 12389), -INT16_C( 20753),  INT16_C( 13855), -INT16_C(  1241) },
      {  INT16_C(  8280), -INT16_C(  1178),  INT16_C( 22170), -INT16_C( 32750), -INT16_C( 25752),  INT16_C( 23953),  INT16_C( 27876), -INT16_C( 11067) },
      {  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MAX,  INT16_C(     0),        INT16_MIN, -INT16_C( 14021),  INT16_C(     0) } },
    { UINT8_C(243),
      {  INT16_C(  7167), -INT16_C( 18986),  INT16_C(  9241), -INT16_C(  6064), -INT16_C(   237),  INT16_C( 18696),  INT16_C(   806),  INT16_C( 18337) },
      { -INT16_C( 25495), -INT16_C( 16415),  INT16_C( 25006),  INT16_C( 18727), -INT16_C( 31502),  INT16_C( 24109),  INT16_C(   329),  INT16_C( 18514) },
      {  INT16_C( 32662), -INT16_C(  2571),  INT16_C(     0),  INT16_C(     0),  INT16_C( 31265), -INT16_C(  5413),  INT16_C(   477), -INT16_C(   177) } },
    { UINT8_C( 29),
      { -INT16_C(   472),  INT16_C( 19510),  INT16_C(  8014),  INT16_C( 19807), -INT16_C( 22489),  INT16_C( 10868), -INT16_C( 17590), -INT16_C(  6508) },
      {  INT16_C( 21404), -INT16_C(   619), -INT16_C(  8581), -INT16_C(    17),  INT16_C( 19980),  INT16_C(  3401), -INT16_C( 28256), -INT16_C( 14294) },
      { -INT16_C( 21876),  INT16_C(     0),  INT16_C( 16595),  INT16_C( 19824),        INT16_MIN,  INT16_C(     0),  INT16_C(     0),  INT16_C(     0) } },
    { UINT8_C(143),
      {  INT16_C(  5217), -INT16_C( 32546),  INT16_C( 11123),  INT16_C(  7079), -INT16_C( 11873),  INT16_C( 23141),  INT16_C( 19557), -INT16_C( 17930) },
      { -INT16_C(  3103), -INT16_C( 16588),  INT16_C( 13283),  INT16_C( 12747), -INT16_C(  9860),  INT16_C(  3793), -INT16_C( 26365),  INT16_C( 25757) },
      {  INT16_C(  8320), -INT16_C( 15958), -INT16_C(  2160), -INT16_C(  5668),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MIN } },
    { UINT8_C(173),
      { -INT16_C(  7045), -INT16_C( 22752),  INT16_C( 15243),  INT16_C( 23878), -INT16_C( 24159), -INT16_C(  4670),  INT16_C( 31639), -INT16_C( 29746) },
      { -INT16_C( 29265), -INT16_C(  7314), -INT16_C( 24743),  INT16_C( 12895),  INT16_C( 28016),  INT16_C(  2357), -INT16_C( 26101), -INT16_C( 31050) },
      {  INT16_C( 22220),  INT16_C(     0),        INT16_MAX,  INT16_C( 10983),  INT16_C(     0), -INT16_C(  7027),  INT16_C(     0),  INT16_C(  1304) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask8 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi16(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi16(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_maskz_subs_epi16(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_maskz_subs_epi16");
    easysimd_test_x86_assert_equal_i16x8(r, easysimd_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    easysimd__m128i a = easysimd_test_x86_random_i16x8();
    easysimd__m128i b = easysimd_test_x86_random_i16x8();
    easysimd__m128i r = easysimd_mm_maskz_subs_epi16(k, a, b);

    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_i16x8(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x8(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x8(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_mask_subs_epu8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint8_t src[16];
    const uint16_t k;
    const uint8_t a[16];
    const uint8_t b[16];
    const uint8_t r[16];
  } test_vec[] = {
    { { UINT8_C(160), UINT8_C(102), UINT8_C(165), UINT8_C(208), UINT8_C(251), UINT8_C(134), UINT8_C(119), UINT8_C(207),
        UINT8_C( 44), UINT8_C( 54), UINT8_C(186), UINT8_C(115), UINT8_C( 76), UINT8_C(142), UINT8_C( 86), UINT8_C( 24) },
      UINT16_C(43723),
      { UINT8_C(148), UINT8_C(184), UINT8_C(139), UINT8_C( 12), UINT8_C(193), UINT8_C( 98), UINT8_C(124), UINT8_C(242),
        UINT8_C(176), UINT8_C( 99), UINT8_C(  6), UINT8_C(249), UINT8_C(202), UINT8_C(166), UINT8_C( 95), UINT8_C(111) },
      { UINT8_C(118), UINT8_C( 90), UINT8_C(245), UINT8_C(237), UINT8_C( 41), UINT8_C( 33), UINT8_C( 36), UINT8_C(227),
        UINT8_C(148), UINT8_C(112), UINT8_C(114), UINT8_C(235), UINT8_C(136), UINT8_C( 61), UINT8_C(149), UINT8_C( 28) },
      { UINT8_C( 30), UINT8_C( 94), UINT8_C(165), UINT8_C(  0), UINT8_C(251), UINT8_C(134), UINT8_C( 88), UINT8_C( 15),
        UINT8_C( 44), UINT8_C(  0), UINT8_C(186), UINT8_C( 14), UINT8_C( 76), UINT8_C(105), UINT8_C( 86), UINT8_C( 83) } },
    { { UINT8_C(245), UINT8_C( 32), UINT8_C( 40), UINT8_C(182), UINT8_C(131), UINT8_C(165), UINT8_C(168), UINT8_C( 51),
        UINT8_C(  8), UINT8_C(174), UINT8_C( 44), UINT8_C(210), UINT8_C( 85), UINT8_C(139), UINT8_C( 65), UINT8_C(203) },
      UINT16_C(14053),
      { UINT8_C(185), UINT8_C( 15), UINT8_C( 87), UINT8_C(221), UINT8_C(242), UINT8_C(235), UINT8_C( 77), UINT8_C(100),
        UINT8_C(214), UINT8_C(213), UINT8_C(161), UINT8_C(108), UINT8_C(241), UINT8_C(150), UINT8_C(140), UINT8_C( 25) },
      { UINT8_C( 76), UINT8_C( 15), UINT8_C(190), UINT8_C(244), UINT8_C( 67), UINT8_C(198), UINT8_C(163), UINT8_C(111),
        UINT8_C(152), UINT8_C(248), UINT8_C(251), UINT8_C(217), UINT8_C(195), UINT8_C(224), UINT8_C( 15), UINT8_C(124) },
      { UINT8_C(109), UINT8_C( 32), UINT8_C(  0), UINT8_C(182), UINT8_C(131), UINT8_C( 37), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  8), UINT8_C(  0), UINT8_C(  0), UINT8_C(210), UINT8_C( 46), UINT8_C(  0), UINT8_C( 65), UINT8_C(203) } },
    { { UINT8_C(239), UINT8_C(102), UINT8_C( 89), UINT8_C(226), UINT8_C( 82), UINT8_C(166), UINT8_C( 70), UINT8_C( 40),
        UINT8_C(123), UINT8_C(232), UINT8_C(148), UINT8_C(108), UINT8_C(126), UINT8_C( 33), UINT8_C(134), UINT8_C(203) },
      UINT16_C(17456),
      { UINT8_C(191), UINT8_C(115), UINT8_C( 11), UINT8_C( 98), UINT8_C(227), UINT8_C(163), UINT8_C( 90), UINT8_C(222),
        UINT8_C(125), UINT8_C( 30), UINT8_C(190), UINT8_C(140), UINT8_C(154), UINT8_C(174), UINT8_C(243), UINT8_C(244) },
      { UINT8_C(144), UINT8_C( 69), UINT8_C(154), UINT8_C(214), UINT8_C(109), UINT8_C( 22), UINT8_C(190), UINT8_C(  2),
        UINT8_C(130), UINT8_C( 61), UINT8_C( 35), UINT8_C(  8), UINT8_C(  8), UINT8_C( 83), UINT8_C( 77), UINT8_C(199) },
      { UINT8_C(239), UINT8_C(102), UINT8_C( 89), UINT8_C(226), UINT8_C(118), UINT8_C(141), UINT8_C( 70), UINT8_C( 40),
        UINT8_C(123), UINT8_C(232), UINT8_C(155), UINT8_C(108), UINT8_C(126), UINT8_C( 33), UINT8_C(166), UINT8_C(203) } },
    { { UINT8_C(199), UINT8_C( 88), UINT8_C( 42), UINT8_C(170), UINT8_C(251), UINT8_C(132), UINT8_C(136), UINT8_C(120),
        UINT8_C(162), UINT8_C( 70), UINT8_C(  5), UINT8_C( 61), UINT8_C(244), UINT8_C(248), UINT8_C( 49), UINT8_C(132) },
      UINT16_C(52029),
      { UINT8_C( 91), UINT8_C(170), UINT8_C(225), UINT8_C( 25), UINT8_C(172), UINT8_C(100), UINT8_C( 86), UINT8_C(207),
        UINT8_C(108), UINT8_C( 94), UINT8_C( 35), UINT8_C(185), UINT8_C( 38), UINT8_C(234), UINT8_C( 17), UINT8_C( 80) },
      { UINT8_C(148), UINT8_C( 13), UINT8_C(212), UINT8_C( 28), UINT8_C(133), UINT8_C(119), UINT8_C( 98), UINT8_C(138),
        UINT8_C(180), UINT8_C( 87), UINT8_C(130), UINT8_C(229), UINT8_C(219), UINT8_C(191), UINT8_C(176), UINT8_C( 54) },
      { UINT8_C(  0), UINT8_C( 88), UINT8_C( 13), UINT8_C(  0), UINT8_C( 39), UINT8_C(  0), UINT8_C(136), UINT8_C(120),
        UINT8_C(  0), UINT8_C(  7), UINT8_C(  5), UINT8_C(  0), UINT8_C(244), UINT8_C(248), UINT8_C(  0), UINT8_C( 26) } },
    { { UINT8_C(106), UINT8_C(146), UINT8_C( 80), UINT8_C( 22), UINT8_C(246), UINT8_C(166), UINT8_C(230), UINT8_C( 98),
        UINT8_C(  5), UINT8_C(  9), UINT8_C( 28), UINT8_C( 43), UINT8_C(243), UINT8_C( 45), UINT8_C(123), UINT8_C(135) },
      UINT16_C(20282),
      { UINT8_C(163), UINT8_C(192), UINT8_C(198), UINT8_C(  5), UINT8_C( 74), UINT8_C(122), UINT8_C( 92), UINT8_C(205),
        UINT8_C( 95), UINT8_C( 56), UINT8_C(140), UINT8_C( 16), UINT8_C(110), UINT8_C(246), UINT8_C(162), UINT8_C(190) },
      { UINT8_C( 13), UINT8_C(152), UINT8_C(101), UINT8_C(243), UINT8_C(250), UINT8_C(106), UINT8_C(252), UINT8_C( 22),
        UINT8_C(149), UINT8_C(239), UINT8_C( 68), UINT8_C( 16), UINT8_C(118), UINT8_C(126), UINT8_C( 95), UINT8_C( 25) },
      { UINT8_C(106), UINT8_C( 40), UINT8_C( 80), UINT8_C(  0), UINT8_C(  0), UINT8_C( 16), UINT8_C(230), UINT8_C( 98),
        UINT8_C(  0), UINT8_C(  0), UINT8_C( 72), UINT8_C(  0), UINT8_C(243), UINT8_C( 45), UINT8_C( 67), UINT8_C(135) } },
    { { UINT8_C( 62), UINT8_C( 38), UINT8_C( 30), UINT8_C(137), UINT8_C(160), UINT8_C(123), UINT8_C( 86), UINT8_C(  0),
        UINT8_C(179), UINT8_C(226), UINT8_C( 16), UINT8_C( 33), UINT8_C(217), UINT8_C(178), UINT8_C(224), UINT8_C(230) },
      UINT16_C(17738),
      { UINT8_C(217), UINT8_C( 68), UINT8_C(175), UINT8_C(213), UINT8_C( 91), UINT8_C( 68), UINT8_C(196), UINT8_C(159),
        UINT8_C( 84), UINT8_C( 58), UINT8_C( 29), UINT8_C(179), UINT8_C( 83), UINT8_C( 92), UINT8_C(217), UINT8_C(113) },
      { UINT8_C(229), UINT8_C(122), UINT8_C(236), UINT8_C( 59), UINT8_C(122), UINT8_C(159), UINT8_C( 29), UINT8_C(138),
        UINT8_C(193), UINT8_C(246), UINT8_C( 60), UINT8_C(161), UINT8_C(220), UINT8_C(134), UINT8_C(230), UINT8_C(181) },
      { UINT8_C( 62), UINT8_C(  0), UINT8_C( 30), UINT8_C(154), UINT8_C(160), UINT8_C(123), UINT8_C(167), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(226), UINT8_C(  0), UINT8_C( 33), UINT8_C(217), UINT8_C(178), UINT8_C(  0), UINT8_C(230) } },
    { { UINT8_C(202), UINT8_C(149), UINT8_C(138), UINT8_C( 37), UINT8_C(217), UINT8_C( 78), UINT8_C(196), UINT8_C( 45),
        UINT8_C(136), UINT8_C(226), UINT8_C(224), UINT8_C(219), UINT8_C( 62), UINT8_C(186), UINT8_C( 77), UINT8_C( 35) },
      UINT16_C(14644),
      { UINT8_C( 94), UINT8_C(174), UINT8_C(217), UINT8_C(123), UINT8_C( 56), UINT8_C(154), UINT8_C(114), UINT8_C(116),
        UINT8_C( 59), UINT8_C( 78), UINT8_C(250), UINT8_C( 33), UINT8_C(  4), UINT8_C(196), UINT8_C(182), UINT8_C(142) },
      { UINT8_C(234), UINT8_C(143), UINT8_C(221), UINT8_C(174), UINT8_C(188), UINT8_C(101), UINT8_C(144), UINT8_C(156),
        UINT8_C( 65), UINT8_C(206), UINT8_C( 86), UINT8_C(142), UINT8_C(241), UINT8_C(138), UINT8_C(199), UINT8_C( 79) },
      { UINT8_C(202), UINT8_C(149), UINT8_C(  0), UINT8_C( 37), UINT8_C(  0), UINT8_C( 53), UINT8_C(196), UINT8_C( 45),
        UINT8_C(  0), UINT8_C(226), UINT8_C(224), UINT8_C(  0), UINT8_C(  0), UINT8_C( 58), UINT8_C( 77), UINT8_C( 35) } },
    { { UINT8_C( 56), UINT8_C(160), UINT8_C(203), UINT8_C(112), UINT8_C( 58), UINT8_C( 61), UINT8_C(228), UINT8_C(117),
        UINT8_C(139), UINT8_C(222), UINT8_C(150), UINT8_C(143), UINT8_C(163), UINT8_C( 76), UINT8_C( 30), UINT8_C(141) },
      UINT16_C(64475),
      { UINT8_C( 59), UINT8_C(151), UINT8_C( 96), UINT8_C(204), UINT8_C( 52), UINT8_C(161), UINT8_C(154), UINT8_C(138),
        UINT8_C( 47), UINT8_C(140), UINT8_C( 21), UINT8_C(247), UINT8_C(219), UINT8_C( 77), UINT8_C(151), UINT8_C(166) },
      { UINT8_C(190), UINT8_C(210), UINT8_C(227), UINT8_C(162), UINT8_C( 71), UINT8_C(111), UINT8_C(129), UINT8_C(222),
        UINT8_C(254), UINT8_C( 36), UINT8_C( 42), UINT8_C( 28), UINT8_C(177), UINT8_C(  6), UINT8_C( 23), UINT8_C(236) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(203), UINT8_C( 42), UINT8_C(  0), UINT8_C( 61), UINT8_C( 25), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(104), UINT8_C(150), UINT8_C(219), UINT8_C( 42), UINT8_C( 71), UINT8_C(128), UINT8_C(  0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m128i src = easysimd_mm_loadu_epi8(test_vec[i].src);
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi8(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi8(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_mask_subs_epu8(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_mask_subs_epu8");
    easysimd_test_x86_assert_equal_u8x16(r, easysimd_mm_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m128i src = easysimd_test_x86_random_u8x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m128i a = easysimd_test_x86_random_u8x16();
    easysimd__m128i b = easysimd_test_x86_random_u8x16();
    easysimd__m128i r = easysimd_mm_mask_subs_epu8(src, k, a, b);

    easysimd_test_x86_write_u8x16(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_maskz_subs_epu8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t k;
    const uint8_t a[16];
    const uint8_t b[16];
    const uint8_t r[16];
  } test_vec[] = {
    { UINT16_C(54910),
      { UINT8_C( 45), UINT8_C( 10), UINT8_C( 17), UINT8_C(116), UINT8_C(103), UINT8_C(178), UINT8_C( 21), UINT8_C( 41),
        UINT8_C(159), UINT8_C(172), UINT8_C(165), UINT8_C(109), UINT8_C( 55), UINT8_C( 84), UINT8_C(251), UINT8_C(165) },
      { UINT8_C( 55), UINT8_C( 84), UINT8_C( 68), UINT8_C(151), UINT8_C(134), UINT8_C(180), UINT8_C(  4), UINT8_C(187),
        UINT8_C(189), UINT8_C( 15), UINT8_C( 85), UINT8_C(115), UINT8_C(150), UINT8_C(212), UINT8_C( 73), UINT8_C(195) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 17), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(157), UINT8_C( 80), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(178), UINT8_C(  0) } },
    { UINT16_C(23518),
      { UINT8_C( 55), UINT8_C( 69), UINT8_C( 13), UINT8_C( 76), UINT8_C(110), UINT8_C(173), UINT8_C(249), UINT8_C( 19),
        UINT8_C( 26), UINT8_C( 48), UINT8_C(104), UINT8_C( 21), UINT8_C(214), UINT8_C(159), UINT8_C(105), UINT8_C( 26) },
      { UINT8_C( 54), UINT8_C(239), UINT8_C(207), UINT8_C( 59), UINT8_C(171), UINT8_C(140), UINT8_C( 74), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(224), UINT8_C(212), UINT8_C( 73), UINT8_C(164), UINT8_C(178), UINT8_C(164), UINT8_C(219) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 17), UINT8_C(  0), UINT8_C(  0), UINT8_C(175), UINT8_C( 19),
        UINT8_C( 26), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 50), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } },
    { UINT16_C(45815),
      { UINT8_C( 40), UINT8_C(102), UINT8_C( 95), UINT8_C( 33), UINT8_C(121), UINT8_C(121), UINT8_C( 81), UINT8_C(225),
        UINT8_C(143), UINT8_C( 39), UINT8_C(129), UINT8_C(248), UINT8_C( 66), UINT8_C(183), UINT8_C(232), UINT8_C( 17) },
      { UINT8_C(242), UINT8_C(147), UINT8_C(157), UINT8_C( 61), UINT8_C(147), UINT8_C(157), UINT8_C( 29), UINT8_C(104),
        UINT8_C(231), UINT8_C(193), UINT8_C( 26), UINT8_C(139), UINT8_C(157), UINT8_C( 18), UINT8_C( 61), UINT8_C(197) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 52), UINT8_C(121),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(165), UINT8_C(  0), UINT8_C(  0) } },
    { UINT16_C(40056),
      { UINT8_C(230), UINT8_C(241), UINT8_C( 22), UINT8_C( 55), UINT8_C(211), UINT8_C(165), UINT8_C( 95), UINT8_C( 84),
        UINT8_C(157), UINT8_C(161), UINT8_C( 11), UINT8_C(133), UINT8_C(178), UINT8_C(254), UINT8_C( 24), UINT8_C( 79) },
      { UINT8_C( 59), UINT8_C(172), UINT8_C(237), UINT8_C( 88), UINT8_C( 20), UINT8_C(212), UINT8_C( 26), UINT8_C( 46),
        UINT8_C( 95), UINT8_C(183), UINT8_C( 64), UINT8_C(157), UINT8_C(124), UINT8_C(184), UINT8_C( 57), UINT8_C( 98) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(191), UINT8_C(  0), UINT8_C( 69), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 54), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } },
    { UINT16_C(20394),
      { UINT8_C(153), UINT8_C(125), UINT8_C(244), UINT8_C(248), UINT8_C(209), UINT8_C(146), UINT8_C(153), UINT8_C(220),
        UINT8_C( 23), UINT8_C( 75), UINT8_C(218), UINT8_C( 48), UINT8_C(155), UINT8_C( 21), UINT8_C(220), UINT8_C(136) },
      { UINT8_C(110), UINT8_C(240), UINT8_C( 92), UINT8_C(136), UINT8_C( 30), UINT8_C(187), UINT8_C( 63), UINT8_C( 95),
        UINT8_C( 88), UINT8_C(187), UINT8_C( 23), UINT8_C(146), UINT8_C( 29), UINT8_C(193), UINT8_C(225), UINT8_C(182) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(112), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(125),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(195), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } },
    { UINT16_C(54846),
      { UINT8_C(175), UINT8_C( 15), UINT8_C(104), UINT8_C( 72), UINT8_C(236), UINT8_C(127), UINT8_C(148), UINT8_C(198),
        UINT8_C(175), UINT8_C( 47), UINT8_C(220), UINT8_C(139), UINT8_C(183), UINT8_C( 74), UINT8_C(123), UINT8_C( 19) },
      { UINT8_C(210), UINT8_C(154), UINT8_C(206), UINT8_C( 17), UINT8_C(249), UINT8_C( 39), UINT8_C(204), UINT8_C( 16),
        UINT8_C(185), UINT8_C(233), UINT8_C(210), UINT8_C(154), UINT8_C(159), UINT8_C( 16), UINT8_C(112), UINT8_C( 78) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 55), UINT8_C(  0), UINT8_C( 88), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C( 10), UINT8_C(  0), UINT8_C( 24), UINT8_C(  0), UINT8_C( 11), UINT8_C(  0) } },
    { UINT16_C(55328),
      { UINT8_C(151), UINT8_C( 12), UINT8_C( 88), UINT8_C( 43), UINT8_C(210), UINT8_C(  7), UINT8_C( 90), UINT8_C(174),
        UINT8_C(147), UINT8_C( 17), UINT8_C(248), UINT8_C( 14), UINT8_C( 36), UINT8_C(202), UINT8_C(168), UINT8_C(242) },
      { UINT8_C(219), UINT8_C(161), UINT8_C( 25), UINT8_C(167), UINT8_C(178), UINT8_C(210), UINT8_C(144), UINT8_C(132),
        UINT8_C(109), UINT8_C( 48), UINT8_C(148), UINT8_C(221), UINT8_C(126), UINT8_C(180), UINT8_C(182), UINT8_C( 21) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(221) } },
    { UINT16_C( 3776),
      { UINT8_C( 64), UINT8_C(147), UINT8_C( 21), UINT8_C(154), UINT8_C( 65), UINT8_C(168), UINT8_C(171), UINT8_C( 58),
        UINT8_C(183), UINT8_C(207), UINT8_C(  4), UINT8_C( 95), UINT8_C(194), UINT8_C(224), UINT8_C(  1), UINT8_C(219) },
      { UINT8_C(135), UINT8_C(179), UINT8_C(174), UINT8_C( 24), UINT8_C( 55), UINT8_C( 27), UINT8_C( 72), UINT8_C(203),
        UINT8_C(248), UINT8_C(198), UINT8_C(128), UINT8_C(174), UINT8_C(220), UINT8_C( 64), UINT8_C(188), UINT8_C( 28) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 99), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  9), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi8(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi8(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_maskz_subs_epu8(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_maskz_subs_epu8");
    easysimd_test_x86_assert_equal_u8x16(r, easysimd_mm_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m128i a = easysimd_test_x86_random_u8x16();
    easysimd__m128i b = easysimd_test_x86_random_u8x16();
    easysimd__m128i r = easysimd_mm_maskz_subs_epu8(k, a, b);

    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_u8x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_mask_subs_epu16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t src[8];
    const uint8_t k;
    const uint16_t a[8];
    const uint16_t b[8];
    const uint16_t r[8];
  } test_vec[] = {
    { { UINT16_C(30877), UINT16_C(53688), UINT16_C(21273), UINT16_C(18780), UINT16_C(29151), UINT16_C(47680), UINT16_C(55230), UINT16_C(31841) },
      UINT8_C(169),
      { UINT16_C( 8004), UINT16_C(46065), UINT16_C(53152), UINT16_C(50354), UINT16_C(52985), UINT16_C(65397), UINT16_C(25062), UINT16_C(24221) },
      { UINT16_C(28186), UINT16_C(28023), UINT16_C(49354), UINT16_C(15180), UINT16_C( 1536), UINT16_C(55546), UINT16_C(30311), UINT16_C(44161) },
      { UINT16_C(    0), UINT16_C(53688), UINT16_C(21273), UINT16_C(35174), UINT16_C(29151), UINT16_C( 9851), UINT16_C(55230), UINT16_C(    0) } },
    { { UINT16_C(29333), UINT16_C(13663), UINT16_C( 4417), UINT16_C(15353), UINT16_C(28384), UINT16_C(50746), UINT16_C(55248), UINT16_C(59940) },
      UINT8_C( 70),
      { UINT16_C(22427), UINT16_C(23568), UINT16_C(19619), UINT16_C(43356), UINT16_C(13382), UINT16_C(48145), UINT16_C(48566), UINT16_C(10322) },
      { UINT16_C(34588), UINT16_C(11882), UINT16_C(42369), UINT16_C(61198), UINT16_C(54495), UINT16_C(47039), UINT16_C(43512), UINT16_C(37885) },
      { UINT16_C(29333), UINT16_C(11686), UINT16_C(    0), UINT16_C(15353), UINT16_C(28384), UINT16_C(50746), UINT16_C( 5054), UINT16_C(59940) } },
    { { UINT16_C( 3328), UINT16_C(41967), UINT16_C(19545), UINT16_C(40781), UINT16_C(24192), UINT16_C(13916), UINT16_C(44571), UINT16_C(14175) },
      UINT8_C( 53),
      { UINT16_C(26057), UINT16_C(28342), UINT16_C(42611), UINT16_C(18253), UINT16_C( 1125), UINT16_C( 3903), UINT16_C(54017), UINT16_C( 3855) },
      { UINT16_C(46018), UINT16_C( 3688), UINT16_C( 2048), UINT16_C(24207), UINT16_C(50532), UINT16_C( 4729), UINT16_C(45092), UINT16_C(60743) },
      { UINT16_C(    0), UINT16_C(41967), UINT16_C(40563), UINT16_C(40781), UINT16_C(    0), UINT16_C(    0), UINT16_C(44571), UINT16_C(14175) } },
    { { UINT16_C(65046), UINT16_C(35163), UINT16_C(43428), UINT16_C( 2513), UINT16_C( 4269), UINT16_C(44824), UINT16_C(10467), UINT16_C(42686) },
      UINT8_C(219),
      { UINT16_C(46118), UINT16_C(11995), UINT16_C(14659), UINT16_C( 2450), UINT16_C(42162), UINT16_C(25133), UINT16_C( 7148), UINT16_C(60024) },
      { UINT16_C(  630), UINT16_C( 8078), UINT16_C(38867), UINT16_C(58317), UINT16_C(31920), UINT16_C(55495), UINT16_C(27962), UINT16_C(24755) },
      { UINT16_C(45488), UINT16_C( 3917), UINT16_C(43428), UINT16_C(    0), UINT16_C(10242), UINT16_C(44824), UINT16_C(    0), UINT16_C(35269) } },
    { { UINT16_C(36385), UINT16_C(25999), UINT16_C( 8647), UINT16_C(31086), UINT16_C(39878), UINT16_C(45787), UINT16_C(21686), UINT16_C(11676) },
      UINT8_C( 86),
      { UINT16_C(19498), UINT16_C(49449), UINT16_C( 3097), UINT16_C(38257), UINT16_C(18899), UINT16_C(16591), UINT16_C(12540), UINT16_C(35426) },
      { UINT16_C(51135), UINT16_C(57425), UINT16_C(51765), UINT16_C(53414), UINT16_C(22694), UINT16_C(64135), UINT16_C(46324), UINT16_C( 7760) },
      { UINT16_C(36385), UINT16_C(    0), UINT16_C(    0), UINT16_C(31086), UINT16_C(    0), UINT16_C(45787), UINT16_C(    0), UINT16_C(11676) } },
    { { UINT16_C(30976), UINT16_C( 6880), UINT16_C(20869), UINT16_C(22959), UINT16_C(32667), UINT16_C(38809), UINT16_C(64431), UINT16_C(28194) },
      UINT8_C(194),
      { UINT16_C(20083), UINT16_C(16119), UINT16_C(51445), UINT16_C(19940), UINT16_C(56911), UINT16_C(  834), UINT16_C(24622), UINT16_C(42755) },
      { UINT16_C( 7488), UINT16_C(37420), UINT16_C(34253), UINT16_C(19501), UINT16_C(50207), UINT16_C( 6907), UINT16_C(27110), UINT16_C(23261) },
      { UINT16_C(30976), UINT16_C(    0), UINT16_C(20869), UINT16_C(22959), UINT16_C(32667), UINT16_C(38809), UINT16_C(    0), UINT16_C(19494) } },
    { { UINT16_C(54455), UINT16_C(44184), UINT16_C(31900), UINT16_C(60410), UINT16_C(15450), UINT16_C(35054), UINT16_C(62108), UINT16_C(56623) },
      UINT8_C( 15),
      { UINT16_C(28507), UINT16_C(57820), UINT16_C(10396), UINT16_C(24576), UINT16_C( 6691), UINT16_C(35911), UINT16_C(41463), UINT16_C(52292) },
      { UINT16_C(61497), UINT16_C(46440), UINT16_C(21738), UINT16_C( 9743), UINT16_C(38722), UINT16_C(13507), UINT16_C(41158), UINT16_C( 8516) },
      { UINT16_C(    0), UINT16_C(11380), UINT16_C(    0), UINT16_C(14833), UINT16_C(15450), UINT16_C(35054), UINT16_C(62108), UINT16_C(56623) } },
    { { UINT16_C( 8207), UINT16_C(43778), UINT16_C(  585), UINT16_C(27659), UINT16_C(21021), UINT16_C( 5369), UINT16_C(15859), UINT16_C(11488) },
      UINT8_C( 45),
      { UINT16_C(57673), UINT16_C(40216), UINT16_C(16112), UINT16_C(34783), UINT16_C( 5121), UINT16_C(41293), UINT16_C(28504), UINT16_C(30896) },
      { UINT16_C(23409), UINT16_C(29889), UINT16_C(11879), UINT16_C(47505), UINT16_C(42279), UINT16_C(25773), UINT16_C(55686), UINT16_C(53137) },
      { UINT16_C(34264), UINT16_C(43778), UINT16_C( 4233), UINT16_C(    0), UINT16_C(21021), UINT16_C(15520), UINT16_C(15859), UINT16_C(11488) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m128i src = easysimd_mm_loadu_epi16(test_vec[i].src);
    easysimd__mmask8 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi16(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi16(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_mask_subs_epu16(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_mask_subs_epu16");
    easysimd_test_x86_assert_equal_u16x8(r, easysimd_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m128i src = easysimd_test_x86_random_u16x8();
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    easysimd__m128i a = easysimd_test_x86_random_u16x8();
    easysimd__m128i b = easysimd_test_x86_random_u16x8();
    easysimd__m128i r = easysimd_mm_mask_subs_epu16(src, k, a, b);

    easysimd_test_x86_write_u16x8(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x8(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x8(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x8(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm_maskz_subs_epu16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint8_t k;
    const uint16_t a[8];
    const uint16_t b[8];
    const uint16_t r[8];
  } test_vec[] = {
    { UINT8_C(211),
      { UINT16_C(47058), UINT16_C(31253), UINT16_C(20322), UINT16_C(12849), UINT16_C(37203), UINT16_C(13300), UINT16_C(53138), UINT16_C(17851) },
      { UINT16_C(54141), UINT16_C(39036), UINT16_C(18203), UINT16_C(57745), UINT16_C(16327), UINT16_C( 2237), UINT16_C(56060), UINT16_C(52955) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(20876), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } },
    { UINT8_C(145),
      { UINT16_C(18672), UINT16_C(16371), UINT16_C( 9594), UINT16_C( 2963), UINT16_C(50713), UINT16_C(59805), UINT16_C(57985), UINT16_C(21606) },
      { UINT16_C(65374), UINT16_C(42351), UINT16_C(20880), UINT16_C(53101), UINT16_C(29966), UINT16_C(59595), UINT16_C(39248), UINT16_C(16761) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(20747), UINT16_C(    0), UINT16_C(    0), UINT16_C( 4845) } },
    { UINT8_C(226),
      { UINT16_C(32877), UINT16_C(37468), UINT16_C(26387), UINT16_C(55980), UINT16_C(38148), UINT16_C(58971), UINT16_C(45307), UINT16_C(64068) },
      { UINT16_C(59679), UINT16_C(28810), UINT16_C(23126), UINT16_C(52095), UINT16_C(26405), UINT16_C(48924), UINT16_C(24033), UINT16_C(20129) },
      { UINT16_C(    0), UINT16_C( 8658), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(10047), UINT16_C(21274), UINT16_C(43939) } },
    { UINT8_C(221),
      { UINT16_C(57597), UINT16_C(25841), UINT16_C(52108), UINT16_C( 8552), UINT16_C(20006), UINT16_C(54813), UINT16_C( 6034), UINT16_C(31734) },
      { UINT16_C(26274), UINT16_C(64722), UINT16_C(40421), UINT16_C(19745), UINT16_C(57529), UINT16_C( 5678), UINT16_C(31873), UINT16_C(32500) },
      { UINT16_C(31323), UINT16_C(    0), UINT16_C(11687), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } },
    { UINT8_C( 92),
      { UINT16_C(58085), UINT16_C(45289), UINT16_C( 2634), UINT16_C(39126), UINT16_C(44327), UINT16_C(16170), UINT16_C(42659), UINT16_C( 2529) },
      { UINT16_C(56696), UINT16_C( 5615), UINT16_C(15614), UINT16_C(57295), UINT16_C(58730), UINT16_C(58976), UINT16_C(57305), UINT16_C(48706) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } },
    { UINT8_C(193),
      { UINT16_C(28203), UINT16_C(13836), UINT16_C(42053), UINT16_C(62045), UINT16_C(40143), UINT16_C(30101), UINT16_C(40573), UINT16_C(23277) },
      { UINT16_C(  653), UINT16_C(51545), UINT16_C(14545), UINT16_C(46899), UINT16_C( 6552), UINT16_C(30608), UINT16_C(20316), UINT16_C(34617) },
      { UINT16_C(27550), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(20257), UINT16_C(    0) } },
    { UINT8_C(189),
      { UINT16_C(48453), UINT16_C(59650), UINT16_C(62491), UINT16_C(47032), UINT16_C(11657), UINT16_C(10293), UINT16_C(36634), UINT16_C( 7605) },
      { UINT16_C(32744), UINT16_C( 8430), UINT16_C(42418), UINT16_C(52409), UINT16_C(12342), UINT16_C(34088), UINT16_C(44905), UINT16_C(44610) },
      { UINT16_C(15709), UINT16_C(    0), UINT16_C(20073), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } },
    { UINT8_C(109),
      { UINT16_C(38981), UINT16_C(14728), UINT16_C(16208), UINT16_C(32451), UINT16_C(60276), UINT16_C( 1176), UINT16_C(46496), UINT16_C( 8172) },
      { UINT16_C( 3492), UINT16_C(18898), UINT16_C(40646), UINT16_C(63103), UINT16_C( 1222), UINT16_C(30048), UINT16_C( 3655), UINT16_C(36066) },
      { UINT16_C(35489), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(42841), UINT16_C(    0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask8 k = test_vec[i].k;
    easysimd__m128i a = easysimd_mm_loadu_epi16(test_vec[i].a);
    easysimd__m128i b = easysimd_mm_loadu_epi16(test_vec[i].b);
    easysimd__m128i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm_maskz_subs_epu16(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm_maskz_subs_epu16");
    easysimd_test_x86_assert_equal_u16x8(r, easysimd_mm_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask8 k = easysimd_test_x86_random_mmask8();
    easysimd__m128i a = easysimd_test_x86_random_u16x8();
    easysimd__m128i b = easysimd_test_x86_random_u16x8();
    easysimd__m128i r = easysimd_mm_maskz_subs_epu16(k, a, b);

    easysimd_test_x86_write_mmask8(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_u16x8(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x8(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x8(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_mask_subs_epi8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const int8_t src[32];
    const uint32_t k;
    const int8_t a[32];
    const int8_t b[32];
    const int8_t r[32];
  } test_vec[] = {
    { {  INT8_C( 105), -INT8_C(  54), -INT8_C(   9),  INT8_C(  70),  INT8_C(  80),  INT8_C( 117),  INT8_C( 111), -INT8_C(  99),
         INT8_C( 101),  INT8_C( 109), -INT8_C(  12), -INT8_C(   1), -INT8_C( 124), -INT8_C(  46),  INT8_C(  42),  INT8_C( 101),
        -INT8_C(  92),  INT8_C( 126),  INT8_C( 109),  INT8_C( 100), -INT8_C( 116), -INT8_C(  92),  INT8_C( 102),  INT8_C(  48),
         INT8_C(  42), -INT8_C(   1), -INT8_C(  14), -INT8_C(  69), -INT8_C(  53), -INT8_C(  19),  INT8_C(   8),  INT8_C(  53) },
      UINT32_C( 142344119),
      {  INT8_C( 116), -INT8_C(  21), -INT8_C(  91), -INT8_C(  39),  INT8_C(  88), -INT8_C( 103), -INT8_C(  39), -INT8_C(  36),
         INT8_C( 107),  INT8_C(   3),  INT8_C(  66),  INT8_C(  15), -INT8_C( 126), -INT8_C(  81),  INT8_C( 115),  INT8_C(  14),
         INT8_C(  83), -INT8_C(  38),  INT8_C(  62),  INT8_C( 126), -INT8_C(  39),  INT8_C(  48),  INT8_C(  57), -INT8_C(  92),
         INT8_C(  29),  INT8_C(  65), -INT8_C(  39), -INT8_C(  43),  INT8_C(  65),  INT8_C(  85), -INT8_C(  35), -INT8_C(  75) },
      {  INT8_C(  64), -INT8_C( 126), -INT8_C( 113), -INT8_C( 104),  INT8_C(  27),  INT8_C( 104),  INT8_C( 117), -INT8_C( 121),
         INT8_C( 107), -INT8_C(  73), -INT8_C( 106), -INT8_C(  19),  INT8_C( 102),  INT8_C(  10), -INT8_C(   5), -INT8_C(  70),
        -INT8_C(  28),  INT8_C(  57),  INT8_C(  56), -INT8_C(  67),  INT8_C( 105),  INT8_C( 113),  INT8_C(  97), -INT8_C( 121),
        -INT8_C(  77),  INT8_C(  59),  INT8_C(  92), -INT8_C(  12), -INT8_C( 112),  INT8_C(  57), -INT8_C(  87), -INT8_C(  48) },
      {  INT8_C(  52),  INT8_C( 105),  INT8_C(  22),  INT8_C(  70),  INT8_C(  61),      INT8_MIN,  INT8_C( 111),  INT8_C(  85),
         INT8_C(   0),  INT8_C(  76),      INT8_MAX,  INT8_C(  34),      INT8_MIN, -INT8_C(  91),  INT8_C( 120),  INT8_C(  84),
         INT8_C( 111), -INT8_C(  95),  INT8_C( 109),      INT8_MAX,      INT8_MIN, -INT8_C(  65), -INT8_C(  40),  INT8_C(  48),
         INT8_C(  42), -INT8_C(   1), -INT8_C(  14), -INT8_C(  31), -INT8_C(  53), -INT8_C(  19),  INT8_C(   8),  INT8_C(  53) } },
    { { -INT8_C(  69),  INT8_C(  56),  INT8_C( 104), -INT8_C(  42), -INT8_C(  96), -INT8_C(  35),  INT8_C(  93),  INT8_C(  12),
        -INT8_C( 108), -INT8_C(  12), -INT8_C(   7), -INT8_C(   5), -INT8_C(   2), -INT8_C(  11), -INT8_C(  75), -INT8_C(  30),
         INT8_C(  46), -INT8_C(  19), -INT8_C(  97), -INT8_C( 104),  INT8_C(  94),  INT8_C(   0),  INT8_C(  31),  INT8_C(  17),
         INT8_C(  59),  INT8_C( 123),  INT8_C(   5), -INT8_C(  53), -INT8_C(  76), -INT8_C(  81), -INT8_C( 101),  INT8_C( 111) },
      UINT32_C(2286224615),
      { -INT8_C(  31), -INT8_C(  93), -INT8_C( 108),  INT8_C( 118), -INT8_C( 105), -INT8_C( 115),  INT8_C( 113), -INT8_C( 107),
        -INT8_C( 126),  INT8_C(  38),  INT8_C( 119), -INT8_C(  79),  INT8_C(  19),  INT8_C(  22),  INT8_C(  73),  INT8_C( 113),
         INT8_C(  22),  INT8_C( 104), -INT8_C( 125),  INT8_C(  82), -INT8_C(  29), -INT8_C( 120),  INT8_C(  29), -INT8_C( 105),
         INT8_C(  55), -INT8_C(  71),  INT8_C(   6),  INT8_C(  31), -INT8_C(  67),  INT8_C(  75), -INT8_C(  89), -INT8_C(  98) },
      { -INT8_C(  18),  INT8_C(  59),  INT8_C(  20), -INT8_C( 123), -INT8_C(  56), -INT8_C( 123),  INT8_C(  26),  INT8_C(  75),
        -INT8_C(  85), -INT8_C( 111), -INT8_C(   4), -INT8_C(  66), -INT8_C(  89),  INT8_C(  69),  INT8_C(  48), -INT8_C(  66),
        -INT8_C(  83), -INT8_C(  77),  INT8_C(  16), -INT8_C( 112),  INT8_C(  59),  INT8_C(  45),  INT8_C(  39),  INT8_C( 115),
        -INT8_C(  26),  INT8_C(  45), -INT8_C( 110), -INT8_C(  93),  INT8_C( 120),  INT8_C(  57),  INT8_C(  66),  INT8_C( 103) },
      { -INT8_C(  13),      INT8_MIN,      INT8_MIN, -INT8_C(  42), -INT8_C(  96),  INT8_C(   8),  INT8_C(  87),      INT8_MIN,
        -INT8_C( 108), -INT8_C(  12),  INT8_C( 123), -INT8_C(   5), -INT8_C(   2), -INT8_C(  11), -INT8_C(  75), -INT8_C(  30),
         INT8_C( 105), -INT8_C(  19),      INT8_MIN, -INT8_C( 104),  INT8_C(  94),  INT8_C(   0), -INT8_C(  10),  INT8_C(  17),
         INT8_C(  59),  INT8_C( 123),  INT8_C(   5),  INT8_C( 124), -INT8_C(  76), -INT8_C(  81), -INT8_C( 101),      INT8_MIN } },
    { {  INT8_C( 116),  INT8_C(  86), -INT8_C(  20),  INT8_C(  60), -INT8_C(  36),  INT8_C(   7), -INT8_C( 121), -INT8_C( 121),
        -INT8_C( 104), -INT8_C( 125),  INT8_C(  70),  INT8_C(  64), -INT8_C(  56),  INT8_C( 118), -INT8_C(   2),  INT8_C( 117),
         INT8_C(  41),  INT8_C(  14),  INT8_C(   5),  INT8_C( 100),  INT8_C(  59),  INT8_C(  44), -INT8_C(  41),  INT8_C(  34),
         INT8_C(  89),  INT8_C( 105), -INT8_C(  59), -INT8_C(  46), -INT8_C(  94),  INT8_C(   7),  INT8_C(  57),  INT8_C(  22) },
      UINT32_C( 978527582),
      {  INT8_C(  44), -INT8_C(  38), -INT8_C(  63), -INT8_C(  59),  INT8_C(  94),  INT8_C(   7),  INT8_C(   5),  INT8_C(  38),
         INT8_C( 125),  INT8_C(   3), -INT8_C( 100), -INT8_C(  90),  INT8_C(  17), -INT8_C(  95),  INT8_C(  11),  INT8_C(  76),
        -INT8_C(  50), -INT8_C(  30),  INT8_C( 110),  INT8_C(  39),  INT8_C(  76),  INT8_C(  52), -INT8_C(   7), -INT8_C(  18),
         INT8_C(  59),  INT8_C(  50),  INT8_C(   5), -INT8_C( 103),  INT8_C(  88),  INT8_C(  88), -INT8_C(  45), -INT8_C( 124) },
      {  INT8_C(  50), -INT8_C( 107),  INT8_C(  73), -INT8_C( 112), -INT8_C( 100),  INT8_C(  78), -INT8_C(  73),  INT8_C(  26),
         INT8_C(  81),  INT8_C(  83), -INT8_C(  64),  INT8_C(  98), -INT8_C(  12), -INT8_C(  53), -INT8_C(  81), -INT8_C(  62),
        -INT8_C(  82),  INT8_C(  29), -INT8_C(  22), -INT8_C(   6),  INT8_C(  81), -INT8_C(  29), -INT8_C(  24), -INT8_C( 115),
         INT8_C(  22), -INT8_C(  19),  INT8_C(  38),  INT8_C( 110),  INT8_C(  69), -INT8_C(   6), -INT8_C(  14),  INT8_C( 120) },
      {  INT8_C( 116),  INT8_C(  69),      INT8_MIN,  INT8_C(  53),      INT8_MAX,  INT8_C(   7),  INT8_C(  78), -INT8_C( 121),
         INT8_C(  44), -INT8_C( 125), -INT8_C(  36),  INT8_C(  64), -INT8_C(  56), -INT8_C(  42), -INT8_C(   2),  INT8_C( 117),
         INT8_C(  32), -INT8_C(  59),  INT8_C(   5),  INT8_C( 100), -INT8_C(   5),  INT8_C(  44),  INT8_C(  17),  INT8_C(  34),
         INT8_C(  89),  INT8_C(  69), -INT8_C(  59),      INT8_MIN,  INT8_C(  19),  INT8_C(  94),  INT8_C(  57),  INT8_C(  22) } },
    { { -INT8_C( 113),  INT8_C(  60),  INT8_C(   8),  INT8_C(  43), -INT8_C( 118), -INT8_C(  65),  INT8_C(  69), -INT8_C(  36),
         INT8_C(  18),  INT8_C(   6),  INT8_C(  62),  INT8_C(   7), -INT8_C(  47), -INT8_C(  19), -INT8_C(  55),      INT8_MAX,
         INT8_C(  11), -INT8_C(  77),  INT8_C( 121),  INT8_C(  92), -INT8_C( 105),  INT8_C(  98), -INT8_C(  23), -INT8_C(  83),
         INT8_C(  79),  INT8_C(  16),  INT8_C(  27), -INT8_C( 107),  INT8_C(  10),  INT8_C(  13),  INT8_C(  13), -INT8_C( 103) },
      UINT32_C(3569620297),
      { -INT8_C(  43),  INT8_C(  10), -INT8_C(  80), -INT8_C(  25),  INT8_C(  16), -INT8_C(  18), -INT8_C(  18), -INT8_C(  31),
        -INT8_C(  36), -INT8_C(  72),  INT8_C(  97), -INT8_C(  25),  INT8_C( 107), -INT8_C(  38),  INT8_C(  67),  INT8_C(   2),
         INT8_C(  60),  INT8_C(  45), -INT8_C(  81), -INT8_C( 116),  INT8_C(  61), -INT8_C(  54),  INT8_C(  33),  INT8_C(  71),
        -INT8_C(  40),  INT8_C(  46), -INT8_C(  32),  INT8_C(  33),  INT8_C(  67), -INT8_C(  92), -INT8_C(  11),  INT8_C(  24) },
      { -INT8_C(  82), -INT8_C(  91),  INT8_C(   0), -INT8_C(  66), -INT8_C( 108), -INT8_C(  18), -INT8_C(  96),  INT8_C( 112),
        -INT8_C(  90),  INT8_C(   1),  INT8_C(  87),  INT8_C(  18), -INT8_C(  37), -INT8_C( 102),  INT8_C(  20),  INT8_C(  24),
        -INT8_C(  57), -INT8_C(  60), -INT8_C(  92),  INT8_C(   4), -INT8_C( 114), -INT8_C(  59),  INT8_C(  75),  INT8_C( 102),
        -INT8_C(  13),  INT8_C(  43), -INT8_C( 120),  INT8_C(  54), -INT8_C(  48),  INT8_C( 125),  INT8_C(  79),  INT8_C( 126) },
      {  INT8_C(  39),  INT8_C(  60),  INT8_C(   8),  INT8_C(  41), -INT8_C( 118), -INT8_C(  65),  INT8_C(  78), -INT8_C(  36),
         INT8_C(  54),  INT8_C(   6),  INT8_C(  10),  INT8_C(   7),      INT8_MAX, -INT8_C(  19), -INT8_C(  55),      INT8_MAX,
         INT8_C(  11), -INT8_C(  77),  INT8_C(  11),  INT8_C(  92), -INT8_C( 105),  INT8_C(  98), -INT8_C(  42), -INT8_C(  31),
         INT8_C(  79),  INT8_C(  16),  INT8_C(  88), -INT8_C( 107),  INT8_C( 115),  INT8_C(  13), -INT8_C(  90), -INT8_C( 102) } },
    { {  INT8_C(  35),  INT8_C(  79),  INT8_C(  61), -INT8_C(  73),  INT8_C(  61), -INT8_C(  35),  INT8_C(  39), -INT8_C(  28),
        -INT8_C(  34),  INT8_C( 126), -INT8_C(  10), -INT8_C(  71),  INT8_C(  24),  INT8_C(  10), -INT8_C(  47), -INT8_C(  32),
        -INT8_C(  50),  INT8_C( 117), -INT8_C(  28),  INT8_C(  93),  INT8_C(  58),  INT8_C(  48), -INT8_C(  61),  INT8_C(  45),
         INT8_C(  91),  INT8_C(  75),  INT8_C( 100),  INT8_C(  43), -INT8_C(  55), -INT8_C(  77), -INT8_C(  86), -INT8_C(  20) },
      UINT32_C(1067706114),
      { -INT8_C(  60), -INT8_C(  54),  INT8_C(  35), -INT8_C(  94),  INT8_C(  72),  INT8_C(  25),  INT8_C(  91),  INT8_C(  96),
         INT8_C(  36),  INT8_C(  45),  INT8_C(  64), -INT8_C(  14), -INT8_C(  94),  INT8_C(  37),  INT8_C(  79), -INT8_C(  35),
         INT8_C(  85),  INT8_C(  19),  INT8_C(  10), -INT8_C(  80),  INT8_C(  94),  INT8_C( 110), -INT8_C(  36),  INT8_C(  39),
         INT8_C(  33), -INT8_C( 122),  INT8_C(  19),  INT8_C(  35),  INT8_C( 109), -INT8_C(  74),  INT8_C(  99),  INT8_C(  49) },
      {      INT8_MIN, -INT8_C( 122), -INT8_C(  45), -INT8_C(  56), -INT8_C(  96),  INT8_C(  46),  INT8_C(  41), -INT8_C(  60),
         INT8_C(  91),  INT8_C( 105), -INT8_C(  74), -INT8_C(   2), -INT8_C( 114),  INT8_C(   6), -INT8_C(  37), -INT8_C(  29),
         INT8_C(  25), -INT8_C(  27), -INT8_C( 108),  INT8_C( 119),  INT8_C(  84),  INT8_C( 112), -INT8_C(  97),  INT8_C( 117),
        -INT8_C(  10), -INT8_C(  78), -INT8_C( 103),  INT8_C(  99),  INT8_C( 105), -INT8_C(   4), -INT8_C( 108), -INT8_C(  23) },
      {  INT8_C(  35),  INT8_C(  68),  INT8_C(  61), -INT8_C(  73),  INT8_C(  61), -INT8_C(  35),  INT8_C(  39), -INT8_C(  28),
        -INT8_C(  55), -INT8_C(  60),      INT8_MAX, -INT8_C(  71),  INT8_C(  24),  INT8_C(  31),  INT8_C( 116), -INT8_C(   6),
         INT8_C(  60),  INT8_C(  46), -INT8_C(  28),  INT8_C(  93),  INT8_C(  58), -INT8_C(   2), -INT8_C(  61), -INT8_C(  78),
         INT8_C(  43), -INT8_C(  44),  INT8_C( 122), -INT8_C(  64),  INT8_C(   4), -INT8_C(  70), -INT8_C(  86), -INT8_C(  20) } },
    { { -INT8_C( 126),  INT8_C( 103), -INT8_C(  78),  INT8_C(  34), -INT8_C( 107), -INT8_C(  37), -INT8_C(  26), -INT8_C(  15),
         INT8_C(  68), -INT8_C(  99), -INT8_C(  17), -INT8_C(  45), -INT8_C(  93), -INT8_C(  54), -INT8_C(  74), -INT8_C(  68),
        -INT8_C(  81),  INT8_C(  74),  INT8_C(  51),  INT8_C(   3), -INT8_C(  70), -INT8_C(  46),  INT8_C( 121), -INT8_C(  80),
        -INT8_C( 123),  INT8_C(  18),  INT8_C(  19), -INT8_C(  18),  INT8_C(  14), -INT8_C(  89), -INT8_C(  41), -INT8_C( 112) },
      UINT32_C(2763229454),
      {  INT8_C( 100), -INT8_C( 103), -INT8_C( 107), -INT8_C(  87),  INT8_C(  54), -INT8_C( 124),  INT8_C( 124), -INT8_C(  39),
         INT8_C(  78),  INT8_C(  50), -INT8_C( 107), -INT8_C(   3),  INT8_C( 125), -INT8_C(  55),  INT8_C(   1),  INT8_C(  55),
        -INT8_C( 101),  INT8_C( 122), -INT8_C(  24),  INT8_C(  32), -INT8_C( 116), -INT8_C(   5),  INT8_C(  14), -INT8_C( 102),
        -INT8_C(  93), -INT8_C(  26),  INT8_C(  42), -INT8_C(  79),  INT8_C( 111), -INT8_C(  35),  INT8_C(  85), -INT8_C(  44) },
      {  INT8_C( 119), -INT8_C(  22),  INT8_C( 125), -INT8_C(  83),  INT8_C( 110), -INT8_C(   7), -INT8_C( 121), -INT8_C(  68),
         INT8_C(  43),  INT8_C(  28), -INT8_C(  70), -INT8_C(  88), -INT8_C(  27), -INT8_C(  69), -INT8_C(  32), -INT8_C( 127),
         INT8_C(  53), -INT8_C(  56), -INT8_C(  95), -INT8_C(  63), -INT8_C(  61), -INT8_C(  80),  INT8_C(  91),  INT8_C( 102),
        -INT8_C( 106), -INT8_C( 123),  INT8_C(  24),  INT8_C(   5),  INT8_C(  99),  INT8_C( 109), -INT8_C(  39), -INT8_C(  38) },
      { -INT8_C( 126), -INT8_C(  81),      INT8_MIN, -INT8_C(   4), -INT8_C( 107), -INT8_C(  37), -INT8_C(  26), -INT8_C(  15),
         INT8_C(  35), -INT8_C(  99), -INT8_C(  17),  INT8_C(  85), -INT8_C(  93), -INT8_C(  54), -INT8_C(  74),      INT8_MAX,
             INT8_MIN,      INT8_MAX,  INT8_C(  51),  INT8_C(   3), -INT8_C(  55),  INT8_C(  75),  INT8_C( 121),      INT8_MIN,
        -INT8_C( 123),  INT8_C(  18),  INT8_C(  18), -INT8_C(  18),  INT8_C(  14),      INT8_MIN, -INT8_C(  41), -INT8_C(   6) } },
    { {  INT8_C(  88),  INT8_C(  86), -INT8_C( 121), -INT8_C(  58),  INT8_C(  79),  INT8_C(  14), -INT8_C( 125),  INT8_C( 123),
         INT8_C(  43),  INT8_C(  61),  INT8_C(  35),  INT8_C(  16), -INT8_C(   8),  INT8_C(   3), -INT8_C( 111),  INT8_C(  45),
        -INT8_C(  53),  INT8_C(  51), -INT8_C(  18), -INT8_C( 113), -INT8_C(  29),  INT8_C(  73), -INT8_C(  11),  INT8_C( 121),
        -INT8_C(  50),  INT8_C(  13),  INT8_C( 126),  INT8_C(  49),  INT8_C( 123),  INT8_C(  88),  INT8_C(  11), -INT8_C(  45) },
      UINT32_C(4271477678),
      { -INT8_C(  95),  INT8_C(  28),  INT8_C( 121), -INT8_C(  52),  INT8_C(  89), -INT8_C( 100), -INT8_C(  35),  INT8_C(  81),
        -INT8_C(  96),  INT8_C( 110),  INT8_C( 126),  INT8_C( 107), -INT8_C(  95),  INT8_C( 108), -INT8_C(   6), -INT8_C( 124),
        -INT8_C(  75), -INT8_C(  16), -INT8_C(   3), -INT8_C( 124), -INT8_C(   3),  INT8_C( 124), -INT8_C(  75),  INT8_C( 120),
        -INT8_C(  44), -INT8_C(  63),  INT8_C(  75), -INT8_C( 126),  INT8_C(  84), -INT8_C(  27),      INT8_MIN, -INT8_C(  11) },
      {  INT8_C(   1), -INT8_C(   7), -INT8_C(  62),  INT8_C(  91), -INT8_C( 106), -INT8_C(  97), -INT8_C(  84),  INT8_C(  54),
         INT8_C(  13),  INT8_C(  43), -INT8_C(  95), -INT8_C(  81), -INT8_C( 105), -INT8_C( 100),  INT8_C(  51),  INT8_C(  77),
        -INT8_C( 116),  INT8_C(  49), -INT8_C(  47), -INT8_C( 119), -INT8_C(  83), -INT8_C( 122),  INT8_C(   2), -INT8_C( 127),
         INT8_C(  71),  INT8_C(  77),  INT8_C(   3), -INT8_C( 101),  INT8_C(  50), -INT8_C( 124), -INT8_C( 111),  INT8_C(  52) },
      {  INT8_C(  88),  INT8_C(  35),      INT8_MAX,      INT8_MIN,  INT8_C(  79), -INT8_C(   3), -INT8_C( 125),  INT8_C(  27),
        -INT8_C( 109),  INT8_C(  67),  INT8_C(  35),  INT8_C(  16),  INT8_C(  10),  INT8_C(   3), -INT8_C( 111),      INT8_MIN,
         INT8_C(  41),  INT8_C(  51), -INT8_C(  18), -INT8_C(   5),  INT8_C(  80),  INT8_C(  73), -INT8_C(  11),      INT8_MAX,
        -INT8_C(  50),      INT8_MIN,  INT8_C(  72), -INT8_C(  25),  INT8_C(  34),  INT8_C(  97), -INT8_C(  17), -INT8_C(  63) } },
    { {  INT8_C( 125),  INT8_C(  83), -INT8_C( 113),  INT8_C(  19), -INT8_C(  14),  INT8_C(  59),  INT8_C(  73), -INT8_C(   1),
         INT8_C( 102), -INT8_C(  21), -INT8_C(  82), -INT8_C(   2), -INT8_C( 121), -INT8_C(  30),  INT8_C(  75),  INT8_C(  19),
         INT8_C(  19),  INT8_C(  28), -INT8_C( 100), -INT8_C(  64), -INT8_C(  94), -INT8_C(  98),  INT8_C(  65), -INT8_C(  22),
        -INT8_C(  20),  INT8_C(  68), -INT8_C( 123),  INT8_C(  30), -INT8_C(  56),  INT8_C(  22),  INT8_C(  82),  INT8_C(  70) },
      UINT32_C(1532617065),
      {  INT8_C(  29), -INT8_C(  93),  INT8_C(  91), -INT8_C( 125), -INT8_C( 114),  INT8_C(   9), -INT8_C( 127),  INT8_C(  21),
        -INT8_C(  21), -INT8_C(  52),  INT8_C(  40), -INT8_C(   2), -INT8_C(  24), -INT8_C(  60), -INT8_C(  66), -INT8_C( 117),
         INT8_C(  99), -INT8_C(   1),  INT8_C( 117),  INT8_C(  79),  INT8_C(  68), -INT8_C(   6),  INT8_C( 109),  INT8_C(  12),
         INT8_C(  17), -INT8_C(  64),  INT8_C(  82),  INT8_C( 122), -INT8_C(  95), -INT8_C(  84), -INT8_C(  42), -INT8_C(  66) },
      {  INT8_C(  79),  INT8_C(  49),  INT8_C(  66), -INT8_C(  35),  INT8_C(  58), -INT8_C(  61), -INT8_C(  14),  INT8_C(  38),
        -INT8_C( 112),  INT8_C(  26),  INT8_C(  36),  INT8_C( 120), -INT8_C(  34), -INT8_C(  29),  INT8_C(   3),  INT8_C(  65),
        -INT8_C(  30),  INT8_C( 120), -INT8_C( 112),  INT8_C(  38),  INT8_C( 115), -INT8_C(   2),  INT8_C(  51), -INT8_C( 124),
        -INT8_C(  66), -INT8_C( 123), -INT8_C(   2),  INT8_C(  95),  INT8_C(  49), -INT8_C(  44),  INT8_C(  30),      INT8_MIN },
      { -INT8_C(  50),  INT8_C(  83), -INT8_C( 113), -INT8_C(  90), -INT8_C(  14),  INT8_C(  70), -INT8_C( 113), -INT8_C(   1),
         INT8_C(  91), -INT8_C(  21), -INT8_C(  82), -INT8_C(   2), -INT8_C( 121), -INT8_C(  31), -INT8_C(  69),      INT8_MIN,
             INT8_MAX,  INT8_C(  28), -INT8_C( 100),  INT8_C(  41), -INT8_C(  47), -INT8_C(  98),  INT8_C(  58), -INT8_C(  22),
         INT8_C(  83),  INT8_C(  59), -INT8_C( 123),  INT8_C(  27),      INT8_MIN,  INT8_C(  22), -INT8_C(  72),  INT8_C(  70) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m256i src = easysimd_mm256_loadu_epi8(test_vec[i].src);
    easysimd__mmask32 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi8(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi8(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_mask_subs_epi8(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_mask_subs_epi8");
    easysimd_test_x86_assert_equal_i8x32(r, easysimd_mm256_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m256i src = easysimd_test_x86_random_i8x32();
    easysimd__mmask32 k = easysimd_test_x86_random_mmask32();
    easysimd__m256i a = easysimd_test_x86_random_i8x32();
    easysimd__m256i b = easysimd_test_x86_random_i8x32();
    easysimd__m256i r = easysimd_mm256_mask_subs_epi8(src, k, a, b);

    easysimd_test_x86_write_i8x32(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask32(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x32(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x32(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_maskz_subs_epi8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint32_t k;
    const int8_t a[32];
    const int8_t b[32];
    const int8_t r[32];
  } test_vec[] = {
    { UINT32_C( 810640076),
      { -INT8_C(  25),  INT8_C(  69),  INT8_C(  78),  INT8_C( 102), -INT8_C(  44), -INT8_C( 103), -INT8_C(  41),  INT8_C(  12),
         INT8_C(  41),  INT8_C( 120),  INT8_C(  16),  INT8_C( 101),  INT8_C(  28), -INT8_C(  38), -INT8_C(  14), -INT8_C( 108),
        -INT8_C(  45),  INT8_C(  20),  INT8_C(  42), -INT8_C(  27), -INT8_C(  96),  INT8_C(  26),  INT8_C(  58), -INT8_C(  43),
        -INT8_C( 107), -INT8_C(  71), -INT8_C(  84),  INT8_C(  97),  INT8_C(  27), -INT8_C(   2), -INT8_C( 111),  INT8_C(   3) },
      {  INT8_C(  67), -INT8_C(  33),  INT8_C( 105),  INT8_C(  23),  INT8_C( 121),  INT8_C(  64),  INT8_C(  35), -INT8_C(  94),
        -INT8_C(  72),  INT8_C(  51),  INT8_C(   7), -INT8_C(  44),  INT8_C(  14), -INT8_C(   7),  INT8_C( 105), -INT8_C(  31),
         INT8_C(  14), -INT8_C( 109), -INT8_C(  58), -INT8_C(  82), -INT8_C(  83),  INT8_C(   0), -INT8_C( 125),  INT8_C(  67),
        -INT8_C(  71),  INT8_C(  48), -INT8_C(  92), -INT8_C(  43),  INT8_C(  46),  INT8_C(  54), -INT8_C(  40),  INT8_C( 113) },
      {  INT8_C(   0),  INT8_C(   0), -INT8_C(  27),  INT8_C(  79),  INT8_C(   0),  INT8_C(   0), -INT8_C(  76),  INT8_C( 106),
         INT8_C(   0),  INT8_C(  69),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(  31), -INT8_C( 119),  INT8_C(   0),
        -INT8_C(  59),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(  13),  INT8_C(   0),      INT8_MAX,  INT8_C(   0),
         INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(  19), -INT8_C(  56),  INT8_C(   0),  INT8_C(   0) } },
    { UINT32_C(2391294229),
      { -INT8_C( 127), -INT8_C(  85),  INT8_C(  48),  INT8_C(  57), -INT8_C(  33),  INT8_C(  55),  INT8_C(  14), -INT8_C(  19),
         INT8_C(  49),  INT8_C( 119), -INT8_C(  50),  INT8_C(  63),  INT8_C(  10), -INT8_C( 107), -INT8_C(  19), -INT8_C(  73),
        -INT8_C( 107),  INT8_C( 113), -INT8_C(   6),  INT8_C(  79), -INT8_C(  95), -INT8_C(  97),  INT8_C(  36), -INT8_C(  49),
        -INT8_C(  43), -INT8_C(   4),  INT8_C(  64), -INT8_C(  22),  INT8_C(  61), -INT8_C(  56),  INT8_C( 121), -INT8_C(  66) },
      {  INT8_C( 115), -INT8_C(  87), -INT8_C(   9),  INT8_C(  82), -INT8_C(  31),  INT8_C(   5),  INT8_C(  63),  INT8_C(  18),
         INT8_C( 124),  INT8_C(  14),  INT8_C(  81), -INT8_C( 122), -INT8_C(  93),  INT8_C(  62),  INT8_C(  62),  INT8_C(  56),
        -INT8_C(  81),  INT8_C(  56), -INT8_C( 121),  INT8_C(  80), -INT8_C(  41), -INT8_C(  85),  INT8_C(  31), -INT8_C(  84),
        -INT8_C(  89),  INT8_C(  95), -INT8_C( 105), -INT8_C(  28),  INT8_C(  39),  INT8_C(  16), -INT8_C(  94), -INT8_C( 101) },
      {      INT8_MIN,  INT8_C(   0),  INT8_C(  57),  INT8_C(   0), -INT8_C(   2),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),
        -INT8_C(  75),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(  81),  INT8_C(   0),
         INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(   1),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(  35),
         INT8_C(   0), -INT8_C(  99),      INT8_MAX,  INT8_C(   6),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(  35) } },
    { UINT32_C(2599262905),
      { -INT8_C(  97),  INT8_C(  45), -INT8_C(  84),  INT8_C(  28),  INT8_C(  59), -INT8_C(   3), -INT8_C(  94), -INT8_C(  34),
         INT8_C(  60), -INT8_C(  32),  INT8_C(  22), -INT8_C(  21),  INT8_C(  25), -INT8_C(  98),  INT8_C(  60), -INT8_C(  16),
         INT8_C(  73),  INT8_C(  91), -INT8_C(  99), -INT8_C(  15), -INT8_C(  69),  INT8_C(  52), -INT8_C(  43), -INT8_C(  30),
         INT8_C(  68),  INT8_C( 120),  INT8_C( 125), -INT8_C(   3),  INT8_C(  18),  INT8_C( 107), -INT8_C( 104), -INT8_C(  79) },
      { -INT8_C( 104),  INT8_C(  68), -INT8_C(  51), -INT8_C(  45),  INT8_C(  66),  INT8_C( 112), -INT8_C(  79),  INT8_C( 126),
         INT8_C(  80), -INT8_C(  57),  INT8_C( 105),  INT8_C( 105),  INT8_C( 101), -INT8_C(  91),  INT8_C(  90), -INT8_C(  81),
         INT8_C(   1), -INT8_C(   9), -INT8_C(  96), -INT8_C(  68),  INT8_C(  43),  INT8_C( 117), -INT8_C(  98),  INT8_C( 111),
        -INT8_C(  19),  INT8_C(  28),  INT8_C( 108), -INT8_C(   1), -INT8_C( 121),  INT8_C(   4), -INT8_C(  79),  INT8_C(  31) },
      {  INT8_C(   7),  INT8_C(   0),  INT8_C(   0),  INT8_C(  73), -INT8_C(   7), -INT8_C( 115),  INT8_C(   0),      INT8_MIN,
         INT8_C(   0),  INT8_C(  25),  INT8_C(   0), -INT8_C( 126), -INT8_C(  76),  INT8_C(   0),  INT8_C(   0),  INT8_C(  65),
         INT8_C(  72),  INT8_C(   0), -INT8_C(   3),  INT8_C(  53),  INT8_C(   0), -INT8_C(  65),  INT8_C(  55),      INT8_MIN,
         INT8_C(   0),  INT8_C(  92),  INT8_C(   0), -INT8_C(   2),      INT8_MAX,  INT8_C(   0),  INT8_C(   0), -INT8_C( 110) } },
    { UINT32_C(2347925065),
      { -INT8_C(  18), -INT8_C(  93),  INT8_C(   9),  INT8_C(  63),  INT8_C( 106),  INT8_C( 114), -INT8_C(  88), -INT8_C(  48),
         INT8_C(  24),  INT8_C(   2),      INT8_MAX,  INT8_C(  25), -INT8_C(   7),  INT8_C(  31), -INT8_C(  43),  INT8_C(  36),
        -INT8_C( 108),  INT8_C( 115), -INT8_C( 109), -INT8_C( 126), -INT8_C( 113),  INT8_C(   0), -INT8_C( 127),  INT8_C(  22),
         INT8_C(   4),  INT8_C(  50),  INT8_C(  53),  INT8_C(  77), -INT8_C(  79),  INT8_C(  39), -INT8_C(  40), -INT8_C(  97) },
      { -INT8_C(  54), -INT8_C(  31), -INT8_C(  34),  INT8_C(  53),  INT8_C(  84), -INT8_C( 121),  INT8_C(   5),  INT8_C( 108),
        -INT8_C( 119), -INT8_C( 124), -INT8_C( 123), -INT8_C( 125), -INT8_C(  93),  INT8_C(  90), -INT8_C(  89),  INT8_C(  55),
        -INT8_C(  51),  INT8_C(  59), -INT8_C(  71),  INT8_C(  93),  INT8_C(  59),  INT8_C(  59),  INT8_C( 115),  INT8_C(  63),
         INT8_C( 109), -INT8_C(  87), -INT8_C( 115),  INT8_C(  30), -INT8_C(  48),  INT8_C( 101), -INT8_C(  66), -INT8_C( 101) },
      {  INT8_C(  36),  INT8_C(   0),  INT8_C(   0),  INT8_C(  10),  INT8_C(   0),  INT8_C(   0), -INT8_C(  93),  INT8_C(   0),
         INT8_C(   0),  INT8_C( 126),      INT8_MAX,      INT8_MAX,  INT8_C(  86), -INT8_C(  59),  INT8_C(  46),  INT8_C(   0),
         INT8_C(   0),  INT8_C(  56),  INT8_C(   0),  INT8_C(   0),      INT8_MIN, -INT8_C(  59),      INT8_MIN, -INT8_C(  41),
        -INT8_C( 105),      INT8_MAX,  INT8_C(   0),  INT8_C(  47),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   4) } },
    { UINT32_C(2614139975),
      {  INT8_C(  35), -INT8_C(  43),  INT8_C(   7), -INT8_C(  83),  INT8_C(  89), -INT8_C( 116),  INT8_C(  48), -INT8_C(   4),
        -INT8_C(  26), -INT8_C(  41),  INT8_C(  51), -INT8_C(  77),  INT8_C(  18), -INT8_C(  19),  INT8_C(  16),  INT8_C(  77),
         INT8_C(  40), -INT8_C( 124), -INT8_C( 115), -INT8_C( 107),  INT8_C(  45),  INT8_C(  26), -INT8_C(  76), -INT8_C(   3),
             INT8_MAX,  INT8_C( 114), -INT8_C( 104), -INT8_C(  58),  INT8_C(  14),  INT8_C( 104),  INT8_C(  97),  INT8_C(  50) },
      {  INT8_C(  61),  INT8_C( 104), -INT8_C(  33), -INT8_C( 106), -INT8_C(  12),  INT8_C(  15), -INT8_C( 110), -INT8_C(  38),
        -INT8_C(  26), -INT8_C(  58), -INT8_C( 114), -INT8_C(   7), -INT8_C(  77), -INT8_C(  98),  INT8_C(  70), -INT8_C(  37),
         INT8_C(  34), -INT8_C(  45),  INT8_C( 112),  INT8_C(  79), -INT8_C(  19),  INT8_C(  36),  INT8_C(  77),  INT8_C( 109),
        -INT8_C( 106), -INT8_C(  27),  INT8_C(  51), -INT8_C(  91),  INT8_C(  78), -INT8_C( 107), -INT8_C(  41), -INT8_C( 117) },
      { -INT8_C(  26),      INT8_MIN,  INT8_C(  40),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),      INT8_MAX,  INT8_C(   0),
         INT8_C(   0),  INT8_C(   0),      INT8_MAX, -INT8_C(  70),  INT8_C(  95),  INT8_C(   0),  INT8_C(   0),  INT8_C( 114),
         INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(  64),  INT8_C(   0),      INT8_MIN, -INT8_C( 112),
             INT8_MAX,      INT8_MAX,  INT8_C(   0),  INT8_C(  33), -INT8_C(  64),  INT8_C(   0),  INT8_C(   0),      INT8_MAX } },
    { UINT32_C(4062361341),
      { -INT8_C(  59), -INT8_C(  76), -INT8_C(  52), -INT8_C(  85),  INT8_C( 122),  INT8_C(  90), -INT8_C(  92),  INT8_C(  45),
        -INT8_C(   7), -INT8_C(  21),  INT8_C(   8),  INT8_C(  27), -INT8_C(  66),  INT8_C( 121),  INT8_C( 107), -INT8_C(  84),
        -INT8_C(  99), -INT8_C(  72),  INT8_C(  25),  INT8_C(  52), -INT8_C(  99),  INT8_C(  76), -INT8_C(  39), -INT8_C(  21),
        -INT8_C(  31), -INT8_C(  80),  INT8_C( 119), -INT8_C(  33),  INT8_C( 102), -INT8_C( 103), -INT8_C(  47),  INT8_C(  43) },
      {  INT8_C(  77), -INT8_C(  99), -INT8_C(  42), -INT8_C(  56), -INT8_C(   8),  INT8_C( 123), -INT8_C(  11), -INT8_C(  15),
         INT8_C( 102), -INT8_C(   2),  INT8_C(  12),  INT8_C(  36),  INT8_C( 119),  INT8_C( 119), -INT8_C(  48),  INT8_C(  20),
         INT8_C(  47), -INT8_C(  23),  INT8_C(  72), -INT8_C(  51),  INT8_C(  54),  INT8_C(  33), -INT8_C(  72),  INT8_C(  23),
        -INT8_C(  47),  INT8_C(  47), -INT8_C(  10),  INT8_C(  55), -INT8_C(  56), -INT8_C(  57),  INT8_C(  98),  INT8_C(  22) },
      {      INT8_MIN,  INT8_C(   0), -INT8_C(  10), -INT8_C(  29),      INT8_MAX, -INT8_C(  33), -INT8_C(  81),  INT8_C(  60),
         INT8_C(   0), -INT8_C(  19), -INT8_C(   4),  INT8_C(   0),      INT8_MIN,  INT8_C(   2),  INT8_C(   0), -INT8_C( 104),
         INT8_C(   0), -INT8_C(  49),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0),  INT8_C(  43),  INT8_C(   0),  INT8_C(   0),
         INT8_C(   0), -INT8_C( 127),  INT8_C(   0),  INT8_C(   0),      INT8_MAX, -INT8_C(  46),      INT8_MIN,  INT8_C(  21) } },
    { UINT32_C(1574844773),
      { -INT8_C(  76), -INT8_C(  45),  INT8_C(  78),  INT8_C(  26), -INT8_C(  47),  INT8_C(  90),  INT8_C(  62),  INT8_C(  72),
        -INT8_C(  46),  INT8_C(  15),  INT8_C(  93),  INT8_C(   1), -INT8_C(   8), -INT8_C(  91), -INT8_C(  50),  INT8_C(  46),
        -INT8_C(  57), -INT8_C( 121),  INT8_C(  70), -INT8_C( 104), -INT8_C(  74),  INT8_C(  60), -INT8_C(  48),      INT8_MAX,
         INT8_C(   4),  INT8_C(  50), -INT8_C( 107),  INT8_C( 105),  INT8_C( 107),  INT8_C( 115), -INT8_C(  58),  INT8_C(  31) },
      {  INT8_C(  70),  INT8_C(  20),  INT8_C(  57),  INT8_C(  24),  INT8_C( 110),  INT8_C( 120),  INT8_C(  96),  INT8_C(  64),
        -INT8_C( 121), -INT8_C(  67),  INT8_C(  66),      INT8_MAX,  INT8_C(  99),  INT8_C(  16), -INT8_C(  82),  INT8_C(  42),
        -INT8_C( 105), -INT8_C(  12), -INT8_C(  62),  INT8_C(  78),  INT8_C(  48), -INT8_C( 110), -INT8_C(  51),  INT8_C(  52),
        -INT8_C(  59),  INT8_C(  98), -INT8_C(  99),  INT8_C(  48), -INT8_C(  43),  INT8_C(  99),  INT8_C(  80),  INT8_C(  27) },
      {      INT8_MIN,  INT8_C(   0),  INT8_C(  21),  INT8_C(   0),  INT8_C(   0), -INT8_C(  30), -INT8_C(  34),  INT8_C(   0),
         INT8_C(  75),  INT8_C(   0),  INT8_C(   0), -INT8_C( 126), -INT8_C( 107), -INT8_C( 107),  INT8_C(   0),  INT8_C(   0),
         INT8_C(   0), -INT8_C( 109),      INT8_MAX,      INT8_MIN, -INT8_C( 122),  INT8_C(   0),  INT8_C(   3),  INT8_C(  75),
         INT8_C(  63),  INT8_C(   0), -INT8_C(   8),  INT8_C(  57),      INT8_MAX,  INT8_C(   0),      INT8_MIN,  INT8_C(   0) } },
    { UINT32_C(3862137207),
      {  INT8_C(   1), -INT8_C( 108),  INT8_C(  38), -INT8_C( 120),  INT8_C(  81),  INT8_C( 104),  INT8_C(   8), -INT8_C(  76),
         INT8_C( 121), -INT8_C(  74), -INT8_C(  34),  INT8_C(  16), -INT8_C(  86), -INT8_C(  95),  INT8_C(  94), -INT8_C(  38),
         INT8_C(  51),  INT8_C(  43),  INT8_C(  15), -INT8_C(   8), -INT8_C( 115), -INT8_C(  84),  INT8_C(  41),  INT8_C(  98),
         INT8_C(  16),  INT8_C( 121),  INT8_C( 126), -INT8_C( 121),  INT8_C(   2), -INT8_C(  79),  INT8_C( 109),  INT8_C(   4) },
      {  INT8_C(  69), -INT8_C( 108), -INT8_C( 116), -INT8_C( 105), -INT8_C(   4), -INT8_C( 108),  INT8_C(  75),  INT8_C( 117),
         INT8_C(  74),  INT8_C(  42), -INT8_C( 122), -INT8_C(  12), -INT8_C(  53), -INT8_C(  28), -INT8_C(  49), -INT8_C(   2),
         INT8_C(  16), -INT8_C(  34), -INT8_C(   9), -INT8_C(  99), -INT8_C( 118),  INT8_C(  32),  INT8_C(   0), -INT8_C( 102),
        -INT8_C( 103),  INT8_C( 126),  INT8_C(  34), -INT8_C( 101),  INT8_C(  47), -INT8_C( 113), -INT8_C(  97),  INT8_C( 117) },
      { -INT8_C(  68),  INT8_C(   0),      INT8_MAX,  INT8_C(   0),  INT8_C(  85),      INT8_MAX, -INT8_C(  67),  INT8_C(   0),
         INT8_C(  47),  INT8_C(   0),  INT8_C(   0),  INT8_C(  28),  INT8_C(   0),  INT8_C(   0),  INT8_C(   0), -INT8_C(  36),
         INT8_C(  35),  INT8_C(  77),  INT8_C(   0),  INT8_C(   0),  INT8_C(   3), -INT8_C( 116),  INT8_C(   0),  INT8_C(   0),
         INT8_C(   0), -INT8_C(   5),  INT8_C(  92),  INT8_C(   0),  INT8_C(   0),  INT8_C(  34),      INT8_MAX, -INT8_C( 113) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask32 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi8(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi8(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_maskz_subs_epi8(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_maskz_subs_epi8");
    easysimd_test_x86_assert_equal_i8x32(r, easysimd_mm256_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask32 k = easysimd_test_x86_random_mmask32();
    easysimd__m256i a = easysimd_test_x86_random_i8x32();
    easysimd__m256i b = easysimd_test_x86_random_i8x32();
    easysimd__m256i r = easysimd_mm256_maskz_subs_epi8(k, a, b);

    easysimd_test_x86_write_mmask32(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_i8x32(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x32(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i8x32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_mask_subs_epi16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const int16_t src[16];
    const uint16_t k;
    const int16_t a[16];
    const int16_t b[16];
    const int16_t r[16];
  } test_vec[] = {
    { {  INT16_C( 24581),  INT16_C( 16477),  INT16_C( 20259), -INT16_C( 19610), -INT16_C( 30103),  INT16_C( 18476),  INT16_C( 12141),  INT16_C( 20617),
         INT16_C(  6824),  INT16_C(  7030), -INT16_C( 22248), -INT16_C( 10593), -INT16_C( 25297),  INT16_C( 24629),  INT16_C( 21362),  INT16_C( 30689) },
      UINT16_C(16051),
      { -INT16_C( 10313),  INT16_C(  7566), -INT16_C(  2166), -INT16_C( 18776),  INT16_C(  5439), -INT16_C( 13850), -INT16_C( 29083), -INT16_C(  8989),
        -INT16_C(  1111),  INT16_C( 18565), -INT16_C( 19247),  INT16_C(  1765),  INT16_C( 22293), -INT16_C(  2470),  INT16_C(  3535), -INT16_C( 31180) },
      { -INT16_C( 15644),  INT16_C( 28580),  INT16_C( 19642), -INT16_C(  1755),  INT16_C(  2913), -INT16_C( 14398), -INT16_C( 23143),  INT16_C( 17059),
         INT16_C( 10400),  INT16_C( 29066),  INT16_C( 28893), -INT16_C(  3464), -INT16_C( 11577), -INT16_C( 26904),  INT16_C(  7391), -INT16_C( 15331) },
      {  INT16_C(  5331), -INT16_C( 21014),  INT16_C( 20259), -INT16_C( 19610),  INT16_C(  2526),  INT16_C(   548),  INT16_C( 12141), -INT16_C( 26048),
         INT16_C(  6824), -INT16_C( 10501),        INT16_MIN,  INT16_C(  5229),        INT16_MAX,  INT16_C( 24434),  INT16_C( 21362),  INT16_C( 30689) } },
    { { -INT16_C( 15905), -INT16_C( 26317),  INT16_C( 22541),  INT16_C( 28306),  INT16_C( 21860), -INT16_C(   715), -INT16_C(  9990), -INT16_C( 25792),
        -INT16_C( 13823), -INT16_C(  8692), -INT16_C( 31686),  INT16_C(   720), -INT16_C( 18346),  INT16_C( 13976), -INT16_C( 18988), -INT16_C( 19462) },
      UINT16_C(11638),
      { -INT16_C( 31924), -INT16_C(  8315), -INT16_C(  5646),  INT16_C( 10036),  INT16_C( 12007),  INT16_C(  9984),  INT16_C(   457), -INT16_C( 10511),
         INT16_C( 11487), -INT16_C( 20646), -INT16_C( 20178), -INT16_C( 14745),  INT16_C( 15335), -INT16_C(  7812), -INT16_C(  3345),  INT16_C( 15118) },
      { -INT16_C( 27786),  INT16_C( 26650),  INT16_C( 20093),  INT16_C( 25743), -INT16_C( 28803),  INT16_C( 18059),  INT16_C( 31888),  INT16_C( 28444),
         INT16_C( 30632), -INT16_C( 10722), -INT16_C( 31448),  INT16_C(  3997),  INT16_C(  6593), -INT16_C( 20240), -INT16_C(   501), -INT16_C( 32277) },
      { -INT16_C( 15905),        INT16_MIN, -INT16_C( 25739),  INT16_C( 28306),        INT16_MAX, -INT16_C(  8075), -INT16_C( 31431), -INT16_C( 25792),
        -INT16_C( 19145), -INT16_C(  8692),  INT16_C( 11270), -INT16_C( 18742), -INT16_C( 18346),  INT16_C( 12428), -INT16_C( 18988), -INT16_C( 19462) } },
    { {  INT16_C(  1681),  INT16_C(  3817),  INT16_C( 31060), -INT16_C( 11918), -INT16_C(   760), -INT16_C( 26344),  INT16_C( 13434),  INT16_C(  8712),
         INT16_C( 10155), -INT16_C( 11271), -INT16_C( 26964),  INT16_C( 28130), -INT16_C( 11601), -INT16_C( 17891),  INT16_C(  2512),  INT16_C( 25148) },
      UINT16_C( 9487),
      {  INT16_C( 25456), -INT16_C(  7266), -INT16_C( 22731),  INT16_C( 19936),  INT16_C( 23104),  INT16_C( 18561),  INT16_C( 11645),  INT16_C( 30319),
         INT16_C(  7168), -INT16_C(  7412), -INT16_C( 17527), -INT16_C( 22603), -INT16_C( 31115), -INT16_C( 20048), -INT16_C( 16408),  INT16_C( 22743) },
      {  INT16_C( 29986),  INT16_C( 22331),  INT16_C(  7196),  INT16_C( 23716),  INT16_C(  9846), -INT16_C(  3163),  INT16_C(  5203),  INT16_C( 21353),
         INT16_C( 30000), -INT16_C( 17866), -INT16_C(  5072), -INT16_C( 22943),  INT16_C(  4466),  INT16_C( 23127),  INT16_C( 11984), -INT16_C(  3406) },
      { -INT16_C(  4530), -INT16_C( 29597), -INT16_C( 29927), -INT16_C(  3780), -INT16_C(   760), -INT16_C( 26344),  INT16_C( 13434),  INT16_C(  8712),
        -INT16_C( 22832), -INT16_C( 11271), -INT16_C( 12455),  INT16_C( 28130), -INT16_C( 11601),        INT16_MIN,  INT16_C(  2512),  INT16_C( 25148) } },
    { { -INT16_C(  4444), -INT16_C( 16310), -INT16_C(  4598), -INT16_C( 32739), -INT16_C( 15852),  INT16_C( 26484), -INT16_C(  8746),  INT16_C(  1979),
        -INT16_C(  3757), -INT16_C( 31807),  INT16_C(  8925),  INT16_C( 20265), -INT16_C( 32461),  INT16_C(   937),  INT16_C( 23727),  INT16_C( 21493) },
      UINT16_C(16202),
      {  INT16_C( 21524),  INT16_C( 12590),  INT16_C( 17108),  INT16_C( 18675), -INT16_C( 13910),  INT16_C( 25894),  INT16_C( 31184), -INT16_C( 28330),
         INT16_C( 13564),  INT16_C(  9907), -INT16_C(  6525),  INT16_C( 11687),  INT16_C( 22249), -INT16_C(  8311), -INT16_C( 11350), -INT16_C( 16866) },
      {  INT16_C( 19495), -INT16_C(  1041), -INT16_C(  7537),  INT16_C( 14660),  INT16_C( 27307),  INT16_C( 31902), -INT16_C(  2845), -INT16_C(  8435),
        -INT16_C( 16088), -INT16_C( 21499), -INT16_C( 21337), -INT16_C( 28199),  INT16_C( 25091), -INT16_C( 21136), -INT16_C( 29131),  INT16_C( 23659) },
      { -INT16_C(  4444),  INT16_C( 13631), -INT16_C(  4598),  INT16_C(  4015), -INT16_C( 15852),  INT16_C( 26484),        INT16_MAX,  INT16_C(  1979),
         INT16_C( 29652),  INT16_C( 31406),  INT16_C( 14812),        INT16_MAX, -INT16_C(  2842),  INT16_C( 12825),  INT16_C( 23727),  INT16_C( 21493) } },
    { {  INT16_C( 23259),  INT16_C( 27223), -INT16_C( 25796), -INT16_C(  6237),  INT16_C( 16645), -INT16_C(  6045),  INT16_C( 28981),  INT16_C( 24264),
        -INT16_C( 13006), -INT16_C(  9974), -INT16_C(  7302),  INT16_C( 32106), -INT16_C(  9659),  INT16_C( 31274), -INT16_C( 27287),  INT16_C( 17622) },
      UINT16_C(11759),
      {  INT16_C( 11182),  INT16_C( 20937), -INT16_C( 12782),  INT16_C( 30354), -INT16_C( 14409),  INT16_C( 32743),  INT16_C(  6437),  INT16_C( 12108),
        -INT16_C( 14606),  INT16_C( 23826),  INT16_C( 22339),  INT16_C( 27959), -INT16_C( 24367), -INT16_C( 22782), -INT16_C(  3612), -INT16_C( 27947) },
      { -INT16_C( 25060),  INT16_C( 12259),  INT16_C( 30060),  INT16_C(  9125), -INT16_C( 29635),  INT16_C( 25250), -INT16_C(  4187), -INT16_C( 26734),
        -INT16_C( 23371), -INT16_C(  1548),  INT16_C( 11516), -INT16_C( 12954),  INT16_C( 27084), -INT16_C( 20107),  INT16_C( 19034),  INT16_C( 30531) },
      {        INT16_MAX,  INT16_C(  8678),        INT16_MIN,  INT16_C( 21229),  INT16_C( 16645),  INT16_C(  7493),  INT16_C( 10624),        INT16_MAX,
         INT16_C(  8765), -INT16_C(  9974),  INT16_C( 10823),        INT16_MAX, -INT16_C(  9659), -INT16_C(  2675), -INT16_C( 27287),  INT16_C( 17622) } },
    { {  INT16_C( 10216),  INT16_C( 21670),  INT16_C( 19356), -INT16_C(  9864),  INT16_C(  6871),  INT16_C( 31804), -INT16_C( 12791), -INT16_C( 16621),
         INT16_C(  2162),  INT16_C( 28344),  INT16_C(  7732),  INT16_C(    60), -INT16_C( 20089), -INT16_C(  7503), -INT16_C(  2565), -INT16_C(  7335) },
      UINT16_C(65308),
      { -INT16_C( 18377), -INT16_C( 20662),  INT16_C(  8594), -INT16_C( 12598), -INT16_C( 11363), -INT16_C( 20324),  INT16_C(  3730),  INT16_C( 19128),
        -INT16_C(  4995), -INT16_C( 18071), -INT16_C(  3859), -INT16_C( 24982),  INT16_C( 26066),  INT16_C( 11155), -INT16_C( 20664),  INT16_C( 32554) },
      {  INT16_C( 29800), -INT16_C(  1489), -INT16_C(  1643),  INT16_C( 13000),  INT16_C( 25804),  INT16_C( 24547), -INT16_C( 25742), -INT16_C(  4183),
         INT16_C(  4744),  INT16_C( 30120),  INT16_C(  4611), -INT16_C( 10989), -INT16_C( 22665), -INT16_C( 16639),  INT16_C( 11094), -INT16_C( 16833) },
      {  INT16_C( 10216),  INT16_C( 21670),  INT16_C( 10237), -INT16_C( 25598),        INT16_MIN,  INT16_C( 31804), -INT16_C( 12791), -INT16_C( 16621),
        -INT16_C(  9739),        INT16_MIN, -INT16_C(  8470), -INT16_C( 13993),        INT16_MAX,  INT16_C( 27794), -INT16_C( 31758),        INT16_MAX } },
    { {  INT16_C( 28320),  INT16_C( 13752), -INT16_C( 32665),  INT16_C( 13160),  INT16_C( 19428),  INT16_C( 22418),  INT16_C( 15590),  INT16_C( 28230),
        -INT16_C(  4274),  INT16_C( 20963), -INT16_C(  2303),  INT16_C( 31015),  INT16_C( 10398), -INT16_C(  3016),  INT16_C( 30547), -INT16_C(  3149) },
      UINT16_C(27621),
      {  INT16_C( 19497), -INT16_C( 28180), -INT16_C( 12160),  INT16_C(  4828), -INT16_C( 15833),  INT16_C( 28238), -INT16_C( 25295),  INT16_C(  5213),
         INT16_C( 24302),  INT16_C(  5387), -INT16_C( 22057),  INT16_C(  4157), -INT16_C( 28258),  INT16_C( 20871),  INT16_C( 28036), -INT16_C( 21060) },
      { -INT16_C( 22343),  INT16_C( 14654),  INT16_C(  6777), -INT16_C( 24500), -INT16_C( 25891),  INT16_C(  3598),  INT16_C( 27447),  INT16_C(  9762),
         INT16_C( 11978), -INT16_C( 24261),  INT16_C( 31191),  INT16_C( 30129),  INT16_C( 14602), -INT16_C( 28986), -INT16_C( 31834),  INT16_C( 24380) },
      {        INT16_MAX,  INT16_C( 13752), -INT16_C( 18937),  INT16_C( 13160),  INT16_C( 19428),  INT16_C( 24640),        INT16_MIN, -INT16_C(  4549),
         INT16_C( 12324),  INT16_C( 29648), -INT16_C(  2303), -INT16_C( 25972),  INT16_C( 10398),        INT16_MAX,        INT16_MAX, -INT16_C(  3149) } },
    { {  INT16_C( 31275), -INT16_C( 23399), -INT16_C(  6763),  INT16_C( 29253),  INT16_C( 21375), -INT16_C( 18560), -INT16_C( 23873), -INT16_C( 30243),
         INT16_C(  6352), -INT16_C( 22486), -INT16_C(  9071), -INT16_C( 25827), -INT16_C(  7147), -INT16_C( 17622),  INT16_C( 26215), -INT16_C( 28134) },
      UINT16_C(46048),
      {  INT16_C( 30007),  INT16_C( 31896),  INT16_C(  6375),  INT16_C( 26575), -INT16_C( 28977), -INT16_C( 21494), -INT16_C(  9705),  INT16_C( 17092),
         INT16_C( 22146), -INT16_C( 24546),  INT16_C( 13297),  INT16_C(  7044), -INT16_C(  5138),  INT16_C(  2177),  INT16_C( 25213), -INT16_C( 19268) },
      {  INT16_C( 21719), -INT16_C( 16592),  INT16_C(   108),  INT16_C( 15142),  INT16_C( 12430), -INT16_C( 22809), -INT16_C( 21493), -INT16_C( 29208),
         INT16_C(  1538), -INT16_C(  3283), -INT16_C( 20167),  INT16_C(  9999), -INT16_C( 28516),  INT16_C(  6703), -INT16_C(  5134), -INT16_C( 13618) },
      {  INT16_C( 31275), -INT16_C( 23399), -INT16_C(  6763),  INT16_C( 29253),  INT16_C( 21375),  INT16_C(  1315),  INT16_C( 11788),        INT16_MAX,
         INT16_C( 20608), -INT16_C( 21263), -INT16_C(  9071), -INT16_C( 25827),  INT16_C( 23378), -INT16_C(  4526),  INT16_C( 26215), -INT16_C(  5650) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m256i src = easysimd_mm256_loadu_epi16(test_vec[i].src);
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi16(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi16(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_mask_subs_epi16(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_mask_subs_epi16");
    easysimd_test_x86_assert_equal_i16x16(r, easysimd_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m256i src = easysimd_test_x86_random_i16x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m256i a = easysimd_test_x86_random_i16x16();
    easysimd__m256i b = easysimd_test_x86_random_i16x16();
    easysimd__m256i r = easysimd_mm256_mask_subs_epi16(src, k, a, b);

    easysimd_test_x86_write_i16x16(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_maskz_subs_epi16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t k;
    const int16_t a[16];
    const int16_t b[16];
    const int16_t r[16];
  } test_vec[] = {
    { UINT16_C(11299),
      {  INT16_C(  8204),  INT16_C( 22464),  INT16_C(  2965),  INT16_C(  7041),  INT16_C( 19711), -INT16_C( 12800),  INT16_C(  4171),  INT16_C( 17068),
         INT16_C( 14253), -INT16_C( 21150), -INT16_C(  1071), -INT16_C(  3285),  INT16_C( 23446),  INT16_C( 13955), -INT16_C( 22832), -INT16_C(  9118) },
      {  INT16_C(  8902),  INT16_C( 23603), -INT16_C( 19155),  INT16_C( 11639),  INT16_C( 30465),  INT16_C( 19707), -INT16_C( 22393),  INT16_C( 13710),
        -INT16_C(  3873), -INT16_C( 20254),  INT16_C(  3819), -INT16_C( 32092),  INT16_C( 10089),  INT16_C( 14776),  INT16_C(  6861), -INT16_C( 27627) },
      { -INT16_C(   698), -INT16_C(  1139),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 32507),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0), -INT16_C(  4890),  INT16_C( 28807),  INT16_C(     0), -INT16_C(   821),  INT16_C(     0),  INT16_C(     0) } },
    { UINT16_C(18492),
      {  INT16_C( 27376),  INT16_C( 26621), -INT16_C(   105), -INT16_C( 27937),  INT16_C( 26187), -INT16_C(  9670),  INT16_C(  6555),  INT16_C( 32458),
        -INT16_C( 18742),  INT16_C( 28300), -INT16_C(  2760), -INT16_C(  3947),  INT16_C( 25134),  INT16_C( 17162),  INT16_C( 18166), -INT16_C(  6517) },
      { -INT16_C( 30288),  INT16_C( 18254),  INT16_C( 11656), -INT16_C( 11302),  INT16_C(  5267),  INT16_C( 12205),  INT16_C( 30766), -INT16_C(  1875),
         INT16_C( 14638),  INT16_C( 26214), -INT16_C(  1234),  INT16_C( 23638),  INT16_C( 24669),  INT16_C( 21663),  INT16_C( 10918),  INT16_C( 22330) },
      {  INT16_C(     0),  INT16_C(     0), -INT16_C( 11761), -INT16_C( 16635),  INT16_C( 20920), -INT16_C( 21875),  INT16_C(     0),  INT16_C(     0),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 27585),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7248),  INT16_C(     0) } },
    { UINT16_C(34995),
      {  INT16_C( 15262),  INT16_C( 30901),  INT16_C( 18703), -INT16_C( 17267), -INT16_C( 17544),  INT16_C(  9524),  INT16_C( 25267),  INT16_C(  6494),
        -INT16_C( 29496),  INT16_C(  7700),  INT16_C( 29160), -INT16_C( 30850),  INT16_C(  9669),  INT16_C(   177),  INT16_C( 25980),  INT16_C(  6792) },
      {  INT16_C( 16032), -INT16_C( 20589),  INT16_C(  8327), -INT16_C(   148), -INT16_C( 24357), -INT16_C( 29148), -INT16_C( 32253), -INT16_C( 13401),
        -INT16_C( 17650), -INT16_C(  2326),  INT16_C( 26668), -INT16_C(  3459),  INT16_C( 11917),  INT16_C(  2546),  INT16_C( 31379),  INT16_C( 13348) },
      { -INT16_C(   770),        INT16_MAX,  INT16_C(     0),  INT16_C(     0),  INT16_C(  6813),        INT16_MAX,  INT16_C(     0),  INT16_C( 19895),
         INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 27391),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C(  6556) } },
    { UINT16_C(47032),
      {  INT16_C( 16355),  INT16_C( 20439), -INT16_C( 19906),  INT16_C( 25328), -INT16_C(  3264), -INT16_C(  6172), -INT16_C(  3394), -INT16_C( 22366),
        -INT16_C( 12568),  INT16_C( 25873), -INT16_C( 24896), -INT16_C( 19820),  INT16_C( 10152), -INT16_C( 13267), -INT16_C(  6821),  INT16_C( 16259) },
      {  INT16_C( 23077),  INT16_C( 25486),  INT16_C( 32268),  INT16_C( 19654), -INT16_C( 21903),  INT16_C( 12339), -INT16_C( 10851), -INT16_C( 31272),
        -INT16_C(  5725),  INT16_C( 25835),  INT16_C( 32648),  INT16_C( 12310),  INT16_C( 17318),  INT16_C(   764),  INT16_C( 32553),  INT16_C( 20033) },
      {  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  5674),  INT16_C( 18639), -INT16_C( 18511),  INT16_C(     0),  INT16_C(  8906),
        -INT16_C(  6843),  INT16_C(    38),        INT16_MIN,  INT16_C(     0), -INT16_C(  7166), -INT16_C( 14031),  INT16_C(     0), -INT16_C(  3774) } },
    { UINT16_C(53209),
      { -INT16_C(  6735),  INT16_C( 30542), -INT16_C( 16591),  INT16_C( 25634), -INT16_C( 16401), -INT16_C( 14279), -INT16_C(  9148),  INT16_C( 12209),
         INT16_C( 14656),  INT16_C( 22446),  INT16_C( 21865),  INT16_C( 26010), -INT16_C( 15529), -INT16_C( 26396), -INT16_C( 17135), -INT16_C( 15513) },
      { -INT16_C( 19038), -INT16_C( 11462),  INT16_C( 23669),  INT16_C( 25655),  INT16_C( 28699),  INT16_C( 24620), -INT16_C(  8627), -INT16_C( 29297),
         INT16_C( 15895), -INT16_C( 32284),  INT16_C( 32659), -INT16_C(  5402), -INT16_C( 13502),  INT16_C( 21634), -INT16_C(  5752),  INT16_C( 11031) },
      {  INT16_C( 12303),  INT16_C(     0),  INT16_C(     0), -INT16_C(    21),        INT16_MIN,  INT16_C(     0), -INT16_C(   521),        INT16_MAX,
        -INT16_C(  1239),        INT16_MAX, -INT16_C( 10794),  INT16_C( 31412),  INT16_C(     0),  INT16_C(     0), -INT16_C( 11383), -INT16_C( 26544) } },
    { UINT16_C(20895),
      {  INT16_C(  5374),  INT16_C( 13998), -INT16_C( 13960), -INT16_C( 23130), -INT16_C(  3287), -INT16_C( 18045), -INT16_C( 25983),  INT16_C( 26103),
        -INT16_C( 30181),  INT16_C(   740),  INT16_C( 10100), -INT16_C(  2355),  INT16_C( 21883), -INT16_C( 27937),  INT16_C( 32384),  INT16_C( 32739) },
      { -INT16_C( 28270),  INT16_C(  2997),  INT16_C( 23387), -INT16_C( 31568),  INT16_C( 13135), -INT16_C( 12227),  INT16_C( 13517), -INT16_C(  5835),
         INT16_C(  6846),  INT16_C( 13035), -INT16_C( 18367), -INT16_C( 17368),  INT16_C(  2061), -INT16_C( 29106),  INT16_C( 12678),  INT16_C(  6413) },
      {        INT16_MAX,  INT16_C( 11001),        INT16_MIN,  INT16_C(  8438), -INT16_C( 16422),  INT16_C(     0),  INT16_C(     0),  INT16_C( 31938),
               INT16_MIN,  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C( 19822),  INT16_C(     0),  INT16_C( 19706),  INT16_C(     0) } },
    { UINT16_C(49859),
      {  INT16_C(  7716), -INT16_C( 11235),  INT16_C( 27810), -INT16_C(  8185), -INT16_C( 11204),  INT16_C( 29204), -INT16_C( 11331), -INT16_C( 22388),
        -INT16_C( 13051),  INT16_C( 11872),  INT16_C( 28297), -INT16_C( 10442), -INT16_C( 17156),  INT16_C(  2312), -INT16_C( 13355), -INT16_C(  1589) },
      { -INT16_C(  5911), -INT16_C( 29491), -INT16_C( 11179), -INT16_C( 28308), -INT16_C( 32599),  INT16_C( 26115), -INT16_C( 28845),  INT16_C( 22799),
         INT16_C( 28508), -INT16_C(  6777), -INT16_C( 16931), -INT16_C(  9796), -INT16_C( 14983),  INT16_C( 20450), -INT16_C( 21104),  INT16_C( 31304) },
      {  INT16_C( 13627),  INT16_C( 18256),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C( 17514),        INT16_MIN,
         INT16_C(     0),  INT16_C( 18649),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7749),        INT16_MIN } },
    { UINT16_C( 5782),
      { -INT16_C(  5370),  INT16_C( 29418), -INT16_C( 27780), -INT16_C( 32526),  INT16_C( 18170),  INT16_C(  2319),  INT16_C( 27807),  INT16_C(  9848),
         INT16_C( 22097),  INT16_C(  3811),  INT16_C( 23599),  INT16_C(  4819),  INT16_C( 25515), -INT16_C(  2881),  INT16_C( 21981), -INT16_C(  7414) },
      { -INT16_C(  3008), -INT16_C( 17067),  INT16_C( 18568), -INT16_C( 32195),  INT16_C( 19598),  INT16_C( 11659),  INT16_C(   952),  INT16_C(  2643),
         INT16_C( 13913), -INT16_C( 30440), -INT16_C(  5230),  INT16_C( 16027),  INT16_C( 23118),  INT16_C( 11314),  INT16_C( 15536), -INT16_C(  4081) },
      {  INT16_C(     0),        INT16_MAX,        INT16_MIN,  INT16_C(     0), -INT16_C(  1428),  INT16_C(     0),  INT16_C(     0),  INT16_C(  7205),
         INT16_C(     0),        INT16_MAX,  INT16_C( 28829),  INT16_C(     0),  INT16_C(  2397),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi16(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi16(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_maskz_subs_epi16(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_maskz_subs_epi16");
    easysimd_test_x86_assert_equal_i16x16(r, easysimd_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m256i a = easysimd_test_x86_random_i16x16();
    easysimd__m256i b = easysimd_test_x86_random_i16x16();
    easysimd__m256i r = easysimd_mm256_maskz_subs_epi16(k, a, b);

    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_i16x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_i16x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_mask_subs_epu8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint8_t src[32];
    const uint32_t k;
    const uint8_t a[32];
    const uint8_t b[32];
    const uint8_t r[32];
  } test_vec[] = {
    { { UINT8_C( 64),    UINT8_MAX, UINT8_C(137), UINT8_C(172),    UINT8_MAX, UINT8_C(175), UINT8_C(232), UINT8_C(141),
        UINT8_C(224), UINT8_C(207), UINT8_C( 51), UINT8_C(235), UINT8_C(123), UINT8_C( 27), UINT8_C(120), UINT8_C(125),
        UINT8_C( 33), UINT8_C(166), UINT8_C(113), UINT8_C( 90), UINT8_C( 87), UINT8_C(128), UINT8_C(129), UINT8_C(244),
        UINT8_C( 16), UINT8_C(177), UINT8_C( 14), UINT8_C(  3), UINT8_C(156), UINT8_C(220), UINT8_C(205), UINT8_C(220) },
      UINT32_C(3666433755),
      { UINT8_C(  5), UINT8_C(113), UINT8_C(104), UINT8_C(229), UINT8_C( 64), UINT8_C(155), UINT8_C(208), UINT8_C(188),
        UINT8_C(183), UINT8_C( 73), UINT8_C( 57), UINT8_C(216), UINT8_C(239), UINT8_C(170), UINT8_C( 51), UINT8_C( 70),
        UINT8_C( 42), UINT8_C(180), UINT8_C( 58), UINT8_C( 59), UINT8_C(101), UINT8_C( 72), UINT8_C( 62), UINT8_C(  2),
        UINT8_C( 37), UINT8_C( 11), UINT8_C(222), UINT8_C(  0), UINT8_C( 97), UINT8_C(103), UINT8_C(219), UINT8_C(102) },
      { UINT8_C(216), UINT8_C( 67), UINT8_C( 76), UINT8_C( 25), UINT8_C(222), UINT8_C( 28), UINT8_C(213), UINT8_C(149),
        UINT8_C(101), UINT8_C( 14), UINT8_C(110), UINT8_C( 84), UINT8_C(185), UINT8_C(161), UINT8_C(155), UINT8_C(227),
        UINT8_C( 85), UINT8_C(213), UINT8_C( 30), UINT8_C(187), UINT8_C( 30), UINT8_C( 92), UINT8_C(189), UINT8_C( 67),
        UINT8_C(103), UINT8_C(155), UINT8_C( 67), UINT8_C(200), UINT8_C(  3), UINT8_C( 30), UINT8_C( 47), UINT8_C(219) },
      { UINT8_C(  0), UINT8_C( 46), UINT8_C(137), UINT8_C(204), UINT8_C(  0), UINT8_C(175), UINT8_C(  0), UINT8_C( 39),
        UINT8_C(224), UINT8_C( 59), UINT8_C(  0), UINT8_C(235), UINT8_C( 54), UINT8_C( 27), UINT8_C(  0), UINT8_C(125),
        UINT8_C(  0), UINT8_C(166), UINT8_C(113), UINT8_C(  0), UINT8_C( 87), UINT8_C(128), UINT8_C(129), UINT8_C(  0),
        UINT8_C( 16), UINT8_C(  0), UINT8_C( 14), UINT8_C(  0), UINT8_C( 94), UINT8_C(220), UINT8_C(172), UINT8_C(  0) } },
    { { UINT8_C( 97), UINT8_C(123), UINT8_C(244), UINT8_C( 64), UINT8_C(151), UINT8_C(201), UINT8_C(213), UINT8_C(253),
        UINT8_C(216), UINT8_C( 67), UINT8_C( 81), UINT8_C(145), UINT8_C(228), UINT8_C(236), UINT8_C(116), UINT8_C( 58),
        UINT8_C(194), UINT8_C(147), UINT8_C(245), UINT8_C(224), UINT8_C(239), UINT8_C(178), UINT8_C( 35), UINT8_C( 87),
        UINT8_C( 77), UINT8_C(102), UINT8_C( 31), UINT8_C( 80), UINT8_C(133), UINT8_C( 78), UINT8_C( 44), UINT8_C(230) },
      UINT32_C(1629888713),
      { UINT8_C(234), UINT8_C(252), UINT8_C( 94), UINT8_C(194), UINT8_C( 63), UINT8_C(175), UINT8_C( 83), UINT8_C( 36),
        UINT8_C(156), UINT8_C(199), UINT8_C( 94), UINT8_C( 94), UINT8_C( 90), UINT8_C( 83), UINT8_C( 62), UINT8_C( 74),
        UINT8_C(  5), UINT8_C( 97), UINT8_C(161), UINT8_C( 82), UINT8_C(199), UINT8_C(192), UINT8_C(163), UINT8_C( 76),
        UINT8_C( 15), UINT8_C(207), UINT8_C( 51), UINT8_C(216), UINT8_C(239), UINT8_C( 89), UINT8_C( 57), UINT8_C(217) },
      { UINT8_C( 85), UINT8_C(151), UINT8_C(155), UINT8_C(149), UINT8_C( 71), UINT8_C(238), UINT8_C(185), UINT8_C(227),
        UINT8_C(182), UINT8_C( 23), UINT8_C( 65), UINT8_C( 16), UINT8_C(106), UINT8_C(127), UINT8_C( 90), UINT8_C(111),
        UINT8_C(224), UINT8_C(251), UINT8_C(193), UINT8_C(167), UINT8_C(188), UINT8_C(100), UINT8_C(244), UINT8_C(203),
        UINT8_C( 51), UINT8_C( 39), UINT8_C(163), UINT8_C( 35), UINT8_C(128), UINT8_C(221), UINT8_C(252), UINT8_C(214) },
      { UINT8_C(149), UINT8_C(123), UINT8_C(244), UINT8_C( 45), UINT8_C(151), UINT8_C(201), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(216), UINT8_C( 67), UINT8_C( 81), UINT8_C(145), UINT8_C(228), UINT8_C(  0), UINT8_C(116), UINT8_C( 58),
        UINT8_C(194), UINT8_C(  0), UINT8_C(  0), UINT8_C(224), UINT8_C(239), UINT8_C( 92), UINT8_C( 35), UINT8_C( 87),
        UINT8_C(  0), UINT8_C(102), UINT8_C( 31), UINT8_C( 80), UINT8_C(133), UINT8_C(  0), UINT8_C(  0), UINT8_C(230) } },
    { { UINT8_C(116), UINT8_C(152), UINT8_C(107), UINT8_C(187), UINT8_C(134), UINT8_C( 36), UINT8_C(158), UINT8_C( 60),
        UINT8_C( 59), UINT8_C(223), UINT8_C( 77), UINT8_C(165), UINT8_C( 94), UINT8_C(167), UINT8_C( 20), UINT8_C( 62),
        UINT8_C(163), UINT8_C(213), UINT8_C(230), UINT8_C( 95), UINT8_C( 58), UINT8_C(218), UINT8_C( 42), UINT8_C(109),
        UINT8_C(  1), UINT8_C(205), UINT8_C(144), UINT8_C(129), UINT8_C(170), UINT8_C(141), UINT8_C( 87), UINT8_C( 31) },
      UINT32_C(2883240485),
      { UINT8_C(230), UINT8_C(121), UINT8_C(232), UINT8_C( 33), UINT8_C( 88), UINT8_C( 53), UINT8_C(198), UINT8_C(183),
        UINT8_C(220), UINT8_C(218), UINT8_C(245), UINT8_C(127), UINT8_C(176), UINT8_C(219), UINT8_C(222), UINT8_C(234),
        UINT8_C(181), UINT8_C(  8), UINT8_C( 87), UINT8_C(182), UINT8_C(214), UINT8_C(232), UINT8_C( 56), UINT8_C(128),
        UINT8_C(117), UINT8_C(143), UINT8_C(159), UINT8_C(154), UINT8_C( 82), UINT8_C(122), UINT8_C( 69), UINT8_C( 56) },
      { UINT8_C(243), UINT8_C( 45), UINT8_C( 90), UINT8_C( 75), UINT8_C( 98), UINT8_C( 32), UINT8_C(  2), UINT8_C( 63),
        UINT8_C(251), UINT8_C(248), UINT8_C(190), UINT8_C(171), UINT8_C(211), UINT8_C(157), UINT8_C(149), UINT8_C(137),
        UINT8_C(165), UINT8_C(236), UINT8_C( 63), UINT8_C(123), UINT8_C(212), UINT8_C(119), UINT8_C(252), UINT8_C( 73),
        UINT8_C(  7), UINT8_C(155), UINT8_C(227), UINT8_C( 89), UINT8_C( 21), UINT8_C( 41), UINT8_C(145), UINT8_C(  8) },
      { UINT8_C(  0), UINT8_C(152), UINT8_C(142), UINT8_C(187), UINT8_C(134), UINT8_C( 21), UINT8_C(158), UINT8_C( 60),
        UINT8_C( 59), UINT8_C(  0), UINT8_C( 77), UINT8_C(165), UINT8_C( 94), UINT8_C(167), UINT8_C( 73), UINT8_C( 97),
        UINT8_C(163), UINT8_C(  0), UINT8_C(230), UINT8_C( 59), UINT8_C(  2), UINT8_C(218), UINT8_C(  0), UINT8_C( 55),
        UINT8_C(110), UINT8_C(  0), UINT8_C(144), UINT8_C( 65), UINT8_C(170), UINT8_C( 81), UINT8_C( 87), UINT8_C( 48) } },
    { { UINT8_C( 86), UINT8_C(235), UINT8_C( 84), UINT8_C(185), UINT8_C( 12), UINT8_C( 86), UINT8_C(248), UINT8_C(  7),
        UINT8_C( 78), UINT8_C(182), UINT8_C(178), UINT8_C( 34), UINT8_C( 83), UINT8_C( 71), UINT8_C(171), UINT8_C(249),
        UINT8_C( 51), UINT8_C(234), UINT8_C(116), UINT8_C(  8), UINT8_C( 98), UINT8_C(112), UINT8_C( 81), UINT8_C(105),
        UINT8_C( 12), UINT8_C( 53), UINT8_C(194), UINT8_C( 33), UINT8_C( 94), UINT8_C( 83), UINT8_C( 42), UINT8_C(180) },
      UINT32_C(1265466943),
      { UINT8_C(212), UINT8_C(101), UINT8_C( 82), UINT8_C( 35), UINT8_C( 28), UINT8_C(  4), UINT8_C( 69), UINT8_C(111),
        UINT8_C( 75), UINT8_C(240), UINT8_C(104), UINT8_C(126), UINT8_C(218), UINT8_C(221), UINT8_C(134), UINT8_C( 60),
        UINT8_C( 77), UINT8_C(216), UINT8_C(165), UINT8_C( 89), UINT8_C( 13), UINT8_C(103), UINT8_C(123), UINT8_C(107),
        UINT8_C(187), UINT8_C(165), UINT8_C( 31), UINT8_C(250), UINT8_C( 35), UINT8_C(141), UINT8_C( 69), UINT8_C(247) },
      { UINT8_C(242), UINT8_C(151), UINT8_C( 26), UINT8_C( 14), UINT8_C(155), UINT8_C( 95), UINT8_C(126), UINT8_C(230),
        UINT8_C( 79), UINT8_C(230), UINT8_C(100), UINT8_C( 42), UINT8_C(195), UINT8_C(235), UINT8_C(102), UINT8_C( 17),
        UINT8_C(195), UINT8_C( 12), UINT8_C(106), UINT8_C(208), UINT8_C(115), UINT8_C(229), UINT8_C( 59), UINT8_C( 46),
        UINT8_C(138), UINT8_C( 90), UINT8_C( 40), UINT8_C(173), UINT8_C(231), UINT8_C(109), UINT8_C(165), UINT8_C(218) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C( 56), UINT8_C( 21), UINT8_C(  0), UINT8_C(  0), UINT8_C(248), UINT8_C(  7),
        UINT8_C( 78), UINT8_C( 10), UINT8_C(  4), UINT8_C( 84), UINT8_C( 23), UINT8_C(  0), UINT8_C( 32), UINT8_C(249),
        UINT8_C(  0), UINT8_C(234), UINT8_C( 59), UINT8_C(  0), UINT8_C( 98), UINT8_C(  0), UINT8_C( 64), UINT8_C(105),
        UINT8_C( 49), UINT8_C( 75), UINT8_C(194), UINT8_C( 77), UINT8_C( 94), UINT8_C( 83), UINT8_C(  0), UINT8_C(180) } },
    { { UINT8_C(  4), UINT8_C(191), UINT8_C(232), UINT8_C(159), UINT8_C( 31), UINT8_C(102), UINT8_C(133), UINT8_C(110),
        UINT8_C( 77), UINT8_C(234), UINT8_C(152), UINT8_C( 16), UINT8_C(213),    UINT8_MAX, UINT8_C( 33), UINT8_C(152),
        UINT8_C( 11), UINT8_C(140), UINT8_C(104), UINT8_C(126), UINT8_C(113), UINT8_C(163), UINT8_C(173), UINT8_C(252),
        UINT8_C(253), UINT8_C(213), UINT8_C(169), UINT8_C(229), UINT8_C( 67), UINT8_C( 78), UINT8_C(191), UINT8_C( 71) },
      UINT32_C( 770156302),
      { UINT8_C( 14), UINT8_C(108), UINT8_C(155), UINT8_C( 91), UINT8_C( 86), UINT8_C( 52), UINT8_C(107), UINT8_C( 43),
        UINT8_C( 51), UINT8_C(141), UINT8_C(195), UINT8_C( 62), UINT8_C( 25), UINT8_C( 43), UINT8_C(188), UINT8_C(138),
        UINT8_C(206), UINT8_C(105), UINT8_C(134), UINT8_C(204), UINT8_C( 63), UINT8_C( 48), UINT8_C(177), UINT8_C(130),
        UINT8_C(126), UINT8_C(112), UINT8_C(201), UINT8_C(140), UINT8_C( 23), UINT8_C(176), UINT8_C(185), UINT8_C( 37) },
      { UINT8_C( 29), UINT8_C( 85), UINT8_C(128), UINT8_C(115), UINT8_C(137), UINT8_C(236), UINT8_C(159), UINT8_C(188),
        UINT8_C(121), UINT8_C( 98), UINT8_C(250), UINT8_C(146), UINT8_C(142), UINT8_C(182), UINT8_C( 28), UINT8_C( 92),
        UINT8_C( 32), UINT8_C(163), UINT8_C( 40), UINT8_C( 95), UINT8_C(211), UINT8_C(217), UINT8_C(225), UINT8_C( 81),
        UINT8_C( 73), UINT8_C(170), UINT8_C(222), UINT8_C( 97), UINT8_C( 91), UINT8_C(151), UINT8_C(134), UINT8_C(120) },
      { UINT8_C(  4), UINT8_C( 23), UINT8_C( 27), UINT8_C(  0), UINT8_C( 31), UINT8_C(102), UINT8_C(133), UINT8_C(110),
        UINT8_C(  0), UINT8_C( 43), UINT8_C(  0), UINT8_C( 16), UINT8_C(213), UINT8_C(  0), UINT8_C( 33), UINT8_C( 46),
        UINT8_C(174), UINT8_C(  0), UINT8_C( 94), UINT8_C(126), UINT8_C(113), UINT8_C(  0), UINT8_C(  0), UINT8_C( 49),
        UINT8_C( 53), UINT8_C(213), UINT8_C(  0), UINT8_C( 43), UINT8_C( 67), UINT8_C( 25), UINT8_C(191), UINT8_C( 71) } },
    { { UINT8_C(236), UINT8_C(  7), UINT8_C(235), UINT8_C(117), UINT8_C(243), UINT8_C(138), UINT8_C( 49), UINT8_C(108),
        UINT8_C(237), UINT8_C( 43), UINT8_C(254), UINT8_C(123), UINT8_C(226), UINT8_C( 26), UINT8_C(215), UINT8_C(  2),
        UINT8_C(189), UINT8_C(  0), UINT8_C( 97), UINT8_C(144), UINT8_C(217), UINT8_C( 66), UINT8_C(226), UINT8_C( 35),
        UINT8_C(236), UINT8_C(192), UINT8_C(132), UINT8_C( 71), UINT8_C( 87), UINT8_C( 10), UINT8_C(191), UINT8_C( 68) },
      UINT32_C(  79276817),
      { UINT8_C( 53), UINT8_C(235), UINT8_C(112), UINT8_C( 34), UINT8_C( 22), UINT8_C(110), UINT8_C(157), UINT8_C(248),
        UINT8_C(137), UINT8_C(117), UINT8_C(250), UINT8_C( 70), UINT8_C(117), UINT8_C( 91), UINT8_C(215), UINT8_C( 78),
        UINT8_C(157), UINT8_C(185), UINT8_C(113), UINT8_C(138), UINT8_C(121), UINT8_C(245), UINT8_C(209), UINT8_C(208),
        UINT8_C(  0), UINT8_C(145), UINT8_C( 20), UINT8_C( 17), UINT8_C( 60), UINT8_C(206), UINT8_C( 22), UINT8_C(113) },
      { UINT8_C(185), UINT8_C(134), UINT8_C(148), UINT8_C(207), UINT8_C(245), UINT8_C( 49), UINT8_C(200), UINT8_C(126),
        UINT8_C(166), UINT8_C(194), UINT8_C(196), UINT8_C( 27), UINT8_C( 30), UINT8_C(155), UINT8_C(106), UINT8_C(187),
        UINT8_C( 84), UINT8_C(219), UINT8_C( 69), UINT8_C(205), UINT8_C(209), UINT8_C( 23), UINT8_C(158), UINT8_C(209),
        UINT8_C(168), UINT8_C(178), UINT8_C(226), UINT8_C(228), UINT8_C(128), UINT8_C(248), UINT8_C( 85), UINT8_C( 57) },
      { UINT8_C(  0), UINT8_C(  7), UINT8_C(235), UINT8_C(117), UINT8_C(  0), UINT8_C(138), UINT8_C( 49), UINT8_C(108),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(254), UINT8_C( 43), UINT8_C(226), UINT8_C(  0), UINT8_C(215), UINT8_C(  0),
        UINT8_C( 73), UINT8_C(  0), UINT8_C( 97), UINT8_C(  0), UINT8_C(  0), UINT8_C(222), UINT8_C(226), UINT8_C(  0),
        UINT8_C(236), UINT8_C(192), UINT8_C(  0), UINT8_C( 71), UINT8_C( 87), UINT8_C( 10), UINT8_C(191), UINT8_C( 68) } },
    { { UINT8_C(127), UINT8_C(233), UINT8_C(  9), UINT8_C(116), UINT8_C( 27), UINT8_C(209), UINT8_C(242), UINT8_C(193),
        UINT8_C(147), UINT8_C(182), UINT8_C(221), UINT8_C(177), UINT8_C( 82), UINT8_C( 71), UINT8_C(109), UINT8_C(166),
        UINT8_C( 34), UINT8_C(178), UINT8_C(116), UINT8_C(243), UINT8_C(201), UINT8_C( 18), UINT8_C(196), UINT8_C(113),
        UINT8_C(196), UINT8_C(167), UINT8_C( 85), UINT8_C( 69), UINT8_C(159), UINT8_C(171), UINT8_C(126), UINT8_C( 30) },
      UINT32_C(2945615764),
      { UINT8_C( 88), UINT8_C(132), UINT8_C(113), UINT8_C(236), UINT8_C( 59), UINT8_C( 78), UINT8_C(157), UINT8_C(141),
        UINT8_C(149), UINT8_C( 10), UINT8_C( 51), UINT8_C(183), UINT8_C(189), UINT8_C(167), UINT8_C(171), UINT8_C(134),
        UINT8_C(185), UINT8_C(111), UINT8_C(248), UINT8_C(126), UINT8_C( 22), UINT8_C( 77), UINT8_C(195), UINT8_C(182),
        UINT8_C(248), UINT8_C( 65), UINT8_C(212), UINT8_C(141), UINT8_C(201), UINT8_C(103), UINT8_C( 60), UINT8_C( 33) },
      { UINT8_C(235), UINT8_C(173), UINT8_C( 13), UINT8_C( 38), UINT8_C(251), UINT8_C(171), UINT8_C(179), UINT8_C(144),
        UINT8_C(181), UINT8_C(231), UINT8_C( 72), UINT8_C(114), UINT8_C(142), UINT8_C(243), UINT8_C(249), UINT8_C( 72),
        UINT8_C( 98), UINT8_C(241), UINT8_C(198), UINT8_C(121), UINT8_C( 62), UINT8_C(137), UINT8_C( 47), UINT8_C( 55),
        UINT8_C(202), UINT8_C(  3), UINT8_C(196), UINT8_C(147), UINT8_C(106), UINT8_C(  0), UINT8_C(181), UINT8_C( 86) },
      { UINT8_C(127), UINT8_C(233), UINT8_C(100), UINT8_C(116), UINT8_C(  0), UINT8_C(209), UINT8_C(242), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(177), UINT8_C( 82), UINT8_C( 71), UINT8_C(109), UINT8_C( 62),
        UINT8_C( 34), UINT8_C(  0), UINT8_C(116), UINT8_C(243), UINT8_C(  0), UINT8_C( 18), UINT8_C(196), UINT8_C(127),
        UINT8_C( 46), UINT8_C( 62), UINT8_C( 16), UINT8_C(  0), UINT8_C(159), UINT8_C(103), UINT8_C(126), UINT8_C(  0) } },
    { { UINT8_C(174), UINT8_C(194), UINT8_C(124), UINT8_C(169), UINT8_C(109), UINT8_C( 48), UINT8_C( 58), UINT8_C( 35),
        UINT8_C( 23), UINT8_C(130), UINT8_C(149), UINT8_C(165), UINT8_C(117), UINT8_C(142), UINT8_C(237), UINT8_C(215),
        UINT8_C(127), UINT8_C(179), UINT8_C( 80), UINT8_C(190), UINT8_C( 60), UINT8_C(127), UINT8_C(245), UINT8_C(  7),
        UINT8_C(131), UINT8_C(185), UINT8_C(154), UINT8_C(237), UINT8_C(185), UINT8_C( 79), UINT8_C( 67), UINT8_C(103) },
      UINT32_C(2131869714),
      { UINT8_C(240), UINT8_C( 75), UINT8_C(162), UINT8_C(  7), UINT8_C(205), UINT8_C( 56), UINT8_C(172), UINT8_C( 66),
        UINT8_C(198), UINT8_C(154), UINT8_C( 25), UINT8_C( 70), UINT8_C( 77), UINT8_C(106), UINT8_C(  4), UINT8_C(138),
        UINT8_C(233), UINT8_C(249), UINT8_C(145), UINT8_C(108), UINT8_C(178), UINT8_C( 43), UINT8_C( 90), UINT8_C(107),
        UINT8_C(123), UINT8_C(157), UINT8_C(211), UINT8_C(141), UINT8_C( 93), UINT8_C(228), UINT8_C( 12), UINT8_C( 77) },
      { UINT8_C( 47), UINT8_C(175), UINT8_C( 84), UINT8_C(252), UINT8_C(231), UINT8_C(  1), UINT8_C( 62), UINT8_C(173),
        UINT8_C(155), UINT8_C( 87), UINT8_C(243), UINT8_C(232), UINT8_C(193), UINT8_C(247), UINT8_C(114), UINT8_C(171),
        UINT8_C(240), UINT8_C(  3), UINT8_C( 23), UINT8_C(162), UINT8_C( 47), UINT8_C(113), UINT8_C( 14), UINT8_C(170),
        UINT8_C( 15), UINT8_C(225), UINT8_C( 55), UINT8_C(108), UINT8_C(197), UINT8_C( 67), UINT8_C(186), UINT8_C(244) },
      { UINT8_C(174), UINT8_C(  0), UINT8_C(124), UINT8_C(169), UINT8_C(  0), UINT8_C( 48), UINT8_C( 58), UINT8_C( 35),
        UINT8_C( 23), UINT8_C(130), UINT8_C(149), UINT8_C(165), UINT8_C(117), UINT8_C(142), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(179), UINT8_C( 80), UINT8_C(190), UINT8_C(131), UINT8_C(127), UINT8_C(245), UINT8_C(  7),
        UINT8_C(108), UINT8_C(  0), UINT8_C(156), UINT8_C( 33), UINT8_C(  0), UINT8_C(161), UINT8_C(  0), UINT8_C(103) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m256i src = easysimd_mm256_loadu_epi8(test_vec[i].src);
    easysimd__mmask32 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi8(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi8(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_mask_subs_epu8(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_mask_subs_epu8");
    easysimd_test_x86_assert_equal_u8x32(r, easysimd_mm256_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m256i src = easysimd_test_x86_random_u8x32();
    easysimd__mmask32 k = easysimd_test_x86_random_mmask32();
    easysimd__m256i a = easysimd_test_x86_random_u8x32();
    easysimd__m256i b = easysimd_test_x86_random_u8x32();
    easysimd__m256i r = easysimd_mm256_mask_subs_epu8(src, k, a, b);

    easysimd_test_x86_write_u8x32(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask32(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x32(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x32(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_maskz_subs_epu8 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint32_t k;
    const uint8_t a[32];
    const uint8_t b[32];
    const uint8_t r[32];
  } test_vec[] = {
    { UINT32_C(3098371376),
      { UINT8_C(173), UINT8_C(234), UINT8_C( 58), UINT8_C( 59), UINT8_C( 55), UINT8_C(197), UINT8_C(104), UINT8_C(239),
        UINT8_C(201), UINT8_C(187), UINT8_C(249), UINT8_C( 34), UINT8_C(241), UINT8_C( 17), UINT8_C(171), UINT8_C(131),
        UINT8_C(252), UINT8_C( 70), UINT8_C(193), UINT8_C( 75), UINT8_C(161), UINT8_C(243), UINT8_C(119), UINT8_C( 81),
        UINT8_C( 47), UINT8_C(134), UINT8_C( 65), UINT8_C( 96), UINT8_C(235), UINT8_C(239), UINT8_C( 24), UINT8_C(152) },
      { UINT8_C(217), UINT8_C( 83), UINT8_C(211), UINT8_C( 16), UINT8_C( 24), UINT8_C( 59), UINT8_C(  0), UINT8_C(225),
        UINT8_C(246), UINT8_C(249), UINT8_C(  4), UINT8_C(231), UINT8_C( 11), UINT8_C(175), UINT8_C(107), UINT8_C(  7),
        UINT8_C(246), UINT8_C( 44), UINT8_C( 82), UINT8_C(151), UINT8_C( 32), UINT8_C(201), UINT8_C(232), UINT8_C( 79),
        UINT8_C( 80), UINT8_C( 41), UINT8_C(175), UINT8_C( 59), UINT8_C( 24), UINT8_C(200), UINT8_C(212), UINT8_C(242) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 31), UINT8_C(138), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(245), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 64), UINT8_C(  0),
        UINT8_C(  6), UINT8_C(  0), UINT8_C(111), UINT8_C(  0), UINT8_C(  0), UINT8_C( 42), UINT8_C(  0), UINT8_C(  2),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 37), UINT8_C(211), UINT8_C( 39), UINT8_C(  0), UINT8_C(  0) } },
    { UINT32_C( 855811867),
      { UINT8_C(227), UINT8_C(  2), UINT8_C( 21), UINT8_C(217), UINT8_C(252), UINT8_C( 25), UINT8_C(193), UINT8_C(  7),
        UINT8_C(200), UINT8_C( 44), UINT8_C( 14), UINT8_C(190), UINT8_C( 88), UINT8_C( 97), UINT8_C( 85), UINT8_C(120),
        UINT8_C( 42), UINT8_C( 61), UINT8_C(200), UINT8_C(122), UINT8_C(103), UINT8_C(119), UINT8_C(182), UINT8_C(127),
        UINT8_C( 63), UINT8_C(138), UINT8_C(113), UINT8_C( 90), UINT8_C( 49), UINT8_C(116), UINT8_C(142), UINT8_C( 20) },
      { UINT8_C(118), UINT8_C(163), UINT8_C(238), UINT8_C(114), UINT8_C(188), UINT8_C(175), UINT8_C(121), UINT8_C(132),
        UINT8_C(219), UINT8_C(136), UINT8_C( 67), UINT8_C( 51), UINT8_C(233), UINT8_C(152), UINT8_C(172), UINT8_C( 19),
        UINT8_C(214), UINT8_C(116), UINT8_C(142), UINT8_C( 61), UINT8_C(235), UINT8_C( 68), UINT8_C(188), UINT8_C( 43),
        UINT8_C(206), UINT8_C( 46), UINT8_C(133),    UINT8_MAX, UINT8_C(162), UINT8_C( 19), UINT8_C( 20), UINT8_C( 24) },
      { UINT8_C(109), UINT8_C(  0), UINT8_C(  0), UINT8_C(103), UINT8_C( 64), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(101),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C( 92), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 97), UINT8_C(  0), UINT8_C(  0) } },
    { UINT32_C(1921712822),
      { UINT8_C(177), UINT8_C(  4), UINT8_C(247), UINT8_C(140), UINT8_C(140), UINT8_C( 58), UINT8_C(191), UINT8_C(117),
        UINT8_C(210), UINT8_C(107), UINT8_C(137), UINT8_C(168), UINT8_C(223), UINT8_C( 23), UINT8_C(229), UINT8_C(203),
        UINT8_C( 91), UINT8_C(162), UINT8_C(246), UINT8_C( 41), UINT8_C(208), UINT8_C(123), UINT8_C( 40), UINT8_C(114),
        UINT8_C(143), UINT8_C( 60), UINT8_C(138), UINT8_C( 69), UINT8_C( 62), UINT8_C( 21), UINT8_C(184), UINT8_C(239) },
      { UINT8_C( 26), UINT8_C(175), UINT8_C(123), UINT8_C(166), UINT8_C(233), UINT8_C( 59), UINT8_C( 28), UINT8_C(187),
        UINT8_C(166), UINT8_C(165), UINT8_C(100), UINT8_C(134), UINT8_C(188), UINT8_C( 73), UINT8_C( 81), UINT8_C( 23),
        UINT8_C(235), UINT8_C( 71), UINT8_C( 64), UINT8_C(187), UINT8_C(194), UINT8_C(104), UINT8_C( 45), UINT8_C( 81),
        UINT8_C(165), UINT8_C(184), UINT8_C(151), UINT8_C(227), UINT8_C(205), UINT8_C( 79), UINT8_C(211), UINT8_C(231) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(124), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C( 91), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 33),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } },
    { UINT32_C(3884863230),
      { UINT8_C(137), UINT8_C(170), UINT8_C(162), UINT8_C( 48), UINT8_C( 79), UINT8_C(  6), UINT8_C(182), UINT8_C( 11),
        UINT8_C( 80), UINT8_C(  7), UINT8_C( 34), UINT8_C( 59), UINT8_C( 78), UINT8_C( 98), UINT8_C(247), UINT8_C( 16),
        UINT8_C(202), UINT8_C( 36), UINT8_C( 98), UINT8_C(111), UINT8_C(220), UINT8_C(249), UINT8_C( 83), UINT8_C(170),
        UINT8_C( 72), UINT8_C( 38), UINT8_C(145), UINT8_C( 70), UINT8_C(116), UINT8_C( 31), UINT8_C( 45), UINT8_C(254) },
      { UINT8_C(201), UINT8_C(207), UINT8_C( 46), UINT8_C( 24), UINT8_C(214), UINT8_C(228), UINT8_C( 35), UINT8_C( 38),
        UINT8_C(235), UINT8_C( 69), UINT8_C( 97), UINT8_C( 57), UINT8_C(167), UINT8_C( 88), UINT8_C( 73), UINT8_C(114),
        UINT8_C(125), UINT8_C(171), UINT8_C(225), UINT8_C( 89), UINT8_C(164), UINT8_C( 52), UINT8_C(  3), UINT8_C(236),
        UINT8_C( 90), UINT8_C(149), UINT8_C( 50), UINT8_C(207), UINT8_C(180), UINT8_C( 95), UINT8_C(205), UINT8_C(126) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(116), UINT8_C( 24), UINT8_C(  0), UINT8_C(  0), UINT8_C(147), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  2), UINT8_C(  0), UINT8_C(  0), UINT8_C(174), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 22), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C( 95), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(128) } },
    { UINT32_C(  93780783),
      { UINT8_C(223), UINT8_C(186), UINT8_C( 43), UINT8_C(202),    UINT8_MAX, UINT8_C(140), UINT8_C(  3), UINT8_C(167),
        UINT8_C(229), UINT8_C( 76), UINT8_C( 25), UINT8_C( 98), UINT8_C(248), UINT8_C(250), UINT8_C(187), UINT8_C(156),
        UINT8_C( 47), UINT8_C(191), UINT8_C(137), UINT8_C(137), UINT8_C( 84), UINT8_C(187), UINT8_C( 88), UINT8_C(  8),
        UINT8_C( 27), UINT8_C( 37), UINT8_C(134), UINT8_C( 74), UINT8_C( 32), UINT8_C( 29), UINT8_C( 79),    UINT8_MAX },
      { UINT8_C(215), UINT8_C(122), UINT8_C(201), UINT8_C(214), UINT8_C(  6), UINT8_C(204), UINT8_C(125), UINT8_C(235),
        UINT8_C( 25), UINT8_C(150), UINT8_C( 77), UINT8_C( 17), UINT8_C(145), UINT8_C(  9), UINT8_C(173), UINT8_C(192),
        UINT8_C(200), UINT8_C( 54), UINT8_C( 73), UINT8_C( 28), UINT8_C(242), UINT8_C(162), UINT8_C( 36), UINT8_C( 13),
        UINT8_C(199), UINT8_C(171), UINT8_C( 87), UINT8_C(232), UINT8_C(200), UINT8_C(166), UINT8_C(231), UINT8_C(159) },
      { UINT8_C(  8), UINT8_C( 64), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(204), UINT8_C(  0), UINT8_C(  0), UINT8_C( 81), UINT8_C(103), UINT8_C(241), UINT8_C( 14), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(137), UINT8_C( 64), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C( 47), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } },
    { UINT32_C( 645247264),
      { UINT8_C(125), UINT8_C(243), UINT8_C( 18), UINT8_C(150), UINT8_C(137), UINT8_C( 95), UINT8_C(167), UINT8_C( 26),
        UINT8_C(104), UINT8_C( 85), UINT8_C(218), UINT8_C( 48), UINT8_C(139), UINT8_C( 36), UINT8_C( 76), UINT8_C(125),
        UINT8_C(198), UINT8_C(113), UINT8_C(138), UINT8_C(141), UINT8_C( 28), UINT8_C(225), UINT8_C(117), UINT8_C(228),
        UINT8_C(135), UINT8_C( 93), UINT8_C(131), UINT8_C(167), UINT8_C( 14), UINT8_C(248), UINT8_C(206), UINT8_C(139) },
      { UINT8_C(235), UINT8_C(224), UINT8_C( 34), UINT8_C(117), UINT8_C( 63), UINT8_C(201), UINT8_C(143), UINT8_C(168),
        UINT8_C( 30), UINT8_C(106), UINT8_C(216), UINT8_C(170), UINT8_C(142), UINT8_C( 37), UINT8_C( 39), UINT8_C( 84),
        UINT8_C(150), UINT8_C(178), UINT8_C(225), UINT8_C(178), UINT8_C(147), UINT8_C( 87), UINT8_C(150), UINT8_C( 27),
        UINT8_C(180), UINT8_C( 25), UINT8_C(194), UINT8_C(194), UINT8_C( 17), UINT8_C(144), UINT8_C( 77), UINT8_C(253) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C( 74), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 41),
        UINT8_C( 48), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(138), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C( 68), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(104), UINT8_C(  0), UINT8_C(  0) } },
    { UINT32_C(2960289648),
      { UINT8_C( 57), UINT8_C(  1), UINT8_C( 88), UINT8_C( 87), UINT8_C(107), UINT8_C( 48), UINT8_C(  1), UINT8_C(249),
        UINT8_C( 85), UINT8_C( 41), UINT8_C( 77), UINT8_C(235), UINT8_C(219), UINT8_C( 47), UINT8_C(157), UINT8_C(110),
        UINT8_C(134), UINT8_C( 51), UINT8_C(137), UINT8_C( 58), UINT8_C( 76), UINT8_C( 76), UINT8_C(252), UINT8_C( 94),
        UINT8_C(220), UINT8_C( 73), UINT8_C( 91), UINT8_C( 77), UINT8_C(185), UINT8_C(205), UINT8_C(253), UINT8_C(242) },
      { UINT8_C(206), UINT8_C( 85), UINT8_C( 73), UINT8_C( 58), UINT8_C(133), UINT8_C( 75), UINT8_C( 51), UINT8_C(219),
        UINT8_C(116), UINT8_C(129), UINT8_C(198), UINT8_C( 79), UINT8_C(176), UINT8_C(100), UINT8_C(189), UINT8_C( 54),
        UINT8_C(151), UINT8_C( 71), UINT8_C(112), UINT8_C(228), UINT8_C(147), UINT8_C(108), UINT8_C( 66), UINT8_C(111),
        UINT8_C(181), UINT8_C(157), UINT8_C(188), UINT8_C(110), UINT8_C(106), UINT8_C(185), UINT8_C( 96), UINT8_C( 56) },
      { UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(156), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(186), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 79), UINT8_C( 20), UINT8_C(  0), UINT8_C(186) } },
    { UINT32_C(2490542606),
      { UINT8_C(245), UINT8_C(166), UINT8_C(111), UINT8_C(105), UINT8_C( 39), UINT8_C( 53), UINT8_C(184), UINT8_C(215),
        UINT8_C(153), UINT8_C(117), UINT8_C( 13), UINT8_C( 49), UINT8_C(188), UINT8_C(125), UINT8_C( 21), UINT8_C( 79),
        UINT8_C(233), UINT8_C( 87), UINT8_C(191), UINT8_C(158), UINT8_C(244), UINT8_C(123), UINT8_C( 13), UINT8_C( 94),
        UINT8_C( 53), UINT8_C(109), UINT8_C(150), UINT8_C( 67), UINT8_C( 23), UINT8_C(  9), UINT8_C(215), UINT8_C( 12) },
      { UINT8_C(175), UINT8_C( 70), UINT8_C(117), UINT8_C(214), UINT8_C(124), UINT8_C( 45), UINT8_C(173), UINT8_C( 21),
        UINT8_C(163), UINT8_C(186), UINT8_C( 70), UINT8_C( 95), UINT8_C( 55), UINT8_C( 91), UINT8_C(175), UINT8_C( 32),
        UINT8_C(178), UINT8_C(110), UINT8_C(190), UINT8_C(166), UINT8_C(233), UINT8_C(203), UINT8_C(  4), UINT8_C( 30),
        UINT8_C( 57), UINT8_C(155), UINT8_C( 98), UINT8_C( 80), UINT8_C(164), UINT8_C( 57), UINT8_C( 93), UINT8_C( 83) },
      { UINT8_C(  0), UINT8_C( 96), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 34), UINT8_C(  0), UINT8_C( 47),
        UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 11), UINT8_C(  0), UINT8_C(  9), UINT8_C(  0),
        UINT8_C(  0), UINT8_C(  0), UINT8_C( 52), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask32 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi8(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi8(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_maskz_subs_epu8(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_maskz_subs_epu8");
    easysimd_test_x86_assert_equal_u8x32(r, easysimd_mm256_loadu_epi8(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask32 k = easysimd_test_x86_random_mmask32();
    easysimd__m256i a = easysimd_test_x86_random_u8x32();
    easysimd__m256i b = easysimd_test_x86_random_u8x32();
    easysimd__m256i r = easysimd_mm256_maskz_subs_epu8(k, a, b);

    easysimd_test_x86_write_mmask32(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_u8x32(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x32(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u8x32(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_mask_subs_epu16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t src[16];
    const uint16_t k;
    const uint16_t a[16];
    const uint16_t b[16];
    const uint16_t r[16];
  } test_vec[] = {
    { { UINT16_C( 3826), UINT16_C(55792), UINT16_C(11791), UINT16_C(43655), UINT16_C(31365), UINT16_C(18323), UINT16_C( 1394), UINT16_C(25330),
        UINT16_C( 2313), UINT16_C(14341), UINT16_C( 4987), UINT16_C(35554), UINT16_C( 6644), UINT16_C(47606), UINT16_C(45148), UINT16_C(20397) },
      UINT16_C(40383),
      { UINT16_C(52776), UINT16_C(45003), UINT16_C(20601), UINT16_C( 3114), UINT16_C(40087), UINT16_C(35089), UINT16_C( 6910), UINT16_C(  915),
        UINT16_C( 3666), UINT16_C(13334), UINT16_C( 2712), UINT16_C(36429), UINT16_C(43715), UINT16_C(28735), UINT16_C(65273), UINT16_C( 8461) },
      { UINT16_C(55500), UINT16_C(17873), UINT16_C(64297), UINT16_C(49233), UINT16_C(25495), UINT16_C(38218), UINT16_C(56701), UINT16_C(53401),
        UINT16_C(45035), UINT16_C(33540), UINT16_C(21178), UINT16_C(32017), UINT16_C(20732), UINT16_C(62958), UINT16_C(64334), UINT16_C( 6934) },
      { UINT16_C(    0), UINT16_C(27130), UINT16_C(    0), UINT16_C(    0), UINT16_C(14592), UINT16_C(    0), UINT16_C( 1394), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(14341), UINT16_C(    0), UINT16_C( 4412), UINT16_C(22983), UINT16_C(47606), UINT16_C(45148), UINT16_C( 1527) } },
    { { UINT16_C(59348), UINT16_C(64864), UINT16_C(45794), UINT16_C(31165), UINT16_C( 1813), UINT16_C(37391), UINT16_C(43236), UINT16_C(53090),
        UINT16_C(26455), UINT16_C( 4434), UINT16_C(25785), UINT16_C(46479), UINT16_C(32180), UINT16_C(  938), UINT16_C(49272), UINT16_C(19486) },
      UINT16_C(32424),
      { UINT16_C(35401), UINT16_C( 1840), UINT16_C(17668), UINT16_C( 4878), UINT16_C(62424), UINT16_C(15035), UINT16_C( 4802), UINT16_C( 5537),
        UINT16_C(23076), UINT16_C(45945), UINT16_C(11535), UINT16_C(47408), UINT16_C(43056), UINT16_C(20090), UINT16_C( 8949), UINT16_C(16077) },
      { UINT16_C(64940), UINT16_C(45125), UINT16_C(21571), UINT16_C( 7107), UINT16_C(32327), UINT16_C( 2389), UINT16_C(63377), UINT16_C(46366),
        UINT16_C(38737), UINT16_C(24936), UINT16_C(39109), UINT16_C(62746), UINT16_C(37952), UINT16_C(13636), UINT16_C( 4534), UINT16_C(25460) },
      { UINT16_C(59348), UINT16_C(64864), UINT16_C(45794), UINT16_C(    0), UINT16_C( 1813), UINT16_C(12646), UINT16_C(43236), UINT16_C(    0),
        UINT16_C(26455), UINT16_C(21009), UINT16_C(    0), UINT16_C(    0), UINT16_C( 5104), UINT16_C( 6454), UINT16_C( 4415), UINT16_C(19486) } },
    { { UINT16_C(47374), UINT16_C(20755), UINT16_C(55053), UINT16_C(21612), UINT16_C(49749), UINT16_C(58974), UINT16_C(31929), UINT16_C( 2715),
        UINT16_C(  788), UINT16_C(55659), UINT16_C(34459), UINT16_C(56526), UINT16_C( 4634), UINT16_C(53521), UINT16_C(34083), UINT16_C(12852) },
      UINT16_C(18239),
      { UINT16_C(19587), UINT16_C(61470), UINT16_C(29857), UINT16_C(65458), UINT16_C(27482), UINT16_C(63099), UINT16_C(36725), UINT16_C(57849),
        UINT16_C(38248), UINT16_C(14183), UINT16_C(33137), UINT16_C(33353), UINT16_C(27986), UINT16_C(34312), UINT16_C(18335), UINT16_C( 8910) },
      { UINT16_C(60563), UINT16_C(13330), UINT16_C(50272), UINT16_C(47923), UINT16_C(44847), UINT16_C(42417), UINT16_C(43582), UINT16_C(42886),
        UINT16_C(60735), UINT16_C(45278), UINT16_C(10094), UINT16_C(49459), UINT16_C(15252), UINT16_C(13127), UINT16_C( 5506), UINT16_C( 5462) },
      { UINT16_C(    0), UINT16_C(48140), UINT16_C(    0), UINT16_C(17535), UINT16_C(    0), UINT16_C(20682), UINT16_C(31929), UINT16_C( 2715),
        UINT16_C(    0), UINT16_C(    0), UINT16_C(23043), UINT16_C(56526), UINT16_C( 4634), UINT16_C(53521), UINT16_C(12829), UINT16_C(12852) } },
    { { UINT16_C(26626), UINT16_C(25162), UINT16_C(32045), UINT16_C(23581), UINT16_C(52780), UINT16_C(27393), UINT16_C(34681), UINT16_C(47122),
        UINT16_C(61556), UINT16_C(58217), UINT16_C(39959), UINT16_C(44196), UINT16_C(60375), UINT16_C(23007), UINT16_C(13569), UINT16_C(  878) },
      UINT16_C(47262),
      { UINT16_C(52069), UINT16_C(33590), UINT16_C(25127), UINT16_C(10577), UINT16_C(51917), UINT16_C(57264), UINT16_C( 9603), UINT16_C(60623),
        UINT16_C(59144), UINT16_C(44168), UINT16_C(24467), UINT16_C(29335), UINT16_C(39096), UINT16_C( 9896), UINT16_C(18075), UINT16_C(  479) },
      { UINT16_C( 5393), UINT16_C(14468), UINT16_C(54647), UINT16_C(17761), UINT16_C( 4768), UINT16_C( 8996), UINT16_C(62519), UINT16_C(16143),
        UINT16_C(38875), UINT16_C(28395), UINT16_C(33526), UINT16_C(44768), UINT16_C(34843), UINT16_C(46804), UINT16_C(46030), UINT16_C(57271) },
      { UINT16_C(26626), UINT16_C(19122), UINT16_C(    0), UINT16_C(    0), UINT16_C(47149), UINT16_C(27393), UINT16_C(34681), UINT16_C(44480),
        UINT16_C(61556), UINT16_C(58217), UINT16_C(39959), UINT16_C(    0), UINT16_C( 4253), UINT16_C(    0), UINT16_C(13569), UINT16_C(    0) } },
    { { UINT16_C(15304), UINT16_C(16408), UINT16_C(30993), UINT16_C(45445), UINT16_C(43403), UINT16_C(49876), UINT16_C(58269), UINT16_C(30721),
        UINT16_C(60538), UINT16_C(28902), UINT16_C(51055), UINT16_C(35358), UINT16_C(62031), UINT16_C( 7744), UINT16_C(63654), UINT16_C(28413) },
      UINT16_C( 5427),
      { UINT16_C(17582), UINT16_C(13199), UINT16_C( 6901), UINT16_C(51677), UINT16_C(31453), UINT16_C(57004), UINT16_C( 9971), UINT16_C(55755),
        UINT16_C(14998), UINT16_C(46240), UINT16_C(61636), UINT16_C( 1191), UINT16_C(19726), UINT16_C( 3068), UINT16_C(12475), UINT16_C(27169) },
      { UINT16_C(45172), UINT16_C(27293), UINT16_C(31434), UINT16_C(42803), UINT16_C(57589), UINT16_C(59526), UINT16_C(20742), UINT16_C(40385),
        UINT16_C(25227), UINT16_C(20305), UINT16_C(63570), UINT16_C(24659), UINT16_C(20549), UINT16_C(  363), UINT16_C(35968), UINT16_C(62571) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(30993), UINT16_C(45445), UINT16_C(    0), UINT16_C(    0), UINT16_C(58269), UINT16_C(30721),
        UINT16_C(    0), UINT16_C(28902), UINT16_C(    0), UINT16_C(35358), UINT16_C(    0), UINT16_C( 7744), UINT16_C(63654), UINT16_C(28413) } },
    { { UINT16_C( 2108), UINT16_C( 1886), UINT16_C(37507), UINT16_C(30894), UINT16_C(13426), UINT16_C(30816), UINT16_C( 8581), UINT16_C( 4117),
        UINT16_C(26499), UINT16_C(54623), UINT16_C(45919), UINT16_C(42293), UINT16_C(41219), UINT16_C(33702), UINT16_C( 4397), UINT16_C(27255) },
      UINT16_C(54809),
      { UINT16_C(40049), UINT16_C( 8040), UINT16_C(55828), UINT16_C(29780), UINT16_C(55634), UINT16_C(26774), UINT16_C( 6634), UINT16_C(18895),
        UINT16_C(12015), UINT16_C( 9468), UINT16_C(65491), UINT16_C(31173), UINT16_C(62338), UINT16_C(64138), UINT16_C(42077), UINT16_C(52944) },
      { UINT16_C(14400), UINT16_C(21997), UINT16_C(16658), UINT16_C(25801), UINT16_C(24347), UINT16_C( 1484), UINT16_C(39801), UINT16_C(26702),
        UINT16_C(19402), UINT16_C(40332), UINT16_C(21066), UINT16_C(52503), UINT16_C(41285), UINT16_C(41671), UINT16_C(38725), UINT16_C(34416) },
      { UINT16_C(25649), UINT16_C( 1886), UINT16_C(37507), UINT16_C( 3979), UINT16_C(31287), UINT16_C(30816), UINT16_C( 8581), UINT16_C( 4117),
        UINT16_C(26499), UINT16_C(    0), UINT16_C(44425), UINT16_C(42293), UINT16_C(21053), UINT16_C(33702), UINT16_C( 3352), UINT16_C(18528) } },
    { { UINT16_C(24015), UINT16_C(57819), UINT16_C(42143), UINT16_C(47685), UINT16_C( 4612), UINT16_C(32191), UINT16_C( 3501), UINT16_C(30693),
        UINT16_C(29016), UINT16_C(41749), UINT16_C(11459), UINT16_C( 2160), UINT16_C(14285), UINT16_C( 5034), UINT16_C( 6862), UINT16_C(40345) },
      UINT16_C(29816),
      { UINT16_C( 6014), UINT16_C(49944), UINT16_C( 7377), UINT16_C(37077), UINT16_C(33689), UINT16_C(32413), UINT16_C(63226), UINT16_C( 4080),
        UINT16_C(45977), UINT16_C( 2363), UINT16_C( 2492), UINT16_C(26176), UINT16_C( 3612), UINT16_C(46465), UINT16_C(63915), UINT16_C(10537) },
      { UINT16_C(16656), UINT16_C(57836), UINT16_C(49758), UINT16_C(63345), UINT16_C( 3653), UINT16_C(16246), UINT16_C(26116), UINT16_C(40271),
        UINT16_C(35353), UINT16_C(54694), UINT16_C(59027), UINT16_C(44860), UINT16_C(48628), UINT16_C(40804), UINT16_C(36278), UINT16_C(50888) },
      { UINT16_C(24015), UINT16_C(57819), UINT16_C(42143), UINT16_C(    0), UINT16_C(30036), UINT16_C(16167), UINT16_C(37110), UINT16_C(30693),
        UINT16_C(29016), UINT16_C(41749), UINT16_C(    0), UINT16_C( 2160), UINT16_C(    0), UINT16_C( 5661), UINT16_C(27637), UINT16_C(40345) } },
    { { UINT16_C(46543), UINT16_C(11687), UINT16_C( 6263), UINT16_C(48164), UINT16_C(39462), UINT16_C(11259), UINT16_C(18944), UINT16_C( 6856),
        UINT16_C(28629), UINT16_C(26863), UINT16_C(11093), UINT16_C(18968), UINT16_C(31976), UINT16_C(40681), UINT16_C(45578), UINT16_C(55652) },
      UINT16_C( 2919),
      { UINT16_C(56838), UINT16_C(10787), UINT16_C(19098), UINT16_C(38341), UINT16_C(50549), UINT16_C(15840), UINT16_C(46559), UINT16_C(53164),
        UINT16_C(  541), UINT16_C(13818), UINT16_C(58188), UINT16_C(13746), UINT16_C(48257), UINT16_C(59111), UINT16_C(20117), UINT16_C(39921) },
      { UINT16_C( 5420), UINT16_C(50885), UINT16_C(35423), UINT16_C(54364), UINT16_C(15440), UINT16_C(12049), UINT16_C(48881), UINT16_C( 3838),
        UINT16_C(63936), UINT16_C( 3140), UINT16_C(63196), UINT16_C(23873), UINT16_C(10674), UINT16_C(18243), UINT16_C(13687), UINT16_C(42210) },
      { UINT16_C(51418), UINT16_C(    0), UINT16_C(    0), UINT16_C(48164), UINT16_C(39462), UINT16_C( 3791), UINT16_C(    0), UINT16_C( 6856),
        UINT16_C(    0), UINT16_C(10678), UINT16_C(11093), UINT16_C(    0), UINT16_C(31976), UINT16_C(40681), UINT16_C(45578), UINT16_C(55652) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__m256i src = easysimd_mm256_loadu_epi16(test_vec[i].src);
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi16(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi16(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_mask_subs_epu16(src, k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_mask_subs_epu16");
    easysimd_test_x86_assert_equal_u16x16(r, easysimd_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__m256i src = easysimd_test_x86_random_u16x16();
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m256i a = easysimd_test_x86_random_u16x16();
    easysimd__m256i b = easysimd_test_x86_random_u16x16();
    easysimd__m256i r = easysimd_mm256_mask_subs_epu16(src, k, a, b);

    easysimd_test_x86_write_u16x16(2, src, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm256_maskz_subs_epu16 (EASYSIMD_MUNIT_TEST_ARGS) {
#if 1
  static const struct {
    const uint16_t k;
    const uint16_t a[16];
    const uint16_t b[16];
    const uint16_t r[16];
  } test_vec[] = {
    { UINT16_C(53888),
      { UINT16_C(64553), UINT16_C(54784), UINT16_C(41745), UINT16_C(22672), UINT16_C(50946), UINT16_C(45491), UINT16_C(26343), UINT16_C(42271),
        UINT16_C( 2316), UINT16_C( 4465), UINT16_C(43559), UINT16_C(35244), UINT16_C(20730), UINT16_C(22467), UINT16_C(17315), UINT16_C(52266) },
      { UINT16_C(10815), UINT16_C(20642), UINT16_C(13005), UINT16_C(53160), UINT16_C(23801), UINT16_C(57473), UINT16_C(41154), UINT16_C(52869),
        UINT16_C(63145), UINT16_C(53727), UINT16_C(35744), UINT16_C(39770), UINT16_C( 7643), UINT16_C(32498), UINT16_C( 7264), UINT16_C(40778) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(13087), UINT16_C(    0), UINT16_C(10051), UINT16_C(11488) } },
    { UINT16_C(60486),
      { UINT16_C( 5104), UINT16_C(38942), UINT16_C( 6115), UINT16_C(25844), UINT16_C(46839), UINT16_C(32004), UINT16_C(44677), UINT16_C(25715),
        UINT16_C( 5247), UINT16_C(55792), UINT16_C(52143), UINT16_C(41463), UINT16_C(22346), UINT16_C(38078), UINT16_C( 1271), UINT16_C(59265) },
      { UINT16_C(40728), UINT16_C(64383), UINT16_C(29879), UINT16_C(44639), UINT16_C(25386), UINT16_C(44843), UINT16_C(40721), UINT16_C(36884),
        UINT16_C( 1203), UINT16_C(25194), UINT16_C(25039), UINT16_C( 6403), UINT16_C(49592), UINT16_C(44974), UINT16_C(12230), UINT16_C(56982) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C( 3956), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(    0), UINT16_C(27104), UINT16_C(35060), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C( 2283) } },
    { UINT16_C( 5838),
      { UINT16_C(34265), UINT16_C(14474), UINT16_C(46132), UINT16_C(24475), UINT16_C(44388), UINT16_C(30974), UINT16_C(45373), UINT16_C(42876),
        UINT16_C(19219), UINT16_C( 5896), UINT16_C(49509), UINT16_C( 5080), UINT16_C(40560), UINT16_C( 1858), UINT16_C( 4220), UINT16_C(21789) },
      { UINT16_C(42902), UINT16_C(51853), UINT16_C(10587), UINT16_C(48937), UINT16_C(10454), UINT16_C( 4919), UINT16_C(46041), UINT16_C(60859),
        UINT16_C(50175), UINT16_C(25604), UINT16_C(56452), UINT16_C(62839), UINT16_C(47483), UINT16_C(63484), UINT16_C( 6601), UINT16_C(24397) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(35545), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } },
    { UINT16_C(56000),
      { UINT16_C( 6953), UINT16_C(21251), UINT16_C(55771), UINT16_C( 4731), UINT16_C(21741), UINT16_C(43206), UINT16_C(50497), UINT16_C(17771),
        UINT16_C(61481), UINT16_C(40994), UINT16_C(40421), UINT16_C(57689), UINT16_C( 8852), UINT16_C(57850), UINT16_C(47746), UINT16_C(43964) },
      { UINT16_C(49109), UINT16_C(45310), UINT16_C(31129), UINT16_C(34499), UINT16_C(35278), UINT16_C( 3886), UINT16_C(39246), UINT16_C(30549),
        UINT16_C(30601), UINT16_C(28183), UINT16_C(28692), UINT16_C(43087), UINT16_C(18834), UINT16_C( 5258), UINT16_C(17923), UINT16_C(55744) },
      { UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(11251), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(12811), UINT16_C(    0), UINT16_C(14602), UINT16_C(    0), UINT16_C(    0), UINT16_C(29823), UINT16_C(    0) } },
    { UINT16_C(48645),
      { UINT16_C(40585), UINT16_C(19512), UINT16_C( 1572), UINT16_C(21205), UINT16_C( 8981), UINT16_C(27372), UINT16_C(30106), UINT16_C(45537),
        UINT16_C(62948), UINT16_C(13089), UINT16_C(46238), UINT16_C(10365), UINT16_C(32968), UINT16_C(34926), UINT16_C(29529), UINT16_C(58183) },
      { UINT16_C(32530), UINT16_C(13871), UINT16_C( 1413), UINT16_C(39561), UINT16_C(29992), UINT16_C(49925), UINT16_C(59114), UINT16_C(52852),
        UINT16_C(38620), UINT16_C(31234), UINT16_C(32586), UINT16_C( 4770), UINT16_C( 4351), UINT16_C(22939), UINT16_C(57987), UINT16_C(38204) },
      { UINT16_C( 8055), UINT16_C(    0), UINT16_C(  159), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(    0), UINT16_C(13652), UINT16_C( 5595), UINT16_C(28617), UINT16_C(11987), UINT16_C(    0), UINT16_C(19979) } },
    { UINT16_C(27489),
      { UINT16_C(59084), UINT16_C(21872), UINT16_C(39296), UINT16_C(34250), UINT16_C(46172), UINT16_C(53356), UINT16_C(18563), UINT16_C(34150),
        UINT16_C(45250), UINT16_C(25604), UINT16_C(  963), UINT16_C(24180), UINT16_C(63324), UINT16_C(38976), UINT16_C(41357), UINT16_C(22788) },
      { UINT16_C(29831), UINT16_C( 1966), UINT16_C(30733), UINT16_C(27021), UINT16_C(63788), UINT16_C(44858), UINT16_C(41025), UINT16_C(  820),
        UINT16_C(14417), UINT16_C( 5223), UINT16_C(56124), UINT16_C(39026), UINT16_C(45778), UINT16_C(24369), UINT16_C(13651), UINT16_C(55992) },
      { UINT16_C(29253), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C( 8498), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(30833), UINT16_C(20381), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(14607), UINT16_C(27706), UINT16_C(    0) } },
    { UINT16_C(26281),
      { UINT16_C(47073), UINT16_C(28382), UINT16_C( 2848), UINT16_C(23143), UINT16_C(43194), UINT16_C(61435), UINT16_C(19627), UINT16_C( 4647),
        UINT16_C(25440), UINT16_C(53997), UINT16_C(49404), UINT16_C(11652), UINT16_C(55071), UINT16_C(55394), UINT16_C( 2993), UINT16_C(37438) },
      { UINT16_C( 7618), UINT16_C(58113), UINT16_C(26664), UINT16_C(57917), UINT16_C(14353), UINT16_C(48337), UINT16_C(63876), UINT16_C(58575),
        UINT16_C(48220), UINT16_C(22710), UINT16_C(14972), UINT16_C(40069), UINT16_C(59153), UINT16_C(49780), UINT16_C(45811), UINT16_C(46421) },
      { UINT16_C(39455), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(13098), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(31287), UINT16_C(34432), UINT16_C(    0), UINT16_C(    0), UINT16_C( 5614), UINT16_C(    0), UINT16_C(    0) } },
    { UINT16_C(22223),
      { UINT16_C(63384), UINT16_C(54974), UINT16_C(53210), UINT16_C(43790), UINT16_C(37772), UINT16_C(23460), UINT16_C(  375), UINT16_C(11799),
        UINT16_C(37977), UINT16_C(57192), UINT16_C(31280), UINT16_C(42182), UINT16_C(47420), UINT16_C(37206), UINT16_C( 9839), UINT16_C( 2023) },
      { UINT16_C(42525), UINT16_C(63453), UINT16_C(60533), UINT16_C(  419), UINT16_C(18303), UINT16_C(63068), UINT16_C(29768), UINT16_C(41508),
        UINT16_C(36104), UINT16_C(14465), UINT16_C(18183), UINT16_C(17372), UINT16_C(12801), UINT16_C(28885), UINT16_C(48216), UINT16_C(30327) },
      { UINT16_C(20859), UINT16_C(    0), UINT16_C(    0), UINT16_C(43371), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0),
        UINT16_C(    0), UINT16_C(42727), UINT16_C(13097), UINT16_C(    0), UINT16_C(34619), UINT16_C(    0), UINT16_C(    0), UINT16_C(    0) } }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])) ; i++) {
    easysimd__mmask16 k = test_vec[i].k;
    easysimd__m256i a = easysimd_mm256_loadu_epi16(test_vec[i].a);
    easysimd__m256i b = easysimd_mm256_loadu_epi16(test_vec[i].b);
    easysimd__m256i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm256_maskz_subs_epu16(k, a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm256_maskz_subs_epu16");
    easysimd_test_x86_assert_equal_u16x16(r, easysimd_mm256_loadu_epi16(test_vec[i].r));
  }

  return 0;
#else
  fputc('\n', stdout);
  for (int i = 0 ; i < 8 ; i++) {
    easysimd__mmask16 k = easysimd_test_x86_random_mmask16();
    easysimd__m256i a = easysimd_test_x86_random_u16x16();
    easysimd__m256i b = easysimd_test_x86_random_u16x16();
    easysimd__m256i r = easysimd_mm256_maskz_subs_epu16(k, a, b);

    easysimd_test_x86_write_mmask16(2, k, EASYSIMD_TEST_VEC_POS_FIRST);
    easysimd_test_x86_write_u16x16(2, a, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x16(2, b, EASYSIMD_TEST_VEC_POS_MIDDLE);
    easysimd_test_x86_write_u16x16(2, r, EASYSIMD_TEST_VEC_POS_LAST);
  }
  return 1;
#endif
}

static int
test_easysimd_mm512_subs_epi8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_mm512_set_epi8(INT8_C(  82), INT8_C(  83), INT8_C( 117), INT8_C(  65),
                           INT8_C( -47), INT8_C(-122), INT8_C( 116), INT8_C(  14),
                           INT8_C(  76), INT8_C(   1), INT8_C( -50), INT8_C(   4),
                           INT8_C(  83), INT8_C( -77), INT8_C( 112), INT8_C(-102),
                           INT8_C(  99), INT8_C(-118), INT8_C( -47), INT8_C( -67),
                           INT8_C(  60), INT8_C( -34), INT8_C(  78), INT8_C(-110),
                           INT8_C( -58), INT8_C(  87), INT8_C( -61), INT8_C(  26),
                           INT8_C( -17), INT8_C( -46), INT8_C( 116), INT8_C( -20),
                           INT8_C(-120), INT8_C(  48), INT8_C(  24), INT8_C(  46),
                           INT8_C( 103), INT8_C( -34), INT8_C(  42), INT8_C(  51),
                           INT8_C( -65), INT8_C(  86), INT8_C(  61), INT8_C( -56),
                           INT8_C(  58), INT8_C( 119), INT8_C(  93), INT8_C(  -1),
                           INT8_C( -58), INT8_C(-121), INT8_C( -32), INT8_C(  98),
                           INT8_C( -66), INT8_C(  79), INT8_C(  99), INT8_C( -93),
                           INT8_C(  77), INT8_C( -56), INT8_C( -78), INT8_C(  39),
                           INT8_C( -50), INT8_C( -60), INT8_C( -68), INT8_C(  -4)),
      easysimd_mm512_set_epi8(INT8_C( 106), INT8_C(  39), INT8_C(-106), INT8_C(  14),
                           INT8_C( -28), INT8_C(  -2), INT8_C(  39), INT8_C( -28),
                           INT8_C(  54), INT8_C(  70), INT8_C( -19), INT8_C( -12),
                           INT8_C( -42), INT8_C(  28), INT8_C( -13), INT8_C(  -6),
                           INT8_C( 116), INT8_C(   2), INT8_C(  23), INT8_C( 121),
                           INT8_C( 112), INT8_C( -35), INT8_C(-124), INT8_C(  10),
                           INT8_C( -16), INT8_C(-117), INT8_C(  26), INT8_C(-125),
                           INT8_C(  36), INT8_C( 109), INT8_C(  29), INT8_C( -35),
                           INT8_C(  -9), INT8_C( -85), INT8_C( -38), INT8_C(  95),
                           INT8_C( -88), INT8_C(   3), INT8_C(   4), INT8_C( 100),
                           INT8_C(  85), INT8_C(  21), INT8_C(  66), INT8_C( -33),
                           INT8_C( -77), INT8_C(  -5), INT8_C(-126), INT8_C( 122),
                           INT8_C( -30), INT8_C( -83), INT8_C(  74), INT8_C(-108),
                           INT8_C(  83), INT8_C( -96), INT8_C( -57), INT8_C(-108),
                           INT8_C(  89), INT8_C(  59), INT8_C( 111), INT8_C( -47),
                           INT8_C( -10), INT8_C( -18), INT8_C(  20), INT8_C(-125)),
      easysimd_mm512_set_epi8(INT8_C( -24), INT8_C(  44), INT8_C( 127), INT8_C(  51),
                           INT8_C( -19), INT8_C(-120), INT8_C(  77), INT8_C(  42),
                           INT8_C(  22), INT8_C( -69), INT8_C( -31), INT8_C(  16),
                           INT8_C( 125), INT8_C(-105), INT8_C( 125), INT8_C( -96),
                           INT8_C( -17), INT8_C(-120), INT8_C( -70), INT8_C(-128),
                           INT8_C( -52), INT8_C(   1), INT8_C( 127), INT8_C(-120),
                           INT8_C( -42), INT8_C( 127), INT8_C( -87), INT8_C( 127),
                           INT8_C( -53), INT8_C(-128), INT8_C(  87), INT8_C(  15),
                           INT8_C(-111), INT8_C( 127), INT8_C(  62), INT8_C( -49),
                           INT8_C( 127), INT8_C( -37), INT8_C(  38), INT8_C( -49),
                           INT8_C(-128), INT8_C(  65), INT8_C(  -5), INT8_C( -23),
                           INT8_C( 127), INT8_C( 124), INT8_C( 127), INT8_C(-123),
                           INT8_C( -28), INT8_C( -38), INT8_C(-106), INT8_C( 127),
                           INT8_C(-128), INT8_C( 127), INT8_C( 127), INT8_C(  15),
                           INT8_C( -12), INT8_C(-115), INT8_C(-128), INT8_C(  86),
                           INT8_C( -40), INT8_C( -42), INT8_C( -88), INT8_C( 121)) },
    { easysimd_mm512_set_epi8(INT8_C(-108), INT8_C(-116), INT8_C(  21), INT8_C(-123),
                           INT8_C( -53), INT8_C(  42), INT8_C(  66), INT8_C(  13),
                           INT8_C(   9), INT8_C( 115), INT8_C(  86), INT8_C( 126),
                           INT8_C( -24), INT8_C(  35), INT8_C(  -5), INT8_C( 103),
                           INT8_C(  38), INT8_C( 111), INT8_C(  24), INT8_C( -71),
                           INT8_C(  -1), INT8_C(  17), INT8_C( -63), INT8_C( -13),
                           INT8_C(  14), INT8_C(  82), INT8_C(  78), INT8_C(-102),
                           INT8_C(  -7), INT8_C(  93), INT8_C(  25), INT8_C( 103),
                           INT8_C( 113), INT8_C( -15), INT8_C( -19), INT8_C( -73),
                           INT8_C( -11), INT8_C( 103), INT8_C( -97), INT8_C( 123),
                           INT8_C(  28), INT8_C(  53), INT8_C( -15), INT8_C( 122),
                           INT8_C(   3), INT8_C( -54), INT8_C( -61), INT8_C(  58),
                           INT8_C( -44), INT8_C(  -3), INT8_C( -43), INT8_C( -35),
                           INT8_C(-118), INT8_C( -18), INT8_C(  15), INT8_C(  54),
                           INT8_C(-102), INT8_C( -58), INT8_C( -74), INT8_C( -70),
                           INT8_C(  46), INT8_C(  48), INT8_C( -35), INT8_C(  92)),
      easysimd_mm512_set_epi8(INT8_C(   6), INT8_C(  68), INT8_C(  77), INT8_C( -94),
                           INT8_C( -48), INT8_C(-101), INT8_C(  -8), INT8_C(  82),
                           INT8_C(  50), INT8_C( -15), INT8_C(   6), INT8_C(  30),
                           INT8_C( -47), INT8_C( -15), INT8_C( -14), INT8_C( -97),
                           INT8_C(  28), INT8_C( -47), INT8_C( -92), INT8_C( -84),
                           INT8_C( -37), INT8_C( -33), INT8_C(-123), INT8_C( -19),
                           INT8_C(  58), INT8_C(  29), INT8_C(  93), INT8_C( -55),
                           INT8_C(-127), INT8_C( -60), INT8_C(  32), INT8_C( 116),
                           INT8_C( -46), INT8_C(  51), INT8_C( -40), INT8_C(  10),
                           INT8_C(   4), INT8_C(  50), INT8_C(  48), INT8_C(  53),
                           INT8_C(  78), INT8_C(  21), INT8_C(  64), INT8_C( 107),
                           INT8_C(  16), INT8_C(  48), INT8_C( -46), INT8_C(  62),
                           INT8_C(  75), INT8_C(  85), INT8_C(-115), INT8_C( -14),
                           INT8_C( -99), INT8_C(  86), INT8_C(-116), INT8_C( -74),
                           INT8_C(  38), INT8_C(  27), INT8_C(-115), INT8_C(  55),
                           INT8_C( -91), INT8_C( -71), INT8_C( -14), INT8_C( -84)),
      easysimd_mm512_set_epi8(INT8_C(-114), INT8_C(-128), INT8_C( -56), INT8_C( -29),
                           INT8_C(  -5), INT8_C( 127), INT8_C(  74), INT8_C( -69),
                           INT8_C( -41), INT8_C( 127), INT8_C(  80), INT8_C(  96),
                           INT8_C(  23), INT8_C(  50), INT8_C(   9), INT8_C( 127),
                           INT8_C(  10), INT8_C( 127), INT8_C( 116), INT8_C(  13),
                           INT8_C(  36), INT8_C(  50), INT8_C(  60), INT8_C(   6),
                           INT8_C( -44), INT8_C(  53), INT8_C( -15), INT8_C( -47),
                           INT8_C( 120), INT8_C( 127), INT8_C(  -7), INT8_C( -13),
                           INT8_C( 127), INT8_C( -66), INT8_C(  21), INT8_C( -83),
                           INT8_C( -15), INT8_C(  53), INT8_C(-128), INT8_C(  70),
                           INT8_C( -50), INT8_C(  32), INT8_C( -79), INT8_C(  15),
                           INT8_C( -13), INT8_C(-102), INT8_C( -15), INT8_C(  -4),
                           INT8_C(-119), INT8_C( -88), INT8_C(  72), INT8_C( -21),
                           INT8_C( -19), INT8_C(-104), INT8_C( 127), INT8_C( 127),
                           INT8_C(-128), INT8_C( -85), INT8_C(  41), INT8_C(-125),
                           INT8_C( 127), INT8_C( 119), INT8_C( -21), INT8_C( 127)) },
    { easysimd_mm512_set_epi8(INT8_C(   2), INT8_C( -77), INT8_C( -19), INT8_C(  41),
                           INT8_C( -13), INT8_C(  75), INT8_C(-123), INT8_C(  96),
                           INT8_C( -86), INT8_C( -24), INT8_C( -27), INT8_C( -84),
                           INT8_C(  35), INT8_C( -86), INT8_C( -72), INT8_C( -97),
                           INT8_C(  44), INT8_C(  11), INT8_C(-106), INT8_C(  44),
                           INT8_C(   0), INT8_C(  90), INT8_C( -79), INT8_C(  91),
                           INT8_C( 119), INT8_C(  59), INT8_C( 105), INT8_C(-128),
                           INT8_C( 110), INT8_C( -29), INT8_C(  67), INT8_C( 114),
                           INT8_C( -39), INT8_C( -49), INT8_C( 105), INT8_C( -40),
                           INT8_C( -33), INT8_C( 120), INT8_C( -27), INT8_C( 100),
                           INT8_C( -90), INT8_C(  86), INT8_C( -18), INT8_C( -57),
                           INT8_C(  84), INT8_C( -26), INT8_C( -77), INT8_C(  17),
                           INT8_C( -47), INT8_C(  51), INT8_C( -83), INT8_C(  53),
                           INT8_C(  71), INT8_C(  96), INT8_C( 110), INT8_C( -89),
                           INT8_C(  27), INT8_C( -45), INT8_C(-126), INT8_C(  40),
                           INT8_C(  95), INT8_C( -87), INT8_C( -62), INT8_C( -52)),
      easysimd_mm512_set_epi8(INT8_C( -84), INT8_C( 127), INT8_C(  61), INT8_C( -16),
                           INT8_C(  30), INT8_C(   6), INT8_C(-112), INT8_C( 104),
                           INT8_C( -60), INT8_C( -88), INT8_C( -39), INT8_C( -19),
                           INT8_C(  44), INT8_C(  36), INT8_C( 105), INT8_C( 120),
                           INT8_C( -26), INT8_C(  21), INT8_C(  14), INT8_C(  42),
                           INT8_C(  49), INT8_C( -84), INT8_C(-120), INT8_C(-107),
                           INT8_C( 123), INT8_C( -47), INT8_C(  21), INT8_C( -10),
                           INT8_C(  95), INT8_C( 124), INT8_C( -33), INT8_C( -34),
                           INT8_C( -33), INT8_C( -71), INT8_C(  11), INT8_C(  74),
                           INT8_C( 104), INT8_C( 108), INT8_C( -35), INT8_C( -59),
                           INT8_C( -55), INT8_C(-126), INT8_C( 107), INT8_C(  23),
                           INT8_C(  29), INT8_C( -27), INT8_C( 123), INT8_C(  23),
                           INT8_C( -83), INT8_C( -90), INT8_C(   9), INT8_C(  94),
                           INT8_C(  91), INT8_C(  69), INT8_C( -51), INT8_C(-103),
                           INT8_C( -72), INT8_C( -45), INT8_C(  16), INT8_C( 108),
                           INT8_C( -80), INT8_C(  27), INT8_C(  58), INT8_C( -83)),
      easysimd_mm512_set_epi8(INT8_C(  86), INT8_C(-128), INT8_C( -80), INT8_C(  57),
                           INT8_C( -43), INT8_C(  69), INT8_C( -11), INT8_C(  -8),
                           INT8_C( -26), INT8_C(  64), INT8_C(  12), INT8_C( -65),
                           INT8_C(  -9), INT8_C(-122), INT8_C(-128), INT8_C(-128),
                           INT8_C(  70), INT8_C( -10), INT8_C(-120), INT8_C(   2),
                           INT8_C( -49), INT8_C( 127), INT8_C(  41), INT8_C( 127),
                           INT8_C(  -4), INT8_C( 106), INT8_C(  84), INT8_C(-118),
                           INT8_C(  15), INT8_C(-128), INT8_C( 100), INT8_C( 127),
                           INT8_C(  -6), INT8_C(  22), INT8_C(  94), INT8_C(-114),
                           INT8_C(-128), INT8_C(  12), INT8_C(   8), INT8_C( 127),
                           INT8_C( -35), INT8_C( 127), INT8_C(-125), INT8_C( -80),
                           INT8_C(  55), INT8_C(   1), INT8_C(-128), INT8_C(  -6),
                           INT8_C(  36), INT8_C( 127), INT8_C( -92), INT8_C( -41),
                           INT8_C( -20), INT8_C(  27), INT8_C( 127), INT8_C(  14),
                           INT8_C(  99), INT8_C(   0), INT8_C(-128), INT8_C( -68),
                           INT8_C( 127), INT8_C(-114), INT8_C(-120), INT8_C(  31)) },
    { easysimd_mm512_set_epi8(INT8_C(  17), INT8_C(  99), INT8_C( -13), INT8_C( -49),
                           INT8_C(  45), INT8_C(-128), INT8_C(  55), INT8_C( 105),
                           INT8_C( -34), INT8_C( -51), INT8_C( -97), INT8_C(-103),
                           INT8_C(-124), INT8_C( 111), INT8_C(  74), INT8_C(  75),
                           INT8_C( 102), INT8_C(  98), INT8_C(-117), INT8_C(   9),
                           INT8_C( -74), INT8_C(  61), INT8_C(  99), INT8_C( 124),
                           INT8_C(  79), INT8_C(-114), INT8_C(  19), INT8_C(  97),
                           INT8_C(-100), INT8_C(-124), INT8_C( -17), INT8_C( -62),
                           INT8_C(  25), INT8_C(  -3), INT8_C(  -7), INT8_C(  72),
                           INT8_C(-117), INT8_C( -27), INT8_C( -56), INT8_C(  92),
                           INT8_C( -20), INT8_C( -53), INT8_C(   2), INT8_C( -38),
                           INT8_C( -81), INT8_C(  59), INT8_C(  66), INT8_C(  90),
                           INT8_C(  36), INT8_C( 100), INT8_C( 112), INT8_C( 123),
                           INT8_C( -72), INT8_C( -97), INT8_C(-115), INT8_C(  17),
                           INT8_C( -93), INT8_C(-122), INT8_C(  31), INT8_C(  27),
                           INT8_C( 109), INT8_C( 115), INT8_C(  53), INT8_C( -96)),
      easysimd_mm512_set_epi8(INT8_C( -43), INT8_C( -18), INT8_C( 114), INT8_C( -29),
                           INT8_C( 118), INT8_C(  -1), INT8_C( -20), INT8_C( -38),
                           INT8_C( -80), INT8_C(  88), INT8_C(-111), INT8_C( -91),
                           INT8_C(  44), INT8_C( -72), INT8_C( 106), INT8_C(  19),
                           INT8_C( -46), INT8_C( 107), INT8_C(  46), INT8_C(  44),
                           INT8_C( -65), INT8_C(-128), INT8_C(  41), INT8_C(  44),
                           INT8_C(  68), INT8_C(  69), INT8_C( -78), INT8_C( -47),
                           INT8_C( 109), INT8_C( 120), INT8_C( -57), INT8_C( -95),
                           INT8_C(  95), INT8_C(  80), INT8_C( -30), INT8_C(  97),
                           INT8_C( -48), INT8_C( -97), INT8_C( 111), INT8_C( -80),
                           INT8_C(-122), INT8_C( -81), INT8_C( -71), INT8_C(  85),
                           INT8_C(  77), INT8_C( -42), INT8_C(-115), INT8_C( -77),
                           INT8_C(  29), INT8_C(  77), INT8_C(  64), INT8_C( -20),
                           INT8_C(  27), INT8_C(  41), INT8_C(  13), INT8_C( 109),
                           INT8_C(  22), INT8_C( -98), INT8_C(  20), INT8_C( -28),
                           INT8_C(  66), INT8_C(  -7), INT8_C(-113), INT8_C(-119)),
      easysimd_mm512_set_epi8(INT8_C(  60), INT8_C( 117), INT8_C(-127), INT8_C( -20),
                           INT8_C( -73), INT8_C(-127), INT8_C(  75), INT8_C( 127),
                           INT8_C(  46), INT8_C(-128), INT8_C(  14), INT8_C( -12),
                           INT8_C(-128), INT8_C( 127), INT8_C( -32), INT8_C(  56),
                           INT8_C( 127), INT8_C(  -9), INT8_C(-128), INT8_C( -35),
                           INT8_C(  -9), INT8_C( 127), INT8_C(  58), INT8_C(  80),
                           INT8_C(  11), INT8_C(-128), INT8_C(  97), INT8_C( 127),
                           INT8_C(-128), INT8_C(-128), INT8_C(  40), INT8_C(  33),
                           INT8_C( -70), INT8_C( -83), INT8_C(  23), INT8_C( -25),
                           INT8_C( -69), INT8_C(  70), INT8_C(-128), INT8_C( 127),
                           INT8_C( 102), INT8_C(  28), INT8_C(  73), INT8_C(-123),
                           INT8_C(-128), INT8_C( 101), INT8_C( 127), INT8_C( 127),
                           INT8_C(   7), INT8_C(  23), INT8_C(  48), INT8_C( 127),
                           INT8_C( -99), INT8_C(-128), INT8_C(-128), INT8_C( -92),
                           INT8_C(-115), INT8_C( -24), INT8_C(  11), INT8_C(  55),
                           INT8_C(  43), INT8_C( 122), INT8_C( 127), INT8_C(  23)) },
    { easysimd_mm512_set_epi8(INT8_C(-124), INT8_C( -73), INT8_C(  74), INT8_C(   5),
                           INT8_C(  -9), INT8_C(  17), INT8_C( -81), INT8_C( -54),
                           INT8_C(  -5), INT8_C( -33), INT8_C( -12), INT8_C(  26),
                           INT8_C(  86), INT8_C( 122), INT8_C( -44), INT8_C( -23),
                           INT8_C(   0), INT8_C(  43), INT8_C( -25), INT8_C(-122),
                           INT8_C( -79), INT8_C(-122), INT8_C( -88), INT8_C(-121),
                           INT8_C(-102), INT8_C(  66), INT8_C( -93), INT8_C( 105),
                           INT8_C( 109), INT8_C( -68), INT8_C(  24), INT8_C( -54),
                           INT8_C(  40), INT8_C(  68), INT8_C(   2), INT8_C(  60),
                           INT8_C(   0), INT8_C(   5), INT8_C(  59), INT8_C( -54),
                           INT8_C( -76), INT8_C(  27), INT8_C( -23), INT8_C(  77),
                           INT8_C(-108), INT8_C( -28), INT8_C(-114), INT8_C(  56),
                           INT8_C( -54), INT8_C(-108), INT8_C( -15), INT8_C( -89),
                           INT8_C(-103), INT8_C( -45), INT8_C(  74), INT8_C(  -3),
                           INT8_C(-108), INT8_C(  55), INT8_C( -79), INT8_C( -62),
                           INT8_C(  14), INT8_C( 106), INT8_C( -16), INT8_C( -10)),
      easysimd_mm512_set_epi8(INT8_C( -47), INT8_C( 124), INT8_C(  57), INT8_C( -74),
                           INT8_C(  20), INT8_C( 124), INT8_C(  70), INT8_C( -69),
                           INT8_C( -65), INT8_C( -12), INT8_C( 124), INT8_C( -90),
                           INT8_C(-113), INT8_C(  63), INT8_C( -79), INT8_C( -70),
                           INT8_C( -76), INT8_C( -34), INT8_C( -60), INT8_C(  -4),
                           INT8_C( -41), INT8_C(  60), INT8_C(  77), INT8_C( -57),
                           INT8_C(  13), INT8_C(   2), INT8_C( 111), INT8_C( -39),
                           INT8_C(  41), INT8_C(  54), INT8_C( -37), INT8_C( 114),
                           INT8_C(  92), INT8_C(-111), INT8_C(  77), INT8_C(  14),
                           INT8_C(-104), INT8_C( -39), INT8_C( -74), INT8_C(  66),
                           INT8_C(  16), INT8_C( -26), INT8_C( -89), INT8_C(-114),
                           INT8_C( -68), INT8_C(   6), INT8_C(  62), INT8_C( -93),
                           INT8_C(  55), INT8_C(-113), INT8_C( -60), INT8_C( -56),
                           INT8_C( -37), INT8_C(   2), INT8_C( -15), INT8_C(  88),
                           INT8_C(  26), INT8_C(  54), INT8_C(  82), INT8_C( 124),
                           INT8_C( -38), INT8_C(-107), INT8_C(  40), INT8_C(  13)),
      easysimd_mm512_set_epi8(INT8_C( -77), INT8_C(-128), INT8_C(  17), INT8_C(  79),
                           INT8_C( -29), INT8_C(-107), INT8_C(-128), INT8_C(  15),
                           INT8_C(  60), INT8_C( -21), INT8_C(-128), INT8_C( 116),
                           INT8_C( 127), INT8_C(  59), INT8_C(  35), INT8_C(  47),
                           INT8_C(  76), INT8_C(  77), INT8_C(  35), INT8_C(-118),
                           INT8_C( -38), INT8_C(-128), INT8_C(-128), INT8_C( -64),
                           INT8_C(-115), INT8_C(  64), INT8_C(-128), INT8_C( 127),
                           INT8_C(  68), INT8_C(-122), INT8_C(  61), INT8_C(-128),
                           INT8_C( -52), INT8_C( 127), INT8_C( -75), INT8_C(  46),
                           INT8_C( 104), INT8_C(  44), INT8_C( 127), INT8_C(-120),
                           INT8_C( -92), INT8_C(  53), INT8_C(  66), INT8_C( 127),
                           INT8_C( -40), INT8_C( -34), INT8_C(-128), INT8_C( 127),
                           INT8_C(-109), INT8_C(   5), INT8_C(  45), INT8_C( -33),
                           INT8_C( -66), INT8_C( -47), INT8_C(  89), INT8_C( -91),
                           INT8_C(-128), INT8_C(   1), INT8_C(-128), INT8_C(-128),
                           INT8_C(  52), INT8_C( 127), INT8_C( -56), INT8_C( -23)) },
    { easysimd_mm512_set_epi8(INT8_C(   5), INT8_C( -68), INT8_C( -18), INT8_C( -37),
                           INT8_C(   5), INT8_C(  16), INT8_C(-109), INT8_C( -67),
                           INT8_C( -62), INT8_C(  -4), INT8_C(  14), INT8_C(-109),
                           INT8_C( -29), INT8_C(-121), INT8_C(-109), INT8_C( -55),
                           INT8_C(   1), INT8_C( -38), INT8_C( 107), INT8_C(  55),
                           INT8_C( -36), INT8_C( -76), INT8_C(  35), INT8_C( -40),
                           INT8_C(  10), INT8_C( -90), INT8_C( -48), INT8_C(-112),
                           INT8_C(  -9), INT8_C( -53), INT8_C( 105), INT8_C(  27),
                           INT8_C( -97), INT8_C(-124), INT8_C(   4), INT8_C( -36),
                           INT8_C( -16), INT8_C( -87), INT8_C( -89), INT8_C(-104),
                           INT8_C( -30), INT8_C(-101), INT8_C(  69), INT8_C(  79),
                           INT8_C(  59), INT8_C( -97), INT8_C( -15), INT8_C(  17),
                           INT8_C( 106), INT8_C( -85), INT8_C( 126), INT8_C(-121),
                           INT8_C( -91), INT8_C(  26), INT8_C(-115), INT8_C(-117),
                           INT8_C(  91), INT8_C(  73), INT8_C( -60), INT8_C(  69),
                           INT8_C( -23), INT8_C(  48), INT8_C(  70), INT8_C(  -8)),
      easysimd_mm512_set_epi8(INT8_C(  91), INT8_C(-103), INT8_C(  69), INT8_C(  61),
                           INT8_C( -82), INT8_C(  73), INT8_C( 122), INT8_C( -22),
                           INT8_C( 122), INT8_C(  76), INT8_C(  -9), INT8_C( 121),
                           INT8_C(-123), INT8_C(-119), INT8_C(-127), INT8_C( 126),
                           INT8_C( 105), INT8_C(  10), INT8_C(-120), INT8_C(-127),
                           INT8_C( -50), INT8_C(  15), INT8_C( -93), INT8_C( -86),
                           INT8_C(-125), INT8_C(  45), INT8_C( -39), INT8_C(-119),
                           INT8_C(  74), INT8_C( -92), INT8_C( -78), INT8_C(  53),
                           INT8_C(  17), INT8_C( -21), INT8_C( 105), INT8_C(-102),
                           INT8_C(  -1), INT8_C( -19), INT8_C( 110), INT8_C( -84),
                           INT8_C( -93), INT8_C(  19), INT8_C( -98), INT8_C(-128),
                           INT8_C( -23), INT8_C(  49), INT8_C( 100), INT8_C( 122),
                           INT8_C( -96), INT8_C(-103), INT8_C(  60), INT8_C( -24),
                           INT8_C(  23), INT8_C( -52), INT8_C( -37), INT8_C( -56),
                           INT8_C( -50), INT8_C(   4), INT8_C( -69), INT8_C(   1),
                           INT8_C( -25), INT8_C( -10), INT8_C(  93), INT8_C(  51)),
      easysimd_mm512_set_epi8(INT8_C( -86), INT8_C(  35), INT8_C( -87), INT8_C( -98),
                           INT8_C(  87), INT8_C( -57), INT8_C(-128), INT8_C( -45),
                           INT8_C(-128), INT8_C( -80), INT8_C(  23), INT8_C(-128),
                           INT8_C(  94), INT8_C(  -2), INT8_C(  18), INT8_C(-128),
                           INT8_C(-104), INT8_C( -48), INT8_C( 127), INT8_C( 127),
                           INT8_C(  14), INT8_C( -91), INT8_C( 127), INT8_C(  46),
                           INT8_C( 127), INT8_C(-128), INT8_C(  -9), INT8_C(   7),
                           INT8_C( -83), INT8_C(  39), INT8_C( 127), INT8_C( -26),
                           INT8_C(-114), INT8_C(-103), INT8_C(-101), INT8_C(  66),
                           INT8_C( -15), INT8_C( -68), INT8_C(-128), INT8_C( -20),
                           INT8_C(  63), INT8_C(-120), INT8_C( 127), INT8_C( 127),
                           INT8_C(  82), INT8_C(-128), INT8_C(-115), INT8_C(-105),
                           INT8_C( 127), INT8_C(  18), INT8_C(  66), INT8_C( -97),
                           INT8_C(-114), INT8_C(  78), INT8_C( -78), INT8_C( -61),
                           INT8_C( 127), INT8_C(  69), INT8_C(   9), INT8_C(  68),
                           INT8_C(   2), INT8_C(  58), INT8_C( -23), INT8_C( -59)) },
    { easysimd_mm512_set_epi8(INT8_C( -89), INT8_C(  43), INT8_C(  52), INT8_C(  82),
                           INT8_C( -37), INT8_C(  55), INT8_C( 112), INT8_C( -22),
                           INT8_C( -75), INT8_C( -36), INT8_C( -34), INT8_C( -15),
                           INT8_C(  35), INT8_C( -42), INT8_C(-101), INT8_C(  -5),
                           INT8_C(   2), INT8_C(  35), INT8_C(  14), INT8_C( -73),
                           INT8_C( -50), INT8_C( -33), INT8_C( -65), INT8_C(  94),
                           INT8_C(  -6), INT8_C( -21), INT8_C( -28), INT8_C(  21),
                           INT8_C( 102), INT8_C( -87), INT8_C( 114), INT8_C( 125),
                           INT8_C( 113), INT8_C( 124), INT8_C(-121), INT8_C(-122),
                           INT8_C(  23), INT8_C( 107), INT8_C(  24), INT8_C( 126),
                           INT8_C(  80), INT8_C(  59), INT8_C(  39), INT8_C( -61),
                           INT8_C(-105), INT8_C(  32), INT8_C(  55), INT8_C(  -9),
                           INT8_C(  60), INT8_C(-125), INT8_C(  72), INT8_C( -36),
                           INT8_C(  77), INT8_C( -65), INT8_C( 117), INT8_C( -85),
                           INT8_C(  98), INT8_C( -83), INT8_C( -69), INT8_C( -52),
                           INT8_C(  41), INT8_C( -10), INT8_C( -18), INT8_C(  56)),
      easysimd_mm512_set_epi8(INT8_C(  22), INT8_C( 122), INT8_C( -90), INT8_C(   2),
                           INT8_C( -65), INT8_C(  51), INT8_C( -94), INT8_C( -50),
                           INT8_C( -15), INT8_C(  19), INT8_C( -19), INT8_C(  66),
                           INT8_C( 119), INT8_C(-118), INT8_C(-112), INT8_C(-116),
                           INT8_C(  44), INT8_C( -12), INT8_C(  31), INT8_C(  43),
                           INT8_C( -16), INT8_C( -37), INT8_C( -24), INT8_C( -32),
                           INT8_C( -95), INT8_C( -86), INT8_C( -96), INT8_C(  80),
                           INT8_C(  68), INT8_C(  13), INT8_C(  -8), INT8_C(  67),
                           INT8_C( 107), INT8_C(-125), INT8_C( 104), INT8_C( -80),
                           INT8_C(  97), INT8_C( -78), INT8_C( 106), INT8_C( -53),
                           INT8_C( -36), INT8_C( -90), INT8_C(  74), INT8_C( -72),
                           INT8_C(  59), INT8_C( -81), INT8_C(  -8), INT8_C( -25),
                           INT8_C( -55), INT8_C( -99), INT8_C(  20), INT8_C(   9),
                           INT8_C( -89), INT8_C( -90), INT8_C( 108), INT8_C(  56),
                           INT8_C( -19), INT8_C(  81), INT8_C( 122), INT8_C(   6),
                           INT8_C(-119), INT8_C( 122), INT8_C( -35), INT8_C( 106)),
      easysimd_mm512_set_epi8(INT8_C(-111), INT8_C( -79), INT8_C( 127), INT8_C(  80),
                           INT8_C(  28), INT8_C(   4), INT8_C( 127), INT8_C(  28),
                           INT8_C( -60), INT8_C( -55), INT8_C( -15), INT8_C( -81),
                           INT8_C( -84), INT8_C(  76), INT8_C(  11), INT8_C( 111),
                           INT8_C( -42), INT8_C(  47), INT8_C( -17), INT8_C(-116),
                           INT8_C( -34), INT8_C(   4), INT8_C( -41), INT8_C( 126),
                           INT8_C(  89), INT8_C(  65), INT8_C(  68), INT8_C( -59),
                           INT8_C(  34), INT8_C(-100), INT8_C( 122), INT8_C(  58),
                           INT8_C(   6), INT8_C( 127), INT8_C(-128), INT8_C( -42),
                           INT8_C( -74), INT8_C( 127), INT8_C( -82), INT8_C( 127),
                           INT8_C( 116), INT8_C( 127), INT8_C( -35), INT8_C(  11),
                           INT8_C(-128), INT8_C( 113), INT8_C(  63), INT8_C(  16),
                           INT8_C( 115), INT8_C( -26), INT8_C(  52), INT8_C( -45),
                           INT8_C( 127), INT8_C(  25), INT8_C(   9), INT8_C(-128),
                           INT8_C( 117), INT8_C(-128), INT8_C(-128), INT8_C( -58),
                           INT8_C( 127), INT8_C(-128), INT8_C(  17), INT8_C( -50)) },
    { easysimd_mm512_set_epi8(INT8_C( 105), INT8_C(-115), INT8_C( 121), INT8_C(-101),
                           INT8_C(   0), INT8_C(  63), INT8_C( -42), INT8_C( -34),
                           INT8_C(  -5), INT8_C( -47), INT8_C(-123), INT8_C( -52),
                           INT8_C( -86), INT8_C( -28), INT8_C( -63), INT8_C(  20),
                           INT8_C( -60), INT8_C( -63), INT8_C(  99), INT8_C(  78),
                           INT8_C(  56), INT8_C( -72), INT8_C( -55), INT8_C( -72),
                           INT8_C(  79), INT8_C( -81), INT8_C( 124), INT8_C( -85),
                           INT8_C( -65), INT8_C( 122), INT8_C( -25), INT8_C( -58),
                           INT8_C( -64), INT8_C(  52), INT8_C( -12), INT8_C(   1),
                           INT8_C( -62), INT8_C( -28), INT8_C( -28), INT8_C(-104),
                           INT8_C(  54), INT8_C(-103), INT8_C( -55), INT8_C( -22),
                           INT8_C( -91), INT8_C(   6), INT8_C(  -9), INT8_C( -31),
                           INT8_C(  18), INT8_C(-111), INT8_C(  58), INT8_C(  71),
                           INT8_C( -73), INT8_C( -96), INT8_C(  28), INT8_C(  -4),
                           INT8_C(  47), INT8_C(  66), INT8_C( 121), INT8_C(  38),
                           INT8_C(  69), INT8_C(-107), INT8_C( -57), INT8_C(-120)),
      easysimd_mm512_set_epi8(INT8_C( -49), INT8_C(  15), INT8_C( -15), INT8_C( -59),
                           INT8_C(-113), INT8_C( 102), INT8_C( -48), INT8_C( -78),
                           INT8_C(  31), INT8_C(  94), INT8_C(  79), INT8_C(  92),
                           INT8_C( 106), INT8_C( -68), INT8_C(  96), INT8_C( -97),
                           INT8_C( -27), INT8_C(-118), INT8_C( -11), INT8_C( 112),
                           INT8_C(-125), INT8_C(  70), INT8_C(  26), INT8_C( -38),
                           INT8_C( -16), INT8_C(-112), INT8_C(  10), INT8_C(  98),
                           INT8_C(  -4), INT8_C( 120), INT8_C( -33), INT8_C(-127),
                           INT8_C( -65), INT8_C( -40), INT8_C(  88), INT8_C(  -6),
                           INT8_C(  74), INT8_C(  41), INT8_C(  39), INT8_C(  79),
                           INT8_C(-125), INT8_C(  -7), INT8_C(  62), INT8_C(-112),
                           INT8_C(-119), INT8_C(  -9), INT8_C(  71), INT8_C( -68),
                           INT8_C( -79), INT8_C(  48), INT8_C( -20), INT8_C( -97),
                           INT8_C(-116), INT8_C( 120), INT8_C( -65), INT8_C(   6),
                           INT8_C( -32), INT8_C( -75), INT8_C(-106), INT8_C(  26),
                           INT8_C( -96), INT8_C(  50), INT8_C( -45), INT8_C(  16)),
      easysimd_mm512_set_epi8(INT8_C( 127), INT8_C(-128), INT8_C( 127), INT8_C( -42),
                           INT8_C( 113), INT8_C( -39), INT8_C(   6), INT8_C(  44),
                           INT8_C( -36), INT8_C(-128), INT8_C(-128), INT8_C(-128),
                           INT8_C(-128), INT8_C(  40), INT8_C(-128), INT8_C( 117),
                           INT8_C( -33), INT8_C(  55), INT8_C( 110), INT8_C( -34),
                           INT8_C( 127), INT8_C(-128), INT8_C( -81), INT8_C( -34),
                           INT8_C(  95), INT8_C(  31), INT8_C( 114), INT8_C(-128),
                           INT8_C( -61), INT8_C(   2), INT8_C(   8), INT8_C(  69),
                           INT8_C(   1), INT8_C(  92), INT8_C(-100), INT8_C(   7),
                           INT8_C(-128), INT8_C( -69), INT8_C( -67), INT8_C(-128),
                           INT8_C( 127), INT8_C( -96), INT8_C(-117), INT8_C(  90),
                           INT8_C(  28), INT8_C(  15), INT8_C( -80), INT8_C(  37),
                           INT8_C(  97), INT8_C(-128), INT8_C(  78), INT8_C( 127),
                           INT8_C(  43), INT8_C(-128), INT8_C(  93), INT8_C( -10),
                           INT8_C(  79), INT8_C( 127), INT8_C( 127), INT8_C(  12),
                           INT8_C( 127), INT8_C(-128), INT8_C( -12), INT8_C(-128)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_subs_epi8(a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_subs_epi8");
    easysimd_assert_m512i_i8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_mask_subs_epi8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i src;
    easysimd__mmask64 k;
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_mm512_set_epi8(INT8_C(  52), INT8_C(-124), INT8_C( -17), INT8_C(  -9),
                           INT8_C(  31), INT8_C(  67), INT8_C( -76), INT8_C(  -4),
                           INT8_C( -52), INT8_C(  99), INT8_C( 106), INT8_C( -35),
                           INT8_C(-115), INT8_C(-127), INT8_C( 121), INT8_C( -60),
                           INT8_C( -27), INT8_C(  73), INT8_C( -21), INT8_C( -51),
                           INT8_C(-127), INT8_C(  68), INT8_C( 109), INT8_C(  35),
                           INT8_C(  96), INT8_C(   3), INT8_C( -62), INT8_C( -43),
                           INT8_C( -75), INT8_C( 102), INT8_C(-105), INT8_C(  63),
                           INT8_C(  64), INT8_C( 114), INT8_C( 112), INT8_C(  10),
                           INT8_C( 108), INT8_C(  71), INT8_C( -40), INT8_C(  20),
                           INT8_C( -40), INT8_C(  26), INT8_C( -94), INT8_C( 107),
                           INT8_C( -89), INT8_C(  22), INT8_C(  55), INT8_C( 105),
                           INT8_C(  23), INT8_C(  52), INT8_C(  82), INT8_C(  50),
                           INT8_C( -48), INT8_C(  77), INT8_C(  73), INT8_C(  98),
                           INT8_C( -85), INT8_C( 123), INT8_C(  15), INT8_C(  36),
                           INT8_C(-103), INT8_C(  18), INT8_C( -81), INT8_C(   9)),
      UINT64_C(          2070647823),
      easysimd_mm512_set_epi8(INT8_C(  87), INT8_C( 118), INT8_C(  10), INT8_C( -53),
                           INT8_C( -21), INT8_C( -77), INT8_C(  81), INT8_C(  16),
                           INT8_C( 125), INT8_C(  53), INT8_C( -93), INT8_C( -44),
                           INT8_C( -14), INT8_C( -81), INT8_C(  93), INT8_C( -81),
                           INT8_C(  69), INT8_C(  88), INT8_C(  17), INT8_C(-127),
                           INT8_C(  49), INT8_C(  91), INT8_C(  55), INT8_C( -23),
                           INT8_C( -84), INT8_C(  12), INT8_C( -97), INT8_C( -75),
                           INT8_C(  99), INT8_C(  54), INT8_C( -92), INT8_C( -28),
                           INT8_C(  -2), INT8_C(  69), INT8_C(-102), INT8_C(  42),
                           INT8_C(  41), INT8_C(-101), INT8_C( -59), INT8_C( -72),
                           INT8_C( -53), INT8_C( -47), INT8_C( -78), INT8_C(  67),
                           INT8_C(  54), INT8_C(  12), INT8_C( -65), INT8_C( 101),
                           INT8_C(  77), INT8_C( -96), INT8_C( -15), INT8_C(  66),
                           INT8_C(  50), INT8_C(   9), INT8_C( -75), INT8_C( 102),
                           INT8_C(   2), INT8_C( -31), INT8_C(  83), INT8_C( -71),
                           INT8_C( -84), INT8_C( -66), INT8_C(-111), INT8_C(  -2)),
      easysimd_mm512_set_epi8(INT8_C(  87), INT8_C(-105), INT8_C(  96), INT8_C( -79),
                           INT8_C(  99), INT8_C(  74), INT8_C(  20), INT8_C( 120),
                           INT8_C(  60), INT8_C(  49), INT8_C( 101), INT8_C( -94),
                           INT8_C(  -5), INT8_C( 114), INT8_C(  17), INT8_C(   1),
                           INT8_C(  36), INT8_C( -92), INT8_C(  39), INT8_C(-108),
                           INT8_C( -15), INT8_C(  14), INT8_C( -15), INT8_C(  79),
                           INT8_C( 112), INT8_C( 108), INT8_C( -44), INT8_C( -18),
                           INT8_C( 125), INT8_C(  93), INT8_C( -92), INT8_C( -51),
                           INT8_C(  21), INT8_C( -19), INT8_C( -56), INT8_C( 114),
                           INT8_C( -95), INT8_C(  40), INT8_C( -27), INT8_C( -85),
                           INT8_C(  26), INT8_C(  29), INT8_C( -30), INT8_C(  53),
                           INT8_C( -69), INT8_C( -26), INT8_C(  79), INT8_C(-124),
                           INT8_C( -35), INT8_C( -29), INT8_C( -59), INT8_C( -99),
                           INT8_C(-118), INT8_C(  30), INT8_C( 105), INT8_C(   3),
                           INT8_C(  -2), INT8_C(  26), INT8_C(-121), INT8_C( 115),
                           INT8_C( -78), INT8_C(  10), INT8_C(   6), INT8_C( -16)),
      easysimd_mm512_set_epi8(INT8_C(  52), INT8_C(-124), INT8_C( -17), INT8_C(  -9),
                           INT8_C(  31), INT8_C(  67), INT8_C( -76), INT8_C(  -4),
                           INT8_C( -52), INT8_C(  99), INT8_C( 106), INT8_C( -35),
                           INT8_C(-115), INT8_C(-127), INT8_C( 121), INT8_C( -60),
                           INT8_C( -27), INT8_C(  73), INT8_C( -21), INT8_C( -51),
                           INT8_C(-127), INT8_C(  68), INT8_C( 109), INT8_C(  35),
                           INT8_C(  96), INT8_C(   3), INT8_C( -62), INT8_C( -43),
                           INT8_C( -75), INT8_C( 102), INT8_C(-105), INT8_C(  63),
                           INT8_C(  64), INT8_C(  88), INT8_C( -46), INT8_C( -72),
                           INT8_C( 127), INT8_C(  71), INT8_C( -32), INT8_C(  13),
                           INT8_C( -40), INT8_C( -76), INT8_C( -48), INT8_C( 107),
                           INT8_C( 123), INT8_C(  22), INT8_C(-128), INT8_C( 127),
                           INT8_C( 112), INT8_C(  52), INT8_C(  82), INT8_C( 127),
                           INT8_C( -48), INT8_C( -21), INT8_C(  73), INT8_C(  98),
                           INT8_C( -85), INT8_C( 123), INT8_C(  15), INT8_C(  36),
                           INT8_C(  -6), INT8_C( -76), INT8_C(-117), INT8_C(  14)) },
    { easysimd_mm512_set_epi8(INT8_C( -60), INT8_C( -92), INT8_C( -73), INT8_C( -20),
                           INT8_C( -84), INT8_C( -11), INT8_C( -28), INT8_C(-123),
                           INT8_C( -48), INT8_C(-118), INT8_C(-107), INT8_C(  73),
                           INT8_C( -80), INT8_C(  46), INT8_C(-117), INT8_C( -85),
                           INT8_C( -21), INT8_C( -54), INT8_C( -49), INT8_C(  -8),
                           INT8_C(  51), INT8_C( 126), INT8_C(  22), INT8_C(  70),
                           INT8_C( -86), INT8_C( -98), INT8_C( -17), INT8_C( -29),
                           INT8_C(  75), INT8_C( 115), INT8_C(  61), INT8_C(  76),
                           INT8_C( -65), INT8_C(  43), INT8_C( -13), INT8_C(  -2),
                           INT8_C(  81), INT8_C( -26), INT8_C(  -6), INT8_C( -15),
                           INT8_C( -40), INT8_C(  72), INT8_C(  66), INT8_C(  32),
                           INT8_C(  22), INT8_C( -74), INT8_C( -73), INT8_C(  67),
                           INT8_C(  75), INT8_C( -18), INT8_C( -97), INT8_C(  75),
                           INT8_C( -47), INT8_C(  32), INT8_C(  26), INT8_C(-108),
                           INT8_C(  31), INT8_C( 110), INT8_C(-101), INT8_C( -57),
                           INT8_C(  28), INT8_C( -50), INT8_C( -16), INT8_C(  37)),
      UINT64_C(          3026541283),
      easysimd_mm512_set_epi8(INT8_C( -66), INT8_C( -12), INT8_C( -24), INT8_C(-107),
                           INT8_C(-117), INT8_C(  63), INT8_C(  42), INT8_C(  79),
                           INT8_C( -78), INT8_C( -79), INT8_C( -22), INT8_C( -52),
                           INT8_C( -78), INT8_C(  -8), INT8_C( -61), INT8_C( 101),
                           INT8_C(-111), INT8_C(  35), INT8_C( -89), INT8_C( 127),
                           INT8_C(  50), INT8_C(-115), INT8_C(  91), INT8_C( -72),
                           INT8_C( -97), INT8_C( -34), INT8_C( -80), INT8_C( -31),
                           INT8_C( -60), INT8_C( 119), INT8_C(-106), INT8_C(  66),
                           INT8_C(  75), INT8_C(-108), INT8_C(-113), INT8_C( 120),
                           INT8_C(  36), INT8_C( 112), INT8_C( -45), INT8_C(  41),
                           INT8_C(  90), INT8_C( -32), INT8_C(  22), INT8_C(  86),
                           INT8_C(  72), INT8_C( -20), INT8_C(  -4), INT8_C(-125),
                           INT8_C( -37), INT8_C(  84), INT8_C( -95), INT8_C( -66),
                           INT8_C( 109), INT8_C(  18), INT8_C( 120), INT8_C(-115),
                           INT8_C(  83), INT8_C(  26), INT8_C(-108), INT8_C(-128),
                           INT8_C( 113), INT8_C( -65), INT8_C(  84), INT8_C( -78)),
      easysimd_mm512_set_epi8(INT8_C(-100), INT8_C(-107), INT8_C( 106), INT8_C( -87),
                           INT8_C(  61), INT8_C( -94), INT8_C(   7), INT8_C(  84),
                           INT8_C(  25), INT8_C(  77), INT8_C(  24), INT8_C(  35),
                           INT8_C(  56), INT8_C( -72), INT8_C(  65), INT8_C( -77),
                           INT8_C(  81), INT8_C( 110), INT8_C( 109), INT8_C(  26),
                           INT8_C( -46), INT8_C(   6), INT8_C(  -4), INT8_C( -76),
                           INT8_C(  49), INT8_C(  67), INT8_C( -22), INT8_C(  12),
                           INT8_C(  66), INT8_C( -76), INT8_C( -71), INT8_C(  20),
                           INT8_C( -11), INT8_C(  97), INT8_C(  20), INT8_C(  -1),
                           INT8_C(  69), INT8_C(  54), INT8_C( -68), INT8_C( 104),
                           INT8_C(  61), INT8_C( -16), INT8_C( -52), INT8_C( -98),
                           INT8_C(-126), INT8_C(-109), INT8_C(  86), INT8_C(  51),
                           INT8_C(  95), INT8_C( -88), INT8_C(   6), INT8_C(-121),
                           INT8_C(  49), INT8_C(  97), INT8_C( -69), INT8_C( 125),
                           INT8_C(  57), INT8_C(  79), INT8_C(   6), INT8_C(   7),
                           INT8_C(  37), INT8_C(-119), INT8_C( -51), INT8_C(  99)),
      easysimd_mm512_set_epi8(INT8_C( -60), INT8_C( -92), INT8_C( -73), INT8_C( -20),
                           INT8_C( -84), INT8_C( -11), INT8_C( -28), INT8_C(-123),
                           INT8_C( -48), INT8_C(-118), INT8_C(-107), INT8_C(  73),
                           INT8_C( -80), INT8_C(  46), INT8_C(-117), INT8_C( -85),
                           INT8_C( -21), INT8_C( -54), INT8_C( -49), INT8_C(  -8),
                           INT8_C(  51), INT8_C( 126), INT8_C(  22), INT8_C(  70),
                           INT8_C( -86), INT8_C( -98), INT8_C( -17), INT8_C( -29),
                           INT8_C(  75), INT8_C( 115), INT8_C(  61), INT8_C(  76),
                           INT8_C(  86), INT8_C(  43), INT8_C(-128), INT8_C( 121),
                           INT8_C(  81), INT8_C(  58), INT8_C(  -6), INT8_C( -15),
                           INT8_C( -40), INT8_C( -16), INT8_C(  74), INT8_C(  32),
                           INT8_C(  22), INT8_C(  89), INT8_C( -73), INT8_C(-128),
                           INT8_C(  75), INT8_C( 127), INT8_C( -97), INT8_C(  55),
                           INT8_C(  60), INT8_C(  32), INT8_C( 127), INT8_C(-108),
                           INT8_C(  26), INT8_C( -53), INT8_C(-114), INT8_C( -57),
                           INT8_C(  28), INT8_C( -50), INT8_C( 127), INT8_C(-128)) },
    { easysimd_mm512_set_epi8(INT8_C(  66), INT8_C(  28), INT8_C( -53), INT8_C(  48),
                           INT8_C( -75), INT8_C( -97), INT8_C( -42), INT8_C(  47),
                           INT8_C( -33), INT8_C( -17), INT8_C( 113), INT8_C( 120),
                           INT8_C(-111), INT8_C(  14), INT8_C(  77), INT8_C(-108),
                           INT8_C(  25), INT8_C( -42), INT8_C( 109), INT8_C( -97),
                           INT8_C( -19), INT8_C( -18), INT8_C(  -1), INT8_C( -50),
                           INT8_C( -87), INT8_C( -70), INT8_C(  94), INT8_C( -91),
                           INT8_C(  23), INT8_C(  33), INT8_C( -10), INT8_C(  81),
                           INT8_C(  81), INT8_C( -63), INT8_C(  35), INT8_C(  44),
                           INT8_C(  11), INT8_C(-124), INT8_C( -20), INT8_C(  71),
                           INT8_C( -25), INT8_C(-112), INT8_C(   2), INT8_C(  59),
                           INT8_C(  21), INT8_C(-113), INT8_C(  35), INT8_C( -40),
                           INT8_C( -89), INT8_C( -74), INT8_C( -34), INT8_C( 115),
                           INT8_C( -51), INT8_C(  30), INT8_C(-104), INT8_C( 117),
                           INT8_C( 127), INT8_C(  -8), INT8_C(  57), INT8_C( -73),
                           INT8_C(  40), INT8_C(  -7), INT8_C(  90), INT8_C(-110)),
      UINT64_C(          3345097188),
      easysimd_mm512_set_epi8(INT8_C(  58), INT8_C(-128), INT8_C(-123), INT8_C(  -3),
                           INT8_C(  74), INT8_C( -78), INT8_C(-124), INT8_C( -30),
                           INT8_C(  21), INT8_C(  86), INT8_C( -53), INT8_C(-116),
                           INT8_C(-126), INT8_C(  10), INT8_C(-123), INT8_C( -78),
                           INT8_C(   2), INT8_C( 100), INT8_C( -90), INT8_C( -79),
                           INT8_C( -46), INT8_C( -83), INT8_C(  11), INT8_C(-120),
                           INT8_C( -56), INT8_C(  -4), INT8_C( -39), INT8_C(-114),
                           INT8_C( -98), INT8_C(-108), INT8_C( -22), INT8_C(  24),
                           INT8_C( 127), INT8_C( -20), INT8_C(   7), INT8_C( -16),
                           INT8_C(  -8), INT8_C(  19), INT8_C( 119), INT8_C( -44),
                           INT8_C(   7), INT8_C( -47), INT8_C(-126), INT8_C(-119),
                           INT8_C(   1), INT8_C( 111), INT8_C( -95), INT8_C( -67),
                           INT8_C(  38), INT8_C( -19), INT8_C(  96), INT8_C( -21),
                           INT8_C( -76), INT8_C(-123), INT8_C(-115), INT8_C( -61),
                           INT8_C(  96), INT8_C(  30), INT8_C( 105), INT8_C(  -4),
                           INT8_C(  44), INT8_C(  54), INT8_C(  89), INT8_C(  40)),
      easysimd_mm512_set_epi8(INT8_C( -42), INT8_C(  43), INT8_C(   6), INT8_C( -97),
                           INT8_C( -90), INT8_C(  -4), INT8_C( -71), INT8_C(  33),
                           INT8_C(   1), INT8_C(   3), INT8_C( -91), INT8_C( -62),
                           INT8_C(-106), INT8_C(  -6), INT8_C(  35), INT8_C(  67),
                           INT8_C(  97), INT8_C(  46), INT8_C(  89), INT8_C(  56),
                           INT8_C( -84), INT8_C( -39), INT8_C( -70), INT8_C(  78),
                           INT8_C( -49), INT8_C(  94), INT8_C(  -1), INT8_C( -23),
                           INT8_C( -88), INT8_C( -11), INT8_C(-128), INT8_C( -62),
                           INT8_C( 106), INT8_C( 125), INT8_C( -71), INT8_C( -96),
                           INT8_C( -28), INT8_C( -58), INT8_C( -40), INT8_C( -32),
                           INT8_C( -13), INT8_C( -84), INT8_C( -69), INT8_C( -40),
                           INT8_C(-122), INT8_C( 117), INT8_C( 115), INT8_C( -87),
                           INT8_C( 101), INT8_C( -82), INT8_C( -68), INT8_C( -48),
                           INT8_C(  42), INT8_C(  29), INT8_C(  67), INT8_C(   9),
                           INT8_C( -44), INT8_C(  54), INT8_C(-101), INT8_C( -13),
                           INT8_C( 111), INT8_C( 110), INT8_C( 114), INT8_C( -57)),
      easysimd_mm512_set_epi8(INT8_C(  66), INT8_C(  28), INT8_C( -53), INT8_C(  48),
                           INT8_C( -75), INT8_C( -97), INT8_C( -42), INT8_C(  47),
                           INT8_C( -33), INT8_C( -17), INT8_C( 113), INT8_C( 120),
                           INT8_C(-111), INT8_C(  14), INT8_C(  77), INT8_C(-108),
                           INT8_C(  25), INT8_C( -42), INT8_C( 109), INT8_C( -97),
                           INT8_C( -19), INT8_C( -18), INT8_C(  -1), INT8_C( -50),
                           INT8_C( -87), INT8_C( -70), INT8_C(  94), INT8_C( -91),
                           INT8_C(  23), INT8_C(  33), INT8_C( -10), INT8_C(  81),
                           INT8_C(  21), INT8_C(-128), INT8_C(  35), INT8_C(  44),
                           INT8_C(  11), INT8_C(  77), INT8_C( 127), INT8_C( -12),
                           INT8_C( -25), INT8_C(  37), INT8_C( -57), INT8_C(  59),
                           INT8_C(  21), INT8_C(-113), INT8_C(-128), INT8_C( -40),
                           INT8_C( -89), INT8_C( -74), INT8_C( 127), INT8_C( 115),
                           INT8_C( -51), INT8_C(  30), INT8_C(-104), INT8_C( -70),
                           INT8_C( 127), INT8_C( -24), INT8_C( 127), INT8_C( -73),
                           INT8_C(  40), INT8_C( -56), INT8_C(  90), INT8_C(-110)) },
    { easysimd_mm512_set_epi8(INT8_C( 127), INT8_C(  66), INT8_C(  63), INT8_C( -46),
                           INT8_C(  90), INT8_C(  39), INT8_C( -89), INT8_C(-105),
                           INT8_C( -51), INT8_C( -46), INT8_C( 111), INT8_C( -45),
                           INT8_C( -76), INT8_C(-112), INT8_C( -37), INT8_C(-120),
                           INT8_C(  50), INT8_C( -97), INT8_C(  -2), INT8_C( 121),
                           INT8_C(  68), INT8_C(-106), INT8_C( 101), INT8_C( 115),
                           INT8_C( -29), INT8_C(  59), INT8_C(  77), INT8_C( -36),
                           INT8_C( 111), INT8_C(  95), INT8_C(  48), INT8_C( 113),
                           INT8_C( -97), INT8_C( 105), INT8_C( -37), INT8_C( -42),
                           INT8_C(  -7), INT8_C(  31), INT8_C(  45), INT8_C(  -5),
                           INT8_C( -29), INT8_C(  44), INT8_C(  78), INT8_C( -25),
                           INT8_C( -47), INT8_C(-119), INT8_C( -90), INT8_C( 115),
                           INT8_C(  44), INT8_C(  94), INT8_C( 127), INT8_C( -12),
                           INT8_C(  90), INT8_C( 111), INT8_C( -20), INT8_C(-110),
                           INT8_C( -82), INT8_C( -19), INT8_C( -79), INT8_C(-128),
                           INT8_C(  -6), INT8_C(-119), INT8_C( 100), INT8_C( 125)),
      UINT64_C(          1390729414),
      easysimd_mm512_set_epi8(INT8_C(  89), INT8_C(  39), INT8_C( 109), INT8_C( 109),
                           INT8_C( -71), INT8_C( -81), INT8_C(  67), INT8_C(  48),
                           INT8_C( -43), INT8_C(  31), INT8_C( -36), INT8_C( -53),
                           INT8_C(  -7), INT8_C(  84), INT8_C( -92), INT8_C( 124),
                           INT8_C( -22), INT8_C(  31), INT8_C(  42), INT8_C(-103),
                           INT8_C(  29), INT8_C(  75), INT8_C( -91), INT8_C(  75),
                           INT8_C( 107), INT8_C(  62), INT8_C( 126), INT8_C(   7),
                           INT8_C( -89), INT8_C( 119), INT8_C(  79), INT8_C( -38),
                           INT8_C(  18), INT8_C(  57), INT8_C(-102), INT8_C(  66),
                           INT8_C(  -7), INT8_C(  89), INT8_C(  57), INT8_C( -55),
                           INT8_C( -68), INT8_C(  21), INT8_C( -21), INT8_C(  -6),
                           INT8_C( -26), INT8_C( 122), INT8_C( 114), INT8_C(  83),
                           INT8_C(  80), INT8_C( 103), INT8_C( 109), INT8_C( -19),
                           INT8_C( -24), INT8_C( -48), INT8_C(  79), INT8_C(   5),
                           INT8_C(  66), INT8_C( -40), INT8_C( -14), INT8_C( -56),
                           INT8_C( -68), INT8_C( -68), INT8_C(-124), INT8_C( -65)),
      easysimd_mm512_set_epi8(INT8_C(-102), INT8_C(-123), INT8_C(  20), INT8_C(  36),
                           INT8_C(  70), INT8_C( -95), INT8_C(  63), INT8_C( 110),
                           INT8_C(  98), INT8_C(-128), INT8_C( -74), INT8_C( -50),
                           INT8_C(  17), INT8_C( -37), INT8_C(-104), INT8_C( -74),
                           INT8_C(  -4), INT8_C(  15), INT8_C( -59), INT8_C(  62),
                           INT8_C( -89), INT8_C( 103), INT8_C(  -5), INT8_C(  71),
                           INT8_C( 103), INT8_C(-119), INT8_C( -62), INT8_C( -47),
                           INT8_C( -78), INT8_C(  32), INT8_C( 104), INT8_C(  33),
                           INT8_C( -45), INT8_C( -54), INT8_C(  17), INT8_C(-117),
                           INT8_C(  96), INT8_C(  66), INT8_C( -18), INT8_C( -58),
                           INT8_C(-111), INT8_C(-110), INT8_C( -14), INT8_C(   7),
                           INT8_C(  85), INT8_C(-113), INT8_C(  19), INT8_C( -72),
                           INT8_C(  51), INT8_C( -49), INT8_C(  69), INT8_C( -80),
                           INT8_C(  34), INT8_C(  87), INT8_C(  88), INT8_C( -38),
                           INT8_C( -14), INT8_C( -30), INT8_C(-111), INT8_C( -87),
                           INT8_C(  37), INT8_C(  40), INT8_C( -30), INT8_C( -40)),
      easysimd_mm512_set_epi8(INT8_C( 127), INT8_C(  66), INT8_C(  63), INT8_C( -46),
                           INT8_C(  90), INT8_C(  39), INT8_C( -89), INT8_C(-105),
                           INT8_C( -51), INT8_C( -46), INT8_C( 111), INT8_C( -45),
                           INT8_C( -76), INT8_C(-112), INT8_C( -37), INT8_C(-120),
                           INT8_C(  50), INT8_C( -97), INT8_C(  -2), INT8_C( 121),
                           INT8_C(  68), INT8_C(-106), INT8_C( 101), INT8_C( 115),
                           INT8_C( -29), INT8_C(  59), INT8_C(  77), INT8_C( -36),
                           INT8_C( 111), INT8_C(  95), INT8_C(  48), INT8_C( 113),
                           INT8_C( -97), INT8_C( 111), INT8_C( -37), INT8_C( 127),
                           INT8_C(  -7), INT8_C(  31), INT8_C(  75), INT8_C(  -5),
                           INT8_C(  43), INT8_C( 127), INT8_C(  -7), INT8_C( -25),
                           INT8_C( -47), INT8_C( 127), INT8_C( -90), INT8_C( 115),
                           INT8_C(  29), INT8_C( 127), INT8_C( 127), INT8_C(  61),
                           INT8_C( -58), INT8_C( 111), INT8_C( -20), INT8_C(-110),
                           INT8_C(  80), INT8_C( -10), INT8_C( -79), INT8_C(-128),
                           INT8_C(  -6), INT8_C(-108), INT8_C( -94), INT8_C( 125)) },
    { easysimd_mm512_set_epi8(INT8_C(  91), INT8_C(  46), INT8_C( -16), INT8_C(  27),
                           INT8_C( -66), INT8_C( -93), INT8_C( -43), INT8_C(  14),
                           INT8_C( 100), INT8_C(-113), INT8_C(  32), INT8_C(  15),
                           INT8_C( -79), INT8_C(  63), INT8_C( -18), INT8_C( -96),
                           INT8_C(-119), INT8_C( 114), INT8_C( -87), INT8_C( -82),
                           INT8_C(  76), INT8_C( 117), INT8_C(  14), INT8_C( -65),
                           INT8_C( -37), INT8_C( -15), INT8_C(  43), INT8_C(   5),
                           INT8_C(-108), INT8_C(  -5), INT8_C( -84), INT8_C(  13),
                           INT8_C( -66), INT8_C(  80), INT8_C( -20), INT8_C(  34),
                           INT8_C(-122), INT8_C(-101), INT8_C( -91), INT8_C( -35),
                           INT8_C(  57), INT8_C( 117), INT8_C( -26), INT8_C( 112),
                           INT8_C(  59), INT8_C(  54), INT8_C(  91), INT8_C(-111),
                           INT8_C( 111), INT8_C(  34), INT8_C( -76), INT8_C(  65),
                           INT8_C( -31), INT8_C(  25), INT8_C( -63), INT8_C(-128),
                           INT8_C( -28), INT8_C(  80), INT8_C( -75), INT8_C(  83),
                           INT8_C( -23), INT8_C( -65), INT8_C( -75), INT8_C( -10)),
      UINT64_C(          2530018527),
      easysimd_mm512_set_epi8(INT8_C(  54), INT8_C( 110), INT8_C( -53), INT8_C( 100),
                           INT8_C(  94), INT8_C(  -2), INT8_C(  72), INT8_C(  95),
                           INT8_C( -61), INT8_C( -31), INT8_C(   2), INT8_C(  88),
                           INT8_C(  69), INT8_C(-117), INT8_C(  33), INT8_C( -57),
                           INT8_C( -67), INT8_C(  92), INT8_C( -31), INT8_C( -16),
                           INT8_C(-115), INT8_C( -91), INT8_C(   0), INT8_C( -73),
                           INT8_C(  -3), INT8_C( -71), INT8_C(  55), INT8_C( -82),
                           INT8_C( -28), INT8_C( -34), INT8_C( -40), INT8_C(  60),
                           INT8_C(  31), INT8_C(-113), INT8_C(  90), INT8_C( 114),
                           INT8_C(  73), INT8_C(  77), INT8_C( -29), INT8_C(  80),
                           INT8_C(-106), INT8_C( 121), INT8_C(-122), INT8_C(  -4),
                           INT8_C( 104), INT8_C( -76), INT8_C(  85), INT8_C( -33),
                           INT8_C( -62), INT8_C(  96), INT8_C( -27), INT8_C( -88),
                           INT8_C( -35), INT8_C( -58), INT8_C( -83), INT8_C(  36),
                           INT8_C( -16), INT8_C(  50), INT8_C(-127), INT8_C( -82),
                           INT8_C( 106), INT8_C(  56), INT8_C(  74), INT8_C( -59)),
      easysimd_mm512_set_epi8(INT8_C( -24), INT8_C( -30), INT8_C(  27), INT8_C( -44),
                           INT8_C( -74), INT8_C( -85), INT8_C( -66), INT8_C(  26),
                           INT8_C( -69), INT8_C( 112), INT8_C( -22), INT8_C(  62),
                           INT8_C(  24), INT8_C(-107), INT8_C( -41), INT8_C( -21),
                           INT8_C(  68), INT8_C( -34), INT8_C( 109), INT8_C(  58),
                           INT8_C(  16), INT8_C( -72), INT8_C( -84), INT8_C(  18),
                           INT8_C( -73), INT8_C( -54), INT8_C(  16), INT8_C( -93),
                           INT8_C( -51), INT8_C( -50), INT8_C(  54), INT8_C( -69),
                           INT8_C( -98), INT8_C(-113), INT8_C( -73), INT8_C(-124),
                           INT8_C( -65), INT8_C( -51), INT8_C(  43), INT8_C(  10),
                           INT8_C( -79), INT8_C(  35), INT8_C( -67), INT8_C(  69),
                           INT8_C(  84), INT8_C( -44), INT8_C( -48), INT8_C(  89),
                           INT8_C(  96), INT8_C(-100), INT8_C( -47), INT8_C( 114),
                           INT8_C(-109), INT8_C(   8), INT8_C(  51), INT8_C( 120),
                           INT8_C( -12), INT8_C(-128), INT8_C(  -4), INT8_C(-105),
                           INT8_C(  83), INT8_C(-123), INT8_C( -98), INT8_C(  -2)),
      easysimd_mm512_set_epi8(INT8_C(  91), INT8_C(  46), INT8_C( -16), INT8_C(  27),
                           INT8_C( -66), INT8_C( -93), INT8_C( -43), INT8_C(  14),
                           INT8_C( 100), INT8_C(-113), INT8_C(  32), INT8_C(  15),
                           INT8_C( -79), INT8_C(  63), INT8_C( -18), INT8_C( -96),
                           INT8_C(-119), INT8_C( 114), INT8_C( -87), INT8_C( -82),
                           INT8_C(  76), INT8_C( 117), INT8_C(  14), INT8_C( -65),
                           INT8_C( -37), INT8_C( -15), INT8_C(  43), INT8_C(   5),
                           INT8_C(-108), INT8_C(  -5), INT8_C( -84), INT8_C(  13),
                           INT8_C( 127), INT8_C(  80), INT8_C( -20), INT8_C( 127),
                           INT8_C(-122), INT8_C( 127), INT8_C( -72), INT8_C( -35),
                           INT8_C( -27), INT8_C(  86), INT8_C( -26), INT8_C( 112),
                           INT8_C(  20), INT8_C( -32), INT8_C(  91), INT8_C(-122),
                           INT8_C( 111), INT8_C(  34), INT8_C( -76), INT8_C(  65),
                           INT8_C( -31), INT8_C( -66), INT8_C( -63), INT8_C(-128),
                           INT8_C(  -4), INT8_C( 127), INT8_C( -75), INT8_C(  23),
                           INT8_C(  23), INT8_C( 127), INT8_C( 127), INT8_C( -57)) },
    { easysimd_mm512_set_epi8(INT8_C( 125), INT8_C( -29), INT8_C( 116), INT8_C( -26),
                           INT8_C(  78), INT8_C(  37), INT8_C( -43), INT8_C(  45),
                           INT8_C( -81), INT8_C(-109), INT8_C(  26), INT8_C( -51),
                           INT8_C( -54), INT8_C(  99), INT8_C( 124), INT8_C(   2),
                           INT8_C(  10), INT8_C(   6), INT8_C( -77), INT8_C( -61),
                           INT8_C(  59), INT8_C(  60), INT8_C(  42), INT8_C(  33),
                           INT8_C( 126), INT8_C(  88), INT8_C(  41), INT8_C(  66),
                           INT8_C(  98), INT8_C( 111), INT8_C(  94), INT8_C( -70),
                           INT8_C( 116), INT8_C( -40), INT8_C( -88), INT8_C(  13),
                           INT8_C(  50), INT8_C(  54), INT8_C(  32), INT8_C( -48),
                           INT8_C(  85), INT8_C(  12), INT8_C( -17), INT8_C(  78),
                           INT8_C(   2), INT8_C( -46), INT8_C(  21), INT8_C(  89),
                           INT8_C( -58), INT8_C( -19), INT8_C(  -7), INT8_C( -46),
                           INT8_C(  58), INT8_C( 120), INT8_C( -85), INT8_C(  46),
                           INT8_C(  80), INT8_C( -20), INT8_C(  94), INT8_C(  32),
                           INT8_C( -61), INT8_C(  80), INT8_C( -39), INT8_C( 109)),
      UINT64_C(          1874542844),
      easysimd_mm512_set_epi8(INT8_C(-100), INT8_C(   8), INT8_C( -30), INT8_C( -66),
                           INT8_C( -36), INT8_C( -55), INT8_C(-115), INT8_C(  64),
                           INT8_C(  70), INT8_C(  -8), INT8_C(-128), INT8_C(  84),
                           INT8_C( 103), INT8_C( -54), INT8_C(  15), INT8_C( -45),
                           INT8_C(-118), INT8_C( -27), INT8_C(  32), INT8_C( -75),
                           INT8_C(  62), INT8_C(  67), INT8_C( -42), INT8_C(   4),
                           INT8_C(  16), INT8_C(  45), INT8_C(  43), INT8_C(  21),
                           INT8_C(  14), INT8_C( -97), INT8_C( -37), INT8_C(  -6),
                           INT8_C(-100), INT8_C( -82), INT8_C(  58), INT8_C(  88),
                           INT8_C(  61), INT8_C(  74), INT8_C(   5), INT8_C(  44),
                           INT8_C(  61), INT8_C( -83), INT8_C(  68), INT8_C(  -3),
                           INT8_C(  41), INT8_C( 117), INT8_C( 116), INT8_C( -16),
                           INT8_C(  48), INT8_C( -35), INT8_C(  -2), INT8_C(  -9),
                           INT8_C( -72), INT8_C(  97), INT8_C(-100), INT8_C( 120),
                           INT8_C( -96), INT8_C(  21), INT8_C(  35), INT8_C(  38),
                           INT8_C( -30), INT8_C(  81), INT8_C(-111), INT8_C(  42)),
      easysimd_mm512_set_epi8(INT8_C( -63), INT8_C( 101), INT8_C( -21), INT8_C( -29),
                           INT8_C( -58), INT8_C(  75), INT8_C( -46), INT8_C(  -8),
                           INT8_C( -92), INT8_C(  68), INT8_C(  64), INT8_C(  71),
                           INT8_C(  50), INT8_C( -60), INT8_C(  45), INT8_C(  13),
                           INT8_C( 106), INT8_C(  39), INT8_C(  64), INT8_C(  94),
                           INT8_C( -73), INT8_C(  90), INT8_C( -93), INT8_C(-109),
                           INT8_C(-100), INT8_C(  76), INT8_C(  29), INT8_C( -99),
                           INT8_C(  84), INT8_C(  37), INT8_C(  69), INT8_C( 125),
                           INT8_C( -66), INT8_C( 106), INT8_C(  75), INT8_C(-109),
                           INT8_C(  19), INT8_C( 119), INT8_C( 108), INT8_C(  52),
                           INT8_C( -69), INT8_C(  84), INT8_C(   6), INT8_C(  75),
                           INT8_C(   9), INT8_C(-103), INT8_C( -24), INT8_C(   9),
                           INT8_C( -42), INT8_C( 127), INT8_C(  47), INT8_C( -53),
                           INT8_C(  93), INT8_C(  18), INT8_C(  -4), INT8_C( -42),
                           INT8_C( -20), INT8_C(  12), INT8_C( 100), INT8_C( -66),
                           INT8_C( -56), INT8_C( -47), INT8_C( -16), INT8_C( 104)),
      easysimd_mm512_set_epi8(INT8_C( 125), INT8_C( -29), INT8_C( 116), INT8_C( -26),
                           INT8_C(  78), INT8_C(  37), INT8_C( -43), INT8_C(  45),
                           INT8_C( -81), INT8_C(-109), INT8_C(  26), INT8_C( -51),
                           INT8_C( -54), INT8_C(  99), INT8_C( 124), INT8_C(   2),
                           INT8_C(  10), INT8_C(   6), INT8_C( -77), INT8_C( -61),
                           INT8_C(  59), INT8_C(  60), INT8_C(  42), INT8_C(  33),
                           INT8_C( 126), INT8_C(  88), INT8_C(  41), INT8_C(  66),
                           INT8_C(  98), INT8_C( 111), INT8_C(  94), INT8_C( -70),
                           INT8_C( 116), INT8_C(-128), INT8_C( -17), INT8_C(  13),
                           INT8_C(  42), INT8_C( -45), INT8_C(-103), INT8_C(  -8),
                           INT8_C( 127), INT8_C(  12), INT8_C(  62), INT8_C( -78),
                           INT8_C(  32), INT8_C( -46), INT8_C( 127), INT8_C( -25),
                           INT8_C( -58), INT8_C(-128), INT8_C(  -7), INT8_C( -46),
                           INT8_C(  58), INT8_C( 120), INT8_C( -85), INT8_C(  46),
                           INT8_C( -76), INT8_C(   9), INT8_C( -65), INT8_C( 104),
                           INT8_C(  26), INT8_C( 127), INT8_C( -39), INT8_C( 109)) },
    { easysimd_mm512_set_epi8(INT8_C(-105), INT8_C( -37), INT8_C(  57), INT8_C( -65),
                           INT8_C( -18), INT8_C( -12), INT8_C( -19), INT8_C( 108),
                           INT8_C(-104), INT8_C( -75), INT8_C(  90), INT8_C(  70),
                           INT8_C( -27), INT8_C(  72), INT8_C(  24), INT8_C( -76),
                           INT8_C( -96), INT8_C(-123), INT8_C(  29), INT8_C(-106),
                           INT8_C(  55), INT8_C( 118), INT8_C(  81), INT8_C(  39),
                           INT8_C( -71), INT8_C( -44), INT8_C( 102), INT8_C( -78),
                           INT8_C( -31), INT8_C( -59), INT8_C(  63), INT8_C(   2),
                           INT8_C(-102), INT8_C(  50), INT8_C(  51), INT8_C(-105),
                           INT8_C( -79), INT8_C(  83), INT8_C(  28), INT8_C( 101),
                           INT8_C(  60), INT8_C( -89), INT8_C(-127), INT8_C(  40),
                           INT8_C(  37), INT8_C( -30), INT8_C( -95), INT8_C( -95),
                           INT8_C( -12), INT8_C( -31), INT8_C(  -9), INT8_C(  29),
                           INT8_C(  10), INT8_C(  43), INT8_C(  -6), INT8_C( -78),
                           INT8_C( -94), INT8_C( 107), INT8_C( 111), INT8_C(   4),
                           INT8_C(  -9), INT8_C(  42), INT8_C( -92), INT8_C(  29)),
      UINT64_C(          3975530942),
      easysimd_mm512_set_epi8(INT8_C( -43), INT8_C(  17), INT8_C(-121), INT8_C(  17),
                           INT8_C( -38), INT8_C(  95), INT8_C(  94), INT8_C( -34),
                           INT8_C(  26), INT8_C(-107), INT8_C(  37), INT8_C(-105),
                           INT8_C(  52), INT8_C(  37), INT8_C(  92), INT8_C( -72),
                           INT8_C( -33), INT8_C( -75), INT8_C( -94), INT8_C(   1),
                           INT8_C( -71), INT8_C(  17), INT8_C(-112), INT8_C( -35),
                           INT8_C(  16), INT8_C( 122), INT8_C( -73), INT8_C(  18),
                           INT8_C(  88), INT8_C(  56), INT8_C( -10), INT8_C( -55),
                           INT8_C( 123), INT8_C(-125), INT8_C( -53), INT8_C(  -1),
                           INT8_C(   2), INT8_C(  36), INT8_C( 121), INT8_C( -35),
                           INT8_C(  48), INT8_C(  77), INT8_C( 102), INT8_C( -56),
                           INT8_C(  57), INT8_C( -53), INT8_C( -69), INT8_C( -26),
                           INT8_C( -26), INT8_C(  90), INT8_C(  94), INT8_C(  84),
                           INT8_C( -13), INT8_C(  64), INT8_C( 115), INT8_C(-119),
                           INT8_C( 126), INT8_C(  83), INT8_C(  55), INT8_C( -37),
                           INT8_C( -59), INT8_C(  31), INT8_C(  24), INT8_C(  17)),
      easysimd_mm512_set_epi8(INT8_C(  74), INT8_C(  90), INT8_C(  31), INT8_C(  63),
                           INT8_C( -50), INT8_C(   3), INT8_C(  34), INT8_C( -98),
                           INT8_C( -18), INT8_C(-126), INT8_C(  83), INT8_C(  80),
                           INT8_C(  21), INT8_C( 114), INT8_C( -45), INT8_C( -76),
                           INT8_C( -10), INT8_C( -63), INT8_C( -36), INT8_C(-104),
                           INT8_C( -48), INT8_C( -29), INT8_C( -85), INT8_C(   3),
                           INT8_C(-112), INT8_C( -72), INT8_C(  68), INT8_C(   5),
                           INT8_C( -84), INT8_C( -48), INT8_C(-110), INT8_C(-128),
                           INT8_C(  89), INT8_C( -17), INT8_C(  -2), INT8_C( -14),
                           INT8_C(  61), INT8_C(  40), INT8_C( -41), INT8_C(  78),
                           INT8_C( -65), INT8_C(  82), INT8_C( -97), INT8_C(-107),
                           INT8_C(  36), INT8_C(  59), INT8_C( -78), INT8_C(  61),
                           INT8_C(   9), INT8_C(  86), INT8_C( 122), INT8_C(   2),
                           INT8_C(  27), INT8_C( 124), INT8_C( -38), INT8_C(  23),
                           INT8_C( -78), INT8_C(  48), INT8_C(  17), INT8_C(  54),
                           INT8_C( 116), INT8_C(-115), INT8_C( 105), INT8_C( -48)),
      easysimd_mm512_set_epi8(INT8_C(-105), INT8_C( -37), INT8_C(  57), INT8_C( -65),
                           INT8_C( -18), INT8_C( -12), INT8_C( -19), INT8_C( 108),
                           INT8_C(-104), INT8_C( -75), INT8_C(  90), INT8_C(  70),
                           INT8_C( -27), INT8_C(  72), INT8_C(  24), INT8_C( -76),
                           INT8_C( -96), INT8_C(-123), INT8_C(  29), INT8_C(-106),
                           INT8_C(  55), INT8_C( 118), INT8_C(  81), INT8_C(  39),
                           INT8_C( -71), INT8_C( -44), INT8_C( 102), INT8_C( -78),
                           INT8_C( -31), INT8_C( -59), INT8_C(  63), INT8_C(   2),
                           INT8_C(  34), INT8_C(-108), INT8_C( -51), INT8_C(-105),
                           INT8_C( -59), INT8_C(  -4), INT8_C(  28), INT8_C( 101),
                           INT8_C( 113), INT8_C(  -5), INT8_C( 127), INT8_C(  51),
                           INT8_C(  37), INT8_C(-112), INT8_C( -95), INT8_C( -87),
                           INT8_C( -35), INT8_C(   4), INT8_C(  -9), INT8_C(  29),
                           INT8_C( -40), INT8_C(  43), INT8_C(  -6), INT8_C(-128),
                           INT8_C( 127), INT8_C( 107), INT8_C(  38), INT8_C( -91),
                           INT8_C(-128), INT8_C( 127), INT8_C( -81), INT8_C(  29)) },
    { easysimd_mm512_set_epi8(INT8_C( -61), INT8_C( -50), INT8_C( -30), INT8_C( 100),
                           INT8_C( -32), INT8_C(-100), INT8_C(   0), INT8_C( -53),
                           INT8_C( -74), INT8_C(  41), INT8_C(  37), INT8_C(  44),
                           INT8_C(   4), INT8_C( -98), INT8_C(  73), INT8_C( -60),
                           INT8_C(  85), INT8_C(  11), INT8_C(  90), INT8_C(  41),
                           INT8_C(  94), INT8_C( 105), INT8_C(  -3), INT8_C( -61),
                           INT8_C( 118), INT8_C( -95), INT8_C(-121), INT8_C( -38),
                           INT8_C(-104), INT8_C(  36), INT8_C(  86), INT8_C(  49),
                           INT8_C( 118), INT8_C( -55), INT8_C( -12), INT8_C( -47),
                           INT8_C(  98), INT8_C(  69), INT8_C(-107), INT8_C( 120),
                           INT8_C(  49), INT8_C( 116), INT8_C( -55), INT8_C( -29),
                           INT8_C(  93), INT8_C(-120), INT8_C( 116), INT8_C(  -2),
                           INT8_C(-100), INT8_C(-116), INT8_C( -60), INT8_C( -65),
                           INT8_C(  55), INT8_C(  64), INT8_C( -42), INT8_C( -46),
                           INT8_C(-101), INT8_C(  -6), INT8_C( -22), INT8_C(  36),
                           INT8_C( 111), INT8_C( -33), INT8_C(  84), INT8_C(  25)),
      UINT64_C(          2085281943),
      easysimd_mm512_set_epi8(INT8_C( 125), INT8_C(   0), INT8_C(  14), INT8_C(  82),
                           INT8_C(  68), INT8_C( -35), INT8_C( -43), INT8_C(  -7),
                           INT8_C(  68), INT8_C( 127), INT8_C( -94), INT8_C( -60),
                           INT8_C( -16), INT8_C( -81), INT8_C(-125), INT8_C(  75),
                           INT8_C(  -5), INT8_C( 103), INT8_C(  97), INT8_C( -56),
                           INT8_C(   5), INT8_C(  -6), INT8_C(  40), INT8_C(  58),
                           INT8_C( 106), INT8_C(-112), INT8_C( -85), INT8_C(   2),
                           INT8_C(  42), INT8_C( -58), INT8_C( -70), INT8_C( -97),
                           INT8_C(  95), INT8_C(  14), INT8_C( 116), INT8_C( -67),
                           INT8_C(   1), INT8_C(  68), INT8_C( -54), INT8_C( -13),
                           INT8_C( -11), INT8_C( -60), INT8_C( -44), INT8_C( 102),
                           INT8_C(  -9), INT8_C( -71), INT8_C( -51), INT8_C(  40),
                           INT8_C(   0), INT8_C( -81), INT8_C(  85), INT8_C(-103),
                           INT8_C(  21), INT8_C( 112), INT8_C(  59), INT8_C( -49),
                           INT8_C( -57), INT8_C(  28), INT8_C( -72), INT8_C( -76),
                           INT8_C( -32), INT8_C( -46), INT8_C( -10), INT8_C(  43)),
      easysimd_mm512_set_epi8(INT8_C(  65), INT8_C(  28), INT8_C( 112), INT8_C(  84),
                           INT8_C( -84), INT8_C(  90), INT8_C(  43), INT8_C( -27),
                           INT8_C(  82), INT8_C( -68), INT8_C( -29), INT8_C(-114),
                           INT8_C(  96), INT8_C(  68), INT8_C(  41), INT8_C(  -5),
                           INT8_C(  60), INT8_C(  55), INT8_C(  65), INT8_C(  51),
                           INT8_C(-116), INT8_C(  90), INT8_C( 113), INT8_C(  72),
                           INT8_C( 119), INT8_C( -14), INT8_C(  52), INT8_C(  73),
                           INT8_C( -28), INT8_C( -61), INT8_C(  83), INT8_C(  94),
                           INT8_C( 116), INT8_C( -75), INT8_C(   6), INT8_C( -97),
                           INT8_C( 114), INT8_C( 125), INT8_C( -13), INT8_C( -39),
                           INT8_C( -76), INT8_C( -78), INT8_C( 126), INT8_C(  42),
                           INT8_C( -31), INT8_C(-119), INT8_C(  44), INT8_C( -13),
                           INT8_C(  39), INT8_C(  26), INT8_C( 103), INT8_C( 126),
                           INT8_C( -63), INT8_C( -48), INT8_C( -12), INT8_C(  54),
                           INT8_C( -42), INT8_C(  31), INT8_C(   1), INT8_C( 119),
                           INT8_C( -34), INT8_C( -59), INT8_C(-107), INT8_C( 102)),
      easysimd_mm512_set_epi8(INT8_C( -61), INT8_C( -50), INT8_C( -30), INT8_C( 100),
                           INT8_C( -32), INT8_C(-100), INT8_C(   0), INT8_C( -53),
                           INT8_C( -74), INT8_C(  41), INT8_C(  37), INT8_C(  44),
                           INT8_C(   4), INT8_C( -98), INT8_C(  73), INT8_C( -60),
                           INT8_C(  85), INT8_C(  11), INT8_C(  90), INT8_C(  41),
                           INT8_C(  94), INT8_C( 105), INT8_C(  -3), INT8_C( -61),
                           INT8_C( 118), INT8_C( -95), INT8_C(-121), INT8_C( -38),
                           INT8_C(-104), INT8_C(  36), INT8_C(  86), INT8_C(  49),
                           INT8_C( 118), INT8_C(  89), INT8_C( 110), INT8_C(  30),
                           INT8_C(-113), INT8_C( -57), INT8_C(-107), INT8_C( 120),
                           INT8_C(  49), INT8_C(  18), INT8_C( -55), INT8_C( -29),
                           INT8_C(  22), INT8_C(-120), INT8_C( -95), INT8_C(  -2),
                           INT8_C( -39), INT8_C(-107), INT8_C( -18), INT8_C( -65),
                           INT8_C(  55), INT8_C(  64), INT8_C( -42), INT8_C( -46),
                           INT8_C( -15), INT8_C(  -6), INT8_C( -22), INT8_C(-128),
                           INT8_C( 111), INT8_C(  13), INT8_C(  97), INT8_C( -59)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i r = easysimd_mm512_mask_subs_epi8(test_vec[i].src, test_vec[i].k, test_vec[i].a, test_vec[i].b);
    easysimd_assert_m512i_i8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_maskz_subs_epi8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__mmask64 k;
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { UINT64_C(          2568138505),
      easysimd_mm512_set_epi8(INT8_C(  65), INT8_C( -91), INT8_C( -13), INT8_C( 114),
                           INT8_C( 123), INT8_C( 107), INT8_C(-108), INT8_C(  15),
                           INT8_C(  52), INT8_C(-124), INT8_C( -17), INT8_C(  -9),
                           INT8_C(  31), INT8_C(  67), INT8_C( -76), INT8_C(  -4),
                           INT8_C( -52), INT8_C(  99), INT8_C( 106), INT8_C( -35),
                           INT8_C(-115), INT8_C(-127), INT8_C( 121), INT8_C( -60),
                           INT8_C( -27), INT8_C(  73), INT8_C( -21), INT8_C( -51),
                           INT8_C(-127), INT8_C(  68), INT8_C( 109), INT8_C(  35),
                           INT8_C(  96), INT8_C(   3), INT8_C( -62), INT8_C( -43),
                           INT8_C( -75), INT8_C( 102), INT8_C(-105), INT8_C(  63),
                           INT8_C(  64), INT8_C( 114), INT8_C( 112), INT8_C(  10),
                           INT8_C( 108), INT8_C(  71), INT8_C( -40), INT8_C(  20),
                           INT8_C( -40), INT8_C(  26), INT8_C( -94), INT8_C( 107),
                           INT8_C( -89), INT8_C(  22), INT8_C(  55), INT8_C( 105),
                           INT8_C(  23), INT8_C(  52), INT8_C(  82), INT8_C(  50),
                           INT8_C( -48), INT8_C(  77), INT8_C(  73), INT8_C(  98)),
      easysimd_mm512_set_epi8(INT8_C(  87), INT8_C( 118), INT8_C(  10), INT8_C( -53),
                           INT8_C( -21), INT8_C( -77), INT8_C(  81), INT8_C(  16),
                           INT8_C( 125), INT8_C(  53), INT8_C( -93), INT8_C( -44),
                           INT8_C( -14), INT8_C( -81), INT8_C(  93), INT8_C( -81),
                           INT8_C(  69), INT8_C(  88), INT8_C(  17), INT8_C(-127),
                           INT8_C(  49), INT8_C(  91), INT8_C(  55), INT8_C( -23),
                           INT8_C( -84), INT8_C(  12), INT8_C( -97), INT8_C( -75),
                           INT8_C(  99), INT8_C(  54), INT8_C( -92), INT8_C( -28),
                           INT8_C(  -2), INT8_C(  69), INT8_C(-102), INT8_C(  42),
                           INT8_C(  41), INT8_C(-101), INT8_C( -59), INT8_C( -72),
                           INT8_C( -53), INT8_C( -47), INT8_C( -78), INT8_C(  67),
                           INT8_C(  54), INT8_C(  12), INT8_C( -65), INT8_C( 101),
                           INT8_C(  77), INT8_C( -96), INT8_C( -15), INT8_C(  66),
                           INT8_C(  50), INT8_C(   9), INT8_C( -75), INT8_C( 102),
                           INT8_C(   2), INT8_C( -31), INT8_C(  83), INT8_C( -71),
                           INT8_C( -84), INT8_C( -66), INT8_C(-111), INT8_C(  -2)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(  98), INT8_C(   0), INT8_C(   0), INT8_C( -85),
                           INT8_C(-116), INT8_C(   0), INT8_C(   0), INT8_C( 127),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C( -57),
                           INT8_C(   0), INT8_C(   0), INT8_C(  25), INT8_C(   0),
                           INT8_C(-117), INT8_C(   0), INT8_C( -79), INT8_C(   0),
                           INT8_C(-128), INT8_C(  13), INT8_C( 127), INT8_C(   3),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(  36), INT8_C(   0), INT8_C(   0), INT8_C( 100)) },
    { UINT64_C(          2987001584),
      easysimd_mm512_set_epi8(INT8_C(  31), INT8_C( 110), INT8_C(-101), INT8_C( -57),
                           INT8_C(  28), INT8_C( -50), INT8_C( -16), INT8_C(  37),
                           INT8_C(  87), INT8_C(-105), INT8_C(  96), INT8_C( -79),
                           INT8_C(  99), INT8_C(  74), INT8_C(  20), INT8_C( 120),
                           INT8_C(  60), INT8_C(  49), INT8_C( 101), INT8_C( -94),
                           INT8_C(  -5), INT8_C( 114), INT8_C(  17), INT8_C(   1),
                           INT8_C(  36), INT8_C( -92), INT8_C(  39), INT8_C(-108),
                           INT8_C( -15), INT8_C(  14), INT8_C( -15), INT8_C(  79),
                           INT8_C( 112), INT8_C( 108), INT8_C( -44), INT8_C( -18),
                           INT8_C( 125), INT8_C(  93), INT8_C( -92), INT8_C( -51),
                           INT8_C(  21), INT8_C( -19), INT8_C( -56), INT8_C( 114),
                           INT8_C( -95), INT8_C(  40), INT8_C( -27), INT8_C( -85),
                           INT8_C(  26), INT8_C(  29), INT8_C( -30), INT8_C(  53),
                           INT8_C( -69), INT8_C( -26), INT8_C(  79), INT8_C(-124),
                           INT8_C( -35), INT8_C( -29), INT8_C( -59), INT8_C( -99),
                           INT8_C(-118), INT8_C(  30), INT8_C( 105), INT8_C(   3)),
      easysimd_mm512_set_epi8(INT8_C( 100), INT8_C(-112), INT8_C( 127), INT8_C(  -1),
                           INT8_C( -76), INT8_C( 101), INT8_C(  90), INT8_C( -29),
                           INT8_C( -60), INT8_C( -92), INT8_C( -73), INT8_C( -20),
                           INT8_C( -84), INT8_C( -11), INT8_C( -28), INT8_C(-123),
                           INT8_C( -48), INT8_C(-118), INT8_C(-107), INT8_C(  73),
                           INT8_C( -80), INT8_C(  46), INT8_C(-117), INT8_C( -85),
                           INT8_C( -21), INT8_C( -54), INT8_C( -49), INT8_C(  -8),
                           INT8_C(  51), INT8_C( 126), INT8_C(  22), INT8_C(  70),
                           INT8_C( -86), INT8_C( -98), INT8_C( -17), INT8_C( -29),
                           INT8_C(  75), INT8_C( 115), INT8_C(  61), INT8_C(  76),
                           INT8_C( -65), INT8_C(  43), INT8_C( -13), INT8_C(  -2),
                           INT8_C(  81), INT8_C( -26), INT8_C(  -6), INT8_C( -15),
                           INT8_C( -40), INT8_C(  72), INT8_C(  66), INT8_C(  32),
                           INT8_C(  22), INT8_C( -74), INT8_C( -73), INT8_C(  67),
                           INT8_C(  75), INT8_C( -18), INT8_C( -97), INT8_C(  75),
                           INT8_C( -47), INT8_C(  32), INT8_C(  26), INT8_C(-108)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C( 127), INT8_C(   0), INT8_C( -27), INT8_C(  11),
                           INT8_C(   0), INT8_C(   0), INT8_C(-128), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(-128), INT8_C(   0), INT8_C( -21), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(  48), INT8_C( 127), INT8_C(   0),
                           INT8_C(-110), INT8_C( -11), INT8_C(  38), INT8_C(-128),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0)) },
    { UINT64_C(          1908364466),
      easysimd_mm512_set_epi8(INT8_C(  57), INT8_C(  79), INT8_C(   6), INT8_C(   7),
                           INT8_C(  37), INT8_C(-119), INT8_C( -51), INT8_C(  99),
                           INT8_C( -66), INT8_C( -12), INT8_C( -24), INT8_C(-107),
                           INT8_C(-117), INT8_C(  63), INT8_C(  42), INT8_C(  79),
                           INT8_C( -78), INT8_C( -79), INT8_C( -22), INT8_C( -52),
                           INT8_C( -78), INT8_C(  -8), INT8_C( -61), INT8_C( 101),
                           INT8_C(-111), INT8_C(  35), INT8_C( -89), INT8_C( 127),
                           INT8_C(  50), INT8_C(-115), INT8_C(  91), INT8_C( -72),
                           INT8_C( -97), INT8_C( -34), INT8_C( -80), INT8_C( -31),
                           INT8_C( -60), INT8_C( 119), INT8_C(-106), INT8_C(  66),
                           INT8_C(  75), INT8_C(-108), INT8_C(-113), INT8_C( 120),
                           INT8_C(  36), INT8_C( 112), INT8_C( -45), INT8_C(  41),
                           INT8_C(  90), INT8_C( -32), INT8_C(  22), INT8_C(  86),
                           INT8_C(  72), INT8_C( -20), INT8_C(  -4), INT8_C(-125),
                           INT8_C( -37), INT8_C(  84), INT8_C( -95), INT8_C( -66),
                           INT8_C( 109), INT8_C(  18), INT8_C( 120), INT8_C(-115)),
      easysimd_mm512_set_epi8(INT8_C( 127), INT8_C(  -8), INT8_C(  57), INT8_C( -73),
                           INT8_C(  40), INT8_C(  -7), INT8_C(  90), INT8_C(-110),
                           INT8_C(-100), INT8_C(-107), INT8_C( 106), INT8_C( -87),
                           INT8_C(  61), INT8_C( -94), INT8_C(   7), INT8_C(  84),
                           INT8_C(  25), INT8_C(  77), INT8_C(  24), INT8_C(  35),
                           INT8_C(  56), INT8_C( -72), INT8_C(  65), INT8_C( -77),
                           INT8_C(  81), INT8_C( 110), INT8_C( 109), INT8_C(  26),
                           INT8_C( -46), INT8_C(   6), INT8_C(  -4), INT8_C( -76),
                           INT8_C(  49), INT8_C(  67), INT8_C( -22), INT8_C(  12),
                           INT8_C(  66), INT8_C( -76), INT8_C( -71), INT8_C(  20),
                           INT8_C( -11), INT8_C(  97), INT8_C(  20), INT8_C(  -1),
                           INT8_C(  69), INT8_C(  54), INT8_C( -68), INT8_C( 104),
                           INT8_C(  61), INT8_C( -16), INT8_C( -52), INT8_C( -98),
                           INT8_C(-126), INT8_C(-109), INT8_C(  86), INT8_C(  51),
                           INT8_C(  95), INT8_C( -88), INT8_C(   6), INT8_C(-121),
                           INT8_C(  49), INT8_C(  97), INT8_C( -69), INT8_C( 125)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(-101), INT8_C( -58), INT8_C( -43),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(  46),
                           INT8_C(  86), INT8_C(   0), INT8_C(-128), INT8_C( 121),
                           INT8_C( -33), INT8_C(  58), INT8_C(  23), INT8_C( -63),
                           INT8_C(   0), INT8_C( -16), INT8_C(   0), INT8_C( 127),
                           INT8_C(   0), INT8_C(  89), INT8_C(   0), INT8_C(   0),
                           INT8_C(-128), INT8_C(   0), INT8_C(-101), INT8_C(  55),
                           INT8_C(   0), INT8_C(   0), INT8_C( 127), INT8_C(   0)) },
    { UINT64_C(          3441334389),
      easysimd_mm512_set_epi8(INT8_C(  96), INT8_C(  30), INT8_C( 105), INT8_C(  -4),
                           INT8_C(  44), INT8_C(  54), INT8_C(  89), INT8_C(  40),
                           INT8_C(  99), INT8_C(  41), INT8_C(   5), INT8_C(  -2),
                           INT8_C( -57), INT8_C(  98), INT8_C(  33), INT8_C( -28),
                           INT8_C(  66), INT8_C(  28), INT8_C( -53), INT8_C(  48),
                           INT8_C( -75), INT8_C( -97), INT8_C( -42), INT8_C(  47),
                           INT8_C( -33), INT8_C( -17), INT8_C( 113), INT8_C( 120),
                           INT8_C(-111), INT8_C(  14), INT8_C(  77), INT8_C(-108),
                           INT8_C(  25), INT8_C( -42), INT8_C( 109), INT8_C( -97),
                           INT8_C( -19), INT8_C( -18), INT8_C(  -1), INT8_C( -50),
                           INT8_C( -87), INT8_C( -70), INT8_C(  94), INT8_C( -91),
                           INT8_C(  23), INT8_C(  33), INT8_C( -10), INT8_C(  81),
                           INT8_C(  81), INT8_C( -63), INT8_C(  35), INT8_C(  44),
                           INT8_C(  11), INT8_C(-124), INT8_C( -20), INT8_C(  71),
                           INT8_C( -25), INT8_C(-112), INT8_C(   2), INT8_C(  59),
                           INT8_C(  21), INT8_C(-113), INT8_C(  35), INT8_C( -40)),
      easysimd_mm512_set_epi8(INT8_C( -44), INT8_C(  54), INT8_C(-101), INT8_C( -13),
                           INT8_C( 111), INT8_C( 110), INT8_C( 114), INT8_C( -57),
                           INT8_C(  58), INT8_C(-128), INT8_C(-123), INT8_C(  -3),
                           INT8_C(  74), INT8_C( -78), INT8_C(-124), INT8_C( -30),
                           INT8_C(  21), INT8_C(  86), INT8_C( -53), INT8_C(-116),
                           INT8_C(-126), INT8_C(  10), INT8_C(-123), INT8_C( -78),
                           INT8_C(   2), INT8_C( 100), INT8_C( -90), INT8_C( -79),
                           INT8_C( -46), INT8_C( -83), INT8_C(  11), INT8_C(-120),
                           INT8_C( -56), INT8_C(  -4), INT8_C( -39), INT8_C(-114),
                           INT8_C( -98), INT8_C(-108), INT8_C( -22), INT8_C(  24),
                           INT8_C( 127), INT8_C( -20), INT8_C(   7), INT8_C( -16),
                           INT8_C(  -8), INT8_C(  19), INT8_C( 119), INT8_C( -44),
                           INT8_C(   7), INT8_C( -47), INT8_C(-126), INT8_C(-119),
                           INT8_C(   1), INT8_C( 111), INT8_C( -95), INT8_C( -67),
                           INT8_C(  38), INT8_C( -19), INT8_C(  96), INT8_C( -21),
                           INT8_C( -76), INT8_C(-123), INT8_C(-115), INT8_C( -61)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(  81), INT8_C( -38), INT8_C(   0), INT8_C(   0),
                           INT8_C(  79), INT8_C(  90), INT8_C(   0), INT8_C( -74),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C( -75),
                           INT8_C(  31), INT8_C(  14), INT8_C(-128), INT8_C(   0),
                           INT8_C(  74), INT8_C(   0), INT8_C(   0), INT8_C( 127),
                           INT8_C(  10), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C( -93), INT8_C( -94), INT8_C(  80),
                           INT8_C(   0), INT8_C(  10), INT8_C(   0), INT8_C(  21)) },
    { UINT64_C(           706560777),
      easysimd_mm512_set_epi8(INT8_C(  44), INT8_C(  94), INT8_C( 127), INT8_C( -12),
                           INT8_C(  90), INT8_C( 111), INT8_C( -20), INT8_C(-110),
                           INT8_C( -82), INT8_C( -19), INT8_C( -79), INT8_C(-128),
                           INT8_C(  -6), INT8_C(-119), INT8_C( 100), INT8_C( 125),
                           INT8_C( -42), INT8_C(  43), INT8_C(   6), INT8_C( -97),
                           INT8_C( -90), INT8_C(  -4), INT8_C( -71), INT8_C(  33),
                           INT8_C(   1), INT8_C(   3), INT8_C( -91), INT8_C( -62),
                           INT8_C(-106), INT8_C(  -6), INT8_C(  35), INT8_C(  67),
                           INT8_C(  97), INT8_C(  46), INT8_C(  89), INT8_C(  56),
                           INT8_C( -84), INT8_C( -39), INT8_C( -70), INT8_C(  78),
                           INT8_C( -49), INT8_C(  94), INT8_C(  -1), INT8_C( -23),
                           INT8_C( -88), INT8_C( -11), INT8_C(-128), INT8_C( -62),
                           INT8_C( 106), INT8_C( 125), INT8_C( -71), INT8_C( -96),
                           INT8_C( -28), INT8_C( -58), INT8_C( -40), INT8_C( -32),
                           INT8_C( -13), INT8_C( -84), INT8_C( -69), INT8_C( -40),
                           INT8_C(-122), INT8_C( 117), INT8_C( 115), INT8_C( -87)),
      easysimd_mm512_set_epi8(INT8_C(  66), INT8_C( -40), INT8_C( -14), INT8_C( -56),
                           INT8_C( -68), INT8_C( -68), INT8_C(-124), INT8_C( -65),
                           INT8_C(  41), INT8_C( -59), INT8_C(-122), INT8_C( 101),
                           INT8_C(  82), INT8_C( -28), INT8_C( -40), INT8_C( -58),
                           INT8_C( 127), INT8_C(  66), INT8_C(  63), INT8_C( -46),
                           INT8_C(  90), INT8_C(  39), INT8_C( -89), INT8_C(-105),
                           INT8_C( -51), INT8_C( -46), INT8_C( 111), INT8_C( -45),
                           INT8_C( -76), INT8_C(-112), INT8_C( -37), INT8_C(-120),
                           INT8_C(  50), INT8_C( -97), INT8_C(  -2), INT8_C( 121),
                           INT8_C(  68), INT8_C(-106), INT8_C( 101), INT8_C( 115),
                           INT8_C( -29), INT8_C(  59), INT8_C(  77), INT8_C( -36),
                           INT8_C( 111), INT8_C(  95), INT8_C(  48), INT8_C( 113),
                           INT8_C( -97), INT8_C( 105), INT8_C( -37), INT8_C( -42),
                           INT8_C(  -7), INT8_C(  31), INT8_C(  45), INT8_C(  -5),
                           INT8_C( -29), INT8_C(  44), INT8_C(  78), INT8_C( -25),
                           INT8_C( -47), INT8_C(-119), INT8_C( -90), INT8_C( 115)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(  91), INT8_C(   0),
                           INT8_C(-128), INT8_C(   0), INT8_C(-128), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(  13),
                           INT8_C(-128), INT8_C(-106), INT8_C(   0), INT8_C(-128),
                           INT8_C(   0), INT8_C(  20), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C( -85), INT8_C( -27),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C( -75), INT8_C(   0), INT8_C(   0), INT8_C(-128)) },
    { UINT64_C(          3905965829),
      easysimd_mm512_set_epi8(INT8_C(  51), INT8_C( -49), INT8_C(  69), INT8_C( -80),
                           INT8_C(  34), INT8_C(  87), INT8_C(  88), INT8_C( -38),
                           INT8_C( -14), INT8_C( -30), INT8_C(-111), INT8_C( -87),
                           INT8_C(  37), INT8_C(  40), INT8_C( -30), INT8_C( -40),
                           INT8_C(  89), INT8_C(  39), INT8_C( 109), INT8_C( 109),
                           INT8_C( -71), INT8_C( -81), INT8_C(  67), INT8_C(  48),
                           INT8_C( -43), INT8_C(  31), INT8_C( -36), INT8_C( -53),
                           INT8_C(  -7), INT8_C(  84), INT8_C( -92), INT8_C( 124),
                           INT8_C( -22), INT8_C(  31), INT8_C(  42), INT8_C(-103),
                           INT8_C(  29), INT8_C(  75), INT8_C( -91), INT8_C(  75),
                           INT8_C( 107), INT8_C(  62), INT8_C( 126), INT8_C(   7),
                           INT8_C( -89), INT8_C( 119), INT8_C(  79), INT8_C( -38),
                           INT8_C(  18), INT8_C(  57), INT8_C(-102), INT8_C(  66),
                           INT8_C(  -7), INT8_C(  89), INT8_C(  57), INT8_C( -55),
                           INT8_C( -68), INT8_C(  21), INT8_C( -21), INT8_C(  -6),
                           INT8_C( -26), INT8_C( 122), INT8_C( 114), INT8_C(  83)),
      easysimd_mm512_set_epi8(INT8_C( 111), INT8_C(  34), INT8_C( -76), INT8_C(  65),
                           INT8_C( -31), INT8_C(  25), INT8_C( -63), INT8_C(-128),
                           INT8_C( -28), INT8_C(  80), INT8_C( -75), INT8_C(  83),
                           INT8_C( -23), INT8_C( -65), INT8_C( -75), INT8_C( -10),
                           INT8_C(-102), INT8_C(-123), INT8_C(  20), INT8_C(  36),
                           INT8_C(  70), INT8_C( -95), INT8_C(  63), INT8_C( 110),
                           INT8_C(  98), INT8_C(-128), INT8_C( -74), INT8_C( -50),
                           INT8_C(  17), INT8_C( -37), INT8_C(-104), INT8_C( -74),
                           INT8_C(  -4), INT8_C(  15), INT8_C( -59), INT8_C(  62),
                           INT8_C( -89), INT8_C( 103), INT8_C(  -5), INT8_C(  71),
                           INT8_C( 103), INT8_C(-119), INT8_C( -62), INT8_C( -47),
                           INT8_C( -78), INT8_C(  32), INT8_C( 104), INT8_C(  33),
                           INT8_C( -45), INT8_C( -54), INT8_C(  17), INT8_C(-117),
                           INT8_C(  96), INT8_C(  66), INT8_C( -18), INT8_C( -58),
                           INT8_C(-111), INT8_C(-110), INT8_C( -14), INT8_C(   7),
                           INT8_C(  85), INT8_C(-113), INT8_C(  19), INT8_C( -72)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C( -18), INT8_C(  16), INT8_C( 101), INT8_C(   0),
                           INT8_C( 118), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   4), INT8_C( 127), INT8_C(   0), INT8_C(  54),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C( 111), INT8_C(   0), INT8_C(   0),
                           INT8_C(-103), INT8_C(  23), INT8_C(  75), INT8_C(   3),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C( 127), INT8_C(   0), INT8_C( 127)) },
    { UINT64_C(           993418129),
      easysimd_mm512_set_epi8(INT8_C( -62), INT8_C(  96), INT8_C( -27), INT8_C( -88),
                           INT8_C( -35), INT8_C( -58), INT8_C( -83), INT8_C(  36),
                           INT8_C( -16), INT8_C(  50), INT8_C(-127), INT8_C( -82),
                           INT8_C( 106), INT8_C(  56), INT8_C(  74), INT8_C( -59),
                           INT8_C( -80), INT8_C( -22), INT8_C(   6), INT8_C( -65),
                           INT8_C(-106), INT8_C( -51), INT8_C(   4), INT8_C( -33),
                           INT8_C(  91), INT8_C(  46), INT8_C( -16), INT8_C(  27),
                           INT8_C( -66), INT8_C( -93), INT8_C( -43), INT8_C(  14),
                           INT8_C( 100), INT8_C(-113), INT8_C(  32), INT8_C(  15),
                           INT8_C( -79), INT8_C(  63), INT8_C( -18), INT8_C( -96),
                           INT8_C(-119), INT8_C( 114), INT8_C( -87), INT8_C( -82),
                           INT8_C(  76), INT8_C( 117), INT8_C(  14), INT8_C( -65),
                           INT8_C( -37), INT8_C( -15), INT8_C(  43), INT8_C(   5),
                           INT8_C(-108), INT8_C(  -5), INT8_C( -84), INT8_C(  13),
                           INT8_C( -66), INT8_C(  80), INT8_C( -20), INT8_C(  34),
                           INT8_C(-122), INT8_C(-101), INT8_C( -91), INT8_C( -35)),
      easysimd_mm512_set_epi8(INT8_C(  96), INT8_C(-100), INT8_C( -47), INT8_C( 114),
                           INT8_C(-109), INT8_C(   8), INT8_C(  51), INT8_C( 120),
                           INT8_C( -12), INT8_C(-128), INT8_C(  -4), INT8_C(-105),
                           INT8_C(  83), INT8_C(-123), INT8_C( -98), INT8_C(  -2),
                           INT8_C(  54), INT8_C( 110), INT8_C( -53), INT8_C( 100),
                           INT8_C(  94), INT8_C(  -2), INT8_C(  72), INT8_C(  95),
                           INT8_C( -61), INT8_C( -31), INT8_C(   2), INT8_C(  88),
                           INT8_C(  69), INT8_C(-117), INT8_C(  33), INT8_C( -57),
                           INT8_C( -67), INT8_C(  92), INT8_C( -31), INT8_C( -16),
                           INT8_C(-115), INT8_C( -91), INT8_C(   0), INT8_C( -73),
                           INT8_C(  -3), INT8_C( -71), INT8_C(  55), INT8_C( -82),
                           INT8_C( -28), INT8_C( -34), INT8_C( -40), INT8_C(  60),
                           INT8_C(  31), INT8_C(-113), INT8_C(  90), INT8_C( 114),
                           INT8_C(  73), INT8_C(  77), INT8_C( -29), INT8_C(  80),
                           INT8_C(-106), INT8_C( 121), INT8_C(-122), INT8_C(  -4),
                           INT8_C( 104), INT8_C( -76), INT8_C(  85), INT8_C( -33)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(  63), INT8_C(  31),
                           INT8_C(  36), INT8_C(   0), INT8_C( -18), INT8_C( -23),
                           INT8_C(   0), INT8_C(   0), INT8_C(-128), INT8_C(   0),
                           INT8_C(   0), INT8_C( 127), INT8_C(  54), INT8_C(   0),
                           INT8_C(   0), INT8_C(  98), INT8_C(   0), INT8_C(-109),
                           INT8_C(-128), INT8_C(   0), INT8_C( -55), INT8_C( -67),
                           INT8_C(  40), INT8_C(   0), INT8_C(   0), INT8_C(  38),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(  -2)) },
    { UINT64_C(          1423233113),
      easysimd_mm512_set_epi8(INT8_C(  85), INT8_C(  12), INT8_C( -17), INT8_C(  78),
                           INT8_C(   2), INT8_C( -46), INT8_C(  21), INT8_C(  89),
                           INT8_C( -58), INT8_C( -19), INT8_C(  -7), INT8_C( -46),
                           INT8_C(  58), INT8_C( 120), INT8_C( -85), INT8_C(  46),
                           INT8_C(  80), INT8_C( -20), INT8_C(  94), INT8_C(  32),
                           INT8_C( -61), INT8_C(  80), INT8_C( -39), INT8_C( 109),
                           INT8_C( -24), INT8_C( -30), INT8_C(  27), INT8_C( -44),
                           INT8_C( -74), INT8_C( -85), INT8_C( -66), INT8_C(  26),
                           INT8_C( -69), INT8_C( 112), INT8_C( -22), INT8_C(  62),
                           INT8_C(  24), INT8_C(-107), INT8_C( -41), INT8_C( -21),
                           INT8_C(  68), INT8_C( -34), INT8_C( 109), INT8_C(  58),
                           INT8_C(  16), INT8_C( -72), INT8_C( -84), INT8_C(  18),
                           INT8_C( -73), INT8_C( -54), INT8_C(  16), INT8_C( -93),
                           INT8_C( -51), INT8_C( -50), INT8_C(  54), INT8_C( -69),
                           INT8_C( -98), INT8_C(-113), INT8_C( -73), INT8_C(-124),
                           INT8_C( -65), INT8_C( -51), INT8_C(  43), INT8_C(  10)),
      easysimd_mm512_set_epi8(INT8_C(  48), INT8_C( -35), INT8_C(  -2), INT8_C(  -9),
                           INT8_C( -72), INT8_C(  97), INT8_C(-100), INT8_C( 120),
                           INT8_C( -96), INT8_C(  21), INT8_C(  35), INT8_C(  38),
                           INT8_C( -30), INT8_C(  81), INT8_C(-111), INT8_C(  42),
                           INT8_C(  39), INT8_C(-112), INT8_C(  20), INT8_C(-116),
                           INT8_C( 111), INT8_C( -69), INT8_C(  64), INT8_C(  -4),
                           INT8_C( 125), INT8_C( -29), INT8_C( 116), INT8_C( -26),
                           INT8_C(  78), INT8_C(  37), INT8_C( -43), INT8_C(  45),
                           INT8_C( -81), INT8_C(-109), INT8_C(  26), INT8_C( -51),
                           INT8_C( -54), INT8_C(  99), INT8_C( 124), INT8_C(   2),
                           INT8_C(  10), INT8_C(   6), INT8_C( -77), INT8_C( -61),
                           INT8_C(  59), INT8_C(  60), INT8_C(  42), INT8_C(  33),
                           INT8_C( 126), INT8_C(  88), INT8_C(  41), INT8_C(  66),
                           INT8_C(  98), INT8_C( 111), INT8_C(  94), INT8_C( -70),
                           INT8_C( 116), INT8_C( -40), INT8_C( -88), INT8_C(  13),
                           INT8_C(  50), INT8_C(  54), INT8_C(  32), INT8_C( -48)),
      easysimd_mm512_set_epi8(INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C( 127), INT8_C(   0), INT8_C( 113),
                           INT8_C(   0), INT8_C(-128), INT8_C(   0), INT8_C(   0),
                           INT8_C(  58), INT8_C( -40), INT8_C(   0), INT8_C( 119),
                           INT8_C(   0), INT8_C(-128), INT8_C(   0), INT8_C(   0),
                           INT8_C(-128), INT8_C(-128), INT8_C(   0), INT8_C(-128),
                           INT8_C(   0), INT8_C(   0), INT8_C(   0), INT8_C(   0),
                           INT8_C(   0), INT8_C( -73), INT8_C(   0), INT8_C(-128),
                           INT8_C(-115), INT8_C(   0), INT8_C(   0), INT8_C(  58)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__mmask64 k = test_vec[i].k;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_maskz_subs_epi8(k, a, b);
    }
    EASYSIMD_TEST_PERF_END("_mm512_maskz_subs_epi8");
    easysimd_assert_m512i_i8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_subs_epi16(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_mm512_set_epi16(INT16_C( 21075), INT16_C( 30017), INT16_C(-11898), INT16_C( 29710),
                            INT16_C( 19457), INT16_C(-12796), INT16_C( 21427), INT16_C( 28826),
                            INT16_C( 25482), INT16_C(-11843), INT16_C( 15582), INT16_C( 20114),
                            INT16_C(-14761), INT16_C(-15590), INT16_C( -4142), INT16_C( 29932),
                            INT16_C(-30672), INT16_C(  6190), INT16_C( 26590), INT16_C( 10803),
                            INT16_C(-16554), INT16_C( 15816), INT16_C( 14967), INT16_C( 24063),
                            INT16_C(-14713), INT16_C( -8094), INT16_C(-16817), INT16_C( 25507),
                            INT16_C( 19912), INT16_C(-19929), INT16_C(-12604), INT16_C(-17156)),
      easysimd_mm512_set_epi16(INT16_C( 27175), INT16_C(-27122), INT16_C( -6914), INT16_C( 10212),
                            INT16_C( 13894), INT16_C( -4620), INT16_C(-10724), INT16_C( -3078),
                            INT16_C( 29698), INT16_C(  6009), INT16_C( 28893), INT16_C(-31734),
                            INT16_C( -3957), INT16_C(  6787), INT16_C(  9325), INT16_C(  7645),
                            INT16_C( -2133), INT16_C( -9633), INT16_C(-22525), INT16_C(  1124),
                            INT16_C( 21781), INT16_C( 17119), INT16_C(-19461), INT16_C(-32134),
                            INT16_C( -7507), INT16_C( 19092), INT16_C( 21408), INT16_C(-14444),
                            INT16_C( 22843), INT16_C( 28625), INT16_C( -2322), INT16_C(  5251)),
      easysimd_mm512_set_epi16(INT16_C( -6100), INT16_C( 32767), INT16_C( -4984), INT16_C( 19498),
                            INT16_C(  5563), INT16_C( -8176), INT16_C( 32151), INT16_C( 31904),
                            INT16_C( -4216), INT16_C(-17852), INT16_C(-13311), INT16_C( 32767),
                            INT16_C(-10804), INT16_C(-22377), INT16_C(-13467), INT16_C( 22287),
                            INT16_C(-28539), INT16_C( 15823), INT16_C( 32767), INT16_C(  9679),
                            INT16_C(-32768), INT16_C( -1303), INT16_C( 32767), INT16_C( 32767),
                            INT16_C( -7206), INT16_C(-27186), INT16_C(-32768), INT16_C( 32767),
                            INT16_C( -2931), INT16_C(-32768), INT16_C(-10282), INT16_C(-22407)) },
    { easysimd_mm512_set_epi16(INT16_C(-27508), INT16_C(  5509), INT16_C(-13526), INT16_C( 16909),
                            INT16_C(  2419), INT16_C( 22142), INT16_C( -6109), INT16_C( -1177),
                            INT16_C(  9839), INT16_C(  6329), INT16_C(  -239), INT16_C(-15885),
                            INT16_C(  3666), INT16_C( 20122), INT16_C( -1699), INT16_C(  6503),
                            INT16_C( 29169), INT16_C( -4681), INT16_C( -2713), INT16_C(-24709),
                            INT16_C(  7221), INT16_C( -3718), INT16_C(   970), INT16_C(-15558),
                            INT16_C(-11011), INT16_C(-10787), INT16_C(-29970), INT16_C(  3894),
                            INT16_C(-25914), INT16_C(-18758), INT16_C( 11824), INT16_C( -8868)),
      easysimd_mm512_set_epi16(INT16_C(  1604), INT16_C( 19874), INT16_C(-12133), INT16_C( -1966),
                            INT16_C( 13041), INT16_C(  1566), INT16_C(-11791), INT16_C( -3425),
                            INT16_C(  7377), INT16_C(-23380), INT16_C( -9249), INT16_C(-31251),
                            INT16_C( 14877), INT16_C( 24009), INT16_C(-32316), INT16_C(  8308),
                            INT16_C(-11725), INT16_C(-10230), INT16_C(  1074), INT16_C( 12341),
                            INT16_C( 19989), INT16_C( 16491), INT16_C(  4144), INT16_C(-11714),
                            INT16_C( 19285), INT16_C(-29198), INT16_C(-25258), INT16_C(-29514),
                            INT16_C(  9755), INT16_C(-29385), INT16_C(-23111), INT16_C( -3412)),
      easysimd_mm512_set_epi16(INT16_C(-29112), INT16_C(-14365), INT16_C( -1393), INT16_C( 18875),
                            INT16_C(-10622), INT16_C( 20576), INT16_C(  5682), INT16_C(  2248),
                            INT16_C(  2462), INT16_C( 29709), INT16_C(  9010), INT16_C( 15366),
                            INT16_C(-11211), INT16_C( -3887), INT16_C( 30617), INT16_C( -1805),
                            INT16_C( 32767), INT16_C(  5549), INT16_C( -3787), INT16_C(-32768),
                            INT16_C(-12768), INT16_C(-20209), INT16_C( -3174), INT16_C( -3844),
                            INT16_C(-30296), INT16_C( 18411), INT16_C( -4712), INT16_C( 32767),
                            INT16_C(-32768), INT16_C( 10627), INT16_C( 32767), INT16_C( -5456)) },
    { easysimd_mm512_set_epi16(INT16_C(   691), INT16_C( -4823), INT16_C( -3253), INT16_C(-31392),
                            INT16_C(-21784), INT16_C( -6740), INT16_C(  9130), INT16_C(-18273),
                            INT16_C( 11275), INT16_C(-27092), INT16_C(    90), INT16_C(-20133),
                            INT16_C( 30523), INT16_C( 27008), INT16_C( 28387), INT16_C( 17266),
                            INT16_C( -9777), INT16_C( 27096), INT16_C( -8328), INT16_C( -6812),
                            INT16_C(-22954), INT16_C( -4409), INT16_C( 21734), INT16_C(-19695),
                            INT16_C(-11981), INT16_C(-21195), INT16_C( 18272), INT16_C( 28327),
                            INT16_C(  7123), INT16_C(-32216), INT16_C( 24489), INT16_C(-15668)),
      easysimd_mm512_set_epi16(INT16_C(-21377), INT16_C( 15856), INT16_C(  7686), INT16_C(-28568),
                            INT16_C(-15192), INT16_C( -9747), INT16_C( 11300), INT16_C( 27000),
                            INT16_C( -6635), INT16_C(  3626), INT16_C( 12716), INT16_C(-30571),
                            INT16_C( 31697), INT16_C(  5622), INT16_C( 24444), INT16_C( -8226),
                            INT16_C( -8263), INT16_C(  2890), INT16_C( 26732), INT16_C( -8763),
                            INT16_C(-13950), INT16_C( 27415), INT16_C(  7653), INT16_C( 31511),
                            INT16_C(-21082), INT16_C(  2398), INT16_C( 23365), INT16_C(-12903),
                            INT16_C(-18221), INT16_C(  4204), INT16_C(-20453), INT16_C( 15021)),
      easysimd_mm512_set_epi16(INT16_C( 22068), INT16_C(-20679), INT16_C(-10939), INT16_C( -2824),
                            INT16_C( -6592), INT16_C(  3007), INT16_C( -2170), INT16_C(-32768),
                            INT16_C( 17910), INT16_C(-30718), INT16_C(-12626), INT16_C( 10438),
                            INT16_C( -1174), INT16_C( 21386), INT16_C(  3943), INT16_C( 25492),
                            INT16_C( -1514), INT16_C( 24206), INT16_C(-32768), INT16_C(  1951),
                            INT16_C( -9004), INT16_C(-31824), INT16_C( 14081), INT16_C(-32768),
                            INT16_C(  9101), INT16_C(-23593), INT16_C( -5093), INT16_C( 32767),
                            INT16_C( 25344), INT16_C(-32768), INT16_C( 32767), INT16_C(-30689)) },
    { easysimd_mm512_set_epi16(INT16_C(  4451), INT16_C( -3121), INT16_C( 11648), INT16_C( 14185),
                            INT16_C( -8499), INT16_C(-24679), INT16_C(-31633), INT16_C( 19019),
                            INT16_C( 26210), INT16_C(-29943), INT16_C(-18883), INT16_C( 25468),
                            INT16_C( 20366), INT16_C(  4961), INT16_C(-25468), INT16_C( -4158),
                            INT16_C(  6653), INT16_C( -1720), INT16_C(-29723), INT16_C(-14244),
                            INT16_C( -4917), INT16_C(   730), INT16_C(-20677), INT16_C( 16986),
                            INT16_C(  9316), INT16_C( 28795), INT16_C(-18273), INT16_C(-29423),
                            INT16_C(-23674), INT16_C(  7963), INT16_C( 28019), INT16_C( 13728)),
      easysimd_mm512_set_epi16(INT16_C(-10770), INT16_C( 29411), INT16_C( 30463), INT16_C( -4902),
                            INT16_C(-20392), INT16_C(-28251), INT16_C( 11448), INT16_C( 27155),
                            INT16_C(-11669), INT16_C( 11820), INT16_C(-16512), INT16_C( 10540),
                            INT16_C( 17477), INT16_C(-19759), INT16_C( 28024), INT16_C(-14431),
                            INT16_C( 24400), INT16_C( -7583), INT16_C(-12129), INT16_C( 28592),
                            INT16_C(-31057), INT16_C(-18091), INT16_C( 19926), INT16_C(-29261),
                            INT16_C(  7501), INT16_C( 16620), INT16_C(  6953), INT16_C(  3437),
                            INT16_C(  5790), INT16_C(  5348), INT16_C( 17145), INT16_C(-28791)),
      easysimd_mm512_set_epi16(INT16_C( 15221), INT16_C(-32532), INT16_C(-18815), INT16_C( 19087),
                            INT16_C( 11893), INT16_C(  3572), INT16_C(-32768), INT16_C( -8136),
                            INT16_C( 32767), INT16_C(-32768), INT16_C( -2371), INT16_C( 14928),
                            INT16_C(  2889), INT16_C( 24720), INT16_C(-32768), INT16_C( 10273),
                            INT16_C(-17747), INT16_C(  5863), INT16_C(-17594), INT16_C(-32768),
                            INT16_C( 26140), INT16_C( 18821), INT16_C(-32768), INT16_C( 32767),
                            INT16_C(  1815), INT16_C( 12175), INT16_C(-25226), INT16_C(-32768),
                            INT16_C(-29464), INT16_C(  2615), INT16_C( 10874), INT16_C( 32767)) },
    { easysimd_mm512_set_epi16(INT16_C(-31561), INT16_C( 18949), INT16_C( -2287), INT16_C(-20534),
                            INT16_C( -1057), INT16_C( -3046), INT16_C( 22138), INT16_C(-11031),
                            INT16_C(    43), INT16_C( -6266), INT16_C(-20090), INT16_C(-22393),
                            INT16_C(-26046), INT16_C(-23703), INT16_C( 28092), INT16_C(  6346),
                            INT16_C( 10308), INT16_C(   572), INT16_C(     5), INT16_C( 15306),
                            INT16_C(-19429), INT16_C( -5811), INT16_C(-27420), INT16_C(-29128),
                            INT16_C(-13676), INT16_C( -3673), INT16_C(-26157), INT16_C( 19197),
                            INT16_C(-27593), INT16_C(-20030), INT16_C(  3690), INT16_C( -3850)),
      easysimd_mm512_set_epi16(INT16_C(-11908), INT16_C( 14774), INT16_C(  5244), INT16_C( 18107),
                            INT16_C(-16396), INT16_C( 31910), INT16_C(-28865), INT16_C(-20038),
                            INT16_C(-19234), INT16_C(-15108), INT16_C(-10436), INT16_C( 19911),
                            INT16_C(  3330), INT16_C( 28633), INT16_C( 10550), INT16_C( -9358),
                            INT16_C( 23697), INT16_C( 19726), INT16_C(-26407), INT16_C(-18878),
                            INT16_C(  4326), INT16_C(-22642), INT16_C(-17402), INT16_C( 16035),
                            INT16_C( 14223), INT16_C(-15160), INT16_C( -9470), INT16_C( -3752),
                            INT16_C(  6710), INT16_C( 21116), INT16_C( -9579), INT16_C( 10253)),
      easysimd_mm512_set_epi16(INT16_C(-19653), INT16_C(  4175), INT16_C( -7531), INT16_C(-32768),
                            INT16_C( 15339), INT16_C(-32768), INT16_C( 32767), INT16_C(  9007),
                            INT16_C( 19277), INT16_C(  8842), INT16_C( -9654), INT16_C(-32768),
                            INT16_C(-29376), INT16_C(-32768), INT16_C( 17542), INT16_C( 15704),
                            INT16_C(-13389), INT16_C(-19154), INT16_C( 26412), INT16_C( 32767),
                            INT16_C(-23755), INT16_C( 16831), INT16_C(-10018), INT16_C(-32768),
                            INT16_C(-27899), INT16_C( 11487), INT16_C(-16687), INT16_C( 22949),
                            INT16_C(-32768), INT16_C(-32768), INT16_C( 13269), INT16_C(-14103)) },
    { easysimd_mm512_set_epi16(INT16_C(  1468), INT16_C( -4389), INT16_C(  1296), INT16_C(-27715),
                            INT16_C(-15620), INT16_C(  3731), INT16_C( -7289), INT16_C(-27703),
                            INT16_C(   474), INT16_C( 27447), INT16_C( -9036), INT16_C(  9176),
                            INT16_C(  2726), INT16_C(-12144), INT16_C( -2101), INT16_C( 26907),
                            INT16_C(-24700), INT16_C(  1244), INT16_C( -3927), INT16_C(-22632),
                            INT16_C( -7525), INT16_C( 17743), INT16_C( 15263), INT16_C( -3823),
                            INT16_C( 27307), INT16_C( 32391), INT16_C(-23270), INT16_C(-29301),
                            INT16_C( 23369), INT16_C(-15291), INT16_C( -5840), INT16_C( 18168)),
      easysimd_mm512_set_epi16(INT16_C( 23449), INT16_C( 17725), INT16_C(-20919), INT16_C( 31466),
                            INT16_C( 31308), INT16_C( -2183), INT16_C(-31351), INT16_C(-32386),
                            INT16_C( 26890), INT16_C(-30591), INT16_C(-12785), INT16_C(-23638),
                            INT16_C(-31955), INT16_C( -9847), INT16_C( 19108), INT16_C(-19915),
                            INT16_C(  4587), INT16_C( 27034), INT16_C(   -19), INT16_C( 28332),
                            INT16_C(-23789), INT16_C(-24960), INT16_C( -5839), INT16_C( 25722),
                            INT16_C(-24423), INT16_C( 15592), INT16_C(  6092), INT16_C( -9272),
                            INT16_C(-12796), INT16_C(-17663), INT16_C( -6154), INT16_C( 23859)),
      easysimd_mm512_set_epi16(INT16_C(-21981), INT16_C(-22114), INT16_C( 22215), INT16_C(-32768),
                            INT16_C(-32768), INT16_C(  5914), INT16_C( 24062), INT16_C(  4683),
                            INT16_C(-26416), INT16_C( 32767), INT16_C(  3749), INT16_C( 32767),
                            INT16_C( 32767), INT16_C( -2297), INT16_C(-21209), INT16_C( 32767),
                            INT16_C(-29287), INT16_C(-25790), INT16_C( -3908), INT16_C(-32768),
                            INT16_C( 16264), INT16_C( 32767), INT16_C( 21102), INT16_C(-29545),
                            INT16_C( 32767), INT16_C( 16799), INT16_C(-29362), INT16_C(-20029),
                            INT16_C( 32767), INT16_C(  2372), INT16_C(   314), INT16_C( -5691)) },
    { easysimd_mm512_set_epi16(INT16_C(-22741), INT16_C( 13394), INT16_C( -9417), INT16_C( 28906),
                            INT16_C(-18980), INT16_C( -8463), INT16_C(  9174), INT16_C(-25605),
                            INT16_C(   547), INT16_C(  3767), INT16_C(-12577), INT16_C(-16546),
                            INT16_C( -1301), INT16_C( -7147), INT16_C( 26281), INT16_C( 29309),
                            INT16_C( 29052), INT16_C(-30842), INT16_C(  5995), INT16_C(  6270),
                            INT16_C( 20539), INT16_C( 10179), INT16_C(-26848), INT16_C( 14327),
                            INT16_C( 15491), INT16_C( 18652), INT16_C( 19903), INT16_C( 30123),
                            INT16_C( 25261), INT16_C(-17460), INT16_C( 10742), INT16_C( -4552)),
      easysimd_mm512_set_epi16(INT16_C(  5754), INT16_C(-23038), INT16_C(-16589), INT16_C(-23858),
                            INT16_C( -3821), INT16_C( -4798), INT16_C( 30602), INT16_C(-28532),
                            INT16_C( 11508), INT16_C(  7979), INT16_C( -3877), INT16_C( -5920),
                            INT16_C(-24150), INT16_C(-24496), INT16_C( 17421), INT16_C( -1981),
                            INT16_C( 27523), INT16_C( 26800), INT16_C( 25010), INT16_C( 27339),
                            INT16_C( -9050), INT16_C( 19128), INT16_C( 15279), INT16_C( -1817),
                            INT16_C(-13923), INT16_C(  5129), INT16_C(-22618), INT16_C( 27704),
                            INT16_C( -4783), INT16_C( 31238), INT16_C(-30342), INT16_C( -8854)),
      easysimd_mm512_set_epi16(INT16_C(-28495), INT16_C( 32767), INT16_C(  7172), INT16_C( 32767),
                            INT16_C(-15159), INT16_C( -3665), INT16_C(-21428), INT16_C(  2927),
                            INT16_C(-10961), INT16_C( -4212), INT16_C( -8700), INT16_C(-10626),
                            INT16_C( 22849), INT16_C( 17349), INT16_C(  8860), INT16_C( 31290),
                            INT16_C(  1529), INT16_C(-32768), INT16_C(-19015), INT16_C(-21069),
                            INT16_C( 29589), INT16_C( -8949), INT16_C(-32768), INT16_C( 16144),
                            INT16_C( 29414), INT16_C( 13523), INT16_C( 32767), INT16_C(  2419),
                            INT16_C( 30044), INT16_C(-32768), INT16_C( 32767), INT16_C(  4302)) },
    { easysimd_mm512_set_epi16(INT16_C( 27021), INT16_C( 31131), INT16_C(    63), INT16_C(-10530),
                            INT16_C( -1071), INT16_C(-31284), INT16_C(-21788), INT16_C(-16108),
                            INT16_C(-15167), INT16_C( 25422), INT16_C( 14520), INT16_C(-13896),
                            INT16_C( 20399), INT16_C( 31915), INT16_C(-16518), INT16_C( -6202),
                            INT16_C(-16332), INT16_C( -3071), INT16_C(-15644), INT16_C( -7016),
                            INT16_C( 13977), INT16_C(-13846), INT16_C(-23290), INT16_C( -2079),
                            INT16_C(  4753), INT16_C( 14919), INT16_C(-18528), INT16_C(  7420),
                            INT16_C( 12098), INT16_C( 31014), INT16_C( 17813), INT16_C(-14456)),
      easysimd_mm512_set_epi16(INT16_C(-12529), INT16_C( -3643), INT16_C(-28826), INT16_C(-12110),
                            INT16_C(  8030), INT16_C( 20316), INT16_C( 27324), INT16_C( 24735),
                            INT16_C( -6774), INT16_C( -2704), INT16_C(-31930), INT16_C(  6874),
                            INT16_C( -3952), INT16_C(  2658), INT16_C(  -904), INT16_C( -8319),
                            INT16_C(-16424), INT16_C( 22778), INT16_C( 18985), INT16_C( 10063),
                            INT16_C(-31751), INT16_C( 16016), INT16_C(-30217), INT16_C( 18364),
                            INT16_C(-20176), INT16_C( -4961), INT16_C(-29576), INT16_C(-16634),
                            INT16_C( -8011), INT16_C(-27110), INT16_C(-24526), INT16_C(-11504)),
      easysimd_mm512_set_epi16(INT16_C( 32767), INT16_C( 32767), INT16_C( 28889), INT16_C(  1580),
                            INT16_C( -9101), INT16_C(-32768), INT16_C(-32768), INT16_C(-32768),
                            INT16_C( -8393), INT16_C( 28126), INT16_C( 32767), INT16_C(-20770),
                            INT16_C( 24351), INT16_C( 29257), INT16_C(-15614), INT16_C(  2117),
                            INT16_C(    92), INT16_C(-25849), INT16_C(-32768), INT16_C(-17079),
                            INT16_C( 32767), INT16_C(-29862), INT16_C(  6927), INT16_C(-20443),
                            INT16_C( 24929), INT16_C( 19880), INT16_C( 11048), INT16_C( 24054),
                            INT16_C( 20109), INT16_C( 32767), INT16_C( 32767), INT16_C( -2952)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_subs_epi16(a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_subs_epi16");
    easysimd_assert_m512i_i16(r, ==, test_vec[i].r);
  }

  return 0;
}


  #define easysimd_mm512_setr_epi16(e31, e30, e29, e28, e27, e26, e25, e24, \
                            e23, e22, e21, e20, e19, e18, e17, e16, \
                            e15, e14, e13, e12, e11, e10, e9, e8, \
                            e7, e6, e5, e4, e3, e2, e1, e0) \
          easysimd_mm512_set_epi16(e0, e1, e2, e3, e4, e5, e6, e7,  \
                                 e8, e9, e10, e11, e12, e13, e14, e15,  \
                                 e16, e17, e18, e19, e20, e21, e22, e23,  \
                                 e24, e25, e26, e27, e28, e29, e30, e31)


static int
test_easysimd_mm512_maskz_subs_epi16(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__mmask32 k;
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { UINT32_C(          2068138505),
      easysimd_mm512_set_epi16(INT16_C( 21075), INT16_C( 30017), INT16_C(-11898), INT16_C( 29710),
                            INT16_C( 19457), INT16_C(-12796), INT16_C( 21427), INT16_C( 28826),
                            INT16_C( 25482), INT16_C(-11843), INT16_C( 15582), INT16_C( 20114),
                            INT16_C(-14761), INT16_C(-15590), INT16_C( -4142), INT16_C( 29932),
                            INT16_C(-30672), INT16_C(  6190), INT16_C( 26590), INT16_C( 10803),
                            INT16_C(-16554), INT16_C( 15816), INT16_C( 14967), INT16_C( 24063),
                            INT16_C(-14713), INT16_C( -8094), INT16_C(-16817), INT16_C( 25507),
                            INT16_C( 19912), INT16_C(-19929), INT16_C(-12604), INT16_C(-17156)),
      easysimd_mm512_set_epi16(INT16_C( 27175), INT16_C(-27122), INT16_C( -6914), INT16_C( 10212),
                            INT16_C( 13894), INT16_C( -4620), INT16_C(-10724), INT16_C( -3078),
                            INT16_C( 29698), INT16_C(  6009), INT16_C( 28893), INT16_C(-31734),
                            INT16_C( -3957), INT16_C(  6787), INT16_C(  9325), INT16_C(  7645),
                            INT16_C( -2133), INT16_C( -9633), INT16_C(-22525), INT16_C(  1124),
                            INT16_C( 21781), INT16_C( 17119), INT16_C(-19461), INT16_C(-32134),
                            INT16_C( -7507), INT16_C( 19092), INT16_C( 21408), INT16_C(-14444),
                            INT16_C( 22843), INT16_C( 28625), INT16_C( -2322), INT16_C(  5251)),
      easysimd_mm512_set_epi16(INT16_C(     0),        INT16_MAX, -INT16_C(  4984),  INT16_C( 19498),  INT16_C(  5563),  INT16_C(     0),  INT16_C( 32151),  INT16_C( 31904),
                           INT16_C(     0), -INT16_C( 17852),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 22377),  INT16_C(     0),  INT16_C( 22287),
                           INT16_C(     0),  INT16_C( 15823),  INT16_C(     0),  INT16_C(     0),        INT16_MIN,  INT16_C(     0),        INT16_MAX,  INT16_C(     0),
                           INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C(  2931),  INT16_C(     0),  INT16_C(     0), -INT16_C( 22407) ) },
    { UINT32_C(          2108134501),
      easysimd_mm512_set_epi16(INT16_C(-27508), INT16_C(  5509), INT16_C(-13526), INT16_C( 16909),
                            INT16_C(  2419), INT16_C( 22142), INT16_C( -6109), INT16_C( -1177),
                            INT16_C(  9839), INT16_C(  6329), INT16_C(  -239), INT16_C(-15885),
                            INT16_C(  3666), INT16_C( 20122), INT16_C( -1699), INT16_C(  6503),
                            INT16_C( 29169), INT16_C( -4681), INT16_C( -2713), INT16_C(-24709),
                            INT16_C(  7221), INT16_C( -3718), INT16_C(   970), INT16_C(-15558),
                            INT16_C(-11011), INT16_C(-10787), INT16_C(-29970), INT16_C(  3894),
                            INT16_C(-25914), INT16_C(-18758), INT16_C( 11824), INT16_C( -8868)),
      easysimd_mm512_set_epi16(INT16_C(  1604), INT16_C( 19874), INT16_C(-12133), INT16_C( -1966),
                            INT16_C( 13041), INT16_C(  1566), INT16_C(-11791), INT16_C( -3425),
                            INT16_C(  7377), INT16_C(-23380), INT16_C( -9249), INT16_C(-31251),
                            INT16_C( 14877), INT16_C( 24009), INT16_C(-32316), INT16_C(  8308),
                            INT16_C(-11725), INT16_C(-10230), INT16_C(  1074), INT16_C( 12341),
                            INT16_C( 19989), INT16_C( 16491), INT16_C(  4144), INT16_C(-11714),
                            INT16_C( 19285), INT16_C(-29198), INT16_C(-25258), INT16_C(-29514),
                            INT16_C(  9755), INT16_C(-29385), INT16_C(-23111), INT16_C( -3412)),
      easysimd_mm512_set_epi16(INT16_C(     0), -INT16_C( 14365), -INT16_C(  1393),  INT16_C( 18875), -INT16_C( 10622),  INT16_C( 20576),  INT16_C(     0),  INT16_C(  2248),
                            INT16_C(  2462),  INT16_C(     0),  INT16_C(  9010),  INT16_C(     0),  INT16_C(     0), -INT16_C(  3887),  INT16_C( 30617), -INT16_C(  1805),
                            INT16_MAX,  INT16_C(     0),  INT16_C(     0),        INT16_MIN,  INT16_C(     0), -INT16_C( 20209),  INT16_C(     0),  INT16_C(     0),
                            INT16_C(     0),  INT16_C( 18411), -INT16_C(  4712),  INT16_C(     0),  INT16_C(     0),  INT16_C( 10627),  INT16_C(     0), -INT16_C(  5456) ) },
    { UINT32_C(          1908131523),
      easysimd_mm512_set_epi16(INT16_C(   691), INT16_C( -4823), INT16_C( -3253), INT16_C(-31392),
                            INT16_C(-21784), INT16_C( -6740), INT16_C(  9130), INT16_C(-18273),
                            INT16_C( 11275), INT16_C(-27092), INT16_C(    90), INT16_C(-20133),
                            INT16_C( 30523), INT16_C( 27008), INT16_C( 28387), INT16_C( 17266),
                            INT16_C( -9777), INT16_C( 27096), INT16_C( -8328), INT16_C( -6812),
                            INT16_C(-22954), INT16_C( -4409), INT16_C( 21734), INT16_C(-19695),
                            INT16_C(-11981), INT16_C(-21195), INT16_C( 18272), INT16_C( 28327),
                            INT16_C(  7123), INT16_C(-32216), INT16_C( 24489), INT16_C(-15668)),
      easysimd_mm512_set_epi16(INT16_C(-21377), INT16_C( 15856), INT16_C(  7686), INT16_C(-28568),
                            INT16_C(-15192), INT16_C( -9747), INT16_C( 11300), INT16_C( 27000),
                            INT16_C( -6635), INT16_C(  3626), INT16_C( 12716), INT16_C(-30571),
                            INT16_C( 31697), INT16_C(  5622), INT16_C( 24444), INT16_C( -8226),
                            INT16_C( -8263), INT16_C(  2890), INT16_C( 26732), INT16_C( -8763),
                            INT16_C(-13950), INT16_C( 27415), INT16_C(  7653), INT16_C( 31511),
                            INT16_C(-21082), INT16_C(  2398), INT16_C( 23365), INT16_C(-12903),
                            INT16_C(-18221), INT16_C(  4204), INT16_C(-20453), INT16_C( 15021)),
      easysimd_mm512_set_epi16(INT16_C(     0), -INT16_C( 20679), -INT16_C( 10939), -INT16_C(  2824),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MIN,
                            INT16_C( 17910),  INT16_C(     0), -INT16_C( 12626),  INT16_C( 10438), -INT16_C(  1174),  INT16_C(     0),  INT16_C(  3943),  INT16_C( 25492),
                           -INT16_C(  1514),  INT16_C( 24206),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 31824),  INT16_C( 14081),  INT16_C(     0),
                            INT16_C(  9101), -INT16_C( 23593),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MAX, -INT16_C( 30689) ) },
    { UINT32_C(          1968130023),
      easysimd_mm512_set_epi16(INT16_C(  4451), INT16_C( -3121), INT16_C( 11648), INT16_C( 14185),
                            INT16_C( -8499), INT16_C(-24679), INT16_C(-31633), INT16_C( 19019),
                            INT16_C( 26210), INT16_C(-29943), INT16_C(-18883), INT16_C( 25468),
                            INT16_C( 20366), INT16_C(  4961), INT16_C(-25468), INT16_C( -4158),
                            INT16_C(  6653), INT16_C( -1720), INT16_C(-29723), INT16_C(-14244),
                            INT16_C( -4917), INT16_C(   730), INT16_C(-20677), INT16_C( 16986),
                            INT16_C(  9316), INT16_C( 28795), INT16_C(-18273), INT16_C(-29423),
                            INT16_C(-23674), INT16_C(  7963), INT16_C( 28019), INT16_C( 13728)),
      easysimd_mm512_set_epi16(INT16_C(-10770), INT16_C( 29411), INT16_C( 30463), INT16_C( -4902),
                            INT16_C(-20392), INT16_C(-28251), INT16_C( 11448), INT16_C( 27155),
                            INT16_C(-11669), INT16_C( 11820), INT16_C(-16512), INT16_C( 10540),
                            INT16_C( 17477), INT16_C(-19759), INT16_C( 28024), INT16_C(-14431),
                            INT16_C( 24400), INT16_C( -7583), INT16_C(-12129), INT16_C( 28592),
                            INT16_C(-31057), INT16_C(-18091), INT16_C( 19926), INT16_C(-29261),
                            INT16_C(  7501), INT16_C( 16620), INT16_C(  6953), INT16_C(  3437),
                            INT16_C(  5790), INT16_C(  5348), INT16_C( 17145), INT16_C(-28791)),
      easysimd_mm512_set_epi16(INT16_C(     0), -INT16_C( 32532), -INT16_C( 18815),  INT16_C( 19087),  INT16_C(     0),  INT16_C(  3572),  INT16_C(     0), -INT16_C(  8136),
                            INT16_C(     0),        INT16_MIN,  INT16_C(     0),  INT16_C(     0),  INT16_C(  2889),  INT16_C( 24720),        INT16_MIN,  INT16_C( 10273),
                            INT16_C(     0),  INT16_C(  5863),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C( 18821),        INT16_MIN,        INT16_MAX,
                            INT16_C(  1815),  INT16_C( 12175), -INT16_C( 25226),  INT16_C(     0),  INT16_C(     0),  INT16_C(  2615),  INT16_C( 10874),        INT16_MAX ) },
    { UINT32_C(          1758136623),
      easysimd_mm512_set_epi16(INT16_C(-31561), INT16_C( 18949), INT16_C( -2287), INT16_C(-20534),
                            INT16_C( -1057), INT16_C( -3046), INT16_C( 22138), INT16_C(-11031),
                            INT16_C(    43), INT16_C( -6266), INT16_C(-20090), INT16_C(-22393),
                            INT16_C(-26046), INT16_C(-23703), INT16_C( 28092), INT16_C(  6346),
                            INT16_C( 10308), INT16_C(   572), INT16_C(     5), INT16_C( 15306),
                            INT16_C(-19429), INT16_C( -5811), INT16_C(-27420), INT16_C(-29128),
                            INT16_C(-13676), INT16_C( -3673), INT16_C(-26157), INT16_C( 19197),
                            INT16_C(-27593), INT16_C(-20030), INT16_C(  3690), INT16_C( -3850)),
      easysimd_mm512_set_epi16(INT16_C(-11908), INT16_C( 14774), INT16_C(  5244), INT16_C( 18107),
                            INT16_C(-16396), INT16_C( 31910), INT16_C(-28865), INT16_C(-20038),
                            INT16_C(-19234), INT16_C(-15108), INT16_C(-10436), INT16_C( 19911),
                            INT16_C(  3330), INT16_C( 28633), INT16_C( 10550), INT16_C( -9358),
                            INT16_C( 23697), INT16_C( 19726), INT16_C(-26407), INT16_C(-18878),
                            INT16_C(  4326), INT16_C(-22642), INT16_C(-17402), INT16_C( 16035),
                            INT16_C( 14223), INT16_C(-15160), INT16_C( -9470), INT16_C( -3752),
                            INT16_C(  6710), INT16_C( 21116), INT16_C( -9579), INT16_C( 10253)),
      easysimd_mm512_set_epi16(INT16_C(     0),  INT16_C(  4175), -INT16_C(  7531),  INT16_C(     0),  INT16_C( 15339),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
                            INT16_C( 19277),  INT16_C(  8842),  INT16_C(     0),  INT16_C(     0), -INT16_C( 29376),  INT16_C(     0),  INT16_C( 17542),  INT16_C( 15704),
                            INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 23755),  INT16_C(     0),  INT16_C(     0),        INT16_MIN,
                            INT16_C(     0),  INT16_C(     0), -INT16_C( 16687),  INT16_C(     0),        INT16_MIN,        INT16_MIN,  INT16_C( 13269), -INT16_C( 14103)) },
    { UINT32_C(          1158536729),
      easysimd_mm512_set_epi16(INT16_C(  1468), INT16_C( -4389), INT16_C(  1296), INT16_C(-27715),
                            INT16_C(-15620), INT16_C(  3731), INT16_C( -7289), INT16_C(-27703),
                            INT16_C(   474), INT16_C( 27447), INT16_C( -9036), INT16_C(  9176),
                            INT16_C(  2726), INT16_C(-12144), INT16_C( -2101), INT16_C( 26907),
                            INT16_C(-24700), INT16_C(  1244), INT16_C( -3927), INT16_C(-22632),
                            INT16_C( -7525), INT16_C( 17743), INT16_C( 15263), INT16_C( -3823),
                            INT16_C( 27307), INT16_C( 32391), INT16_C(-23270), INT16_C(-29301),
                            INT16_C( 23369), INT16_C(-15291), INT16_C( -5840), INT16_C( 18168)),
      easysimd_mm512_set_epi16(INT16_C( 23449), INT16_C( 17725), INT16_C(-20919), INT16_C( 31466),
                            INT16_C( 31308), INT16_C( -2183), INT16_C(-31351), INT16_C(-32386),
                            INT16_C( 26890), INT16_C(-30591), INT16_C(-12785), INT16_C(-23638),
                            INT16_C(-31955), INT16_C( -9847), INT16_C( 19108), INT16_C(-19915),
                            INT16_C(  4587), INT16_C( 27034), INT16_C(   -19), INT16_C( 28332),
                            INT16_C(-23789), INT16_C(-24960), INT16_C( -5839), INT16_C( 25722),
                            INT16_C(-24423), INT16_C( 15592), INT16_C(  6092), INT16_C( -9272),
                            INT16_C(-12796), INT16_C(-17663), INT16_C( -6154), INT16_C( 23859)),
      easysimd_mm512_set_epi16(INT16_C(     0), -INT16_C( 22114),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(  5914),  INT16_C(     0),  INT16_C(  4683),
                            INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MAX, -INT16_C(  2297),  INT16_C(     0),        INT16_MAX,
                           -INT16_C( 29287), -INT16_C( 25790),  INT16_C(     0),        INT16_MIN,  INT16_C( 16264),        INT16_MAX,  INT16_C( 21102),  INT16_C(     0),
                            INT16_C(     0),  INT16_C(     0),  INT16_C(     0), -INT16_C( 20029),        INT16_MAX,  INT16_C(     0),  INT16_C(     0), -INT16_C(  5691) ) },
    { UINT32_C(          1458560829),
      easysimd_mm512_set_epi16(INT16_C(-22741), INT16_C( 13394), INT16_C( -9417), INT16_C( 28906),
                            INT16_C(-18980), INT16_C( -8463), INT16_C(  9174), INT16_C(-25605),
                            INT16_C(   547), INT16_C(  3767), INT16_C(-12577), INT16_C(-16546),
                            INT16_C( -1301), INT16_C( -7147), INT16_C( 26281), INT16_C( 29309),
                            INT16_C( 29052), INT16_C(-30842), INT16_C(  5995), INT16_C(  6270),
                            INT16_C( 20539), INT16_C( 10179), INT16_C(-26848), INT16_C( 14327),
                            INT16_C( 15491), INT16_C( 18652), INT16_C( 19903), INT16_C( 30123),
                            INT16_C( 25261), INT16_C(-17460), INT16_C( 10742), INT16_C( -4552)),
      easysimd_mm512_set_epi16(INT16_C(  5754), INT16_C(-23038), INT16_C(-16589), INT16_C(-23858),
                            INT16_C( -3821), INT16_C( -4798), INT16_C( 30602), INT16_C(-28532),
                            INT16_C( 11508), INT16_C(  7979), INT16_C( -3877), INT16_C( -5920),
                            INT16_C(-24150), INT16_C(-24496), INT16_C( 17421), INT16_C( -1981),
                            INT16_C( 27523), INT16_C( 26800), INT16_C( 25010), INT16_C( 27339),
                            INT16_C( -9050), INT16_C( 19128), INT16_C( 15279), INT16_C( -1817),
                            INT16_C(-13923), INT16_C(  5129), INT16_C(-22618), INT16_C( 27704),
                            INT16_C( -4783), INT16_C( 31238), INT16_C(-30342), INT16_C( -8854)),
      easysimd_mm512_set_epi16(INT16_C(     0),        INT16_MAX,  INT16_C(     0),        INT16_MAX,  INT16_C(     0), -INT16_C(  3665), -INT16_C( 21428),  INT16_C(     0),
                           -INT16_C( 10961), -INT16_C(  4212), -INT16_C(  8700),  INT16_C(     0),  INT16_C( 22849),  INT16_C( 17349),  INT16_C(  8860),  INT16_C( 31290),
                            INT16_C(  1529),        INT16_MIN,  INT16_C(     0), -INT16_C( 21069),  INT16_C( 29589), -INT16_C(  8949),        INT16_MIN,  INT16_C( 16144),
                            INT16_C(     0),  INT16_C(     0),        INT16_MAX,  INT16_C(  2419),  INT16_C( 30044),        INT16_MIN,  INT16_C(     0),  INT16_C(  4302)) },
    { UINT32_C(          2008550329),
      easysimd_mm512_set_epi16(INT16_C( 27021), INT16_C( 31131), INT16_C(    63), INT16_C(-10530),
                            INT16_C( -1071), INT16_C(-31284), INT16_C(-21788), INT16_C(-16108),
                            INT16_C(-15167), INT16_C( 25422), INT16_C( 14520), INT16_C(-13896),
                            INT16_C( 20399), INT16_C( 31915), INT16_C(-16518), INT16_C( -6202),
                            INT16_C(-16332), INT16_C( -3071), INT16_C(-15644), INT16_C( -7016),
                            INT16_C( 13977), INT16_C(-13846), INT16_C(-23290), INT16_C( -2079),
                            INT16_C(  4753), INT16_C( 14919), INT16_C(-18528), INT16_C(  7420),
                            INT16_C( 12098), INT16_C( 31014), INT16_C( 17813), INT16_C(-14456)),
      easysimd_mm512_set_epi16(INT16_C(-12529), INT16_C( -3643), INT16_C(-28826), INT16_C(-12110),
                            INT16_C(  8030), INT16_C( 20316), INT16_C( 27324), INT16_C( 24735),
                            INT16_C( -6774), INT16_C( -2704), INT16_C(-31930), INT16_C(  6874),
                            INT16_C( -3952), INT16_C(  2658), INT16_C(  -904), INT16_C( -8319),
                            INT16_C(-16424), INT16_C( 22778), INT16_C( 18985), INT16_C( 10063),
                            INT16_C(-31751), INT16_C( 16016), INT16_C(-30217), INT16_C( 18364),
                            INT16_C(-20176), INT16_C( -4961), INT16_C(-29576), INT16_C(-16634),
                            INT16_C( -8011), INT16_C(-27110), INT16_C(-24526), INT16_C(-11504)),
      easysimd_mm512_set_epi16(INT16_C(     0),        INT16_MAX,  INT16_C( 28889),  INT16_C(  1580),  INT16_C(     0),        INT16_MIN,        INT16_MIN,        INT16_MIN,
                            -INT16_C(  8393),  INT16_C(     0),        INT16_MAX, -INT16_C( 20770),  INT16_C( 24351),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),
                            INT16_C(     0),  INT16_C(     0),  INT16_C(     0),  INT16_C(     0),        INT16_MAX,  INT16_C(     0),  INT16_C(  6927), -INT16_C( 20443),
                            INT16_C( 24929),  INT16_C(     0),  INT16_C( 11048),  INT16_C( 24054),  INT16_C( 20109),  INT16_C(     0),  INT16_C(     0), -INT16_C(  2952) ) }
  };
  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__mmask32 k = test_vec[i].k;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_maskz_subs_epi16(k, a, b);
    } EASYSIMD_TEST_PERF_END("_mm512_maskz_subs_epi16");
    easysimd_assert_m512i_i16(test_vec[i].r, ==, r);
    easysimd_assert_m512i_i16(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_subs_epu8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_x_mm512_set_epu8(UINT8_C( 82), UINT8_C( 83), UINT8_C(117), UINT8_C( 65),
                             UINT8_C(209), UINT8_C(134), UINT8_C(116), UINT8_C( 14),
                             UINT8_C( 76), UINT8_C(  1), UINT8_C(206), UINT8_C(  4),
                             UINT8_C( 83), UINT8_C(179), UINT8_C(112), UINT8_C(154),
                             UINT8_C( 99), UINT8_C(138), UINT8_C(209), UINT8_C(189),
                             UINT8_C( 60), UINT8_C(222), UINT8_C( 78), UINT8_C(146),
                             UINT8_C(198), UINT8_C( 87), UINT8_C(195), UINT8_C( 26),
                             UINT8_C(239), UINT8_C(210), UINT8_C(116), UINT8_C(236),
                             UINT8_C(136), UINT8_C( 48), UINT8_C( 24), UINT8_C( 46),
                             UINT8_C(103), UINT8_C(222), UINT8_C( 42), UINT8_C( 51),
                             UINT8_C(191), UINT8_C( 86), UINT8_C( 61), UINT8_C(200),
                             UINT8_C( 58), UINT8_C(119), UINT8_C( 93), UINT8_C(255),
                             UINT8_C(198), UINT8_C(135), UINT8_C(224), UINT8_C( 98),
                             UINT8_C(190), UINT8_C( 79), UINT8_C( 99), UINT8_C(163),
                             UINT8_C( 77), UINT8_C(200), UINT8_C(178), UINT8_C( 39),
                             UINT8_C(206), UINT8_C(196), UINT8_C(188), UINT8_C(252)),
      easysimd_x_mm512_set_epu8(UINT8_C(106), UINT8_C( 39), UINT8_C(150), UINT8_C( 14),
                             UINT8_C(228), UINT8_C(254), UINT8_C( 39), UINT8_C(228),
                             UINT8_C( 54), UINT8_C( 70), UINT8_C(237), UINT8_C(244),
                             UINT8_C(214), UINT8_C( 28), UINT8_C(243), UINT8_C(250),
                             UINT8_C(116), UINT8_C(  2), UINT8_C( 23), UINT8_C(121),
                             UINT8_C(112), UINT8_C(221), UINT8_C(132), UINT8_C( 10),
                             UINT8_C(240), UINT8_C(139), UINT8_C( 26), UINT8_C(131),
                             UINT8_C( 36), UINT8_C(109), UINT8_C( 29), UINT8_C(221),
                             UINT8_C(247), UINT8_C(171), UINT8_C(218), UINT8_C( 95),
                             UINT8_C(168), UINT8_C(  3), UINT8_C(  4), UINT8_C(100),
                             UINT8_C( 85), UINT8_C( 21), UINT8_C( 66), UINT8_C(223),
                             UINT8_C(179), UINT8_C(251), UINT8_C(130), UINT8_C(122),
                             UINT8_C(226), UINT8_C(173), UINT8_C( 74), UINT8_C(148),
                             UINT8_C( 83), UINT8_C(160), UINT8_C(199), UINT8_C(148),
                             UINT8_C( 89), UINT8_C( 59), UINT8_C(111), UINT8_C(209),
                             UINT8_C(246), UINT8_C(238), UINT8_C( 20), UINT8_C(131)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C( 44), UINT8_C(  0), UINT8_C( 51),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 77), UINT8_C(  0),
                             UINT8_C( 22), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(151), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(136), UINT8_C(186), UINT8_C( 68),
                             UINT8_C(  0), UINT8_C(  1), UINT8_C(  0), UINT8_C(136),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(169), UINT8_C(  0),
                             UINT8_C(203), UINT8_C(101), UINT8_C( 87), UINT8_C( 15),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(219), UINT8_C( 38), UINT8_C(  0),
                             UINT8_C(106), UINT8_C( 65), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(133),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(150), UINT8_C(  0),
                             UINT8_C(107), UINT8_C(  0), UINT8_C(  0), UINT8_C( 15),
                             UINT8_C(  0), UINT8_C(141), UINT8_C( 67), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(168), UINT8_C(121)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(148), UINT8_C(140), UINT8_C( 21), UINT8_C(133),
                             UINT8_C(203), UINT8_C( 42), UINT8_C( 66), UINT8_C( 13),
                             UINT8_C(  9), UINT8_C(115), UINT8_C( 86), UINT8_C(126),
                             UINT8_C(232), UINT8_C( 35), UINT8_C(251), UINT8_C(103),
                             UINT8_C( 38), UINT8_C(111), UINT8_C( 24), UINT8_C(185),
                             UINT8_C(255), UINT8_C( 17), UINT8_C(193), UINT8_C(243),
                             UINT8_C( 14), UINT8_C( 82), UINT8_C( 78), UINT8_C(154),
                             UINT8_C(249), UINT8_C( 93), UINT8_C( 25), UINT8_C(103),
                             UINT8_C(113), UINT8_C(241), UINT8_C(237), UINT8_C(183),
                             UINT8_C(245), UINT8_C(103), UINT8_C(159), UINT8_C(123),
                             UINT8_C( 28), UINT8_C( 53), UINT8_C(241), UINT8_C(122),
                             UINT8_C(  3), UINT8_C(202), UINT8_C(195), UINT8_C( 58),
                             UINT8_C(212), UINT8_C(253), UINT8_C(213), UINT8_C(221),
                             UINT8_C(138), UINT8_C(238), UINT8_C( 15), UINT8_C( 54),
                             UINT8_C(154), UINT8_C(198), UINT8_C(182), UINT8_C(186),
                             UINT8_C( 46), UINT8_C( 48), UINT8_C(221), UINT8_C( 92)),
      easysimd_x_mm512_set_epu8(UINT8_C(  6), UINT8_C( 68), UINT8_C( 77), UINT8_C(162),
                             UINT8_C(208), UINT8_C(155), UINT8_C(248), UINT8_C( 82),
                             UINT8_C( 50), UINT8_C(241), UINT8_C(  6), UINT8_C( 30),
                             UINT8_C(209), UINT8_C(241), UINT8_C(242), UINT8_C(159),
                             UINT8_C( 28), UINT8_C(209), UINT8_C(164), UINT8_C(172),
                             UINT8_C(219), UINT8_C(223), UINT8_C(133), UINT8_C(237),
                             UINT8_C( 58), UINT8_C( 29), UINT8_C( 93), UINT8_C(201),
                             UINT8_C(129), UINT8_C(196), UINT8_C( 32), UINT8_C(116),
                             UINT8_C(210), UINT8_C( 51), UINT8_C(216), UINT8_C( 10),
                             UINT8_C(  4), UINT8_C( 50), UINT8_C( 48), UINT8_C( 53),
                             UINT8_C( 78), UINT8_C( 21), UINT8_C( 64), UINT8_C(107),
                             UINT8_C( 16), UINT8_C( 48), UINT8_C(210), UINT8_C( 62),
                             UINT8_C( 75), UINT8_C( 85), UINT8_C(141), UINT8_C(242),
                             UINT8_C(157), UINT8_C( 86), UINT8_C(140), UINT8_C(182),
                             UINT8_C( 38), UINT8_C( 27), UINT8_C(141), UINT8_C( 55),
                             UINT8_C(165), UINT8_C(185), UINT8_C(242), UINT8_C(172)),
      easysimd_x_mm512_set_epu8(UINT8_C(142), UINT8_C( 72), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 80), UINT8_C( 96),
                             UINT8_C( 23), UINT8_C(  0), UINT8_C(  9), UINT8_C(  0),
                             UINT8_C( 10), UINT8_C(  0), UINT8_C(  0), UINT8_C( 13),
                             UINT8_C( 36), UINT8_C(  0), UINT8_C( 60), UINT8_C(  6),
                             UINT8_C(  0), UINT8_C( 53), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(120), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(190), UINT8_C( 21), UINT8_C(173),
                             UINT8_C(241), UINT8_C( 53), UINT8_C(111), UINT8_C( 70),
                             UINT8_C(  0), UINT8_C( 32), UINT8_C(177), UINT8_C( 15),
                             UINT8_C(  0), UINT8_C(154), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(137), UINT8_C(168), UINT8_C( 72), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(152), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(116), UINT8_C(171), UINT8_C( 41), UINT8_C(131),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(  2), UINT8_C(179), UINT8_C(237), UINT8_C( 41),
                             UINT8_C(243), UINT8_C( 75), UINT8_C(133), UINT8_C( 96),
                             UINT8_C(170), UINT8_C(232), UINT8_C(229), UINT8_C(172),
                             UINT8_C( 35), UINT8_C(170), UINT8_C(184), UINT8_C(159),
                             UINT8_C( 44), UINT8_C( 11), UINT8_C(150), UINT8_C( 44),
                             UINT8_C(  0), UINT8_C( 90), UINT8_C(177), UINT8_C( 91),
                             UINT8_C(119), UINT8_C( 59), UINT8_C(105), UINT8_C(128),
                             UINT8_C(110), UINT8_C(227), UINT8_C( 67), UINT8_C(114),
                             UINT8_C(217), UINT8_C(207), UINT8_C(105), UINT8_C(216),
                             UINT8_C(223), UINT8_C(120), UINT8_C(229), UINT8_C(100),
                             UINT8_C(166), UINT8_C( 86), UINT8_C(238), UINT8_C(199),
                             UINT8_C( 84), UINT8_C(230), UINT8_C(179), UINT8_C( 17),
                             UINT8_C(209), UINT8_C( 51), UINT8_C(173), UINT8_C( 53),
                             UINT8_C( 71), UINT8_C( 96), UINT8_C(110), UINT8_C(167),
                             UINT8_C( 27), UINT8_C(211), UINT8_C(130), UINT8_C( 40),
                             UINT8_C( 95), UINT8_C(169), UINT8_C(194), UINT8_C(204)),
      easysimd_x_mm512_set_epu8(UINT8_C(172), UINT8_C(127), UINT8_C( 61), UINT8_C(240),
                             UINT8_C( 30), UINT8_C(  6), UINT8_C(144), UINT8_C(104),
                             UINT8_C(196), UINT8_C(168), UINT8_C(217), UINT8_C(237),
                             UINT8_C( 44), UINT8_C( 36), UINT8_C(105), UINT8_C(120),
                             UINT8_C(230), UINT8_C( 21), UINT8_C( 14), UINT8_C( 42),
                             UINT8_C( 49), UINT8_C(172), UINT8_C(136), UINT8_C(149),
                             UINT8_C(123), UINT8_C(209), UINT8_C( 21), UINT8_C(246),
                             UINT8_C( 95), UINT8_C(124), UINT8_C(223), UINT8_C(222),
                             UINT8_C(223), UINT8_C(185), UINT8_C( 11), UINT8_C( 74),
                             UINT8_C(104), UINT8_C(108), UINT8_C(221), UINT8_C(197),
                             UINT8_C(201), UINT8_C(130), UINT8_C(107), UINT8_C( 23),
                             UINT8_C( 29), UINT8_C(229), UINT8_C(123), UINT8_C( 23),
                             UINT8_C(173), UINT8_C(166), UINT8_C(  9), UINT8_C( 94),
                             UINT8_C( 91), UINT8_C( 69), UINT8_C(205), UINT8_C(153),
                             UINT8_C(184), UINT8_C(211), UINT8_C( 16), UINT8_C(108),
                             UINT8_C(176), UINT8_C( 27), UINT8_C( 58), UINT8_C(173)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C( 52), UINT8_C(176), UINT8_C(  0),
                             UINT8_C(213), UINT8_C( 69), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 64), UINT8_C( 12), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(134), UINT8_C( 79), UINT8_C( 39),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(136), UINT8_C(  2),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 41), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 84), UINT8_C(  0),
                             UINT8_C( 15), UINT8_C(103), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 22), UINT8_C( 94), UINT8_C(142),
                             UINT8_C(119), UINT8_C( 12), UINT8_C(  8), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(131), UINT8_C(176),
                             UINT8_C( 55), UINT8_C(  1), UINT8_C( 56), UINT8_C(  0),
                             UINT8_C( 36), UINT8_C(  0), UINT8_C(164), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 27), UINT8_C(  0), UINT8_C( 14),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(114), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(142), UINT8_C(136), UINT8_C( 31)) },
    { easysimd_x_mm512_set_epu8(UINT8_C( 17), UINT8_C( 99), UINT8_C(243), UINT8_C(207),
                             UINT8_C( 45), UINT8_C(128), UINT8_C( 55), UINT8_C(105),
                             UINT8_C(222), UINT8_C(205), UINT8_C(159), UINT8_C(153),
                             UINT8_C(132), UINT8_C(111), UINT8_C( 74), UINT8_C( 75),
                             UINT8_C(102), UINT8_C( 98), UINT8_C(139), UINT8_C(  9),
                             UINT8_C(182), UINT8_C( 61), UINT8_C( 99), UINT8_C(124),
                             UINT8_C( 79), UINT8_C(142), UINT8_C( 19), UINT8_C( 97),
                             UINT8_C(156), UINT8_C(132), UINT8_C(239), UINT8_C(194),
                             UINT8_C( 25), UINT8_C(253), UINT8_C(249), UINT8_C( 72),
                             UINT8_C(139), UINT8_C(229), UINT8_C(200), UINT8_C( 92),
                             UINT8_C(236), UINT8_C(203), UINT8_C(  2), UINT8_C(218),
                             UINT8_C(175), UINT8_C( 59), UINT8_C( 66), UINT8_C( 90),
                             UINT8_C( 36), UINT8_C(100), UINT8_C(112), UINT8_C(123),
                             UINT8_C(184), UINT8_C(159), UINT8_C(141), UINT8_C( 17),
                             UINT8_C(163), UINT8_C(134), UINT8_C( 31), UINT8_C( 27),
                             UINT8_C(109), UINT8_C(115), UINT8_C( 53), UINT8_C(160)),
      easysimd_x_mm512_set_epu8(UINT8_C(213), UINT8_C(238), UINT8_C(114), UINT8_C(227),
                             UINT8_C(118), UINT8_C(255), UINT8_C(236), UINT8_C(218),
                             UINT8_C(176), UINT8_C( 88), UINT8_C(145), UINT8_C(165),
                             UINT8_C( 44), UINT8_C(184), UINT8_C(106), UINT8_C( 19),
                             UINT8_C(210), UINT8_C(107), UINT8_C( 46), UINT8_C( 44),
                             UINT8_C(191), UINT8_C(128), UINT8_C( 41), UINT8_C( 44),
                             UINT8_C( 68), UINT8_C( 69), UINT8_C(178), UINT8_C(209),
                             UINT8_C(109), UINT8_C(120), UINT8_C(199), UINT8_C(161),
                             UINT8_C( 95), UINT8_C( 80), UINT8_C(226), UINT8_C( 97),
                             UINT8_C(208), UINT8_C(159), UINT8_C(111), UINT8_C(176),
                             UINT8_C(134), UINT8_C(175), UINT8_C(185), UINT8_C( 85),
                             UINT8_C( 77), UINT8_C(214), UINT8_C(141), UINT8_C(179),
                             UINT8_C( 29), UINT8_C( 77), UINT8_C( 64), UINT8_C(236),
                             UINT8_C( 27), UINT8_C( 41), UINT8_C( 13), UINT8_C(109),
                             UINT8_C( 22), UINT8_C(158), UINT8_C( 20), UINT8_C(228),
                             UINT8_C( 66), UINT8_C(249), UINT8_C(143), UINT8_C(137)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(129), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 46), UINT8_C(117), UINT8_C( 14), UINT8_C(  0),
                             UINT8_C( 88), UINT8_C(  0), UINT8_C(  0), UINT8_C( 56),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 93), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 58), UINT8_C( 80),
                             UINT8_C( 11), UINT8_C( 73), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 47), UINT8_C( 12), UINT8_C( 40), UINT8_C( 33),
                             UINT8_C(  0), UINT8_C(173), UINT8_C( 23), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 70), UINT8_C( 89), UINT8_C(  0),
                             UINT8_C(102), UINT8_C( 28), UINT8_C(  0), UINT8_C(133),
                             UINT8_C( 98), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  7), UINT8_C( 23), UINT8_C( 48), UINT8_C(  0),
                             UINT8_C(157), UINT8_C(118), UINT8_C(128), UINT8_C(  0),
                             UINT8_C(141), UINT8_C(  0), UINT8_C( 11), UINT8_C(  0),
                             UINT8_C( 43), UINT8_C(  0), UINT8_C(  0), UINT8_C( 23)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(132), UINT8_C(183), UINT8_C( 74), UINT8_C(  5),
                             UINT8_C(247), UINT8_C( 17), UINT8_C(175), UINT8_C(202),
                             UINT8_C(251), UINT8_C(223), UINT8_C(244), UINT8_C( 26),
                             UINT8_C( 86), UINT8_C(122), UINT8_C(212), UINT8_C(233),
                             UINT8_C(  0), UINT8_C( 43), UINT8_C(231), UINT8_C(134),
                             UINT8_C(177), UINT8_C(134), UINT8_C(168), UINT8_C(135),
                             UINT8_C(154), UINT8_C( 66), UINT8_C(163), UINT8_C(105),
                             UINT8_C(109), UINT8_C(188), UINT8_C( 24), UINT8_C(202),
                             UINT8_C( 40), UINT8_C( 68), UINT8_C(  2), UINT8_C( 60),
                             UINT8_C(  0), UINT8_C(  5), UINT8_C( 59), UINT8_C(202),
                             UINT8_C(180), UINT8_C( 27), UINT8_C(233), UINT8_C( 77),
                             UINT8_C(148), UINT8_C(228), UINT8_C(142), UINT8_C( 56),
                             UINT8_C(202), UINT8_C(148), UINT8_C(241), UINT8_C(167),
                             UINT8_C(153), UINT8_C(211), UINT8_C( 74), UINT8_C(253),
                             UINT8_C(148), UINT8_C( 55), UINT8_C(177), UINT8_C(194),
                             UINT8_C( 14), UINT8_C(106), UINT8_C(240), UINT8_C(246)),
      easysimd_x_mm512_set_epu8(UINT8_C(209), UINT8_C(124), UINT8_C( 57), UINT8_C(182),
                             UINT8_C( 20), UINT8_C(124), UINT8_C( 70), UINT8_C(187),
                             UINT8_C(191), UINT8_C(244), UINT8_C(124), UINT8_C(166),
                             UINT8_C(143), UINT8_C( 63), UINT8_C(177), UINT8_C(186),
                             UINT8_C(180), UINT8_C(222), UINT8_C(196), UINT8_C(252),
                             UINT8_C(215), UINT8_C( 60), UINT8_C( 77), UINT8_C(199),
                             UINT8_C( 13), UINT8_C(  2), UINT8_C(111), UINT8_C(217),
                             UINT8_C( 41), UINT8_C( 54), UINT8_C(219), UINT8_C(114),
                             UINT8_C( 92), UINT8_C(145), UINT8_C( 77), UINT8_C( 14),
                             UINT8_C(152), UINT8_C(217), UINT8_C(182), UINT8_C( 66),
                             UINT8_C( 16), UINT8_C(230), UINT8_C(167), UINT8_C(142),
                             UINT8_C(188), UINT8_C(  6), UINT8_C( 62), UINT8_C(163),
                             UINT8_C( 55), UINT8_C(143), UINT8_C(196), UINT8_C(200),
                             UINT8_C(219), UINT8_C(  2), UINT8_C(241), UINT8_C( 88),
                             UINT8_C( 26), UINT8_C( 54), UINT8_C( 82), UINT8_C(124),
                             UINT8_C(218), UINT8_C(149), UINT8_C( 40), UINT8_C( 13)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C( 59), UINT8_C( 17), UINT8_C(  0),
                             UINT8_C(227), UINT8_C(  0), UINT8_C(105), UINT8_C( 15),
                             UINT8_C( 60), UINT8_C(  0), UINT8_C(120), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 59), UINT8_C( 35), UINT8_C( 47),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 35), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 74), UINT8_C( 91), UINT8_C(  0),
                             UINT8_C(141), UINT8_C( 64), UINT8_C( 52), UINT8_C(  0),
                             UINT8_C( 68), UINT8_C(134), UINT8_C(  0), UINT8_C( 88),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 46),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(136),
                             UINT8_C(164), UINT8_C(  0), UINT8_C( 66), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(222), UINT8_C( 80), UINT8_C(  0),
                             UINT8_C(147), UINT8_C(  5), UINT8_C( 45), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(209), UINT8_C(  0), UINT8_C(165),
                             UINT8_C(122), UINT8_C(  1), UINT8_C( 95), UINT8_C( 70),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(200), UINT8_C(233)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(  5), UINT8_C(188), UINT8_C(238), UINT8_C(219),
                             UINT8_C(  5), UINT8_C( 16), UINT8_C(147), UINT8_C(189),
                             UINT8_C(194), UINT8_C(252), UINT8_C( 14), UINT8_C(147),
                             UINT8_C(227), UINT8_C(135), UINT8_C(147), UINT8_C(201),
                             UINT8_C(  1), UINT8_C(218), UINT8_C(107), UINT8_C( 55),
                             UINT8_C(220), UINT8_C(180), UINT8_C( 35), UINT8_C(216),
                             UINT8_C( 10), UINT8_C(166), UINT8_C(208), UINT8_C(144),
                             UINT8_C(247), UINT8_C(203), UINT8_C(105), UINT8_C( 27),
                             UINT8_C(159), UINT8_C(132), UINT8_C(  4), UINT8_C(220),
                             UINT8_C(240), UINT8_C(169), UINT8_C(167), UINT8_C(152),
                             UINT8_C(226), UINT8_C(155), UINT8_C( 69), UINT8_C( 79),
                             UINT8_C( 59), UINT8_C(159), UINT8_C(241), UINT8_C( 17),
                             UINT8_C(106), UINT8_C(171), UINT8_C(126), UINT8_C(135),
                             UINT8_C(165), UINT8_C( 26), UINT8_C(141), UINT8_C(139),
                             UINT8_C( 91), UINT8_C( 73), UINT8_C(196), UINT8_C( 69),
                             UINT8_C(233), UINT8_C( 48), UINT8_C( 70), UINT8_C(248)),
      easysimd_x_mm512_set_epu8(UINT8_C( 91), UINT8_C(153), UINT8_C( 69), UINT8_C( 61),
                             UINT8_C(174), UINT8_C( 73), UINT8_C(122), UINT8_C(234),
                             UINT8_C(122), UINT8_C( 76), UINT8_C(247), UINT8_C(121),
                             UINT8_C(133), UINT8_C(137), UINT8_C(129), UINT8_C(126),
                             UINT8_C(105), UINT8_C( 10), UINT8_C(136), UINT8_C(129),
                             UINT8_C(206), UINT8_C( 15), UINT8_C(163), UINT8_C(170),
                             UINT8_C(131), UINT8_C( 45), UINT8_C(217), UINT8_C(137),
                             UINT8_C( 74), UINT8_C(164), UINT8_C(178), UINT8_C( 53),
                             UINT8_C( 17), UINT8_C(235), UINT8_C(105), UINT8_C(154),
                             UINT8_C(255), UINT8_C(237), UINT8_C(110), UINT8_C(172),
                             UINT8_C(163), UINT8_C( 19), UINT8_C(158), UINT8_C(128),
                             UINT8_C(233), UINT8_C( 49), UINT8_C(100), UINT8_C(122),
                             UINT8_C(160), UINT8_C(153), UINT8_C( 60), UINT8_C(232),
                             UINT8_C( 23), UINT8_C(204), UINT8_C(219), UINT8_C(200),
                             UINT8_C(206), UINT8_C(  4), UINT8_C(187), UINT8_C(  1),
                             UINT8_C(231), UINT8_C(246), UINT8_C( 93), UINT8_C( 51)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C( 35), UINT8_C(169), UINT8_C(158),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 25), UINT8_C(  0),
                             UINT8_C( 72), UINT8_C(176), UINT8_C(  0), UINT8_C( 26),
                             UINT8_C( 94), UINT8_C(  0), UINT8_C( 18), UINT8_C( 75),
                             UINT8_C(  0), UINT8_C(208), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 14), UINT8_C(165), UINT8_C(  0), UINT8_C( 46),
                             UINT8_C(  0), UINT8_C(121), UINT8_C(  0), UINT8_C(  7),
                             UINT8_C(173), UINT8_C( 39), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(142), UINT8_C(  0), UINT8_C(  0), UINT8_C( 66),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 57), UINT8_C(  0),
                             UINT8_C( 63), UINT8_C(136), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(110), UINT8_C(141), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 18), UINT8_C( 66), UINT8_C(  0),
                             UINT8_C(142), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 69), UINT8_C(  9), UINT8_C( 68),
                             UINT8_C(  2), UINT8_C(  0), UINT8_C(  0), UINT8_C(197)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(167), UINT8_C( 43), UINT8_C( 52), UINT8_C( 82),
                             UINT8_C(219), UINT8_C( 55), UINT8_C(112), UINT8_C(234),
                             UINT8_C(181), UINT8_C(220), UINT8_C(222), UINT8_C(241),
                             UINT8_C( 35), UINT8_C(214), UINT8_C(155), UINT8_C(251),
                             UINT8_C(  2), UINT8_C( 35), UINT8_C( 14), UINT8_C(183),
                             UINT8_C(206), UINT8_C(223), UINT8_C(191), UINT8_C( 94),
                             UINT8_C(250), UINT8_C(235), UINT8_C(228), UINT8_C( 21),
                             UINT8_C(102), UINT8_C(169), UINT8_C(114), UINT8_C(125),
                             UINT8_C(113), UINT8_C(124), UINT8_C(135), UINT8_C(134),
                             UINT8_C( 23), UINT8_C(107), UINT8_C( 24), UINT8_C(126),
                             UINT8_C( 80), UINT8_C( 59), UINT8_C( 39), UINT8_C(195),
                             UINT8_C(151), UINT8_C( 32), UINT8_C( 55), UINT8_C(247),
                             UINT8_C( 60), UINT8_C(131), UINT8_C( 72), UINT8_C(220),
                             UINT8_C( 77), UINT8_C(191), UINT8_C(117), UINT8_C(171),
                             UINT8_C( 98), UINT8_C(173), UINT8_C(187), UINT8_C(204),
                             UINT8_C( 41), UINT8_C(246), UINT8_C(238), UINT8_C( 56)),
      easysimd_x_mm512_set_epu8(UINT8_C( 22), UINT8_C(122), UINT8_C(166), UINT8_C(  2),
                             UINT8_C(191), UINT8_C( 51), UINT8_C(162), UINT8_C(206),
                             UINT8_C(241), UINT8_C( 19), UINT8_C(237), UINT8_C( 66),
                             UINT8_C(119), UINT8_C(138), UINT8_C(144), UINT8_C(140),
                             UINT8_C( 44), UINT8_C(244), UINT8_C( 31), UINT8_C( 43),
                             UINT8_C(240), UINT8_C(219), UINT8_C(232), UINT8_C(224),
                             UINT8_C(161), UINT8_C(170), UINT8_C(160), UINT8_C( 80),
                             UINT8_C( 68), UINT8_C( 13), UINT8_C(248), UINT8_C( 67),
                             UINT8_C(107), UINT8_C(131), UINT8_C(104), UINT8_C(176),
                             UINT8_C( 97), UINT8_C(178), UINT8_C(106), UINT8_C(203),
                             UINT8_C(220), UINT8_C(166), UINT8_C( 74), UINT8_C(184),
                             UINT8_C( 59), UINT8_C(175), UINT8_C(248), UINT8_C(231),
                             UINT8_C(201), UINT8_C(157), UINT8_C( 20), UINT8_C(  9),
                             UINT8_C(167), UINT8_C(166), UINT8_C(108), UINT8_C( 56),
                             UINT8_C(237), UINT8_C( 81), UINT8_C(122), UINT8_C(  6),
                             UINT8_C(137), UINT8_C(122), UINT8_C(221), UINT8_C(106)),
      easysimd_x_mm512_set_epu8(UINT8_C(145), UINT8_C(  0), UINT8_C(  0), UINT8_C( 80),
                             UINT8_C( 28), UINT8_C(  4), UINT8_C(  0), UINT8_C( 28),
                             UINT8_C(  0), UINT8_C(201), UINT8_C(  0), UINT8_C(175),
                             UINT8_C(  0), UINT8_C( 76), UINT8_C( 11), UINT8_C(111),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(140),
                             UINT8_C(  0), UINT8_C(  4), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 89), UINT8_C( 65), UINT8_C( 68), UINT8_C(  0),
                             UINT8_C( 34), UINT8_C(156), UINT8_C(  0), UINT8_C( 58),
                             UINT8_C(  6), UINT8_C(  0), UINT8_C( 31), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 11),
                             UINT8_C( 92), UINT8_C(  0), UINT8_C(  0), UINT8_C( 16),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 52), UINT8_C(211),
                             UINT8_C(  0), UINT8_C( 25), UINT8_C(  9), UINT8_C(115),
                             UINT8_C(  0), UINT8_C( 92), UINT8_C( 65), UINT8_C(198),
                             UINT8_C(  0), UINT8_C(124), UINT8_C( 17), UINT8_C(  0)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(105), UINT8_C(141), UINT8_C(121), UINT8_C(155),
                             UINT8_C(  0), UINT8_C( 63), UINT8_C(214), UINT8_C(222),
                             UINT8_C(251), UINT8_C(209), UINT8_C(133), UINT8_C(204),
                             UINT8_C(170), UINT8_C(228), UINT8_C(193), UINT8_C( 20),
                             UINT8_C(196), UINT8_C(193), UINT8_C( 99), UINT8_C( 78),
                             UINT8_C( 56), UINT8_C(184), UINT8_C(201), UINT8_C(184),
                             UINT8_C( 79), UINT8_C(175), UINT8_C(124), UINT8_C(171),
                             UINT8_C(191), UINT8_C(122), UINT8_C(231), UINT8_C(198),
                             UINT8_C(192), UINT8_C( 52), UINT8_C(244), UINT8_C(  1),
                             UINT8_C(194), UINT8_C(228), UINT8_C(228), UINT8_C(152),
                             UINT8_C( 54), UINT8_C(153), UINT8_C(201), UINT8_C(234),
                             UINT8_C(165), UINT8_C(  6), UINT8_C(247), UINT8_C(225),
                             UINT8_C( 18), UINT8_C(145), UINT8_C( 58), UINT8_C( 71),
                             UINT8_C(183), UINT8_C(160), UINT8_C( 28), UINT8_C(252),
                             UINT8_C( 47), UINT8_C( 66), UINT8_C(121), UINT8_C( 38),
                             UINT8_C( 69), UINT8_C(149), UINT8_C(199), UINT8_C(136)),
      easysimd_x_mm512_set_epu8(UINT8_C(207), UINT8_C( 15), UINT8_C(241), UINT8_C(197),
                             UINT8_C(143), UINT8_C(102), UINT8_C(208), UINT8_C(178),
                             UINT8_C( 31), UINT8_C( 94), UINT8_C( 79), UINT8_C( 92),
                             UINT8_C(106), UINT8_C(188), UINT8_C( 96), UINT8_C(159),
                             UINT8_C(229), UINT8_C(138), UINT8_C(245), UINT8_C(112),
                             UINT8_C(131), UINT8_C( 70), UINT8_C( 26), UINT8_C(218),
                             UINT8_C(240), UINT8_C(144), UINT8_C( 10), UINT8_C( 98),
                             UINT8_C(252), UINT8_C(120), UINT8_C(223), UINT8_C(129),
                             UINT8_C(191), UINT8_C(216), UINT8_C( 88), UINT8_C(250),
                             UINT8_C( 74), UINT8_C( 41), UINT8_C( 39), UINT8_C( 79),
                             UINT8_C(131), UINT8_C(249), UINT8_C( 62), UINT8_C(144),
                             UINT8_C(137), UINT8_C(247), UINT8_C( 71), UINT8_C(188),
                             UINT8_C(177), UINT8_C( 48), UINT8_C(236), UINT8_C(159),
                             UINT8_C(140), UINT8_C(120), UINT8_C(191), UINT8_C(  6),
                             UINT8_C(224), UINT8_C(181), UINT8_C(150), UINT8_C( 26),
                             UINT8_C(160), UINT8_C( 50), UINT8_C(211), UINT8_C( 16)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(126), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  6), UINT8_C( 44),
                             UINT8_C(220), UINT8_C(115), UINT8_C( 54), UINT8_C(112),
                             UINT8_C( 64), UINT8_C( 40), UINT8_C( 97), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 55), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(114), UINT8_C(175), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 31), UINT8_C(114), UINT8_C( 73),
                             UINT8_C(  0), UINT8_C(  2), UINT8_C(  8), UINT8_C( 69),
                             UINT8_C(  1), UINT8_C(  0), UINT8_C(156), UINT8_C(  0),
                             UINT8_C(120), UINT8_C(187), UINT8_C(189), UINT8_C( 73),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(139), UINT8_C( 90),
                             UINT8_C( 28), UINT8_C(  0), UINT8_C(176), UINT8_C( 37),
                             UINT8_C(  0), UINT8_C( 97), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 43), UINT8_C( 40), UINT8_C(  0), UINT8_C(246),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 12),
                             UINT8_C(  0), UINT8_C( 99), UINT8_C(  0), UINT8_C(120)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_subs_epu8(a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_subs_epu8");
    easysimd_assert_m512i_u8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_mask_subs_epu8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i src;
    easysimd__mmask64 k;
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_x_mm512_set_epu8(UINT8_C(160), UINT8_C(209), UINT8_C( 53), UINT8_C(241),
                             UINT8_C(169), UINT8_C( 74), UINT8_C(195), UINT8_C(156),
                             UINT8_C(226), UINT8_C(114), UINT8_C(119), UINT8_C(203),
                             UINT8_C( 15), UINT8_C( 80), UINT8_C(207), UINT8_C(120),
                             UINT8_C(164), UINT8_C(171), UINT8_C( 95), UINT8_C(130),
                             UINT8_C(161), UINT8_C(  3), UINT8_C( 82), UINT8_C(197),
                             UINT8_C( 78), UINT8_C(216), UINT8_C(176), UINT8_C(131),
                             UINT8_C(213), UINT8_C( 21), UINT8_C( 48), UINT8_C(162),
                             UINT8_C(135), UINT8_C( 81), UINT8_C( 67), UINT8_C(242),
                             UINT8_C( 97), UINT8_C( 89), UINT8_C(174), UINT8_C( 64),
                             UINT8_C(170), UINT8_C(194), UINT8_C(235), UINT8_C(133),
                             UINT8_C( 33), UINT8_C(160), UINT8_C(236), UINT8_C(  7),
                             UINT8_C(224), UINT8_C( 63), UINT8_C(130), UINT8_C( 28),
                             UINT8_C( 83), UINT8_C(152), UINT8_C(149), UINT8_C(111),
                             UINT8_C(188), UINT8_C( 24), UINT8_C( 57), UINT8_C( 80),
                             UINT8_C(100), UINT8_C( 11), UINT8_C(241), UINT8_C(117)),
      UINT64_C(          2661966794),
      easysimd_x_mm512_set_epu8(UINT8_C(164), UINT8_C( 45), UINT8_C(193), UINT8_C(111),
                             UINT8_C( 96), UINT8_C(220), UINT8_C( 54), UINT8_C(232),
                             UINT8_C(214), UINT8_C(244), UINT8_C(236), UINT8_C( 74),
                             UINT8_C( 47), UINT8_C(180), UINT8_C(143), UINT8_C(214),
                             UINT8_C(  6), UINT8_C(178), UINT8_C( 35), UINT8_C(129),
                             UINT8_C( 21), UINT8_C(157), UINT8_C( 30), UINT8_C( 29),
                             UINT8_C(226), UINT8_C(222), UINT8_C( 14), UINT8_C(170),
                             UINT8_C(223), UINT8_C(200), UINT8_C( 41), UINT8_C(245),
                             UINT8_C(  7), UINT8_C(251), UINT8_C( 30), UINT8_C(217),
                             UINT8_C( 93), UINT8_C(228), UINT8_C(143), UINT8_C(  9),
                             UINT8_C(221), UINT8_C( 49), UINT8_C(207), UINT8_C( 44),
                             UINT8_C( 52), UINT8_C(108), UINT8_C(124), UINT8_C( 14),
                             UINT8_C(144), UINT8_C(229), UINT8_C(102), UINT8_C( 16),
                             UINT8_C( 61), UINT8_C(  2), UINT8_C(169), UINT8_C( 72),
                             UINT8_C(194), UINT8_C(122), UINT8_C(216), UINT8_C(151),
                             UINT8_C(244), UINT8_C(227), UINT8_C(  5), UINT8_C( 98)),
      easysimd_x_mm512_set_epu8(UINT8_C( 53), UINT8_C( 65), UINT8_C(131), UINT8_C(189),
                             UINT8_C(196), UINT8_C(200), UINT8_C(234), UINT8_C( 92),
                             UINT8_C( 99), UINT8_C(187), UINT8_C(123), UINT8_C(180),
                             UINT8_C(209), UINT8_C(163), UINT8_C( 86), UINT8_C( 26),
                             UINT8_C(192), UINT8_C( 36), UINT8_C(205), UINT8_C(108),
                             UINT8_C(173), UINT8_C( 71), UINT8_C(190), UINT8_C( 46),
                             UINT8_C(173), UINT8_C(156), UINT8_C( 59), UINT8_C(250),
                             UINT8_C( 13), UINT8_C(171), UINT8_C(  1), UINT8_C( 47),
                             UINT8_C(227), UINT8_C( 45), UINT8_C(181), UINT8_C( 45),
                             UINT8_C(116), UINT8_C( 89), UINT8_C(112), UINT8_C(127),
                             UINT8_C( 42), UINT8_C(134), UINT8_C(128), UINT8_C(206),
                             UINT8_C( 87), UINT8_C(206), UINT8_C( 39), UINT8_C(  7),
                             UINT8_C( 48), UINT8_C( 47), UINT8_C( 79), UINT8_C( 32),
                             UINT8_C( 39), UINT8_C(205), UINT8_C(174), UINT8_C(244),
                             UINT8_C(251), UINT8_C( 10), UINT8_C( 13), UINT8_C( 53),
                             UINT8_C(255), UINT8_C(222), UINT8_C( 66), UINT8_C( 52)),
      easysimd_x_mm512_set_epu8(UINT8_C(160), UINT8_C(209), UINT8_C( 53), UINT8_C(241),
                             UINT8_C(169), UINT8_C( 74), UINT8_C(195), UINT8_C(156),
                             UINT8_C(226), UINT8_C(114), UINT8_C(119), UINT8_C(203),
                             UINT8_C( 15), UINT8_C( 80), UINT8_C(207), UINT8_C(120),
                             UINT8_C(164), UINT8_C(171), UINT8_C( 95), UINT8_C(130),
                             UINT8_C(161), UINT8_C(  3), UINT8_C( 82), UINT8_C(197),
                             UINT8_C( 78), UINT8_C(216), UINT8_C(176), UINT8_C(131),
                             UINT8_C(213), UINT8_C( 21), UINT8_C( 48), UINT8_C(162),
                             UINT8_C(  0), UINT8_C( 81), UINT8_C( 67), UINT8_C(172),
                             UINT8_C(  0), UINT8_C(139), UINT8_C( 31), UINT8_C( 64),
                             UINT8_C(179), UINT8_C(194), UINT8_C( 79), UINT8_C(133),
                             UINT8_C(  0), UINT8_C(160), UINT8_C( 85), UINT8_C(  7),
                             UINT8_C(224), UINT8_C(182), UINT8_C( 23), UINT8_C( 28),
                             UINT8_C( 83), UINT8_C(152), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(112), UINT8_C( 57), UINT8_C( 80),
                             UINT8_C(  0), UINT8_C( 11), UINT8_C(  0), UINT8_C(117)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(108), UINT8_C( 96), UINT8_C(  9), UINT8_C(145),
                             UINT8_C(131), UINT8_C(204), UINT8_C(151), UINT8_C(200),
                             UINT8_C(172), UINT8_C(193), UINT8_C(248), UINT8_C(227),
                             UINT8_C(159), UINT8_C( 34), UINT8_C( 70), UINT8_C( 14),
                             UINT8_C(229), UINT8_C( 98), UINT8_C( 73), UINT8_C(209),
                             UINT8_C( 59), UINT8_C(209), UINT8_C( 82), UINT8_C( 90),
                             UINT8_C(172), UINT8_C( 10), UINT8_C(185), UINT8_C(194),
                             UINT8_C(184), UINT8_C( 76), UINT8_C(173), UINT8_C( 75),
                             UINT8_C(136), UINT8_C(130), UINT8_C(227), UINT8_C(162),
                             UINT8_C(154), UINT8_C(158), UINT8_C(121), UINT8_C( 19),
                             UINT8_C(211), UINT8_C(197), UINT8_C( 15), UINT8_C( 80),
                             UINT8_C( 75), UINT8_C( 26), UINT8_C( 77), UINT8_C(210),
                             UINT8_C(117), UINT8_C( 85), UINT8_C(204), UINT8_C(  0),
                             UINT8_C(244), UINT8_C( 11), UINT8_C(128), UINT8_C(245),
                             UINT8_C(177), UINT8_C(132), UINT8_C(179), UINT8_C(117),
                             UINT8_C(215), UINT8_C( 43), UINT8_C(143), UINT8_C( 75)),
      UINT64_C(          1314676378),
      easysimd_x_mm512_set_epu8(UINT8_C(122), UINT8_C(121), UINT8_C( 15), UINT8_C(167),
                             UINT8_C(146), UINT8_C(  1), UINT8_C( 27), UINT8_C( 93),
                             UINT8_C(177), UINT8_C(197), UINT8_C(189), UINT8_C(233),
                             UINT8_C(110), UINT8_C( 47), UINT8_C( 66), UINT8_C( 91),
                             UINT8_C( 52), UINT8_C(  7), UINT8_C(197), UINT8_C( 20),
                             UINT8_C( 34), UINT8_C(208), UINT8_C(127), UINT8_C( 73),
                             UINT8_C(145), UINT8_C(  2), UINT8_C( 27), UINT8_C(235),
                             UINT8_C(109), UINT8_C(152), UINT8_C(220), UINT8_C(143),
                             UINT8_C(189), UINT8_C(222), UINT8_C(102), UINT8_C(126),
                             UINT8_C( 80), UINT8_C( 51), UINT8_C(253), UINT8_C(186),
                             UINT8_C( 51), UINT8_C(206), UINT8_C(118), UINT8_C( 48),
                             UINT8_C( 59), UINT8_C(184), UINT8_C(197), UINT8_C(107),
                             UINT8_C( 52), UINT8_C(  5), UINT8_C(208), UINT8_C(231),
                             UINT8_C(151), UINT8_C(166), UINT8_C(151), UINT8_C( 49),
                             UINT8_C( 74), UINT8_C(239), UINT8_C(157), UINT8_C(112),
                             UINT8_C(217), UINT8_C(111), UINT8_C( 21), UINT8_C(221)),
      easysimd_x_mm512_set_epu8(UINT8_C( 54), UINT8_C( 10), UINT8_C( 52), UINT8_C(157),
                             UINT8_C( 51), UINT8_C( 63), UINT8_C(190), UINT8_C(105),
                             UINT8_C(159), UINT8_C( 57), UINT8_C(152), UINT8_C(  2),
                             UINT8_C(134), UINT8_C(112), UINT8_C( 29), UINT8_C(  8),
                             UINT8_C(240), UINT8_C( 55), UINT8_C(110), UINT8_C(144),
                             UINT8_C(247), UINT8_C( 78), UINT8_C(254), UINT8_C( 89),
                             UINT8_C(189), UINT8_C(169), UINT8_C(164), UINT8_C(239),
                             UINT8_C(227), UINT8_C(187), UINT8_C( 11), UINT8_C(211),
                             UINT8_C(183), UINT8_C(  9), UINT8_C(204), UINT8_C(138),
                             UINT8_C(223), UINT8_C( 91), UINT8_C(198), UINT8_C( 18),
                             UINT8_C(178), UINT8_C(209), UINT8_C(152), UINT8_C(100),
                             UINT8_C(247), UINT8_C(142), UINT8_C( 53), UINT8_C( 94),
                             UINT8_C(238), UINT8_C(239), UINT8_C(151), UINT8_C(119),
                             UINT8_C(229), UINT8_C( 96), UINT8_C(245), UINT8_C(  0),
                             UINT8_C(141), UINT8_C( 95), UINT8_C(101), UINT8_C(146),
                             UINT8_C(141), UINT8_C( 37), UINT8_C( 41), UINT8_C(148)),
      easysimd_x_mm512_set_epu8(UINT8_C(108), UINT8_C( 96), UINT8_C(  9), UINT8_C(145),
                             UINT8_C(131), UINT8_C(204), UINT8_C(151), UINT8_C(200),
                             UINT8_C(172), UINT8_C(193), UINT8_C(248), UINT8_C(227),
                             UINT8_C(159), UINT8_C( 34), UINT8_C( 70), UINT8_C( 14),
                             UINT8_C(229), UINT8_C( 98), UINT8_C( 73), UINT8_C(209),
                             UINT8_C( 59), UINT8_C(209), UINT8_C( 82), UINT8_C( 90),
                             UINT8_C(172), UINT8_C( 10), UINT8_C(185), UINT8_C(194),
                             UINT8_C(184), UINT8_C( 76), UINT8_C(173), UINT8_C( 75),
                             UINT8_C(136), UINT8_C(213), UINT8_C(227), UINT8_C(162),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 55), UINT8_C( 19),
                             UINT8_C(211), UINT8_C(  0), UINT8_C( 15), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 42), UINT8_C( 77), UINT8_C(210),
                             UINT8_C(117), UINT8_C(  0), UINT8_C(204), UINT8_C(112),
                             UINT8_C(  0), UINT8_C( 70), UINT8_C(  0), UINT8_C(245),
                             UINT8_C(  0), UINT8_C(132), UINT8_C(179), UINT8_C(  0),
                             UINT8_C( 76), UINT8_C( 43), UINT8_C(  0), UINT8_C( 75)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(206), UINT8_C(206), UINT8_C( 30), UINT8_C( 15),
                             UINT8_C(114), UINT8_C(103), UINT8_C( 13), UINT8_C(110),
                             UINT8_C(166), UINT8_C( 46), UINT8_C(130), UINT8_C(151),
                             UINT8_C( 16), UINT8_C( 40), UINT8_C(154), UINT8_C( 67),
                             UINT8_C(184), UINT8_C( 37), UINT8_C(207), UINT8_C( 94),
                             UINT8_C( 79), UINT8_C(202), UINT8_C(122), UINT8_C(203),
                             UINT8_C(179), UINT8_C(164), UINT8_C( 37), UINT8_C(173),
                             UINT8_C( 95), UINT8_C(170), UINT8_C( 47), UINT8_C(161),
                             UINT8_C(255), UINT8_C(185), UINT8_C(163), UINT8_C(181),
                             UINT8_C( 29), UINT8_C(148), UINT8_C(134), UINT8_C( 11),
                             UINT8_C(137), UINT8_C(213), UINT8_C(115), UINT8_C(139),
                             UINT8_C( 77), UINT8_C(129), UINT8_C( 55), UINT8_C(  6),
                             UINT8_C(222), UINT8_C(184), UINT8_C(104), UINT8_C( 68),
                             UINT8_C(167), UINT8_C( 53), UINT8_C( 35), UINT8_C( 81),
                             UINT8_C(255), UINT8_C(129), UINT8_C(219), UINT8_C(221),
                             UINT8_C(186), UINT8_C( 75), UINT8_C(231), UINT8_C(243)),
      UINT64_C(          1370699036),
      easysimd_x_mm512_set_epu8(UINT8_C(228), UINT8_C( 29), UINT8_C(156), UINT8_C(201),
                             UINT8_C(217), UINT8_C( 60), UINT8_C( 61), UINT8_C( 86),
                             UINT8_C(205), UINT8_C(204), UINT8_C( 26), UINT8_C( 35),
                             UINT8_C(113), UINT8_C( 54), UINT8_C( 44), UINT8_C(150),
                             UINT8_C(  5), UINT8_C(127), UINT8_C(118), UINT8_C(122),
                             UINT8_C(  8), UINT8_C( 76), UINT8_C( 62), UINT8_C( 54),
                             UINT8_C(171), UINT8_C(236), UINT8_C(228), UINT8_C( 23),
                             UINT8_C(167), UINT8_C( 85), UINT8_C(106), UINT8_C(203),
                             UINT8_C( 75), UINT8_C(211), UINT8_C(183), UINT8_C(233),
                             UINT8_C(230), UINT8_C(155), UINT8_C(159), UINT8_C(231),
                             UINT8_C( 53), UINT8_C( 16), UINT8_C(224), UINT8_C(218),
                             UINT8_C(254), UINT8_C(170), UINT8_C(229), UINT8_C(158),
                             UINT8_C(154), UINT8_C(108), UINT8_C(114), UINT8_C(193),
                             UINT8_C(254), UINT8_C( 39), UINT8_C(143), UINT8_C(155),
                             UINT8_C(241), UINT8_C(232), UINT8_C(128), UINT8_C(233),
                             UINT8_C(178), UINT8_C(  6), UINT8_C(154), UINT8_C(184)),
      easysimd_x_mm512_set_epu8(UINT8_C(165), UINT8_C(173), UINT8_C(234), UINT8_C(165),
                             UINT8_C(146), UINT8_C(243), UINT8_C( 52), UINT8_C( 89),
                             UINT8_C(227), UINT8_C( 93), UINT8_C(108), UINT8_C( 47),
                             UINT8_C(207), UINT8_C(115), UINT8_C(178), UINT8_C(155),
                             UINT8_C(250), UINT8_C(115), UINT8_C(  2), UINT8_C( 73),
                             UINT8_C(254), UINT8_C(119), UINT8_C( 72), UINT8_C(108),
                             UINT8_C( 90), UINT8_C( 96), UINT8_C( 56), UINT8_C(182),
                             UINT8_C( 64), UINT8_C(  8), UINT8_C(172), UINT8_C(169),
                             UINT8_C( 32), UINT8_C( 75), UINT8_C( 92), UINT8_C(114),
                             UINT8_C( 16), UINT8_C( 36), UINT8_C(161), UINT8_C( 46),
                             UINT8_C(214), UINT8_C(247), UINT8_C(176), UINT8_C( 43),
                             UINT8_C(168), UINT8_C(161), UINT8_C(148), UINT8_C( 77),
                             UINT8_C(231), UINT8_C(174), UINT8_C( 75), UINT8_C( 48),
                             UINT8_C(123), UINT8_C(251), UINT8_C(221), UINT8_C(100),
                             UINT8_C( 39), UINT8_C(159), UINT8_C( 61), UINT8_C( 37),
                             UINT8_C(160), UINT8_C(166), UINT8_C( 87), UINT8_C(103)),
      easysimd_x_mm512_set_epu8(UINT8_C(206), UINT8_C(206), UINT8_C( 30), UINT8_C( 15),
                             UINT8_C(114), UINT8_C(103), UINT8_C( 13), UINT8_C(110),
                             UINT8_C(166), UINT8_C( 46), UINT8_C(130), UINT8_C(151),
                             UINT8_C( 16), UINT8_C( 40), UINT8_C(154), UINT8_C( 67),
                             UINT8_C(184), UINT8_C( 37), UINT8_C(207), UINT8_C( 94),
                             UINT8_C( 79), UINT8_C(202), UINT8_C(122), UINT8_C(203),
                             UINT8_C(179), UINT8_C(164), UINT8_C( 37), UINT8_C(173),
                             UINT8_C( 95), UINT8_C(170), UINT8_C( 47), UINT8_C(161),
                             UINT8_C(255), UINT8_C(136), UINT8_C(163), UINT8_C(119),
                             UINT8_C( 29), UINT8_C(148), UINT8_C(134), UINT8_C(185),
                             UINT8_C(  0), UINT8_C(213), UINT8_C( 48), UINT8_C(175),
                             UINT8_C( 77), UINT8_C(129), UINT8_C( 81), UINT8_C( 81),
                             UINT8_C(222), UINT8_C(184), UINT8_C( 39), UINT8_C(145),
                             UINT8_C(167), UINT8_C(  0), UINT8_C( 35), UINT8_C( 55),
                             UINT8_C(255), UINT8_C(129), UINT8_C(219), UINT8_C(196),
                             UINT8_C( 18), UINT8_C(  0), UINT8_C(231), UINT8_C(243)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(215), UINT8_C( 43), UINT8_C(249), UINT8_C(194),
                             UINT8_C(157), UINT8_C(199), UINT8_C( 98), UINT8_C(233),
                             UINT8_C( 27), UINT8_C(181), UINT8_C(227), UINT8_C( 75),
                             UINT8_C( 73), UINT8_C( 96), UINT8_C(149), UINT8_C(223),
                             UINT8_C(104), UINT8_C( 32), UINT8_C( 22), UINT8_C(168),
                             UINT8_C( 89), UINT8_C( 99), UINT8_C(164), UINT8_C(153),
                             UINT8_C( 65), UINT8_C(170), UINT8_C( 53), UINT8_C( 47),
                             UINT8_C(191), UINT8_C(169), UINT8_C( 40), UINT8_C( 76),
                             UINT8_C(114), UINT8_C(220), UINT8_C( 85), UINT8_C(210),
                             UINT8_C(141), UINT8_C( 16), UINT8_C( 66), UINT8_C(216),
                             UINT8_C(211), UINT8_C(107), UINT8_C(217), UINT8_C(119),
                             UINT8_C(250), UINT8_C( 64), UINT8_C(254), UINT8_C( 91),
                             UINT8_C( 35), UINT8_C(245), UINT8_C(193), UINT8_C( 56),
                             UINT8_C(248), UINT8_C(186), UINT8_C( 68), UINT8_C(150),
                             UINT8_C(220), UINT8_C(248), UINT8_C(101), UINT8_C(  0),
                             UINT8_C(116), UINT8_C(116), UINT8_C( 64), UINT8_C(175)),
      UINT64_C(          4015290579),
      easysimd_x_mm512_set_epu8(UINT8_C( 21), UINT8_C(153), UINT8_C(252), UINT8_C(180),
                             UINT8_C(184), UINT8_C( 70), UINT8_C( 16), UINT8_C(164),
                             UINT8_C( 32), UINT8_C(157), UINT8_C(177), UINT8_C(185),
                             UINT8_C( 75), UINT8_C(213), UINT8_C(118), UINT8_C( 48),
                             UINT8_C(250), UINT8_C(247), UINT8_C(144), UINT8_C(182),
                             UINT8_C( 89), UINT8_C(193), UINT8_C(215), UINT8_C(109),
                             UINT8_C( 32), UINT8_C( 44), UINT8_C( 30), UINT8_C(115),
                             UINT8_C(122), UINT8_C(173), UINT8_C( 22), UINT8_C(177),
                             UINT8_C(163), UINT8_C(190), UINT8_C(161), UINT8_C(157),
                             UINT8_C(186), UINT8_C(207), UINT8_C(230), UINT8_C( 94),
                             UINT8_C(188), UINT8_C( 54), UINT8_C(164), UINT8_C(150),
                             UINT8_C( 11), UINT8_C( 80), UINT8_C(167), UINT8_C(171),
                             UINT8_C(  7), UINT8_C(177), UINT8_C(223), UINT8_C(132),
                             UINT8_C(186), UINT8_C( 43), UINT8_C( 15), UINT8_C(205),
                             UINT8_C( 56), UINT8_C(209), UINT8_C( 90), UINT8_C(226),
                             UINT8_C(128), UINT8_C( 65), UINT8_C( 94), UINT8_C(244)),
      easysimd_x_mm512_set_epu8(UINT8_C( 31), UINT8_C( 58), UINT8_C(132), UINT8_C( 37),
                             UINT8_C(154), UINT8_C(  6), UINT8_C( 75), UINT8_C(156),
                             UINT8_C(149), UINT8_C(144), UINT8_C(181), UINT8_C(171),
                             UINT8_C(160), UINT8_C( 77), UINT8_C(155), UINT8_C(252),
                             UINT8_C(181), UINT8_C(149), UINT8_C( 69), UINT8_C( 75),
                             UINT8_C(202), UINT8_C( 32), UINT8_C( 21), UINT8_C( 82),
                             UINT8_C(184), UINT8_C(152), UINT8_C(217), UINT8_C( 20),
                             UINT8_C( 41), UINT8_C( 41), UINT8_C(  1), UINT8_C( 97),
                             UINT8_C(165), UINT8_C(111), UINT8_C(131), UINT8_C( 21),
                             UINT8_C( 63), UINT8_C( 20), UINT8_C(145), UINT8_C(147),
                             UINT8_C( 66), UINT8_C( 29), UINT8_C(208), UINT8_C( 15),
                             UINT8_C(209), UINT8_C(114), UINT8_C(194), UINT8_C(  3),
                             UINT8_C( 96), UINT8_C(111), UINT8_C( 93), UINT8_C(100),
                             UINT8_C(124), UINT8_C( 70), UINT8_C(116), UINT8_C(210),
                             UINT8_C( 69), UINT8_C(255), UINT8_C(157), UINT8_C(160),
                             UINT8_C( 53), UINT8_C( 12), UINT8_C(237), UINT8_C(134)),
      easysimd_x_mm512_set_epu8(UINT8_C(215), UINT8_C( 43), UINT8_C(249), UINT8_C(194),
                             UINT8_C(157), UINT8_C(199), UINT8_C( 98), UINT8_C(233),
                             UINT8_C( 27), UINT8_C(181), UINT8_C(227), UINT8_C( 75),
                             UINT8_C( 73), UINT8_C( 96), UINT8_C(149), UINT8_C(223),
                             UINT8_C(104), UINT8_C( 32), UINT8_C( 22), UINT8_C(168),
                             UINT8_C( 89), UINT8_C( 99), UINT8_C(164), UINT8_C(153),
                             UINT8_C( 65), UINT8_C(170), UINT8_C( 53), UINT8_C( 47),
                             UINT8_C(191), UINT8_C(169), UINT8_C( 40), UINT8_C( 76),
                             UINT8_C(  0), UINT8_C( 79), UINT8_C( 30), UINT8_C(210),
                             UINT8_C(123), UINT8_C(187), UINT8_C( 85), UINT8_C(  0),
                             UINT8_C(211), UINT8_C( 25), UINT8_C(217), UINT8_C(135),
                             UINT8_C(250), UINT8_C(  0), UINT8_C(254), UINT8_C( 91),
                             UINT8_C( 35), UINT8_C( 66), UINT8_C(130), UINT8_C( 32),
                             UINT8_C( 62), UINT8_C(186), UINT8_C( 68), UINT8_C(150),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(101), UINT8_C( 66),
                             UINT8_C(116), UINT8_C(116), UINT8_C(  0), UINT8_C(110)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(181), UINT8_C( 56), UINT8_C(192), UINT8_C(150),
                             UINT8_C( 44), UINT8_C(209), UINT8_C( 13), UINT8_C(238),
                             UINT8_C(199), UINT8_C(135), UINT8_C(144), UINT8_C(  8),
                             UINT8_C( 13), UINT8_C(143), UINT8_C(242), UINT8_C(219),
                             UINT8_C(103), UINT8_C(252), UINT8_C(214), UINT8_C(167),
                             UINT8_C(  3), UINT8_C(136), UINT8_C(222), UINT8_C(241),
                             UINT8_C(  7), UINT8_C( 92), UINT8_C(141), UINT8_C(140),
                             UINT8_C(104), UINT8_C(125), UINT8_C(212), UINT8_C(114),
                             UINT8_C(114), UINT8_C(229), UINT8_C(235), UINT8_C(144),
                             UINT8_C(233), UINT8_C(188), UINT8_C( 95), UINT8_C(193),
                             UINT8_C( 27), UINT8_C(148), UINT8_C( 89), UINT8_C(138),
                             UINT8_C(232), UINT8_C(105), UINT8_C(208), UINT8_C(244),
                             UINT8_C( 62), UINT8_C(166), UINT8_C(227), UINT8_C( 87),
                             UINT8_C(254), UINT8_C( 17), UINT8_C(235), UINT8_C(147),
                             UINT8_C(215), UINT8_C(  8), UINT8_C(107), UINT8_C( 75),
                             UINT8_C(237), UINT8_C(121), UINT8_C( 75), UINT8_C( 80)),
      UINT64_C(          3983161372),
      easysimd_x_mm512_set_epu8(UINT8_C(105), UINT8_C(165), UINT8_C(196), UINT8_C(175),
                             UINT8_C( 21), UINT8_C( 33), UINT8_C( 59), UINT8_C( 91),
                             UINT8_C(173), UINT8_C( 84), UINT8_C(102), UINT8_C(234),
                             UINT8_C(240), UINT8_C( 97), UINT8_C( 44), UINT8_C(117),
                             UINT8_C(253), UINT8_C( 63), UINT8_C(177), UINT8_C(  7),
                             UINT8_C( 84), UINT8_C(101), UINT8_C( 54), UINT8_C(237),
                             UINT8_C(110), UINT8_C( 66), UINT8_C( 52), UINT8_C(158),
                             UINT8_C(218), UINT8_C(146), UINT8_C(129), UINT8_C(  7),
                             UINT8_C(170), UINT8_C( 34), UINT8_C( 11), UINT8_C( 33),
                             UINT8_C(109), UINT8_C( 75), UINT8_C(249), UINT8_C(174),
                             UINT8_C( 89), UINT8_C(221), UINT8_C(115), UINT8_C(113),
                             UINT8_C(179), UINT8_C( 55), UINT8_C(200), UINT8_C( 84),
                             UINT8_C(219), UINT8_C(209), UINT8_C(106), UINT8_C(223),
                             UINT8_C(220), UINT8_C(150), UINT8_C(243), UINT8_C( 88),
                             UINT8_C( 23), UINT8_C( 59), UINT8_C(210), UINT8_C(197),
                             UINT8_C( 39), UINT8_C(187), UINT8_C( 89), UINT8_C( 99)),
      easysimd_x_mm512_set_epu8(UINT8_C(202), UINT8_C( 54), UINT8_C( 42), UINT8_C(168),
                             UINT8_C( 22), UINT8_C(221), UINT8_C( 17), UINT8_C(189),
                             UINT8_C( 39), UINT8_C(155), UINT8_C(135), UINT8_C(162),
                             UINT8_C(148), UINT8_C(181), UINT8_C(120), UINT8_C( 52),
                             UINT8_C(206), UINT8_C( 24), UINT8_C(206), UINT8_C(117),
                             UINT8_C(240), UINT8_C( 17), UINT8_C(210), UINT8_C(188),
                             UINT8_C(193), UINT8_C(112), UINT8_C( 80), UINT8_C(199),
                             UINT8_C(136), UINT8_C( 33), UINT8_C( 97), UINT8_C(247),
                             UINT8_C(161), UINT8_C( 97), UINT8_C( 42), UINT8_C(181),
                             UINT8_C( 25), UINT8_C( 62), UINT8_C( 47), UINT8_C( 32),
                             UINT8_C( 10), UINT8_C(145), UINT8_C( 81), UINT8_C( 51),
                             UINT8_C(106), UINT8_C( 74), UINT8_C(253), UINT8_C( 27),
                             UINT8_C(198), UINT8_C( 49), UINT8_C(205), UINT8_C(189),
                             UINT8_C( 32), UINT8_C(168), UINT8_C(102), UINT8_C( 88),
                             UINT8_C( 86), UINT8_C(170), UINT8_C(185), UINT8_C( 98),
                             UINT8_C(232), UINT8_C( 43), UINT8_C( 26), UINT8_C(165)),
      easysimd_x_mm512_set_epu8(UINT8_C(181), UINT8_C( 56), UINT8_C(192), UINT8_C(150),
                             UINT8_C( 44), UINT8_C(209), UINT8_C( 13), UINT8_C(238),
                             UINT8_C(199), UINT8_C(135), UINT8_C(144), UINT8_C(  8),
                             UINT8_C( 13), UINT8_C(143), UINT8_C(242), UINT8_C(219),
                             UINT8_C(103), UINT8_C(252), UINT8_C(214), UINT8_C(167),
                             UINT8_C(  3), UINT8_C(136), UINT8_C(222), UINT8_C(241),
                             UINT8_C(  7), UINT8_C( 92), UINT8_C(141), UINT8_C(140),
                             UINT8_C(104), UINT8_C(125), UINT8_C(212), UINT8_C(114),
                             UINT8_C(  9), UINT8_C(  0), UINT8_C(  0), UINT8_C(144),
                             UINT8_C( 84), UINT8_C( 13), UINT8_C( 95), UINT8_C(142),
                             UINT8_C( 27), UINT8_C( 76), UINT8_C( 34), UINT8_C(138),
                             UINT8_C( 73), UINT8_C(105), UINT8_C(  0), UINT8_C(244),
                             UINT8_C( 62), UINT8_C(166), UINT8_C(  0), UINT8_C( 34),
                             UINT8_C(188), UINT8_C( 17), UINT8_C(235), UINT8_C(147),
                             UINT8_C(215), UINT8_C(  8), UINT8_C(107), UINT8_C( 99),
                             UINT8_C(  0), UINT8_C(144), UINT8_C( 75), UINT8_C( 80)) },
    { easysimd_x_mm512_set_epu8(UINT8_C( 98), UINT8_C( 81), UINT8_C(150), UINT8_C(221),
                             UINT8_C( 96), UINT8_C( 40), UINT8_C(142), UINT8_C( 23),
                             UINT8_C( 87), UINT8_C(207), UINT8_C(191), UINT8_C( 92),
                             UINT8_C( 77), UINT8_C(157), UINT8_C(184), UINT8_C(138),
                             UINT8_C(172), UINT8_C( 66), UINT8_C(  9), UINT8_C(115),
                             UINT8_C(240), UINT8_C(175), UINT8_C(107), UINT8_C( 49),
                             UINT8_C( 50), UINT8_C(243), UINT8_C( 59), UINT8_C( 91),
                             UINT8_C(  0), UINT8_C( 76), UINT8_C(  9), UINT8_C(  2),
                             UINT8_C( 15), UINT8_C( 39), UINT8_C(150), UINT8_C( 31),
                             UINT8_C( 12), UINT8_C(247), UINT8_C(212), UINT8_C( 40),
                             UINT8_C(158), UINT8_C( 81), UINT8_C(244), UINT8_C( 20),
                             UINT8_C(204), UINT8_C( 92), UINT8_C(198), UINT8_C(205),
                             UINT8_C( 11), UINT8_C( 60), UINT8_C(191), UINT8_C( 47),
                             UINT8_C( 22), UINT8_C(151), UINT8_C(149), UINT8_C( 16),
                             UINT8_C(247), UINT8_C(164), UINT8_C( 21), UINT8_C( 75),
                             UINT8_C(153), UINT8_C(240), UINT8_C(253), UINT8_C(242)),
      UINT64_C(            56397128),
      easysimd_x_mm512_set_epu8(UINT8_C(183), UINT8_C(245), UINT8_C(114), UINT8_C(158),
                             UINT8_C( 37), UINT8_C(  8), UINT8_C(173), UINT8_C( 26),
                             UINT8_C(128), UINT8_C( 46), UINT8_C(239), UINT8_C(202),
                             UINT8_C( 36), UINT8_C(170), UINT8_C( 57), UINT8_C( 95),
                             UINT8_C(183), UINT8_C(182), UINT8_C( 41), UINT8_C(122),
                             UINT8_C(112), UINT8_C(137), UINT8_C(112), UINT8_C( 40),
                             UINT8_C(142), UINT8_C( 91), UINT8_C( 37), UINT8_C( 25),
                             UINT8_C(202), UINT8_C(195), UINT8_C(221), UINT8_C(250),
                             UINT8_C(146), UINT8_C(239), UINT8_C( 69), UINT8_C(186),
                             UINT8_C(170), UINT8_C(230), UINT8_C(161), UINT8_C(178),
                             UINT8_C( 40), UINT8_C(125), UINT8_C(237), UINT8_C(124),
                             UINT8_C(248), UINT8_C( 56), UINT8_C(  8), UINT8_C( 55),
                             UINT8_C(249), UINT8_C(227), UINT8_C(149), UINT8_C(232),
                             UINT8_C( 71), UINT8_C(244), UINT8_C(128), UINT8_C( 10),
                             UINT8_C(194), UINT8_C(169), UINT8_C(169), UINT8_C( 87),
                             UINT8_C(140), UINT8_C(131), UINT8_C( 55), UINT8_C(150)),
      easysimd_x_mm512_set_epu8(UINT8_C(110), UINT8_C( 33), UINT8_C(123), UINT8_C(125),
                             UINT8_C( 28), UINT8_C(250), UINT8_C(180), UINT8_C(218),
                             UINT8_C(138), UINT8_C(236), UINT8_C( 38), UINT8_C(136),
                             UINT8_C(156), UINT8_C(154), UINT8_C(163), UINT8_C(128),
                             UINT8_C(  3), UINT8_C( 20), UINT8_C(100), UINT8_C(126),
                             UINT8_C(164), UINT8_C( 42), UINT8_C(151), UINT8_C(206),
                             UINT8_C(  0), UINT8_C(  4), UINT8_C(235), UINT8_C(224),
                             UINT8_C( 89), UINT8_C(213), UINT8_C( 61), UINT8_C(138),
                             UINT8_C( 77), UINT8_C( 74), UINT8_C( 61), UINT8_C(173),
                             UINT8_C( 87), UINT8_C(142), UINT8_C( 26), UINT8_C(213),
                             UINT8_C( 90), UINT8_C(221), UINT8_C( 14), UINT8_C( 55),
                             UINT8_C(246), UINT8_C(136), UINT8_C(230), UINT8_C(198),
                             UINT8_C(193), UINT8_C(138), UINT8_C(163), UINT8_C( 46),
                             UINT8_C( 13), UINT8_C(134), UINT8_C(202), UINT8_C( 58),
                             UINT8_C( 24), UINT8_C(220), UINT8_C( 93), UINT8_C(159),
                             UINT8_C(158), UINT8_C(228), UINT8_C( 77), UINT8_C( 48)),
      easysimd_x_mm512_set_epu8(UINT8_C( 98), UINT8_C( 81), UINT8_C(150), UINT8_C(221),
                             UINT8_C( 96), UINT8_C( 40), UINT8_C(142), UINT8_C( 23),
                             UINT8_C( 87), UINT8_C(207), UINT8_C(191), UINT8_C( 92),
                             UINT8_C( 77), UINT8_C(157), UINT8_C(184), UINT8_C(138),
                             UINT8_C(172), UINT8_C( 66), UINT8_C(  9), UINT8_C(115),
                             UINT8_C(240), UINT8_C(175), UINT8_C(107), UINT8_C( 49),
                             UINT8_C( 50), UINT8_C(243), UINT8_C( 59), UINT8_C( 91),
                             UINT8_C(  0), UINT8_C( 76), UINT8_C(  9), UINT8_C(  2),
                             UINT8_C( 15), UINT8_C( 39), UINT8_C(150), UINT8_C( 31),
                             UINT8_C( 12), UINT8_C(247), UINT8_C(135), UINT8_C(  0),
                             UINT8_C(158), UINT8_C(  0), UINT8_C(244), UINT8_C( 69),
                             UINT8_C(  2), UINT8_C(  0), UINT8_C(198), UINT8_C(205),
                             UINT8_C( 56), UINT8_C( 60), UINT8_C(191), UINT8_C( 47),
                             UINT8_C( 58), UINT8_C(110), UINT8_C(149), UINT8_C(  0),
                             UINT8_C(247), UINT8_C(  0), UINT8_C( 21), UINT8_C( 75),
                             UINT8_C(  0), UINT8_C(240), UINT8_C(253), UINT8_C(242)) },
    { easysimd_x_mm512_set_epu8(UINT8_C( 53), UINT8_C(227), UINT8_C(166), UINT8_C(167),
                             UINT8_C(220), UINT8_C( 62), UINT8_C(127), UINT8_C(188),
                             UINT8_C(162), UINT8_C( 93), UINT8_C( 87), UINT8_C( 20),
                             UINT8_C(253), UINT8_C(151), UINT8_C(167), UINT8_C( 97),
                             UINT8_C(141), UINT8_C( 56), UINT8_C( 46), UINT8_C(112),
                             UINT8_C(183), UINT8_C(242), UINT8_C(234), UINT8_C(225),
                             UINT8_C( 17), UINT8_C(244), UINT8_C(208), UINT8_C(134),
                             UINT8_C( 62), UINT8_C(227), UINT8_C(122), UINT8_C(145),
                             UINT8_C( 35), UINT8_C(116), UINT8_C( 86), UINT8_C( 57),
                             UINT8_C( 43), UINT8_C(  6), UINT8_C( 33), UINT8_C(  4),
                             UINT8_C(148), UINT8_C( 62), UINT8_C( 78), UINT8_C(134),
                             UINT8_C( 59), UINT8_C(194), UINT8_C(251), UINT8_C(176),
                             UINT8_C(131), UINT8_C(  3), UINT8_C(158), UINT8_C( 64),
                             UINT8_C(  7), UINT8_C( 23), UINT8_C(141), UINT8_C( 30),
                             UINT8_C( 80), UINT8_C(118), UINT8_C(234), UINT8_C(166),
                             UINT8_C(190), UINT8_C(141), UINT8_C(  8), UINT8_C(147)),
      UINT64_C(            22184990),
      easysimd_x_mm512_set_epu8(UINT8_C( 84), UINT8_C( 30), UINT8_C(240), UINT8_C(  3),
                             UINT8_C( 77), UINT8_C(250), UINT8_C(105), UINT8_C( 84),
                             UINT8_C( 36), UINT8_C(146), UINT8_C(  3), UINT8_C( 91),
                             UINT8_C( 21), UINT8_C( 50), UINT8_C( 15), UINT8_C(197),
                             UINT8_C(184), UINT8_C(164), UINT8_C(243), UINT8_C( 49),
                             UINT8_C(139), UINT8_C(155), UINT8_C( 62), UINT8_C(216),
                             UINT8_C(245), UINT8_C( 40), UINT8_C( 99), UINT8_C(208),
                             UINT8_C(124), UINT8_C(170), UINT8_C(118), UINT8_C(243),
                             UINT8_C(134), UINT8_C( 41), UINT8_C(113), UINT8_C( 32),
                             UINT8_C(248), UINT8_C( 57), UINT8_C( 20), UINT8_C(118),
                             UINT8_C(143), UINT8_C(142), UINT8_C(167), UINT8_C(111),
                             UINT8_C( 61), UINT8_C(150), UINT8_C( 44), UINT8_C(181),
                             UINT8_C(206), UINT8_C(236), UINT8_C( 29), UINT8_C(231),
                             UINT8_C(142), UINT8_C( 18), UINT8_C( 45), UINT8_C(166),
                             UINT8_C( 68), UINT8_C(228), UINT8_C( 11), UINT8_C( 98),
                             UINT8_C(196), UINT8_C(139), UINT8_C( 34), UINT8_C( 25)),
      easysimd_x_mm512_set_epu8(UINT8_C(  5), UINT8_C( 56), UINT8_C(136), UINT8_C(206),
                             UINT8_C(185), UINT8_C( 86), UINT8_C(170), UINT8_C(156),
                             UINT8_C( 56), UINT8_C( 24), UINT8_C(243), UINT8_C( 74),
                             UINT8_C( 28), UINT8_C( 35), UINT8_C(114), UINT8_C(  4),
                             UINT8_C( 15), UINT8_C(140), UINT8_C(233), UINT8_C(248),
                             UINT8_C(211), UINT8_C(113), UINT8_C(132), UINT8_C( 79),
                             UINT8_C( 67), UINT8_C( 31), UINT8_C(151), UINT8_C(212),
                             UINT8_C( 77), UINT8_C(114), UINT8_C(132), UINT8_C(196),
                             UINT8_C(210), UINT8_C(113), UINT8_C(221), UINT8_C(195),
                             UINT8_C( 83), UINT8_C(114), UINT8_C(111), UINT8_C(219),
                             UINT8_C(131), UINT8_C(244), UINT8_C(252), UINT8_C(192),
                             UINT8_C(162), UINT8_C(101), UINT8_C(212), UINT8_C( 52),
                             UINT8_C( 99), UINT8_C(238), UINT8_C( 29), UINT8_C(150),
                             UINT8_C(119), UINT8_C( 43), UINT8_C( 64), UINT8_C(199),
                             UINT8_C(174), UINT8_C( 41), UINT8_C( 78), UINT8_C( 66),
                             UINT8_C(152), UINT8_C(112), UINT8_C( 89), UINT8_C(237)),
      easysimd_x_mm512_set_epu8(UINT8_C( 53), UINT8_C(227), UINT8_C(166), UINT8_C(167),
                             UINT8_C(220), UINT8_C( 62), UINT8_C(127), UINT8_C(188),
                             UINT8_C(162), UINT8_C( 93), UINT8_C( 87), UINT8_C( 20),
                             UINT8_C(253), UINT8_C(151), UINT8_C(167), UINT8_C( 97),
                             UINT8_C(141), UINT8_C( 56), UINT8_C( 46), UINT8_C(112),
                             UINT8_C(183), UINT8_C(242), UINT8_C(234), UINT8_C(225),
                             UINT8_C( 17), UINT8_C(244), UINT8_C(208), UINT8_C(134),
                             UINT8_C( 62), UINT8_C(227), UINT8_C(122), UINT8_C(145),
                             UINT8_C( 35), UINT8_C(116), UINT8_C( 86), UINT8_C( 57),
                             UINT8_C( 43), UINT8_C(  6), UINT8_C( 33), UINT8_C(  0),
                             UINT8_C(148), UINT8_C(  0), UINT8_C( 78), UINT8_C(  0),
                             UINT8_C( 59), UINT8_C(194), UINT8_C(  0), UINT8_C(176),
                             UINT8_C(107), UINT8_C(  3), UINT8_C(158), UINT8_C( 64),
                             UINT8_C(  7), UINT8_C(  0), UINT8_C(141), UINT8_C( 30),
                             UINT8_C( 80), UINT8_C(118), UINT8_C(234), UINT8_C( 32),
                             UINT8_C( 44), UINT8_C( 27), UINT8_C(  0), UINT8_C(147)) },
    { easysimd_x_mm512_set_epu8(UINT8_C(235), UINT8_C(117), UINT8_C(121), UINT8_C(105),
                             UINT8_C( 64), UINT8_C(  2), UINT8_C( 13), UINT8_C(246),
                             UINT8_C(161), UINT8_C(246), UINT8_C(247), UINT8_C( 22),
                             UINT8_C(159), UINT8_C( 42), UINT8_C(201), UINT8_C( 79),
                             UINT8_C( 21), UINT8_C(172), UINT8_C(230), UINT8_C(126),
                             UINT8_C(213), UINT8_C(157), UINT8_C(132), UINT8_C(237),
                             UINT8_C(124), UINT8_C(235), UINT8_C(111), UINT8_C( 29),
                             UINT8_C( 89), UINT8_C( 58), UINT8_C(255), UINT8_C(134),
                             UINT8_C(101), UINT8_C( 62), UINT8_C(180), UINT8_C(233),
                             UINT8_C(164), UINT8_C(115), UINT8_C(231), UINT8_C( 98),
                             UINT8_C(155), UINT8_C(153), UINT8_C(181), UINT8_C(181),
                             UINT8_C( 69), UINT8_C(210), UINT8_C(151), UINT8_C( 85),
                             UINT8_C( 48), UINT8_C( 82), UINT8_C( 52), UINT8_C( 54),
                             UINT8_C( 55), UINT8_C(158), UINT8_C(113), UINT8_C(247),
                             UINT8_C(228), UINT8_C(233), UINT8_C( 78), UINT8_C( 66),
                             UINT8_C( 93), UINT8_C(202), UINT8_C(157), UINT8_C(212)),
      UINT64_C(          2103571959),
      easysimd_x_mm512_set_epu8(UINT8_C(144), UINT8_C( 21), UINT8_C(157), UINT8_C( 81),
                             UINT8_C(156), UINT8_C(133), UINT8_C(103), UINT8_C(155),
                             UINT8_C(182), UINT8_C(168), UINT8_C(151), UINT8_C(201),
                             UINT8_C( 69), UINT8_C(193), UINT8_C(130), UINT8_C( 74),
                             UINT8_C(226), UINT8_C(223), UINT8_C(134), UINT8_C( 37),
                             UINT8_C( 29), UINT8_C( 47), UINT8_C( 30), UINT8_C(250),
                             UINT8_C(230), UINT8_C( 55), UINT8_C( 98), UINT8_C( 11),
                             UINT8_C(116), UINT8_C( 66), UINT8_C(237), UINT8_C(241),
                             UINT8_C(184), UINT8_C(235), UINT8_C(101), UINT8_C( 24),
                             UINT8_C(135), UINT8_C( 72), UINT8_C(219), UINT8_C(214),
                             UINT8_C( 61), UINT8_C(252), UINT8_C(209), UINT8_C(153),
                             UINT8_C( 26), UINT8_C( 69), UINT8_C(254), UINT8_C( 81),
                             UINT8_C(112), UINT8_C(  1), UINT8_C( 13), UINT8_C(163),
                             UINT8_C( 13), UINT8_C( 42), UINT8_C(243), UINT8_C(185),
                             UINT8_C( 74), UINT8_C( 36), UINT8_C(112), UINT8_C(104),
                             UINT8_C( 13), UINT8_C(101), UINT8_C(  7), UINT8_C( 51)),
      easysimd_x_mm512_set_epu8(UINT8_C(133), UINT8_C(195), UINT8_C( 74), UINT8_C( 77),
                             UINT8_C(127), UINT8_C(119), UINT8_C(202), UINT8_C( 85),
                             UINT8_C(236), UINT8_C( 29), UINT8_C(224), UINT8_C( 26),
                             UINT8_C(102), UINT8_C(226), UINT8_C(128), UINT8_C(173),
                             UINT8_C(247), UINT8_C(167), UINT8_C(253), UINT8_C(107),
                             UINT8_C(195), UINT8_C( 44), UINT8_C(250), UINT8_C( 78),
                             UINT8_C( 22), UINT8_C(248), UINT8_C( 49), UINT8_C(127),
                             UINT8_C(226), UINT8_C(177), UINT8_C(135), UINT8_C( 20),
                             UINT8_C(199), UINT8_C(239), UINT8_C(100), UINT8_C(134),
                             UINT8_C(164), UINT8_C(130), UINT8_C(104), UINT8_C(154),
                             UINT8_C( 70), UINT8_C(141), UINT8_C(181), UINT8_C(104),
                             UINT8_C(215), UINT8_C( 61), UINT8_C(212), UINT8_C( 26),
                             UINT8_C(110), UINT8_C(215), UINT8_C(220), UINT8_C(161),
                             UINT8_C( 37), UINT8_C( 95), UINT8_C(129), UINT8_C(178),
                             UINT8_C(134), UINT8_C( 99), UINT8_C(129), UINT8_C( 29),
                             UINT8_C(214), UINT8_C(225), UINT8_C(121), UINT8_C(165)),
      easysimd_x_mm512_set_epu8(UINT8_C(235), UINT8_C(117), UINT8_C(121), UINT8_C(105),
                             UINT8_C( 64), UINT8_C(  2), UINT8_C( 13), UINT8_C(246),
                             UINT8_C(161), UINT8_C(246), UINT8_C(247), UINT8_C( 22),
                             UINT8_C(159), UINT8_C( 42), UINT8_C(201), UINT8_C( 79),
                             UINT8_C( 21), UINT8_C(172), UINT8_C(230), UINT8_C(126),
                             UINT8_C(213), UINT8_C(157), UINT8_C(132), UINT8_C(237),
                             UINT8_C(124), UINT8_C(235), UINT8_C(111), UINT8_C( 29),
                             UINT8_C( 89), UINT8_C( 58), UINT8_C(255), UINT8_C(134),
                             UINT8_C(101), UINT8_C(  0), UINT8_C(  1), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(231), UINT8_C( 60),
                             UINT8_C(155), UINT8_C(111), UINT8_C( 28), UINT8_C(181),
                             UINT8_C( 69), UINT8_C(210), UINT8_C(151), UINT8_C( 55),
                             UINT8_C(  2), UINT8_C(  0), UINT8_C(  0), UINT8_C(  2),
                             UINT8_C( 55), UINT8_C(  0), UINT8_C(113), UINT8_C(  7),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 75),
                             UINT8_C( 93), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i r = easysimd_mm512_mask_subs_epu8(test_vec[i].src, test_vec[i].k, test_vec[i].a, test_vec[i].b);
    easysimd_assert_m512i_u8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_maskz_subs_epu8(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__mmask64 k;
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { UINT64_C(          1678504309),
      easysimd_x_mm512_set_epu8(UINT8_C(188), UINT8_C(227), UINT8_C(248), UINT8_C(  6),
                             UINT8_C(158), UINT8_C(170), UINT8_C( 99), UINT8_C(202),
                             UINT8_C(160), UINT8_C(209), UINT8_C( 53), UINT8_C(241),
                             UINT8_C(169), UINT8_C( 74), UINT8_C(195), UINT8_C(156),
                             UINT8_C(226), UINT8_C(114), UINT8_C(119), UINT8_C(203),
                             UINT8_C( 15), UINT8_C( 80), UINT8_C(207), UINT8_C(120),
                             UINT8_C(164), UINT8_C(171), UINT8_C( 95), UINT8_C(130),
                             UINT8_C(161), UINT8_C(  3), UINT8_C( 82), UINT8_C(197),
                             UINT8_C( 78), UINT8_C(216), UINT8_C(176), UINT8_C(131),
                             UINT8_C(213), UINT8_C( 21), UINT8_C( 48), UINT8_C(162),
                             UINT8_C(135), UINT8_C( 81), UINT8_C( 67), UINT8_C(242),
                             UINT8_C( 97), UINT8_C( 89), UINT8_C(174), UINT8_C( 64),
                             UINT8_C(170), UINT8_C(194), UINT8_C(235), UINT8_C(133),
                             UINT8_C( 33), UINT8_C(160), UINT8_C(236), UINT8_C(  7),
                             UINT8_C(224), UINT8_C( 63), UINT8_C(130), UINT8_C( 28),
                             UINT8_C( 83), UINT8_C(152), UINT8_C(149), UINT8_C(111)),
      easysimd_x_mm512_set_epu8(UINT8_C(164), UINT8_C( 45), UINT8_C(193), UINT8_C(111),
                             UINT8_C( 96), UINT8_C(220), UINT8_C( 54), UINT8_C(232),
                             UINT8_C(214), UINT8_C(244), UINT8_C(236), UINT8_C( 74),
                             UINT8_C( 47), UINT8_C(180), UINT8_C(143), UINT8_C(214),
                             UINT8_C(  6), UINT8_C(178), UINT8_C( 35), UINT8_C(129),
                             UINT8_C( 21), UINT8_C(157), UINT8_C( 30), UINT8_C( 29),
                             UINT8_C(226), UINT8_C(222), UINT8_C( 14), UINT8_C(170),
                             UINT8_C(223), UINT8_C(200), UINT8_C( 41), UINT8_C(245),
                             UINT8_C(  7), UINT8_C(251), UINT8_C( 30), UINT8_C(217),
                             UINT8_C( 93), UINT8_C(228), UINT8_C(143), UINT8_C(  9),
                             UINT8_C(221), UINT8_C( 49), UINT8_C(207), UINT8_C( 44),
                             UINT8_C( 52), UINT8_C(108), UINT8_C(124), UINT8_C( 14),
                             UINT8_C(144), UINT8_C(229), UINT8_C(102), UINT8_C( 16),
                             UINT8_C( 61), UINT8_C(  2), UINT8_C(169), UINT8_C( 72),
                             UINT8_C(194), UINT8_C(122), UINT8_C(216), UINT8_C(151),
                             UINT8_C(244), UINT8_C(227), UINT8_C(  5), UINT8_C( 98)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(146), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 45), UINT8_C(  0), UINT8_C( 50), UINT8_C( 50),
                             UINT8_C( 26), UINT8_C(  0), UINT8_C(133), UINT8_C(117),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 13)) },
    { UINT64_C(          4292756020),
      easysimd_x_mm512_set_epu8(UINT8_C(177), UINT8_C(132), UINT8_C(179), UINT8_C(117),
                             UINT8_C(215), UINT8_C( 43), UINT8_C(143), UINT8_C( 75),
                             UINT8_C( 53), UINT8_C( 65), UINT8_C(131), UINT8_C(189),
                             UINT8_C(196), UINT8_C(200), UINT8_C(234), UINT8_C( 92),
                             UINT8_C( 99), UINT8_C(187), UINT8_C(123), UINT8_C(180),
                             UINT8_C(209), UINT8_C(163), UINT8_C( 86), UINT8_C( 26),
                             UINT8_C(192), UINT8_C( 36), UINT8_C(205), UINT8_C(108),
                             UINT8_C(173), UINT8_C( 71), UINT8_C(190), UINT8_C( 46),
                             UINT8_C(173), UINT8_C(156), UINT8_C( 59), UINT8_C(250),
                             UINT8_C( 13), UINT8_C(171), UINT8_C(  1), UINT8_C( 47),
                             UINT8_C(227), UINT8_C( 45), UINT8_C(181), UINT8_C( 45),
                             UINT8_C(116), UINT8_C( 89), UINT8_C(112), UINT8_C(127),
                             UINT8_C( 42), UINT8_C(134), UINT8_C(128), UINT8_C(206),
                             UINT8_C( 87), UINT8_C(206), UINT8_C( 39), UINT8_C(  7),
                             UINT8_C( 48), UINT8_C( 47), UINT8_C( 79), UINT8_C( 32),
                             UINT8_C( 39), UINT8_C(205), UINT8_C(174), UINT8_C(244)),
      easysimd_x_mm512_set_epu8(UINT8_C(103), UINT8_C( 74), UINT8_C( 78), UINT8_C(251),
                             UINT8_C( 78), UINT8_C( 92), UINT8_C( 94), UINT8_C(154),
                             UINT8_C(108), UINT8_C( 96), UINT8_C(  9), UINT8_C(145),
                             UINT8_C(131), UINT8_C(204), UINT8_C(151), UINT8_C(200),
                             UINT8_C(172), UINT8_C(193), UINT8_C(248), UINT8_C(227),
                             UINT8_C(159), UINT8_C( 34), UINT8_C( 70), UINT8_C( 14),
                             UINT8_C(229), UINT8_C( 98), UINT8_C( 73), UINT8_C(209),
                             UINT8_C( 59), UINT8_C(209), UINT8_C( 82), UINT8_C( 90),
                             UINT8_C(172), UINT8_C( 10), UINT8_C(185), UINT8_C(194),
                             UINT8_C(184), UINT8_C( 76), UINT8_C(173), UINT8_C( 75),
                             UINT8_C(136), UINT8_C(130), UINT8_C(227), UINT8_C(162),
                             UINT8_C(154), UINT8_C(158), UINT8_C(121), UINT8_C( 19),
                             UINT8_C(211), UINT8_C(197), UINT8_C( 15), UINT8_C( 80),
                             UINT8_C( 75), UINT8_C( 26), UINT8_C( 77), UINT8_C(210),
                             UINT8_C(117), UINT8_C( 85), UINT8_C(204), UINT8_C(  0),
                             UINT8_C(244), UINT8_C( 11), UINT8_C(128), UINT8_C(245)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  1), UINT8_C(146), UINT8_C(  0), UINT8_C( 56),
                             UINT8_C(  0), UINT8_C( 95), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 91), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C( 32),
                             UINT8_C(  0), UINT8_C(194), UINT8_C(  0), UINT8_C(  0)) },
    { UINT64_C(          3647935965),
      easysimd_x_mm512_set_epu8(UINT8_C(141), UINT8_C( 95), UINT8_C(101), UINT8_C(146),
                             UINT8_C(141), UINT8_C( 37), UINT8_C( 41), UINT8_C(148),
                             UINT8_C(122), UINT8_C(121), UINT8_C( 15), UINT8_C(167),
                             UINT8_C(146), UINT8_C(  1), UINT8_C( 27), UINT8_C( 93),
                             UINT8_C(177), UINT8_C(197), UINT8_C(189), UINT8_C(233),
                             UINT8_C(110), UINT8_C( 47), UINT8_C( 66), UINT8_C( 91),
                             UINT8_C( 52), UINT8_C(  7), UINT8_C(197), UINT8_C( 20),
                             UINT8_C( 34), UINT8_C(208), UINT8_C(127), UINT8_C( 73),
                             UINT8_C(145), UINT8_C(  2), UINT8_C( 27), UINT8_C(235),
                             UINT8_C(109), UINT8_C(152), UINT8_C(220), UINT8_C(143),
                             UINT8_C(189), UINT8_C(222), UINT8_C(102), UINT8_C(126),
                             UINT8_C( 80), UINT8_C( 51), UINT8_C(253), UINT8_C(186),
                             UINT8_C( 51), UINT8_C(206), UINT8_C(118), UINT8_C( 48),
                             UINT8_C( 59), UINT8_C(184), UINT8_C(197), UINT8_C(107),
                             UINT8_C( 52), UINT8_C(  5), UINT8_C(208), UINT8_C(231),
                             UINT8_C(151), UINT8_C(166), UINT8_C(151), UINT8_C( 49)),
      easysimd_x_mm512_set_epu8(UINT8_C(255), UINT8_C(129), UINT8_C(219), UINT8_C(221),
                             UINT8_C(186), UINT8_C( 75), UINT8_C(231), UINT8_C(243),
                             UINT8_C( 54), UINT8_C( 10), UINT8_C( 52), UINT8_C(157),
                             UINT8_C( 51), UINT8_C( 63), UINT8_C(190), UINT8_C(105),
                             UINT8_C(159), UINT8_C( 57), UINT8_C(152), UINT8_C(  2),
                             UINT8_C(134), UINT8_C(112), UINT8_C( 29), UINT8_C(  8),
                             UINT8_C(240), UINT8_C( 55), UINT8_C(110), UINT8_C(144),
                             UINT8_C(247), UINT8_C( 78), UINT8_C(254), UINT8_C( 89),
                             UINT8_C(189), UINT8_C(169), UINT8_C(164), UINT8_C(239),
                             UINT8_C(227), UINT8_C(187), UINT8_C( 11), UINT8_C(211),
                             UINT8_C(183), UINT8_C(  9), UINT8_C(204), UINT8_C(138),
                             UINT8_C(223), UINT8_C( 91), UINT8_C(198), UINT8_C( 18),
                             UINT8_C(178), UINT8_C(209), UINT8_C(152), UINT8_C(100),
                             UINT8_C(247), UINT8_C(142), UINT8_C( 53), UINT8_C( 94),
                             UINT8_C(238), UINT8_C(239), UINT8_C(151), UINT8_C(119),
                             UINT8_C(229), UINT8_C( 96), UINT8_C(245), UINT8_C(  0)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(213), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C( 55), UINT8_C(168),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 42), UINT8_C(  0), UINT8_C( 13),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(112),
                             UINT8_C(  0), UINT8_C( 70), UINT8_C(  0), UINT8_C( 49)) },
    { UINT64_C(          2805277521),
      easysimd_x_mm512_set_epu8(UINT8_C(241), UINT8_C(232), UINT8_C(128), UINT8_C(233),
                             UINT8_C(178), UINT8_C(  6), UINT8_C(154), UINT8_C(184),
                             UINT8_C(219), UINT8_C(217), UINT8_C( 22), UINT8_C( 47),
                             UINT8_C( 81), UINT8_C(179), UINT8_C( 53), UINT8_C( 28),
                             UINT8_C(206), UINT8_C(206), UINT8_C( 30), UINT8_C( 15),
                             UINT8_C(114), UINT8_C(103), UINT8_C( 13), UINT8_C(110),
                             UINT8_C(166), UINT8_C( 46), UINT8_C(130), UINT8_C(151),
                             UINT8_C( 16), UINT8_C( 40), UINT8_C(154), UINT8_C( 67),
                             UINT8_C(184), UINT8_C( 37), UINT8_C(207), UINT8_C( 94),
                             UINT8_C( 79), UINT8_C(202), UINT8_C(122), UINT8_C(203),
                             UINT8_C(179), UINT8_C(164), UINT8_C( 37), UINT8_C(173),
                             UINT8_C( 95), UINT8_C(170), UINT8_C( 47), UINT8_C(161),
                             UINT8_C(255), UINT8_C(185), UINT8_C(163), UINT8_C(181),
                             UINT8_C( 29), UINT8_C(148), UINT8_C(134), UINT8_C( 11),
                             UINT8_C(137), UINT8_C(213), UINT8_C(115), UINT8_C(139),
                             UINT8_C( 77), UINT8_C(129), UINT8_C( 55), UINT8_C(  6)),
      easysimd_x_mm512_set_epu8(UINT8_C( 39), UINT8_C(159), UINT8_C( 61), UINT8_C( 37),
                             UINT8_C(160), UINT8_C(166), UINT8_C( 87), UINT8_C(103),
                             UINT8_C(228), UINT8_C( 29), UINT8_C(156), UINT8_C(201),
                             UINT8_C(217), UINT8_C( 60), UINT8_C( 61), UINT8_C( 86),
                             UINT8_C(205), UINT8_C(204), UINT8_C( 26), UINT8_C( 35),
                             UINT8_C(113), UINT8_C( 54), UINT8_C( 44), UINT8_C(150),
                             UINT8_C(  5), UINT8_C(127), UINT8_C(118), UINT8_C(122),
                             UINT8_C(  8), UINT8_C( 76), UINT8_C( 62), UINT8_C( 54),
                             UINT8_C(171), UINT8_C(236), UINT8_C(228), UINT8_C( 23),
                             UINT8_C(167), UINT8_C( 85), UINT8_C(106), UINT8_C(203),
                             UINT8_C( 75), UINT8_C(211), UINT8_C(183), UINT8_C(233),
                             UINT8_C(230), UINT8_C(155), UINT8_C(159), UINT8_C(231),
                             UINT8_C( 53), UINT8_C( 16), UINT8_C(224), UINT8_C(218),
                             UINT8_C(254), UINT8_C(170), UINT8_C(229), UINT8_C(158),
                             UINT8_C(154), UINT8_C(108), UINT8_C(114), UINT8_C(193),
                             UINT8_C(254), UINT8_C( 39), UINT8_C(143), UINT8_C(155)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 13), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(117), UINT8_C( 16), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 15), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(105), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0)) },
    { UINT64_C(          2080103780),
      easysimd_x_mm512_set_epu8(UINT8_C( 35), UINT8_C(245), UINT8_C(193), UINT8_C( 56),
                             UINT8_C(248), UINT8_C(186), UINT8_C( 68), UINT8_C(150),
                             UINT8_C(220), UINT8_C(248), UINT8_C(101), UINT8_C(  0),
                             UINT8_C(116), UINT8_C(116), UINT8_C( 64), UINT8_C(175),
                             UINT8_C(165), UINT8_C(173), UINT8_C(234), UINT8_C(165),
                             UINT8_C(146), UINT8_C(243), UINT8_C( 52), UINT8_C( 89),
                             UINT8_C(227), UINT8_C( 93), UINT8_C(108), UINT8_C( 47),
                             UINT8_C(207), UINT8_C(115), UINT8_C(178), UINT8_C(155),
                             UINT8_C(250), UINT8_C(115), UINT8_C(  2), UINT8_C( 73),
                             UINT8_C(254), UINT8_C(119), UINT8_C( 72), UINT8_C(108),
                             UINT8_C( 90), UINT8_C( 96), UINT8_C( 56), UINT8_C(182),
                             UINT8_C( 64), UINT8_C(  8), UINT8_C(172), UINT8_C(169),
                             UINT8_C( 32), UINT8_C( 75), UINT8_C( 92), UINT8_C(114),
                             UINT8_C( 16), UINT8_C( 36), UINT8_C(161), UINT8_C( 46),
                             UINT8_C(214), UINT8_C(247), UINT8_C(176), UINT8_C( 43),
                             UINT8_C(168), UINT8_C(161), UINT8_C(148), UINT8_C( 77)),
      easysimd_x_mm512_set_epu8(UINT8_C( 56), UINT8_C(209), UINT8_C( 90), UINT8_C(226),
                             UINT8_C(128), UINT8_C( 65), UINT8_C( 94), UINT8_C(244),
                             UINT8_C(183), UINT8_C( 61), UINT8_C(186), UINT8_C(254),
                             UINT8_C(239), UINT8_C( 84), UINT8_C(120), UINT8_C(211),
                             UINT8_C(215), UINT8_C( 43), UINT8_C(249), UINT8_C(194),
                             UINT8_C(157), UINT8_C(199), UINT8_C( 98), UINT8_C(233),
                             UINT8_C( 27), UINT8_C(181), UINT8_C(227), UINT8_C( 75),
                             UINT8_C( 73), UINT8_C( 96), UINT8_C(149), UINT8_C(223),
                             UINT8_C(104), UINT8_C( 32), UINT8_C( 22), UINT8_C(168),
                             UINT8_C( 89), UINT8_C( 99), UINT8_C(164), UINT8_C(153),
                             UINT8_C( 65), UINT8_C(170), UINT8_C( 53), UINT8_C( 47),
                             UINT8_C(191), UINT8_C(169), UINT8_C( 40), UINT8_C( 76),
                             UINT8_C(114), UINT8_C(220), UINT8_C( 85), UINT8_C(210),
                             UINT8_C(141), UINT8_C( 16), UINT8_C( 66), UINT8_C(216),
                             UINT8_C(211), UINT8_C(107), UINT8_C(217), UINT8_C(119),
                             UINT8_C(250), UINT8_C( 64), UINT8_C(254), UINT8_C( 91)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 83), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(165), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 25), UINT8_C(  0), UINT8_C(  3), UINT8_C(135),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(132), UINT8_C( 93),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 20), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(140), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 97), UINT8_C(  0), UINT8_C(  0)) },
    { UINT64_C(          3123384269),
      easysimd_x_mm512_set_epu8(UINT8_C( 96), UINT8_C(111), UINT8_C( 93), UINT8_C(100),
                             UINT8_C(124), UINT8_C( 70), UINT8_C(116), UINT8_C(210),
                             UINT8_C( 69), UINT8_C(255), UINT8_C(157), UINT8_C(160),
                             UINT8_C( 53), UINT8_C( 12), UINT8_C(237), UINT8_C(134),
                             UINT8_C( 21), UINT8_C(153), UINT8_C(252), UINT8_C(180),
                             UINT8_C(184), UINT8_C( 70), UINT8_C( 16), UINT8_C(164),
                             UINT8_C( 32), UINT8_C(157), UINT8_C(177), UINT8_C(185),
                             UINT8_C( 75), UINT8_C(213), UINT8_C(118), UINT8_C( 48),
                             UINT8_C(250), UINT8_C(247), UINT8_C(144), UINT8_C(182),
                             UINT8_C( 89), UINT8_C(193), UINT8_C(215), UINT8_C(109),
                             UINT8_C( 32), UINT8_C( 44), UINT8_C( 30), UINT8_C(115),
                             UINT8_C(122), UINT8_C(173), UINT8_C( 22), UINT8_C(177),
                             UINT8_C(163), UINT8_C(190), UINT8_C(161), UINT8_C(157),
                             UINT8_C(186), UINT8_C(207), UINT8_C(230), UINT8_C( 94),
                             UINT8_C(188), UINT8_C( 54), UINT8_C(164), UINT8_C(150),
                             UINT8_C( 11), UINT8_C( 80), UINT8_C(167), UINT8_C(171)),
      easysimd_x_mm512_set_epu8(UINT8_C( 62), UINT8_C(166), UINT8_C(227), UINT8_C( 87),
                             UINT8_C(254), UINT8_C( 17), UINT8_C(235), UINT8_C(147),
                             UINT8_C(215), UINT8_C(  8), UINT8_C(107), UINT8_C( 75),
                             UINT8_C(237), UINT8_C(121), UINT8_C( 75), UINT8_C( 80),
                             UINT8_C( 31), UINT8_C( 58), UINT8_C(132), UINT8_C( 37),
                             UINT8_C(154), UINT8_C(  6), UINT8_C( 75), UINT8_C(156),
                             UINT8_C(149), UINT8_C(144), UINT8_C(181), UINT8_C(171),
                             UINT8_C(160), UINT8_C( 77), UINT8_C(155), UINT8_C(252),
                             UINT8_C(181), UINT8_C(149), UINT8_C( 69), UINT8_C( 75),
                             UINT8_C(202), UINT8_C( 32), UINT8_C( 21), UINT8_C( 82),
                             UINT8_C(184), UINT8_C(152), UINT8_C(217), UINT8_C( 20),
                             UINT8_C( 41), UINT8_C( 41), UINT8_C(  1), UINT8_C( 97),
                             UINT8_C(165), UINT8_C(111), UINT8_C(131), UINT8_C( 21),
                             UINT8_C( 63), UINT8_C( 20), UINT8_C(145), UINT8_C(147),
                             UINT8_C( 66), UINT8_C( 29), UINT8_C(208), UINT8_C( 15),
                             UINT8_C(209), UINT8_C(114), UINT8_C(194), UINT8_C(  3)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 69), UINT8_C(  0), UINT8_C( 75), UINT8_C(107),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(194), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 81), UINT8_C(  0), UINT8_C( 21), UINT8_C( 80),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(123), UINT8_C(187), UINT8_C( 85), UINT8_C(  0),
                             UINT8_C(122), UINT8_C( 25), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(168)) },
    { UINT64_C(          3899248884),
      easysimd_x_mm512_set_epu8(UINT8_C(219), UINT8_C(209), UINT8_C(106), UINT8_C(223),
                             UINT8_C(220), UINT8_C(150), UINT8_C(243), UINT8_C( 88),
                             UINT8_C( 23), UINT8_C( 59), UINT8_C(210), UINT8_C(197),
                             UINT8_C( 39), UINT8_C(187), UINT8_C( 89), UINT8_C( 99),
                             UINT8_C( 19), UINT8_C(249), UINT8_C( 10), UINT8_C( 39),
                             UINT8_C(237), UINT8_C(106), UINT8_C( 56), UINT8_C( 28),
                             UINT8_C(181), UINT8_C( 56), UINT8_C(192), UINT8_C(150),
                             UINT8_C( 44), UINT8_C(209), UINT8_C( 13), UINT8_C(238),
                             UINT8_C(199), UINT8_C(135), UINT8_C(144), UINT8_C(  8),
                             UINT8_C( 13), UINT8_C(143), UINT8_C(242), UINT8_C(219),
                             UINT8_C(103), UINT8_C(252), UINT8_C(214), UINT8_C(167),
                             UINT8_C(  3), UINT8_C(136), UINT8_C(222), UINT8_C(241),
                             UINT8_C(  7), UINT8_C( 92), UINT8_C(141), UINT8_C(140),
                             UINT8_C(104), UINT8_C(125), UINT8_C(212), UINT8_C(114),
                             UINT8_C(114), UINT8_C(229), UINT8_C(235), UINT8_C(144),
                             UINT8_C(233), UINT8_C(188), UINT8_C( 95), UINT8_C(193)),
      easysimd_x_mm512_set_epu8(UINT8_C(198), UINT8_C( 49), UINT8_C(205), UINT8_C(189),
                             UINT8_C( 32), UINT8_C(168), UINT8_C(102), UINT8_C( 88),
                             UINT8_C( 86), UINT8_C(170), UINT8_C(185), UINT8_C( 98),
                             UINT8_C(232), UINT8_C( 43), UINT8_C( 26), UINT8_C(165),
                             UINT8_C(105), UINT8_C(165), UINT8_C(196), UINT8_C(175),
                             UINT8_C( 21), UINT8_C( 33), UINT8_C( 59), UINT8_C( 91),
                             UINT8_C(173), UINT8_C( 84), UINT8_C(102), UINT8_C(234),
                             UINT8_C(240), UINT8_C( 97), UINT8_C( 44), UINT8_C(117),
                             UINT8_C(253), UINT8_C( 63), UINT8_C(177), UINT8_C(  7),
                             UINT8_C( 84), UINT8_C(101), UINT8_C( 54), UINT8_C(237),
                             UINT8_C(110), UINT8_C( 66), UINT8_C( 52), UINT8_C(158),
                             UINT8_C(218), UINT8_C(146), UINT8_C(129), UINT8_C(  7),
                             UINT8_C(170), UINT8_C( 34), UINT8_C( 11), UINT8_C( 33),
                             UINT8_C(109), UINT8_C( 75), UINT8_C(249), UINT8_C(174),
                             UINT8_C( 89), UINT8_C(221), UINT8_C(115), UINT8_C(113),
                             UINT8_C(179), UINT8_C( 55), UINT8_C(200), UINT8_C( 84)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C( 72), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(186), UINT8_C(162), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(234),
                             UINT8_C(  0), UINT8_C( 58), UINT8_C(  0), UINT8_C(107),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 25), UINT8_C(  8), UINT8_C(120), UINT8_C( 31),
                             UINT8_C(  0), UINT8_C(133), UINT8_C(  0), UINT8_C(  0)) },
    { UINT64_C(          1783299355),
      easysimd_x_mm512_set_epu8(UINT8_C(158), UINT8_C( 81), UINT8_C(244), UINT8_C( 20),
                             UINT8_C(204), UINT8_C( 92), UINT8_C(198), UINT8_C(205),
                             UINT8_C( 11), UINT8_C( 60), UINT8_C(191), UINT8_C( 47),
                             UINT8_C( 22), UINT8_C(151), UINT8_C(149), UINT8_C( 16),
                             UINT8_C(247), UINT8_C(164), UINT8_C( 21), UINT8_C( 75),
                             UINT8_C(153), UINT8_C(240), UINT8_C(253), UINT8_C(242),
                             UINT8_C(202), UINT8_C( 54), UINT8_C( 42), UINT8_C(168),
                             UINT8_C( 22), UINT8_C(221), UINT8_C( 17), UINT8_C(189),
                             UINT8_C( 39), UINT8_C(155), UINT8_C(135), UINT8_C(162),
                             UINT8_C(148), UINT8_C(181), UINT8_C(120), UINT8_C( 52),
                             UINT8_C(206), UINT8_C( 24), UINT8_C(206), UINT8_C(117),
                             UINT8_C(240), UINT8_C( 17), UINT8_C(210), UINT8_C(188),
                             UINT8_C(193), UINT8_C(112), UINT8_C( 80), UINT8_C(199),
                             UINT8_C(136), UINT8_C( 33), UINT8_C( 97), UINT8_C(247),
                             UINT8_C(161), UINT8_C( 97), UINT8_C( 42), UINT8_C(181),
                             UINT8_C( 25), UINT8_C( 62), UINT8_C( 47), UINT8_C( 32)),
      easysimd_x_mm512_set_epu8(UINT8_C(249), UINT8_C(227), UINT8_C(149), UINT8_C(232),
                             UINT8_C( 71), UINT8_C(244), UINT8_C(128), UINT8_C( 10),
                             UINT8_C(194), UINT8_C(169), UINT8_C(169), UINT8_C( 87),
                             UINT8_C(140), UINT8_C(131), UINT8_C( 55), UINT8_C(150),
                             UINT8_C(104), UINT8_C(180), UINT8_C(190), UINT8_C(178),
                             UINT8_C(  3), UINT8_C( 92), UINT8_C(141), UINT8_C( 72),
                             UINT8_C( 98), UINT8_C( 81), UINT8_C(150), UINT8_C(221),
                             UINT8_C( 96), UINT8_C( 40), UINT8_C(142), UINT8_C( 23),
                             UINT8_C( 87), UINT8_C(207), UINT8_C(191), UINT8_C( 92),
                             UINT8_C( 77), UINT8_C(157), UINT8_C(184), UINT8_C(138),
                             UINT8_C(172), UINT8_C( 66), UINT8_C(  9), UINT8_C(115),
                             UINT8_C(240), UINT8_C(175), UINT8_C(107), UINT8_C( 49),
                             UINT8_C( 50), UINT8_C(243), UINT8_C( 59), UINT8_C( 91),
                             UINT8_C(  0), UINT8_C( 76), UINT8_C(  9), UINT8_C(  2),
                             UINT8_C( 15), UINT8_C( 39), UINT8_C(150), UINT8_C( 31),
                             UINT8_C( 12), UINT8_C(247), UINT8_C(212), UINT8_C( 40)),
      easysimd_x_mm512_set_epu8(UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C( 71), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(103), UINT8_C(  0),
                             UINT8_C(143), UINT8_C(  0), UINT8_C( 21), UINT8_C(108),
                             UINT8_C(136), UINT8_C(  0), UINT8_C(  0), UINT8_C(245),
                             UINT8_C(  0), UINT8_C(  0), UINT8_C(  0), UINT8_C(150),
                             UINT8_C( 13), UINT8_C(  0), UINT8_C(  0), UINT8_C(  0)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__mmask64 k = test_vec[i].k;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_maskz_subs_epu8(k, a, b);
    }
    EASYSIMD_TEST_PERF_END("_mm512_maskz_subs_epu8");
    easysimd_assert_m512i_u8(r, ==, test_vec[i].r);
  }

  return 0;
}

static int
test_easysimd_mm512_subs_epu16(EASYSIMD_MUNIT_TEST_ARGS) {
  const struct {
    easysimd__m512i a;
    easysimd__m512i b;
    easysimd__m512i r;
  } test_vec[8] = {
    { easysimd_x_mm512_set_epu16(UINT16_C( 21075), UINT16_C( 30017), UINT16_C( 53638), UINT16_C( 29710),
                              UINT16_C( 19457), UINT16_C( 52740), UINT16_C( 21427), UINT16_C( 28826),
                              UINT16_C( 25482), UINT16_C( 53693), UINT16_C( 15582), UINT16_C( 20114),
                              UINT16_C( 50775), UINT16_C( 49946), UINT16_C( 61394), UINT16_C( 29932),
                              UINT16_C( 34864), UINT16_C(  6190), UINT16_C( 26590), UINT16_C( 10803),
                              UINT16_C( 48982), UINT16_C( 15816), UINT16_C( 14967), UINT16_C( 24063),
                              UINT16_C( 50823), UINT16_C( 57442), UINT16_C( 48719), UINT16_C( 25507),
                              UINT16_C( 19912), UINT16_C( 45607), UINT16_C( 52932), UINT16_C( 48380)),
      easysimd_x_mm512_set_epu16(UINT16_C( 27175), UINT16_C( 38414), UINT16_C( 58622), UINT16_C( 10212),
                              UINT16_C( 13894), UINT16_C( 60916), UINT16_C( 54812), UINT16_C( 62458),
                              UINT16_C( 29698), UINT16_C(  6009), UINT16_C( 28893), UINT16_C( 33802),
                              UINT16_C( 61579), UINT16_C(  6787), UINT16_C(  9325), UINT16_C(  7645),
                              UINT16_C( 63403), UINT16_C( 55903), UINT16_C( 43011), UINT16_C(  1124),
                              UINT16_C( 21781), UINT16_C( 17119), UINT16_C( 46075), UINT16_C( 33402),
                              UINT16_C( 58029), UINT16_C( 19092), UINT16_C( 21408), UINT16_C( 51092),
                              UINT16_C( 22843), UINT16_C( 28625), UINT16_C( 63214), UINT16_C(  5251)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C( 19498),
                              UINT16_C(  5563), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 47684), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 43159), UINT16_C( 52069), UINT16_C( 22287),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(  9679),
                              UINT16_C( 27201), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 38350), UINT16_C( 27311), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 16982), UINT16_C(     0), UINT16_C( 43129)) },
    { easysimd_x_mm512_set_epu16(UINT16_C( 38028), UINT16_C(  5509), UINT16_C( 52010), UINT16_C( 16909),
                              UINT16_C(  2419), UINT16_C( 22142), UINT16_C( 59427), UINT16_C( 64359),
                              UINT16_C(  9839), UINT16_C(  6329), UINT16_C( 65297), UINT16_C( 49651),
                              UINT16_C(  3666), UINT16_C( 20122), UINT16_C( 63837), UINT16_C(  6503),
                              UINT16_C( 29169), UINT16_C( 60855), UINT16_C( 62823), UINT16_C( 40827),
                              UINT16_C(  7221), UINT16_C( 61818), UINT16_C(   970), UINT16_C( 49978),
                              UINT16_C( 54525), UINT16_C( 54749), UINT16_C( 35566), UINT16_C(  3894),
                              UINT16_C( 39622), UINT16_C( 46778), UINT16_C( 11824), UINT16_C( 56668)),
      easysimd_x_mm512_set_epu16(UINT16_C(  1604), UINT16_C( 19874), UINT16_C( 53403), UINT16_C( 63570),
                              UINT16_C( 13041), UINT16_C(  1566), UINT16_C( 53745), UINT16_C( 62111),
                              UINT16_C(  7377), UINT16_C( 42156), UINT16_C( 56287), UINT16_C( 34285),
                              UINT16_C( 14877), UINT16_C( 24009), UINT16_C( 33220), UINT16_C(  8308),
                              UINT16_C( 53811), UINT16_C( 55306), UINT16_C(  1074), UINT16_C( 12341),
                              UINT16_C( 19989), UINT16_C( 16491), UINT16_C(  4144), UINT16_C( 53822),
                              UINT16_C( 19285), UINT16_C( 36338), UINT16_C( 40278), UINT16_C( 36022),
                              UINT16_C(  9755), UINT16_C( 36151), UINT16_C( 42425), UINT16_C( 62124)),
      easysimd_x_mm512_set_epu16(UINT16_C( 36424), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 20576), UINT16_C(  5682), UINT16_C(  2248),
                              UINT16_C(  2462), UINT16_C(     0), UINT16_C(  9010), UINT16_C( 15366),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C( 30617), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(  5549), UINT16_C( 61749), UINT16_C( 28486),
                              UINT16_C(     0), UINT16_C( 45327), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 35240), UINT16_C( 18411), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 29867), UINT16_C( 10627), UINT16_C(     0), UINT16_C(     0)) },
    { easysimd_x_mm512_set_epu16(UINT16_C(   691), UINT16_C( 60713), UINT16_C( 62283), UINT16_C( 34144),
                              UINT16_C( 43752), UINT16_C( 58796), UINT16_C(  9130), UINT16_C( 47263),
                              UINT16_C( 11275), UINT16_C( 38444), UINT16_C(    90), UINT16_C( 45403),
                              UINT16_C( 30523), UINT16_C( 27008), UINT16_C( 28387), UINT16_C( 17266),
                              UINT16_C( 55759), UINT16_C( 27096), UINT16_C( 57208), UINT16_C( 58724),
                              UINT16_C( 42582), UINT16_C( 61127), UINT16_C( 21734), UINT16_C( 45841),
                              UINT16_C( 53555), UINT16_C( 44341), UINT16_C( 18272), UINT16_C( 28327),
                              UINT16_C(  7123), UINT16_C( 33320), UINT16_C( 24489), UINT16_C( 49868)),
      easysimd_x_mm512_set_epu16(UINT16_C( 44159), UINT16_C( 15856), UINT16_C(  7686), UINT16_C( 36968),
                              UINT16_C( 50344), UINT16_C( 55789), UINT16_C( 11300), UINT16_C( 27000),
                              UINT16_C( 58901), UINT16_C(  3626), UINT16_C( 12716), UINT16_C( 34965),
                              UINT16_C( 31697), UINT16_C(  5622), UINT16_C( 24444), UINT16_C( 57310),
                              UINT16_C( 57273), UINT16_C(  2890), UINT16_C( 26732), UINT16_C( 56773),
                              UINT16_C( 51586), UINT16_C( 27415), UINT16_C(  7653), UINT16_C( 31511),
                              UINT16_C( 44454), UINT16_C(  2398), UINT16_C( 23365), UINT16_C( 52633),
                              UINT16_C( 47315), UINT16_C(  4204), UINT16_C( 45083), UINT16_C( 15021)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C( 44857), UINT16_C( 54597), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(  3007), UINT16_C(     0), UINT16_C( 20263),
                              UINT16_C(     0), UINT16_C( 34818), UINT16_C(     0), UINT16_C( 10438),
                              UINT16_C(     0), UINT16_C( 21386), UINT16_C(  3943), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 24206), UINT16_C( 30476), UINT16_C(  1951),
                              UINT16_C(     0), UINT16_C( 33712), UINT16_C( 14081), UINT16_C( 14330),
                              UINT16_C(  9101), UINT16_C( 41943), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 29116), UINT16_C(     0), UINT16_C( 34847)) },
    { easysimd_x_mm512_set_epu16(UINT16_C(  4451), UINT16_C( 62415), UINT16_C( 11648), UINT16_C( 14185),
                              UINT16_C( 57037), UINT16_C( 40857), UINT16_C( 33903), UINT16_C( 19019),
                              UINT16_C( 26210), UINT16_C( 35593), UINT16_C( 46653), UINT16_C( 25468),
                              UINT16_C( 20366), UINT16_C(  4961), UINT16_C( 40068), UINT16_C( 61378),
                              UINT16_C(  6653), UINT16_C( 63816), UINT16_C( 35813), UINT16_C( 51292),
                              UINT16_C( 60619), UINT16_C(   730), UINT16_C( 44859), UINT16_C( 16986),
                              UINT16_C(  9316), UINT16_C( 28795), UINT16_C( 47263), UINT16_C( 36113),
                              UINT16_C( 41862), UINT16_C(  7963), UINT16_C( 28019), UINT16_C( 13728)),
      easysimd_x_mm512_set_epu16(UINT16_C( 54766), UINT16_C( 29411), UINT16_C( 30463), UINT16_C( 60634),
                              UINT16_C( 45144), UINT16_C( 37285), UINT16_C( 11448), UINT16_C( 27155),
                              UINT16_C( 53867), UINT16_C( 11820), UINT16_C( 49024), UINT16_C( 10540),
                              UINT16_C( 17477), UINT16_C( 45777), UINT16_C( 28024), UINT16_C( 51105),
                              UINT16_C( 24400), UINT16_C( 57953), UINT16_C( 53407), UINT16_C( 28592),
                              UINT16_C( 34479), UINT16_C( 47445), UINT16_C( 19926), UINT16_C( 36275),
                              UINT16_C(  7501), UINT16_C( 16620), UINT16_C(  6953), UINT16_C(  3437),
                              UINT16_C(  5790), UINT16_C(  5348), UINT16_C( 17145), UINT16_C( 36745)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C( 33004), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 11893), UINT16_C(  3572), UINT16_C( 22455), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 23773), UINT16_C(     0), UINT16_C( 14928),
                              UINT16_C(  2889), UINT16_C(     0), UINT16_C( 12044), UINT16_C( 10273),
                              UINT16_C(     0), UINT16_C(  5863), UINT16_C(     0), UINT16_C( 22700),
                              UINT16_C( 26140), UINT16_C(     0), UINT16_C( 24933), UINT16_C(     0),
                              UINT16_C(  1815), UINT16_C( 12175), UINT16_C( 40310), UINT16_C( 32676),
                              UINT16_C( 36072), UINT16_C(  2615), UINT16_C( 10874), UINT16_C(     0)) },
    { easysimd_x_mm512_set_epu16(UINT16_C( 33975), UINT16_C( 18949), UINT16_C( 63249), UINT16_C( 45002),
                              UINT16_C( 64479), UINT16_C( 62490), UINT16_C( 22138), UINT16_C( 54505),
                              UINT16_C(    43), UINT16_C( 59270), UINT16_C( 45446), UINT16_C( 43143),
                              UINT16_C( 39490), UINT16_C( 41833), UINT16_C( 28092), UINT16_C(  6346),
                              UINT16_C( 10308), UINT16_C(   572), UINT16_C(     5), UINT16_C( 15306),
                              UINT16_C( 46107), UINT16_C( 59725), UINT16_C( 38116), UINT16_C( 36408),
                              UINT16_C( 51860), UINT16_C( 61863), UINT16_C( 39379), UINT16_C( 19197),
                              UINT16_C( 37943), UINT16_C( 45506), UINT16_C(  3690), UINT16_C( 61686)),
      easysimd_x_mm512_set_epu16(UINT16_C( 53628), UINT16_C( 14774), UINT16_C(  5244), UINT16_C( 18107),
                              UINT16_C( 49140), UINT16_C( 31910), UINT16_C( 36671), UINT16_C( 45498),
                              UINT16_C( 46302), UINT16_C( 50428), UINT16_C( 55100), UINT16_C( 19911),
                              UINT16_C(  3330), UINT16_C( 28633), UINT16_C( 10550), UINT16_C( 56178),
                              UINT16_C( 23697), UINT16_C( 19726), UINT16_C( 39129), UINT16_C( 46658),
                              UINT16_C(  4326), UINT16_C( 42894), UINT16_C( 48134), UINT16_C( 16035),
                              UINT16_C( 14223), UINT16_C( 50376), UINT16_C( 56066), UINT16_C( 61784),
                              UINT16_C(  6710), UINT16_C( 21116), UINT16_C( 55957), UINT16_C( 10253)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C(  4175), UINT16_C( 58005), UINT16_C( 26895),
                              UINT16_C( 15339), UINT16_C( 30580), UINT16_C(     0), UINT16_C(  9007),
                              UINT16_C(     0), UINT16_C(  8842), UINT16_C(     0), UINT16_C( 23232),
                              UINT16_C( 36160), UINT16_C( 13200), UINT16_C( 17542), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 41781), UINT16_C( 16831), UINT16_C(     0), UINT16_C( 20373),
                              UINT16_C( 37637), UINT16_C( 11487), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 31233), UINT16_C( 24390), UINT16_C(     0), UINT16_C( 51433)) },
    { easysimd_x_mm512_set_epu16(UINT16_C(  1468), UINT16_C( 61147), UINT16_C(  1296), UINT16_C( 37821),
                              UINT16_C( 49916), UINT16_C(  3731), UINT16_C( 58247), UINT16_C( 37833),
                              UINT16_C(   474), UINT16_C( 27447), UINT16_C( 56500), UINT16_C(  9176),
                              UINT16_C(  2726), UINT16_C( 53392), UINT16_C( 63435), UINT16_C( 26907),
                              UINT16_C( 40836), UINT16_C(  1244), UINT16_C( 61609), UINT16_C( 42904),
                              UINT16_C( 58011), UINT16_C( 17743), UINT16_C( 15263), UINT16_C( 61713),
                              UINT16_C( 27307), UINT16_C( 32391), UINT16_C( 42266), UINT16_C( 36235),
                              UINT16_C( 23369), UINT16_C( 50245), UINT16_C( 59696), UINT16_C( 18168)),
      easysimd_x_mm512_set_epu16(UINT16_C( 23449), UINT16_C( 17725), UINT16_C( 44617), UINT16_C( 31466),
                              UINT16_C( 31308), UINT16_C( 63353), UINT16_C( 34185), UINT16_C( 33150),
                              UINT16_C( 26890), UINT16_C( 34945), UINT16_C( 52751), UINT16_C( 41898),
                              UINT16_C( 33581), UINT16_C( 55689), UINT16_C( 19108), UINT16_C( 45621),
                              UINT16_C(  4587), UINT16_C( 27034), UINT16_C( 65517), UINT16_C( 28332),
                              UINT16_C( 41747), UINT16_C( 40576), UINT16_C( 59697), UINT16_C( 25722),
                              UINT16_C( 41113), UINT16_C( 15592), UINT16_C(  6092), UINT16_C( 56264),
                              UINT16_C( 52740), UINT16_C( 47873), UINT16_C( 59382), UINT16_C( 23859)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C( 43422), UINT16_C(     0), UINT16_C(  6355),
                              UINT16_C( 18608), UINT16_C(     0), UINT16_C( 24062), UINT16_C(  4683),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(  3749), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C( 44327), UINT16_C(     0),
                              UINT16_C( 36249), UINT16_C(     0), UINT16_C(     0), UINT16_C( 14572),
                              UINT16_C( 16264), UINT16_C(     0), UINT16_C(     0), UINT16_C( 35991),
                              UINT16_C(     0), UINT16_C( 16799), UINT16_C( 36174), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(  2372), UINT16_C(   314), UINT16_C(     0)) },
    { easysimd_x_mm512_set_epu16(UINT16_C( 42795), UINT16_C( 13394), UINT16_C( 56119), UINT16_C( 28906),
                              UINT16_C( 46556), UINT16_C( 57073), UINT16_C(  9174), UINT16_C( 39931),
                              UINT16_C(   547), UINT16_C(  3767), UINT16_C( 52959), UINT16_C( 48990),
                              UINT16_C( 64235), UINT16_C( 58389), UINT16_C( 26281), UINT16_C( 29309),
                              UINT16_C( 29052), UINT16_C( 34694), UINT16_C(  5995), UINT16_C(  6270),
                              UINT16_C( 20539), UINT16_C( 10179), UINT16_C( 38688), UINT16_C( 14327),
                              UINT16_C( 15491), UINT16_C( 18652), UINT16_C( 19903), UINT16_C( 30123),
                              UINT16_C( 25261), UINT16_C( 48076), UINT16_C( 10742), UINT16_C( 60984)),
      easysimd_x_mm512_set_epu16(UINT16_C(  5754), UINT16_C( 42498), UINT16_C( 48947), UINT16_C( 41678),
                              UINT16_C( 61715), UINT16_C( 60738), UINT16_C( 30602), UINT16_C( 37004),
                              UINT16_C( 11508), UINT16_C(  7979), UINT16_C( 61659), UINT16_C( 59616),
                              UINT16_C( 41386), UINT16_C( 41040), UINT16_C( 17421), UINT16_C( 63555),
                              UINT16_C( 27523), UINT16_C( 26800), UINT16_C( 25010), UINT16_C( 27339),
                              UINT16_C( 56486), UINT16_C( 19128), UINT16_C( 15279), UINT16_C( 63719),
                              UINT16_C( 51613), UINT16_C(  5129), UINT16_C( 42918), UINT16_C( 27704),
                              UINT16_C( 60753), UINT16_C( 31238), UINT16_C( 35194), UINT16_C( 56682)),
      easysimd_x_mm512_set_epu16(UINT16_C( 37041), UINT16_C(     0), UINT16_C(  7172), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(  2927),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C( 22849), UINT16_C( 17349), UINT16_C(  8860), UINT16_C(     0),
                              UINT16_C(  1529), UINT16_C(  7894), UINT16_C(     0), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C( 23409), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C( 13523), UINT16_C(     0), UINT16_C(  2419),
                              UINT16_C(     0), UINT16_C( 16838), UINT16_C(     0), UINT16_C(  4302)) },
    { easysimd_x_mm512_set_epu16(UINT16_C( 27021), UINT16_C( 31131), UINT16_C(    63), UINT16_C( 55006),
                              UINT16_C( 64465), UINT16_C( 34252), UINT16_C( 43748), UINT16_C( 49428),
                              UINT16_C( 50369), UINT16_C( 25422), UINT16_C( 14520), UINT16_C( 51640),
                              UINT16_C( 20399), UINT16_C( 31915), UINT16_C( 49018), UINT16_C( 59334),
                              UINT16_C( 49204), UINT16_C( 62465), UINT16_C( 49892), UINT16_C( 58520),
                              UINT16_C( 13977), UINT16_C( 51690), UINT16_C( 42246), UINT16_C( 63457),
                              UINT16_C(  4753), UINT16_C( 14919), UINT16_C( 47008), UINT16_C(  7420),
                              UINT16_C( 12098), UINT16_C( 31014), UINT16_C( 17813), UINT16_C( 51080)),
      easysimd_x_mm512_set_epu16(UINT16_C( 53007), UINT16_C( 61893), UINT16_C( 36710), UINT16_C( 53426),
                              UINT16_C(  8030), UINT16_C( 20316), UINT16_C( 27324), UINT16_C( 24735),
                              UINT16_C( 58762), UINT16_C( 62832), UINT16_C( 33606), UINT16_C(  6874),
                              UINT16_C( 61584), UINT16_C(  2658), UINT16_C( 64632), UINT16_C( 57217),
                              UINT16_C( 49112), UINT16_C( 22778), UINT16_C( 18985), UINT16_C( 10063),
                              UINT16_C( 33785), UINT16_C( 16016), UINT16_C( 35319), UINT16_C( 18364),
                              UINT16_C( 45360), UINT16_C( 60575), UINT16_C( 35960), UINT16_C( 48902),
                              UINT16_C( 57525), UINT16_C( 38426), UINT16_C( 41010), UINT16_C( 54032)),
      easysimd_x_mm512_set_epu16(UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(  1580),
                              UINT16_C( 56435), UINT16_C( 13936), UINT16_C( 16424), UINT16_C( 24693),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C( 44766),
                              UINT16_C(     0), UINT16_C( 29257), UINT16_C(     0), UINT16_C(  2117),
                              UINT16_C(    92), UINT16_C( 39687), UINT16_C( 30907), UINT16_C( 48457),
                              UINT16_C(     0), UINT16_C( 35674), UINT16_C(  6927), UINT16_C( 45093),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C( 11048), UINT16_C(     0),
                              UINT16_C(     0), UINT16_C(     0), UINT16_C(     0), UINT16_C(     0)) }
  };

  for (size_t i = 0 ; i < (sizeof(test_vec) / sizeof(test_vec[0])); i++) {
    easysimd__m512i a = test_vec[i].a;
    easysimd__m512i b = test_vec[i].b;
    easysimd__m512i r;
    EASYSIMD_TEST_PERF_WITH_LOOP_START(100000) {
      r = easysimd_mm512_subs_epu16(a, b);
    } EASYSIMD_TEST_PERF_END("easysimd_mm512_subs_epu16");
    easysimd_assert_m512i_u16(r, ==, test_vec[i].r);
  }

  return 0;
}

EASYSIMD_TEST_FUNC_LIST_BEGIN
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_mask_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_maskz_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_mask_subs_epi16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_maskz_subs_epi16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_mask_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_maskz_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_mask_subs_epu16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm_maskz_subs_epu16)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_mask_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_maskz_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_mask_subs_epi16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_maskz_subs_epi16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_mask_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_maskz_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_mask_subs_epu16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm256_maskz_subs_epu16)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_subs_epi8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_maskz_subs_epi8)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_subs_epi16)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_mask_subs_epu8)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_maskz_subs_epu8)

  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_subs_epu16)
  EASYSIMD_TEST_FUNC_LIST_ENTRY(mm512_maskz_subs_epi16)
EASYSIMD_TEST_FUNC_LIST_END

#include <test/x86/avx512/test-avx512-footer.h>
